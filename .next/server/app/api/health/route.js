"use strict";(()=>{var e={};e.id=8829,e.ids=[8829],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},85158:e=>{e.exports=require("http2")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},77282:e=>{e.exports=require("process")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},18535:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>k,patchFetch:()=>b,requestAsyncStorage:()=>w,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>g});var s={};t.r(s),t.d(s,{GET:()=>p,HEAD:()=>m});var a=t(10884),o=t(16132),i=t(21040),n=t(95798);class h{constructor(){this.healthChecks=new Map,this.startTime=Date.now(),this.registerDefaultHealthChecks()}registerDefaultHealthChecks(){this.registerHealthCheck("firebase-auth",this.checkFirebaseAuth.bind(this)),this.registerHealthCheck("firestore",this.checkFirestore.bind(this)),this.registerHealthCheck("storage",this.checkStorage.bind(this)),this.registerHealthCheck("stripe",this.checkStripe.bind(this))}registerHealthCheck(e,r){this.healthChecks.set(e,r)}async runHealthChecks(){let e=[];for(let[r,t]of Array.from(this.healthChecks))try{let s=await Promise.race([t(),this.timeoutPromise(r,5e3)]);e.push(s)}catch(t){e.push({service:r,status:"unhealthy",responseTime:5e3,error:t instanceof Error?t.message:"Unknown error",timestamp:Date.now()})}return{overall:this.calculateOverallHealth(e),services:e,uptime:Date.now()-this.startTime,version:process.env.npm_package_version||"1.0.0"}}calculateOverallHealth(e){let r=e.filter(e=>"unhealthy"===e.status).length,t=e.filter(e=>"degraded"===e.status).length;return r>0?"unhealthy":t>0?"degraded":"healthy"}timeoutPromise(e,r){return new Promise((t,s)=>{setTimeout(()=>{s(Error(`Health check timeout for ${e}`))},r)})}async checkFirebaseAuth(){let e=performance.now();try{let{getAuth:r}=await Promise.all([t.e(3393),t.e(255)]).then(t.bind(t,90255)),s=r();if(s&&void 0!==s.currentUser)return{service:"firebase-auth",status:"healthy",responseTime:performance.now()-e,timestamp:Date.now()};throw Error("Firebase Auth not properly initialized")}catch(r){return{service:"firebase-auth",status:"unhealthy",responseTime:performance.now()-e,error:r instanceof Error?r.message:"Unknown error",timestamp:Date.now()}}}async checkFirestore(){let e=performance.now();try{let{doc:r,getDoc:s}=await Promise.all([t.e(3393),t.e(720)]).then(t.bind(t,70720)),{db:a}=await Promise.all([t.e(3393),t.e(720),t.e(255),t.e(7723),t.e(7469)]).then(t.bind(t,27469)),o=r(a,"system","health");await s(o);let i=performance.now()-e;return{service:"firestore",status:i>1e3?"degraded":"healthy",responseTime:i,timestamp:Date.now()}}catch(r){return{service:"firestore",status:"unhealthy",responseTime:performance.now()-e,error:r instanceof Error?r.message:"Unknown error",timestamp:Date.now()}}}async checkStorage(){let e=performance.now();try{let{getStorage:r,ref:s,getDownloadURL:a}=await Promise.all([t.e(3393),t.e(7723)]).then(t.bind(t,37723)),o=r(),i=s(o,"health-check.txt");if(o&&i)return{service:"storage",status:"healthy",responseTime:performance.now()-e,timestamp:Date.now()};throw Error("Storage not accessible")}catch(r){return{service:"storage",status:"unhealthy",responseTime:performance.now()-e,error:r instanceof Error?r.message:"Unknown error",timestamp:Date.now()}}}async checkStripe(){let e=performance.now();try{let r="pk_test_xxxxx";if(!r)throw Error("Stripe publishable key not configured");if(!r.startsWith("pk_"))throw Error("Invalid Stripe publishable key format");return{service:"stripe",status:"healthy",responseTime:performance.now()-e,timestamp:Date.now()}}catch(r){return{service:"stripe",status:"unhealthy",responseTime:performance.now()-e,error:r instanceof Error?r.message:"Unknown error",timestamp:Date.now()}}}async logMetrics(){}async sendHealthMetrics(e){try{let{getAnalytics:r,logEvent:s}=await Promise.all([t.e(3393),t.e(3754)]).then(t.bind(t,23754)),a=r();s(a,"system_health_check",{overall_status:e.overall,uptime_seconds:Math.round(e.uptime/1e3),healthy_services:e.services.filter(e=>"healthy"===e.status).length,total_services:e.services.length}),e.services.forEach(e=>{s(a,"service_health_check",{service_name:e.service,status:e.status,response_time_ms:Math.round(e.responseTime)})})}catch(e){console.warn("Failed to send health metrics:",e)}}}class c{trackError(e,r={}){let t={error:e,context:r,timestamp:Date.now(),userId:this.getCurrentUserId(),url:"unknown"};this.errorQueue.push(t),this.reportError(t),this.errorQueue.length>100&&this.errorQueue.shift()}async reportError(e){try{let{getAnalytics:r,logEvent:s}=await Promise.all([t.e(3393),t.e(3754)]).then(t.bind(t,23754)),a=r();s(a,"application_error",{error_message:e.error.message,error_stack:e.error.stack?.substring(0,500),user_id:e.userId,page_url:e.url})}catch(e){console.warn("Failed to report error:",e)}}getCurrentUserId(){try{return localStorage.getItem("userId")||void 0}catch{return}}getErrorSummary(){return{totalErrors:this.errorQueue.length,recentErrors:this.errorQueue.slice(-10),errorsByType:this.groupErrorsByType()}}groupErrorsByType(){return this.errorQueue.reduce((e,{error:r})=>{let t=r.constructor.name;return e[t]=(e[t]||0)+1,e},{})}constructor(){this.errorQueue=[]}}class l{collectWebVitals(){}observeMetric(e,r){if("PerformanceObserver"in window)try{new PerformanceObserver(t=>{t.getEntries().forEach(t=>{let s=t.startTime;"first-input"===e?s=t.processingStart-t.startTime:"layout-shift"===e&&(s=t.value),this.recordMetric(r,s)})}).observe({type:e,buffered:!0})}catch(r){console.warn(`Failed to observe ${e}:`,r)}}recordMetric(e,r){this.metrics.push({name:e,value:r,timestamp:Date.now(),url:window.location.pathname}),this.sendMetric(e,r)}async sendMetric(e,r){try{let{getAnalytics:s,logEvent:a}=await Promise.all([t.e(3393),t.e(3754)]).then(t.bind(t,23754)),o=s();a(o,"performance_metric",{metric_name:e,metric_value:Math.round(r),page_path:window.location.pathname})}catch(e){console.warn("Failed to send performance metric:",e)}}constructor(){this.metrics=[]}}let u=new h;async function p(e){try{let e=await u.runHealthChecks(),r="healthy"===e.overall?200:"degraded"===e.overall?200:503,t={timestamp:new Date().toISOString(),environment:"production",version:process.env.npm_package_version||"1.0.0",nodeVersion:process.version,platform:process.platform,arch:process.arch},s={status:e.overall,uptime:Math.round(e.uptime/1e3),services:e.services.map(e=>({name:e.service,status:e.status,responseTime:Math.round(e.responseTime),...e.error&&{error:e.error}})),system:t};return n.Z.json(s,{status:r})}catch(e){return console.error("Health check failed:",e),n.Z.json({status:"unhealthy",error:"Health check system failure",timestamp:new Date().toISOString()},{status:503})}}async function m(e){return new n.Z(null,{status:200})}new c,new l;let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/health/route",pathname:"/api/health",filename:"route",bundlePath:"app/api/health/route"},resolvedPagePath:"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/api/health/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:w,staticGenerationAsyncStorage:f,serverHooks:y,headerHooks:v,staticGenerationBailout:g}=d,k="/api/health/route";function b(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[3271,8107],()=>t(18535));module.exports=s})();