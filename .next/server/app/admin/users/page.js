(()=>{var e={};e.id=9674,e.ids=[9674],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},43480:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>o});var s=t(67096),a=t(16132),i=t(37284),n=t.n(i),l=t(32564),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(r,d);let o=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7257)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/users/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,46070)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/users/page.tsx"],u="/admin/users/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},17365:(e,r,t)=>{Promise.resolve().then(t.bind(t,95448))},95448:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var s=t(53854),a=t(34218),i=t(26422),n=t(49465),l=t(24844),d=t(59924),o=t(21663),c=t(31489),u=t(1853);function m(){let{user:e,userProfile:r,loading:t,hasRequiredRole:m}=(0,o.Rc)(),[x,p]=(0,a.useState)([]),[h,g]=(0,a.useState)(!0),[v,b]=(0,a.useState)(""),[f,y]=(0,a.useState)("all"),[j,N]=(0,a.useState)("");(0,a.useEffect)(()=>{!t&&m&&w()},[t,m,f]);let w=async()=>{try{let e;g(!0),b("");let r=(0,c.collection)(u.db,"users");switch(f){case"active":e=(0,c.query)(r,(0,c.where)("isActive","==",!0),(0,c.orderBy)("createdAt","desc"));break;case"inactive":e=(0,c.query)(r,(0,c.where)("isActive","==",!1),(0,c.orderBy)("createdAt","desc"));break;case"moderators":e=(0,c.query)(r,(0,c.where)("role","in",["moderator","admin"]),(0,c.orderBy)("createdAt","desc"));break;default:e=(0,c.query)(r,(0,c.orderBy)("createdAt","desc"))}let t=await (0,c.getDocs)(e),s=[];t.forEach(e=>{let r=e.data(),t={id:e.id,...r,createdAt:r.createdAt?.toDate?.()||new Date,updatedAt:r.updatedAt?.toDate?.()||new Date,lastLoginAt:r.lastLoginAt?.toDate?.()};s.push(t)}),p(s)}catch(e){console.error("Error loading users:",e),b("Failed to load users")}finally{g(!1)}},A=async(e,t)=>{if(r)try{N(e);let r=(0,c.doc)(u.db,"users",e),s={updatedAt:new Date};switch(t){case"activate":s.isActive=!0;break;case"deactivate":s.isActive=!1;break;case"promote":s.role="moderator";break;case"demote":s.role="user"}await (0,c.updateDoc)(r,s),p(r=>r.map(r=>r.id===e?{...r,...s}:r)),"all"!==f&&w()}catch(e){console.error(`Error ${t}ing user:`,e),alert(`Failed to ${t} user. Please try again.`)}finally{N("")}};return t?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(i.default,{}),s.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)]",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})]}):m?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(i.default,{}),s.jsx(n.Z,{}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"User Management"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Manage user accounts and permissions"})]}),s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"all",label:"All Users",count:x.length},{key:"active",label:"Active",count:x.filter(e=>e.isActive).length},{key:"inactive",label:"Inactive",count:x.filter(e=>!e.isActive).length},{key:"moderators",label:"Staff",count:x.filter(e=>["moderator","admin"].includes(e.role)).length}].map(e=>(0,s.jsxs)("button",{onClick:()=>y(e.key),className:`py-2 px-1 border-b-2 font-medium text-sm ${f===e.key?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.label,!h&&s.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2.5 rounded-full text-xs",children:e.count})]},e.key))})})}),h?s.jsx("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,r)=>s.jsx(l.Zb,{children:s.jsx(l.aY,{className:"p-6",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})})},r))}):v?(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[s.jsx("p",{className:"text-red-600",children:v}),s.jsx(d.z,{onClick:w,className:"mt-4",variant:"outline",children:"Try Again"})]}):0===x.length?s.jsx(l.Zb,{children:(0,s.jsxs)(l.aY,{className:"py-12 text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),s.jsx("p",{className:"text-gray-600",children:"No users match the current filter criteria."})]})}):s.jsx("div",{className:"space-y-4",children:x.map(e=>s.jsx(l.Zb,{children:s.jsx(l.aY,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-green-600 font-medium text-lg",children:(e.name||e.email||"U").charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name||e.email||"Unknown User"}),s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"admin"===e.role?"bg-purple-100 text-purple-800":"moderator"===e.role?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:e.role}),s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.isActive?"Active":"Inactive"})]}),s.jsx("p",{className:"text-gray-600",children:e.email}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500",children:[(0,s.jsxs)("span",{children:["Joined: ",e.createdAt.toLocaleDateString()]}),e.lastLoginAt&&(0,s.jsxs)("span",{children:["Last login:"," ",e.lastLoginAt.toLocaleDateString()]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.verifiedEmail&&(0,s.jsxs)("span",{className:"inline-flex items-center text-green-600",children:[s.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Email"]}),e.verifiedPhone&&(0,s.jsxs)("span",{className:"inline-flex items-center text-green-600",children:[s.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Phone"]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.id!==r?.id&&(0,s.jsxs)(s.Fragment,{children:[e.isActive?s.jsx(d.z,{size:"sm",variant:"outline",onClick:()=>{confirm("Are you sure you want to deactivate this user?")&&A(e.id,"deactivate")},disabled:j===e.id,className:"text-red-600 border-red-300 hover:bg-red-50",children:"Deactivate"}):s.jsx(d.z,{size:"sm",onClick:()=>A(e.id,"activate"),disabled:j===e.id,className:"bg-green-600 hover:bg-green-700",children:"Activate"}),"user"===e.role?s.jsx(d.z,{size:"sm",variant:"outline",onClick:()=>{confirm("Are you sure you want to promote this user to moderator?")&&A(e.id,"promote")},disabled:j===e.id,children:"Promote to Moderator"}):"moderator"===e.role?s.jsx(d.z,{size:"sm",variant:"outline",onClick:()=>{confirm("Are you sure you want to demote this moderator to user?")&&A(e.id,"demote")},disabled:j===e.id,children:"Demote to User"}):null]}),e.id===r?.id&&s.jsx("span",{className:"text-sm text-gray-500 px-3 py-1 bg-gray-100 rounded-md",children:"You"}),j===e.id&&s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"})]})]})})},e.id))})]})]}):null}},26422:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(8465);let a=t.n(s)()(async()=>{},{loadableGenerated:{modules:["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/components/layout/HeaderWrapper.tsx -> ./Header"]},ssr:!1,loading:()=>null})},59924:(e,r,t)=>{"use strict";t.d(r,{z:()=>o});var s=t(53854),a=t(34218),i=t(48225),n=t(82457),l=t(68504);let d=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef(({className:e,variant:r,size:t,asChild:a=!1,...n},o)=>{let c=a?i.g7:"button";return s.jsx(c,{className:(0,l.cn)(d({variant:r,size:t,className:e})),ref:o,...n})});o.displayName="Button"},21663:(e,r,t)=>{"use strict";t.d(r,{Rc:()=>d,fc:()=>u,u2:()=>o,xw:()=>n}),t(53854);var s=t(34218),a=t(51018),i=t(58198);let n=(e="/auth/login")=>{let{user:r,loading:t}=(0,i.useAuth)(),n=(0,a.useRouter)();return(0,s.useEffect)(()=>{if(!t&&!r){let r=window.location.pathname,t=`${e}?redirect=${encodeURIComponent(r)}`;n.push(t)}},[r,t,n,e]),{user:r,loading:t,isAuthenticated:!!r}},l=(e,r="/dashboard")=>{let{user:t,userProfile:n,loading:l}=(0,i.useAuth)(),d=(0,a.useRouter)();return(0,s.useEffect)(()=>{if(!l){if(t)n&&!e.includes(n.role)&&d.push(r);else{let e=window.location.pathname,r=`/auth/login?redirect=${encodeURIComponent(e)}`;d.push(r)}}},[t,n,l,d,e,r]),{user:t,userProfile:n,loading:l,isAuthenticated:!!t,hasRequiredRole:!!n&&e.includes(n.role)}},d=(e="/dashboard")=>l(["admin"],e),o=(e="/dashboard")=>l(["moderator","admin"],e),c=(e,r)=>!!e&&r.includes(e.role),u=e=>c(e,["moderator","admin"])},68504:(e,r,t)=>{"use strict";t.d(r,{cn:()=>i});var s=t(29395),a=t(1088);function i(...e){return(0,a.m6)((0,s.W)(e))}},7257:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,t(95153).createProxy)(String.raw`/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/users/page.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[3271,8025,6078,7490,580,3257],()=>t(43480));module.exports=s})();