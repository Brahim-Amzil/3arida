(()=>{var e={};e.id=9674,e.ids=[9674],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},43480:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>o});var t=s(50482),a=s(69108),i=s(62563),n=s.n(i),l=s(68300),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(r,d);let o=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,75002)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/users/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,33990)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/users/page.tsx"],u="/admin/users/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},17365:(e,r,s)=>{Promise.resolve().then(s.bind(s,45289))},45289:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>x});var t=s(95344),a=s(3729),i=s(20783),n=s.n(i),l=s(84454),d=s(23673),o=s(5094),c=s(51133),u=s(87097),m=s(81012);function x(){let{user:e,userProfile:r,loading:s,hasRequiredRole:i}=(0,c.Rc)(),[x,p]=(0,a.useState)([]),[h,g]=(0,a.useState)(!0),[v,b]=(0,a.useState)(""),[f,j]=(0,a.useState)("all"),[y,N]=(0,a.useState)("");(0,a.useEffect)(()=>{!s&&i&&A()},[s,i,f]);let A=async()=>{try{let e;g(!0),b("");let r=(0,u.collection)(m.db,"users");switch(f){case"active":e=(0,u.query)(r,(0,u.where)("isActive","==",!0),(0,u.orderBy)("createdAt","desc"));break;case"inactive":e=(0,u.query)(r,(0,u.where)("isActive","==",!1),(0,u.orderBy)("createdAt","desc"));break;case"moderators":e=(0,u.query)(r,(0,u.where)("role","in",["moderator","admin"]),(0,u.orderBy)("createdAt","desc"));break;default:e=(0,u.query)(r,(0,u.orderBy)("createdAt","desc"))}let s=await (0,u.getDocs)(e),t=[];s.forEach(e=>{let r=e.data(),s={id:e.id,...r,createdAt:r.createdAt?.toDate?.()||new Date,updatedAt:r.updatedAt?.toDate?.()||new Date,lastLoginAt:r.lastLoginAt?.toDate?.()};t.push(s)}),p(t)}catch(e){console.error("Error loading users:",e),b("Failed to load users")}finally{g(!1)}},w=async(e,s)=>{if(r)try{N(e);let r=(0,u.doc)(m.db,"users",e),t={updatedAt:new Date};switch(s){case"activate":t.isActive=!0;break;case"deactivate":t.isActive=!1;break;case"promote":t.role="moderator";break;case"demote":t.role="user"}await (0,u.updateDoc)(r,t),p(r=>r.map(r=>r.id===e?{...r,...t}:r)),"all"!==f&&A()}catch(e){console.error(`Error ${s}ing user:`,e),alert(`Failed to ${s} user. Please try again.`)}finally{N("")}};return s?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(l.Z,{}),t.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)]",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})]}):i?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(l.Z,{}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[t.jsx("div",{className:"flex items-center gap-4 mb-4",children:t.jsx(o.z,{variant:"outline",asChild:!0,children:(0,t.jsxs)(n(),{href:"/admin",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Dashboard"]})})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"User Management"}),t.jsx("p",{className:"text-lg text-gray-600",children:"Manage user accounts and permissions"})]}),t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"border-b border-gray-200",children:t.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"all",label:"All Users",count:x.length},{key:"active",label:"Active",count:x.filter(e=>e.isActive).length},{key:"inactive",label:"Inactive",count:x.filter(e=>!e.isActive).length},{key:"moderators",label:"Staff",count:x.filter(e=>["moderator","admin"].includes(e.role)).length}].map(e=>(0,t.jsxs)("button",{onClick:()=>j(e.key),className:`py-2 px-1 border-b-2 font-medium text-sm ${f===e.key?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.label,!h&&t.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2.5 rounded-full text-xs",children:e.count})]},e.key))})})}),h?t.jsx("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,r)=>t.jsx(d.Zb,{children:t.jsx(d.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})})},r))}):v?(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsx("p",{className:"text-red-600",children:v}),t.jsx(o.z,{onClick:A,className:"mt-4",variant:"outline",children:"Try Again"})]}):0===x.length?t.jsx(d.Zb,{children:(0,t.jsxs)(d.aY,{className:"py-12 text-center",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),t.jsx("p",{className:"text-gray-600",children:"No users match the current filter criteria."})]})}):t.jsx("div",{className:"space-y-4",children:x.map(e=>t.jsx(d.Zb,{children:t.jsx(d.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-green-600 font-medium text-lg",children:e.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"admin"===e.role?"bg-purple-100 text-purple-800":"moderator"===e.role?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:e.role}),t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.isActive?"Active":"Inactive"})]}),t.jsx("p",{className:"text-gray-600",children:e.email}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:["Joined: ",e.createdAt.toLocaleDateString()]}),e.lastLoginAt&&(0,t.jsxs)("span",{children:["Last login:"," ",e.lastLoginAt.toLocaleDateString()]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.verifiedEmail&&(0,t.jsxs)("span",{className:"inline-flex items-center text-green-600",children:[t.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Email"]}),e.verifiedPhone&&(0,t.jsxs)("span",{className:"inline-flex items-center text-green-600",children:[t.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Phone"]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.id!==r?.id&&(0,t.jsxs)(t.Fragment,{children:[e.isActive?t.jsx(o.z,{size:"sm",variant:"outline",onClick:()=>{confirm("Are you sure you want to deactivate this user?")&&w(e.id,"deactivate")},disabled:y===e.id,className:"text-red-600 border-red-300 hover:bg-red-50",children:"Deactivate"}):t.jsx(o.z,{size:"sm",onClick:()=>w(e.id,"activate"),disabled:y===e.id,className:"bg-green-600 hover:bg-green-700",children:"Activate"}),"user"===e.role?t.jsx(o.z,{size:"sm",variant:"outline",onClick:()=>{confirm("Are you sure you want to promote this user to moderator?")&&w(e.id,"promote")},disabled:y===e.id,children:"Promote to Moderator"}):"moderator"===e.role?t.jsx(o.z,{size:"sm",variant:"outline",onClick:()=>{confirm("Are you sure you want to demote this moderator to user?")&&w(e.id,"demote")},disabled:y===e.id,children:"Demote to User"}):null]}),e.id===r?.id&&t.jsx("span",{className:"text-sm text-gray-500 px-3 py-1 bg-gray-100 rounded-md",children:"You"}),y===e.id&&t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"})]})]})})},e.id))})]})]}):null}},51133:(e,r,s)=>{"use strict";s.d(r,{Rc:()=>d,fc:()=>u,u2:()=>o,xw:()=>n}),s(95344);var t=s(3729),a=s(22254),i=s(87382);let n=(e="/auth/login")=>{let{user:r,loading:s}=(0,i.useAuth)(),n=(0,a.useRouter)();return(0,t.useEffect)(()=>{if(!s&&!r){let r=window.location.pathname,s=`${e}?redirect=${encodeURIComponent(r)}`;n.push(s)}},[r,s,n,e]),{user:r,loading:s,isAuthenticated:!!r}},l=(e,r="/dashboard")=>{let{user:s,userProfile:n,loading:l}=(0,i.useAuth)(),d=(0,a.useRouter)();return(0,t.useEffect)(()=>{if(!l){if(s)n&&!e.includes(n.role)&&d.push(r);else{let e=window.location.pathname,r=`/auth/login?redirect=${encodeURIComponent(e)}`;d.push(r)}}},[s,n,l,d,e,r]),{user:s,userProfile:n,loading:l,isAuthenticated:!!s,hasRequiredRole:!!n&&e.includes(n.role)}},d=(e="/dashboard")=>l(["admin"],e),o=(e="/dashboard")=>l(["moderator","admin"],e),c=(e,r)=>!!e&&r.includes(e.role),u=e=>c(e,["moderator","admin"])},75002:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let t=(0,s(86843).createProxy)(String.raw`/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/users/page.tsx`),{__esModule:a,$$typeof:i}=t,n=t.default}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[1638,322,8584,783,2569,8415,4454],()=>s(43480));module.exports=t})();