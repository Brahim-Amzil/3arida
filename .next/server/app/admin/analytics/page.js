(()=>{var e={};e.id=8668,e.ids=[8668],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},59705:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>d});var r=s(67096),a=s(16132),i=s(37284),n=s.n(i),l=s(32564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let d=["",{children:["admin",{children:["analytics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,11996)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/analytics/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,46070)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/analytics/page.tsx"],x="/admin/analytics/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/analytics/page",pathname:"/admin/analytics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},55274:(e,t,s)=>{Promise.resolve().then(s.bind(s,82111))},82111:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(53854),a=s(34218),i=s(75548),n=s.n(i),l=s(26422),c=s(49465),d=s(24844),o=s(59924),x=s(21663),m=s(31489),u=s(1853);function h(){let{user:e,userProfile:t,loading:s,hasRequiredRole:i}=(0,x.Rc)(),[h,p]=(0,a.useState)({totalPetitions:0,totalSignatures:0,totalUsers:0,totalViews:0,totalShares:0,avgSignaturesPerPetition:0,petitionsByStatus:{pending:0,approved:0,rejected:0,paused:0,deleted:0,archived:0},petitionsByCategory:{},topPetitions:[],recentGrowth:{petitionsThisWeek:0,petitionsLastWeek:0,signaturesThisWeek:0,signaturesLastWeek:0}}),[g,j]=(0,a.useState)(!0),[f,v]=(0,a.useState)("");(0,a.useEffect)(()=>{!s&&i&&y()},[s,i]);let y=async()=>{try{j(!0),v("");let e=(0,m.collection)(u.db,"petitions"),t=(0,m.collection)(u.db,"users"),s=await (0,m.getDocs)(e),r=await (0,m.getDocs)(t),a=0,i=0,n=0,l={pending:0,approved:0,rejected:0,paused:0,deleted:0,archived:0},c={},d=[],o=new Date,x=new Date(o.getTime()-6048e5),h=new Date(o.getTime()-12096e5),g=0,f=0,y=0,b=0;s.forEach(e=>{let t=e.data(),s={id:e.id,...t,currentSignatures:t.currentSignatures||0,viewCount:t.viewCount||0,shareCount:t.shareCount||0,createdAt:t.createdAt?.toDate?.()||new Date,updatedAt:t.updatedAt?.toDate?.()||new Date};a+=s.currentSignatures,i+=s.viewCount,n+=s.shareCount;let r=s.status;void 0!==l[r]&&l[r]++,s.category&&(c[s.category]=(c[s.category]||0)+1),d.push(s);let o=s.createdAt;o>=x?(g++,y+=s.currentSignatures||0):o>=h&&(f++,b+=s.currentSignatures||0)}),d.sort((e,t)=>t.currentSignatures-e.currentSignatures),p({totalPetitions:s.size,totalSignatures:a,totalUsers:r.size,totalViews:i,totalShares:n,avgSignaturesPerPetition:s.size>0?Math.round(a/s.size):0,petitionsByStatus:l,petitionsByCategory:c,topPetitions:d.slice(0,10),recentGrowth:{petitionsThisWeek:g,petitionsLastWeek:f,signaturesThisWeek:y,signaturesLastWeek:b}})}catch(e){console.error("Error loading analytics:",e),v("Failed to load analytics data")}finally{j(!1)}};if(s)return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(l.default,{}),r.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)]",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})]});if(!i)return null;let b=(e,t)=>0===t?e>0?100:0:Math.round((e-t)/t*100);return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(l.default,{}),r.jsx(c.Z,{}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Platform Analytics"}),r.jsx("p",{className:"text-lg text-gray-600",children:"Comprehensive insights and statistics"})]}),g?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(8)].map((e,t)=>r.jsx(d.Zb,{children:r.jsx(d.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})})},t))}):f?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[r.jsx("p",{className:"text-red-600",children:f}),r.jsx(o.z,{onClick:y,className:"mt-4",variant:"outline",children:"Try Again"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsx(d.Zb,{children:r.jsx(d.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Petitions"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:h.totalPetitions}),(0,r.jsxs)("p",{className:"text-sm text-green-600 mt-1",children:["+",h.recentGrowth.petitionsThisWeek," this week"]})]}),r.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})})}),r.jsx(d.Zb,{children:r.jsx(d.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Signatures"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:h.totalSignatures.toLocaleString()}),(0,r.jsxs)("p",{className:"text-sm text-green-600 mt-1",children:["+",h.recentGrowth.signaturesThisWeek.toLocaleString()," ","this week"]})]}),r.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})}),r.jsx(d.Zb,{children:r.jsx(d.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:h.totalUsers}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Platform members"})]}),r.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})})]})})}),r.jsx(d.Zb,{children:r.jsx(d.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg. Signatures"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:h.avgSignaturesPerPetition}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Per petition"})]}),r.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,r.jsxs)(d.Zb,{children:[r.jsx(d.Ol,{children:r.jsx(d.ll,{children:"Petitions by Status"})}),r.jsx(d.aY,{children:r.jsx("div",{className:"space-y-4",children:Object.entries(h.petitionsByStatus).map(([e,t])=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center gap-3",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"pending"===e?"bg-yellow-100 text-yellow-800":"approved"===e?"bg-green-100 text-green-800":"rejected"===e?"bg-red-100 text-red-800":"paused"===e?"bg-orange-100 text-orange-800":"archived"===e?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:e.charAt(0).toUpperCase()+e.slice(1)})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["(",h.totalPetitions>0?Math.round(t/h.totalPetitions*100):0,"%)"]})]})]},e))})})]}),(0,r.jsxs)(d.Zb,{children:[r.jsx(d.Ol,{children:r.jsx(d.ll,{children:"Petitions by Category"})}),r.jsx(d.aY,{children:r.jsx("div",{className:"space-y-4",children:Object.entries(h.petitionsByCategory).sort(([,e],[,t])=>t-e).slice(0,6).map(([e,t])=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:e}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${h.totalPetitions>0?t/h.totalPetitions*100:0}%`}})}),r.jsx("span",{className:"text-sm font-bold text-gray-900 w-8 text-right",children:t})]})]},e))})})]})]}),(0,r.jsxs)(d.Zb,{children:[r.jsx(d.Ol,{children:r.jsx(d.ll,{children:"Top 10 Petitions by Signatures"})}),r.jsx(d.aY,{children:r.jsx("div",{className:"space-y-3",children:h.topPetitions.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[r.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,r.jsxs)("span",{className:"text-sm font-bold text-green-600",children:["#",t+1]})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("h4",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[r.jsx("span",{className:"text-sm text-gray-500",children:e.category}),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${"approved"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.status})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-6",children:[(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(e.currentSignatures||0).toLocaleString()}),r.jsx("p",{className:"text-xs text-gray-500",children:"signatures"})]}),r.jsx(o.z,{size:"sm",variant:"outline",asChild:!0,children:r.jsx(n(),{href:`/petitions/${e.id}`,children:"View"})})]})]},e.id))})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",children:[(0,r.jsxs)(d.Zb,{children:[r.jsx(d.Ol,{children:r.jsx(d.ll,{children:"Engagement Metrics"})}),r.jsx(d.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Views"}),r.jsx("span",{className:"text-xl font-bold text-gray-900",children:h.totalViews.toLocaleString()})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total Shares"}),r.jsx("span",{className:"text-xl font-bold text-gray-900",children:h.totalShares.toLocaleString()})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Avg. Views per Petition"}),r.jsx("span",{className:"text-xl font-bold text-gray-900",children:h.totalPetitions>0?Math.round(h.totalViews/h.totalPetitions):0})]})]})})]}),(0,r.jsxs)(d.Zb,{children:[r.jsx(d.Ol,{children:r.jsx(d.ll,{children:"Growth Trends"})}),r.jsx(d.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Petitions Growth"}),(0,r.jsxs)("span",{className:`text-sm font-bold ${b(h.recentGrowth.petitionsThisWeek,h.recentGrowth.petitionsLastWeek)>=0?"text-green-600":"text-red-600"}`,children:[b(h.recentGrowth.petitionsThisWeek,h.recentGrowth.petitionsLastWeek)>=0?"+":"",b(h.recentGrowth.petitionsThisWeek,h.recentGrowth.petitionsLastWeek),"%"]})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Week over week comparison"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Signatures Growth"}),(0,r.jsxs)("span",{className:`text-sm font-bold ${b(h.recentGrowth.signaturesThisWeek,h.recentGrowth.signaturesLastWeek)>=0?"text-green-600":"text-red-600"}`,children:[b(h.recentGrowth.signaturesThisWeek,h.recentGrowth.signaturesLastWeek)>=0?"+":"",b(h.recentGrowth.signaturesThisWeek,h.recentGrowth.signaturesLastWeek),"%"]})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Week over week comparison"})]})]})})]})]})]})]})]})}},26422:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(8465);let a=s.n(r)()(async()=>{},{loadableGenerated:{modules:["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/components/layout/HeaderWrapper.tsx -> ./Header"]},ssr:!1,loading:()=>null})},59924:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var r=s(53854),a=s(34218),i=s(48225),n=s(82457),l=s(68504);let c=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...n},d)=>{let o=a?i.g7:"button";return r.jsx(o,{className:(0,l.cn)(c({variant:t,size:s,className:e})),ref:d,...n})});d.displayName="Button"},21663:(e,t,s)=>{"use strict";s.d(t,{Rc:()=>c,fc:()=>x,u2:()=>d,xw:()=>n}),s(53854);var r=s(34218),a=s(51018),i=s(58198);let n=(e="/auth/login")=>{let{user:t,loading:s}=(0,i.useAuth)(),n=(0,a.useRouter)();return(0,r.useEffect)(()=>{if(!s&&!t){let t=window.location.pathname,s=`${e}?redirect=${encodeURIComponent(t)}`;n.push(s)}},[t,s,n,e]),{user:t,loading:s,isAuthenticated:!!t}},l=(e,t="/dashboard")=>{let{user:s,userProfile:n,loading:l}=(0,i.useAuth)(),c=(0,a.useRouter)();return(0,r.useEffect)(()=>{if(!l){if(s)n&&!e.includes(n.role)&&c.push(t);else{let e=window.location.pathname,t=`/auth/login?redirect=${encodeURIComponent(e)}`;c.push(t)}}},[s,n,l,c,e,t]),{user:s,userProfile:n,loading:l,isAuthenticated:!!s,hasRequiredRole:!!n&&e.includes(n.role)}},c=(e="/dashboard")=>l(["admin"],e),d=(e="/dashboard")=>l(["moderator","admin"],e),o=(e,t)=>!!e&&t.includes(e.role),x=e=>o(e,["moderator","admin"])},68504:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var r=s(29395),a=s(1088);function i(...e){return(0,a.m6)((0,r.W)(e))}},11996:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let r=(0,s(95153).createProxy)(String.raw`/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/admin/analytics/page.tsx`),{__esModule:a,$$typeof:i}=r,n=r.default}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[3271,8025,6078,7490,580,3257],()=>s(59705));module.exports=r})();