(()=>{var e={};e.id=4178,e.ids=[4178],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},3512:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var t=s(50482),a=s(69108),n=s(62563),i=s.n(n),l=s(68300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(r,o);let d=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,65648)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,33990)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/profile/page.tsx"],u="/profile/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},21277:(e,r,s)=>{Promise.resolve().then(s.bind(s,11940))},66150:(e,r,s)=>{"use strict";e.exports=s(16372).vendored.contexts.RouterContext},22254:(e,r,s)=>{e.exports=s(14767)},11940:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>y});var t=s(95344),a=s(3729),n=s.n(a),i=s(22254),l=s(49151),o=s(5094),d=s(87382),c=s(27007),u=s(50815),m=s(87097),x=s(81012),h=s(73424);async function p(e,r){if(!r.type.startsWith("image/"))throw Error("File must be an image");if(r.size>5242880)throw Error("Image must be less than 5MB");let s=Date.now(),t=r.name.split(".").pop(),a=`${e}_${s}.${t}`,n=(0,h.ref)(x.t,`profile-images/${a}`);return await (0,h.KV)(n,r),await (0,h.getDownloadURL)(n)}async function g(e){try{let r=new URL(e),s=decodeURIComponent(r.pathname.split("/o/")[1].split("?")[0]),t=(0,h.ref)(x.t,s);await (0,h.oq)(t)}catch(e){console.error("Error deleting profile image:",e)}}var f=s(41223),b=s.n(f);function y(){let e=(0,i.useRouter)(),r=(0,i.useSearchParams)(),{user:s,userProfile:h}=(0,d.useAuth)(),[f,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)(""),[P,k]=(0,a.useState)("account");(0,a.useEffect)(()=>{let e=r.get("tab");e&&["account","profile","security","preferences"].includes(e)&&k(e)},[r]);let[C,D]=(0,a.useState)({name:h?.name||s?.displayName||"",email:s?.email||"",phone:h?.phone||"",bio:h?.bio||""}),[A,S]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,a.useEffect)(()=>{h&&(console.log("\uD83D\uDD04 Syncing form data from userProfile:",{name:h.name,phone:h.phone,bio:h?.bio,fullProfile:h}),D({name:h.name||s?.displayName||"",email:s?.email||"",phone:h.phone||"",bio:h?.bio||""}))},[h,s]);let[z,q]=(0,a.useState)(!1),[E,L]=(0,a.useState)(!1),[V,_]=(0,a.useState)(h?.photoURL||s?.photoURL||null);(0,a.useEffect)(()=>{(h||s)&&_(h?.photoURL||s?.photoURL||null)},[h,s]);let U=async e=>{if(e.preventDefault(),s){y(!0),N(""),v(!1);try{console.log("\uD83D\uDCDD Updating profile with data:",{name:C.name,phone:C.phone,bio:C.bio}),C.name!==s.displayName&&await (0,u.ck)(s,{displayName:C.name});let e=(0,m.doc)(x.db,"users",s.uid);await (0,m.updateDoc)(e,{name:C.name,phone:C.phone,bio:C.bio,updatedAt:new Date}),console.log("✅ Profile updated successfully"),v(!0),setTimeout(()=>v(!1),3e3)}catch(e){console.error("❌ Error updating profile:",e),N(e.message||"Failed to update profile")}finally{y(!1)}}},M=async e=>{if(e.preventDefault(),s){if(A.newPassword!==A.confirmPassword){N("New passwords do not match."),setTimeout(()=>N(""),3e3);return}if(A.newPassword.length<6){N("New password must be at least 6 characters long."),setTimeout(()=>N(""),3e3);return}y(!0),N(""),v(!1);try{let e=u.w9.credential(s.email,A.currentPassword);await (0,u.aF)(s,e),await (0,u.gQ)(s,A.newPassword),v(!0),S({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>v(!1),3e3)}catch(r){console.error("Error updating password:",r);let e="Failed to update password.";"auth/wrong-password"===r.code&&(e="Current password is incorrect."),N(e)}finally{y(!1)}}},F=e=>{let r=e.target.name,s=e.target.value;"bio"===r&&console.log("✏️ Bio field changed:",s),D({...C,[r]:s})},R=async e=>{let r=e.target.files?.[0];if(r&&s){L(!0),N("");try{V&&await g(V);let e=await p(s.uid,r);_(e);let t=(0,m.doc)(x.db,"users",s.uid);await (0,m.updateDoc)(t,{photoURL:e,updatedAt:new Date}),await (0,u.ck)(s,{photoURL:e}),v(!0),setTimeout(()=>v(!1),3e3)}catch(e){console.error("Error uploading image:",e),N(e.message||"Failed to upload image")}finally{L(!1)}}};return(n().useEffect(()=>{s||e.push("/auth/login")},[s,e]),s)?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(l.default,{}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile Settings"}),t.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your account settings and preferences."})]}),(j||w)&&t.jsx("div",{className:`mb-6 p-4 rounded-lg ${j?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:j?"Changes saved successfully!":w}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[t.jsx("div",{className:"border-b border-gray-200",children:(0,t.jsxs)("nav",{className:"-mb-px flex",children:[t.jsx("button",{onClick:()=>k("account"),className:`py-4 px-6 text-sm font-medium border-b-2 ${"account"===P?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Account Status"}),t.jsx("button",{onClick:()=>k("profile"),className:`py-4 px-6 text-sm font-medium border-b-2 ${"profile"===P?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Profile Information"}),t.jsx("button",{onClick:()=>k("security"),className:`py-4 px-6 text-sm font-medium border-b-2 ${"security"===P?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Security"}),t.jsx("button",{onClick:()=>k("preferences"),className:`py-4 px-6 text-sm font-medium border-b-2 ${"preferences"===P?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Preferences"})]})}),(0,t.jsxs)("div",{className:"p-6",children:["account"===P&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Account Status Overview"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-12 h-12 mr-3 flex-shrink-0 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Account Type"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 capitalize",children:[h?.role||"user"," Account"]})]})]}),t.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 capitalize",children:h?.role||"User"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-12 h-12 mr-3 flex-shrink-0 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Email Verification"}),t.jsx("p",{className:"text-sm text-gray-500",children:s.emailVerified?"Your email is verified":"Please verify your email"})]})]}),t.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${s.emailVerified?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.emailVerified?"Verified":"Unverified"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-12 h-12 mr-3 flex-shrink-0 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Phone Verification"}),t.jsx("p",{className:"text-sm text-gray-500",children:(h?.verifiedPhone,"Verify phone to create and sign petitions")})]})]}),t.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${h?.verifiedPhone?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:h?.verifiedPhone?"Verified":"Pending"})]})]})]}),!h?.verifiedPhone&&(0,t.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Action Required"}),(0,t.jsxs)("div",{className:"flex items-center p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsx("div",{className:"w-5 h-5 mr-3 flex-shrink-0",children:t.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Phone Verification Required"}),t.jsx("p",{className:"text-sm text-yellow-600",children:"You must verify your phone number to create or sign petitions."})]}),t.jsx(o.z,{onClick:()=>q(!0),className:"ml-4 bg-yellow-600 hover:bg-yellow-700 flex-shrink-0",children:"Verify Phone"})]})]}),(0,t.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account Details"}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Member Since"}),t.jsx("p",{className:"text-sm text-gray-500",children:h?.createdAt?.toLocaleDateString()||"Recently"})]})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Email Address"}),t.jsx("p",{className:"text-sm text-gray-500",children:C.email})]})]})]})]})]}),"profile"===P&&(0,t.jsxs)("form",{onSubmit:U,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Profile Picture"}),(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsxs)("div",{className:"relative",children:[V?t.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200",children:t.jsx(b(),{src:V,alt:"Profile",width:96,height:96,className:"object-cover"})}):t.jsx("div",{className:"w-24 h-24 rounded-full bg-green-100 flex items-center justify-center",children:t.jsx("span",{className:"text-green-600 font-bold text-3xl",children:s?.email?.charAt(0).toUpperCase()})}),E&&t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"profile-image",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:E?"Uploading...":"Change Photo"}),t.jsx("input",{id:"profile-image",type:"file",accept:"image/*",onChange:R,disabled:E,className:"hidden"}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"JPG, PNG or GIF. Max 5MB."})]})]})]}),(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Basic Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),t.jsx("input",{type:"text",id:"name",name:"name",value:C.name,onChange:F,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),t.jsx("input",{type:"email",id:"email",name:"email",value:C.email,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"}),t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Email cannot be changed"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),t.jsx("input",{type:"tel",id:"phone",name:"phone",value:C.phone,onChange:F,placeholder:"+212 6XX XXX XXX",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]})]}),(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Information"}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),t.jsx("textarea",{id:"bio",name:"bio",value:C.bio,onChange:F,rows:4,placeholder:"Tell us about yourself...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx(o.z,{type:"submit",disabled:f,children:f?"Saving...":"Save Changes"})})]}),"security"===P&&(0,t.jsxs)("form",{onSubmit:M,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),t.jsx("input",{type:"password",id:"currentPassword",value:A.currentPassword,onChange:e=>S({...A,currentPassword:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),t.jsx("input",{type:"password",id:"newPassword",value:A.newPassword,onChange:e=>S({...A,newPassword:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",minLength:6,required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),t.jsx("input",{type:"password",id:"confirmPassword",value:A.confirmPassword,onChange:e=>S({...A,confirmPassword:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",minLength:6,required:!0})]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx(o.z,{type:"submit",disabled:f,children:f?"Updating...":"Update Password"})})]}),"preferences"===P&&t.jsx("div",{className:"space-y-8",children:(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Account Actions"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,t.jsxs)("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:"Download Account Data"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Export your account information"})]}),t.jsx(o.z,{variant:"outline",size:"sm",children:"Download"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-red-200 rounded-lg bg-red-50",children:[(0,t.jsxs)("div",{children:[t.jsx("h4",{className:"font-medium text-red-900",children:"Delete Account"}),t.jsx("p",{className:"text-sm text-red-700",children:"Permanently delete your account and all data"})]}),t.jsx(o.z,{variant:"outline",size:"sm",className:"text-red-600 border-red-300 hover:bg-red-100",children:"Delete"})]})]})]})})]})]}),z&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:t.jsx(c.Z,{onVerified:async e=>{if(s)try{let r=(0,m.doc)(x.db,"users",s.uid);console.log("\uD83D\uDCF1 Updating user profile with verified phone:",{userId:s.uid,phoneNumber:e}),await (0,m.updateDoc)(r,{phone:e,verifiedPhone:!0,updatedAt:new Date}),console.log("✅ Phone verified and saved successfully"),v(!0),q(!1)}catch(e){console.error("❌ Error updating phone:",e),N("Failed to update phone number"),q(!1)}},onCancel:()=>q(!1)})})})]})]}):null}},27007:(e,r,s)=>{"use strict";s.d(r,{Z:()=>o});var t=s(95344),a=s(3729),n=s(5094),i=s(81012),l=s(50815);function o({onVerified:e,onCancel:r}){let[s,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)("phone"),[x,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(""),[f,b]=(0,a.useState)(null),y=(0,a.useRef)(null);(0,a.useEffect)(()=>((()=>{try{y.current||(y.current=new l.lI(i.auth,"recaptcha-container",{size:"invisible",callback:()=>{console.log("✅ reCAPTCHA solved")},"expired-callback":()=>{console.log("⚠️ reCAPTCHA expired"),g("انتهت صلاحية التحقق. يرجى المحاولة مرة أخرى")}}))}catch(e){console.error("Error initializing reCAPTCHA:",e)}})(),()=>{if(y.current){try{y.current.clear()}catch(e){console.error("Error clearing reCAPTCHA:",e)}y.current=null}}),[]);let j=async()=>{if(!s.trim()){g("الرجاء إدخال رقم هاتف صحيح");return}let e=s.replace(/\s/g,"");if(!/^\+?[1-9]\d{1,14}$/.test(e)){g("رقم الهاتف غير صحيح. يجب أن يبدأ بـ + ورمز الدولة");return}h(!0),g("");try{if(!y.current)throw Error("reCAPTCHA not initialized");console.log("\uD83D\uDCF1 Sending SMS to:",e);let r=await (0,l.$g)(i.auth,e,y.current);b(r),m("code"),console.log("✅ SMS sent successfully")}catch(e){if(console.error("❌ Error sending SMS:",e),"auth/invalid-phone-number"===e.code?g("رقم الهاتف غير صحيح"):"auth/too-many-requests"===e.code?g("تم تجاوز عدد المحاولات. يرجى المحاولة لاحقًا"):"auth/quota-exceeded"===e.code?g("تم تجاوز حد الرسائل اليومي"):"auth/invalid-app-credential"===e.code?g("خطأ في إعدادات التحقق. يرجى التواصل مع الدعم الفني"):g("فشل إرسال رمز التحقق. يرجى المحاولة مرة أخرى"),y.current)try{y.current.clear(),y.current=new l.lI(i.auth,"recaptcha-container",{size:"invisible"})}catch(e){console.error("Error resetting reCAPTCHA:",e)}}finally{h(!1)}},v=async()=>{if(!d.trim()){g("الرجاء إدخال رمز التحقق");return}if(!f){g("خطأ في التحقق. يرجى إعادة إرسال الرمز");return}h(!0),g("");try{console.log("\uD83D\uDD0D Verifying code:",d),await f.confirm(d),console.log("✅ Phone number verified successfully"),e(s)}catch(e){console.error("❌ Error verifying code:",e),"auth/invalid-verification-code"===e.code?g("رمز التحقق غير صحيح"):"auth/code-expired"===e.code?g("انتهت صلاحية الرمز. يرجى إعادة إرسال الرمز"):g("فشل التحقق من الرمز. يرجى المحاولة مرة أخرى")}finally{h(!1)}};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"التحقق من رقم الهاتف مطلوب"}),t.jsx("div",{id:"recaptcha-container"}),"phone"===u?(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-gray-600",children:"الرجاء إدخال رقم هاتفك للتوقيع على هذه العريضة."}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الهاتف"}),t.jsx("input",{type:"tel",value:s,onChange:e=>o(e.target.value),placeholder:"+212 6XX XXX XXX",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",dir:"ltr"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"مثال: +212612345678 أو +34613658220"})]}),p&&t.jsx("p",{className:"text-red-600 text-sm",children:p}),(0,t.jsxs)("div",{className:"flex gap-3",children:[t.jsx(n.z,{onClick:j,disabled:x,className:"flex-1",children:x?"جاري الإرسال...":"إرسال الرمز"}),t.jsx(n.z,{variant:"outline",onClick:r,disabled:x,children:"إلغاء"})]})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("p",{className:"text-gray-600",children:["أدخل الرمز المكون من 6 أرقام المرسل إلى ",s]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رمز التحقق"}),t.jsx("input",{type:"text",value:d,onChange:e=>{c(e.target.value.replace(/\D/g,""))},placeholder:"123456",maxLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-center text-lg tracking-widest",dir:"ltr"})]}),p&&t.jsx("p",{className:"text-red-600 text-sm",children:p}),(0,t.jsxs)("div",{className:"flex gap-3",children:[t.jsx(n.z,{onClick:v,disabled:x,className:"flex-1",children:x?"جاري التحقق...":"تحقق"}),t.jsx(n.z,{variant:"outline",onClick:()=>{m("phone"),c(""),g(""),b(null)},disabled:x,children:"رجوع"})]}),t.jsx("button",{onClick:j,disabled:x,className:"w-full text-sm text-green-600 hover:text-green-700 underline",children:"إعادة إرسال الرمز"})]})]})})}},49151:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});var t=s(53267);let a=s.n(t)()(async()=>{},{loadableGenerated:{modules:["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/components/layout/HeaderWrapper.tsx -> ./Header"]},ssr:!1,loading:()=>null})},5094:(e,r,s)=>{"use strict";s.d(r,{z:()=>d});var t=s(95344),a=s(3729),n=s(45877),i=s(49247),l=s(11453);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:r,size:s,asChild:a=!1,...i},d)=>{let c=a?n.g7:"button";return t.jsx(c,{className:(0,l.cn)(o({variant:r,size:s,className:e})),ref:d,...i})});d.displayName="Button"},11453:(e,r,s)=>{"use strict";s.d(r,{cn:()=>n});var t=s(56815),a=s(79377);function n(...e){return(0,a.m6)((0,t.W)(e))}},65648:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>n,__esModule:()=>a,default:()=>i});let t=(0,s(86843).createProxy)(String.raw`/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/profile/page.tsx`),{__esModule:a,$$typeof:n}=t,i=t.default}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[1638,322,4697,5815,4983],()=>s(3512));module.exports=t})();