(()=>{var e={};e.id=6368,e.ids=[6368],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},85835:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=t(50482),a=t(69108),i=t(62563),n=t.n(i),l=t(68300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=["",{children:["dashboard",{children:["analytics",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,52828)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/dashboard/analytics/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,33990)),"/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/dashboard/analytics/[id]/page.tsx"],x="/dashboard/analytics/[id]/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/analytics/[id]/page",pathname:"/dashboard/analytics/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},46572:(e,s,t)=>{Promise.resolve().then(t.bind(t,91366))},91366:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(95344),a=t(3729),i=t(22254),n=t(20783),l=t.n(n),o=t(84454),c=t(23673),d=t(78653);function x({petition:e,className:s=""}){let[t,i]=(0,a.useState)(null),[n,l]=(0,a.useState)(!0),[o,x]=(0,a.useState)("30d"),u=(0,d.SB)(e.currentSignatures,e.targetSignatures);(0,a.useEffect)(()=>{h()},[e.id,o]);let h=async()=>{try{l(!0);let s={totalViews:e.viewCount,totalShares:e.shareCount,totalSignatures:e.currentSignatures,conversionRate:e.viewCount>0?e.currentSignatures/e.viewCount*100:0,shareRate:e.viewCount>0?e.shareCount/e.viewCount*100:0,dailyViews:m(e.viewCount,o),dailySignatures:m(e.currentSignatures,o),topReferrers:[{source:"Direct",count:Math.floor(.4*e.viewCount)},{source:"Facebook",count:Math.floor(.25*e.viewCount)},{source:"WhatsApp",count:Math.floor(.15*e.viewCount)},{source:"Twitter",count:Math.floor(.1*e.viewCount)},{source:"Other",count:Math.floor(.1*e.viewCount)}],demographics:{ageGroups:[{range:"18-24",count:Math.floor(.2*e.currentSignatures)},{range:"25-34",count:Math.floor(.35*e.currentSignatures)},{range:"35-44",count:Math.floor(.25*e.currentSignatures)},{range:"45-54",count:Math.floor(.15*e.currentSignatures)},{range:"55+",count:Math.floor(.05*e.currentSignatures)}],locations:[{city:"Casablanca",count:Math.floor(.3*e.currentSignatures)},{city:"Rabat",count:Math.floor(.2*e.currentSignatures)},{city:"Marrakech",count:Math.floor(.15*e.currentSignatures)},{city:"Fes",count:Math.floor(.1*e.currentSignatures)},{city:"Other",count:Math.floor(.25*e.currentSignatures)}]}};i(s)}catch(e){console.error("Error loading analytics:",e)}finally{l(!1)}},m=(e,s)=>{let t="7d"===s?7:"30d"===s?30:90,r=[];for(let s=0;s<t;s++){let s=e/t,a=.5*Math.random()+.75;r.push(Math.floor(s*a))}return r};return n?r.jsx("div",{className:`space-y-6 ${s}`,children:[void 0,void 0,void 0,void 0].map((e,s)=>r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})})},s))}):t?(0,r.jsxs)("div",{className:`space-y-6 ${s}`,children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Petition Analytics"}),r.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["7d","30d","90d"].map(e=>r.jsx("button",{onClick:()=>x(e),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${o===e?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"7d"===e?"7 days":"30d"===e?"30 days":"90 days"},e))})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,r.jsxs)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Views"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.totalViews.toLocaleString()})]})]})})}),r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Signatures"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.totalSignatures.toLocaleString()})]})]})})}),r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Shares"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.totalShares.toLocaleString()})]})]})})}),r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversion Rate"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[t.conversionRate.toFixed(1),"%"]})]})]})})})]}),(0,r.jsxs)(c.Zb,{children:[r.jsx(c.Ol,{children:r.jsx(c.ll,{children:"Progress Overview"})}),r.jsx(c.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{className:"text-lg font-medium text-gray-900",children:[t.totalSignatures.toLocaleString()," of"," ",e.targetSignatures.toLocaleString()," signatures"]}),(0,r.jsxs)("span",{className:"text-lg font-bold text-green-600",children:[u.toFixed(1),"%"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:r.jsx("div",{className:"bg-green-600 h-4 rounded-full transition-all duration-300",style:{width:`${Math.min(u,100)}%`}})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Remaining:"})," ",Math.max(0,e.targetSignatures-t.totalSignatures).toLocaleString()]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Share Rate:"})," ",t.shareRate.toFixed(1),"%"]})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(c.Zb,{children:[r.jsx(c.Ol,{children:r.jsx(c.ll,{children:"Traffic Sources"})}),r.jsx(c.aY,{children:r.jsx("div",{className:"space-y-4",children:t.topReferrers.map((e,s)=>{let a=t.totalViews>0?e.count/t.totalViews*100:0;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${0===s?"bg-blue-500":1===s?"bg-green-500":2===s?"bg-yellow-500":3===s?"bg-purple-500":"bg-gray-500"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.source})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-bold text-gray-900",children:e.count.toLocaleString()}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[a.toFixed(1),"%"]})]})]},e.source)})})})]}),(0,r.jsxs)(c.Zb,{children:[r.jsx(c.Ol,{children:r.jsx(c.ll,{children:"Top Locations"})}),r.jsx(c.aY,{children:r.jsx("div",{className:"space-y-4",children:t.demographics.locations.map((e,s)=>{let a=t.totalSignatures>0?e.count/t.totalSignatures*100:0;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${0===s?"bg-red-500":1===s?"bg-orange-500":2===s?"bg-yellow-500":3===s?"bg-green-500":"bg-blue-500"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.city})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-bold text-gray-900",children:e.count.toLocaleString()}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[a.toFixed(1),"%"]})]})]},e.city)})})})]})]}),(0,r.jsxs)(c.Zb,{children:[r.jsx(c.Ol,{children:r.jsx(c.ll,{children:"Performance Insights"})}),r.jsx(c.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[t.conversionRate<2&&(0,r.jsxs)("div",{className:"flex items-start p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsx("svg",{className:"w-5 h-5 text-yellow-600 mr-3 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Low Conversion Rate"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["Your conversion rate is"," ",t.conversionRate.toFixed(1),"%. Consider improving your petition description or adding compelling images."]})]})]}),t.shareRate<5&&(0,r.jsxs)("div",{className:"flex items-start p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-3 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Increase Sharing"}),(0,r.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["Your share rate is ",t.shareRate.toFixed(1),"%. Encourage supporters to share your petition on social media."]})]})]}),u>=75&&(0,r.jsxs)("div",{className:"flex items-start p-4 bg-green-50 border border-green-200 rounded-lg",children:[r.jsx("svg",{className:"w-5 h-5 text-green-600 mr-3 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-green-800",children:"Great Progress!"}),(0,r.jsxs)("p",{className:"text-sm text-green-700 mt-1",children:["You're ",u.toFixed(1),"% of the way to your goal. Keep promoting your petition to reach 100%!"]})]})]})]})})]})]}):r.jsx("div",{className:`${s}`,children:r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"py-12 text-center",children:r.jsx("p",{className:"text-gray-500",children:"Failed to load analytics data"})})})})}var u=t(5094),h=t(51133),m=t(16471);function g(){let e=(0,i.useParams)(),s=(0,i.useRouter)(),t=e?.id,{user:n}=(0,h.xw)(),[c,d]=(0,a.useState)(null),[g,p]=(0,a.useState)(!0),[j,f]=(0,a.useState)("");(0,a.useEffect)(()=>{n&&t&&v()},[n,t]);let v=async()=>{try{p(!0),f("");let e=await (0,m.Am)(t);if(!e){f("Petition not found");return}if(e.creatorId!==n?.uid){f("You can only view analytics for your own petitions");return}d(e)}catch(e){console.error("Error loading petition:",e),f("Failed to load petition")}finally{p(!1)}};return g?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(o.Z,{}),r.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)]",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})]}):j||!c?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(o.Z,{}),r.jsx("div",{className:"max-w-2xl mx-auto px-4 py-12",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[r.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error"}),r.jsx("p",{className:"text-gray-600 mb-6",children:j}),r.jsx(u.z,{onClick:()=>s.push("/dashboard"),children:"Back to Dashboard"})]})})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(o.Z,{}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[r.jsx(u.z,{variant:"outline",asChild:!0,children:(0,r.jsxs)(l(),{href:"/dashboard",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Dashboard"]})}),r.jsx(u.z,{variant:"outline",asChild:!0,children:r.jsx(l(),{href:`/petitions/${c.id}`,children:"View Petition"})})]}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Petition Analytics"}),r.jsx("p",{className:"text-lg text-gray-600",children:c.title})]}),r.jsx(x,{petition:c})]})]})}},51133:(e,s,t)=>{"use strict";t.d(s,{Rc:()=>o,fc:()=>x,u2:()=>c,xw:()=>n}),t(95344);var r=t(3729),a=t(22254),i=t(87382);let n=(e="/auth/login")=>{let{user:s,loading:t}=(0,i.useAuth)(),n=(0,a.useRouter)();return(0,r.useEffect)(()=>{if(!t&&!s){let s=window.location.pathname,t=`${e}?redirect=${encodeURIComponent(s)}`;n.push(t)}},[s,t,n,e]),{user:s,loading:t,isAuthenticated:!!s}},l=(e,s="/dashboard")=>{let{user:t,userProfile:n,loading:l}=(0,i.useAuth)(),o=(0,a.useRouter)();return(0,r.useEffect)(()=>{if(!l){if(t)n&&!e.includes(n.role)&&o.push(s);else{let e=window.location.pathname,s=`/auth/login?redirect=${encodeURIComponent(e)}`;o.push(s)}}},[t,n,l,o,e,s]),{user:t,userProfile:n,loading:l,isAuthenticated:!!t,hasRequiredRole:!!n&&e.includes(n.role)}},o=(e="/dashboard")=>l(["admin"],e),c=(e="/dashboard")=>l(["moderator","admin"],e),d=(e,s)=>!!e&&s.includes(e.role),x=e=>d(e,["moderator","admin"])},52828:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let r=(0,t(86843).createProxy)(String.raw`/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/src/app/dashboard/analytics/[id]/page.tsx`),{__esModule:a,$$typeof:i}=r,n=r.default}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[1638,322,8584,783,2569,8415,4454,6471],()=>t(85835));module.exports=r})();