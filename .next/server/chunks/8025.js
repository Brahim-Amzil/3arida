exports.id=8025,exports.ids=[8025],exports.modules={12942:()=>{},76833:()=>{},60177:T=>{T.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}},44667:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.addAdminServicesToServer=S.registerAdminService=void 0;let R=[];function O(T,S){R.push({getServiceDefinition:T,getHandlers:S})}function N(T){for(let{getServiceDefinition:S,getHandlers:O}of R)T.addService(S(),O())}S.registerAdminService=O,S.addAdminServicesToServer=N},9360:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BackoffTimeout=void 0;let R=1e3,O=1.6,N=12e4,P=.2;function M(T,S){return Math.random()*(S-T)+T}class L{constructor(T,S){this.callback=T,this.initialDelay=R,this.multiplier=O,this.maxDelay=N,this.jitter=P,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,S&&(S.initialDelay&&(this.initialDelay=S.initialDelay),S.multiplier&&(this.multiplier=S.multiplier),S.jitter&&(this.jitter=S.jitter),S.maxDelay&&(this.maxDelay=S.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(T){var S,R;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},T),this.hasRef||null===(R=(S=this.timerId).unref)||void 0===R||R.call(S)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let T=Math.min(this.nextDelay*this.multiplier,this.maxDelay),S=T*this.jitter;this.nextDelay=T+M(-S,S)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let T=new Date,S=this.startTime;S.setMilliseconds(S.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),T<S?this.runTimer(S.getTime()-T.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var T,S;this.hasRef=!0,null===(S=(T=this.timerId).ref)||void 0===S||S.call(T)}unref(){var T,S;this.hasRef=!1,null===(S=(T=this.timerId).unref)||void 0===S||S.call(T)}getEndTime(){return this.endTime}}S.BackoffTimeout=L},92542:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.CallCredentials=void 0;let O=R(40834);function N(T){return"getRequestHeaders"in T&&"function"==typeof T.getRequestHeaders}class P{static createFromMetadataGenerator(T){return new L(T)}static createFromGoogleCredential(T){return P.createFromMetadataGenerator((S,R)=>{let P;(P=N(T)?T.getRequestHeaders(S.service_url):new Promise((R,O)=>{T.getRequestMetadata(S.service_url,(T,S)=>{if(T){O(T);return}if(!S){O(Error("Headers not set by metadata plugin"));return}R(S)})})).then(T=>{let S=new O.Metadata;for(let R of Object.keys(T))S.add(R,T[R]);R(null,S)},T=>{R(T)})})}static createEmpty(){return new U}}S.CallCredentials=P;class M extends P{constructor(T){super(),this.creds=T}async generateMetadata(T){let S=new O.Metadata;for(let R of(await Promise.all(this.creds.map(S=>S.generateMetadata(T)))))S.merge(R);return S}compose(T){return new M(this.creds.concat([T]))}_equals(T){return this===T||T instanceof M&&this.creds.every((S,R)=>S._equals(T.creds[R]))}}class L extends P{constructor(T){super(),this.metadataGenerator=T}generateMetadata(T){return new Promise((S,R)=>{this.metadataGenerator(T,(T,O)=>{void 0!==O?S(O):R(T)})})}compose(T){return new M([this,T])}_equals(T){return this===T||T instanceof L&&this.metadataGenerator===T.metadataGenerator}}class U extends P{generateMetadata(T){return Promise.resolve(new O.Metadata)}compose(T){return T}_equals(T){return T instanceof U}}},25528:(T,S)=>{"use strict";function R(T){return void 0!==T.onReceiveMetadata&&1===T.onReceiveMetadata.length}Object.defineProperty(S,"__esModule",{value:!0}),S.InterceptingListenerImpl=S.isInterceptingListener=void 0,S.isInterceptingListener=R;class O{constructor(T,S){this.listener=T,this.nextListener=S,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(T){this.processingMetadata=!0,this.listener.onReceiveMetadata(T,T=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(T),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(T){this.processingMessage=!0,this.listener.onReceiveMessage(T,T=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=T,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(T),this.processPendingStatus())})}onReceiveStatus(T){this.listener.onReceiveStatus(T,T=>{this.processingMetadata||this.processingMessage?this.pendingStatus=T:this.nextListener.onReceiveStatus(T)})}}S.InterceptingListenerImpl=O},56710:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getNextCallNumber=void 0;let R=0;function O(){return R++}S.getNextCallNumber=O},37909:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ClientDuplexStreamImpl=S.ClientWritableStreamImpl=S.ClientReadableStreamImpl=S.ClientUnaryCallImpl=S.callErrorFromStatus=void 0;let O=R(82361),N=R(12781),P=R(80933);function M(T,S){let R=`${T.code} ${P.Status[T.code]}: ${T.details}`,O=Error(R),N=`${O.stack}
for call at
${S}`;return Object.assign(Error(R),T,{stack:N})}S.callErrorFromStatus=M;class L extends O.EventEmitter{constructor(){super()}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}}S.ClientUnaryCallImpl=L;class U extends N.Readable{constructor(T){super({objectMode:!0}),this.deserialize=T}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_read(T){var S;null===(S=this.call)||void 0===S||S.startRead()}}S.ClientReadableStreamImpl=U;class V extends N.Writable{constructor(T){super({objectMode:!0}),this.serialize=T}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_write(T,S,R){var O;let N={callback:R},P=Number(S);Number.isNaN(P)||(N.flags=P),null===(O=this.call)||void 0===O||O.sendMessageWithContext(N,T)}_final(T){var S;null===(S=this.call)||void 0===S||S.halfClose(),T()}}S.ClientWritableStreamImpl=V;class $ extends N.Duplex{constructor(T,S){super({objectMode:!0}),this.serialize=T,this.deserialize=S}cancel(){var T;null===(T=this.call)||void 0===T||T.cancelWithStatus(P.Status.CANCELLED,"Cancelled on client")}getPeer(){var T,S;return null!==(S=null===(T=this.call)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:"unknown"}_read(T){var S;null===(S=this.call)||void 0===S||S.startRead()}_write(T,S,R){var O;let N={callback:R},P=Number(S);Number.isNaN(P)||(N.flags=P),null===(O=this.call)||void 0===O||O.sendMessageWithContext(N,T)}_final(T){var S;null===(S=this.call)||void 0===S||S.halfClose(),T()}}S.ClientDuplexStreamImpl=$},604:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChannelCredentials=void 0;let O=R(24404),N=R(92542),P=R(60459);function M(T,S){if(T&&!(T instanceof Buffer))throw TypeError(`${S}, if provided, must be a Buffer.`)}class L{constructor(T){this.callCredentials=T||N.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(T,S,R,N){var L;if(M(T,"Root certificate"),M(S,"Private key"),M(R,"Certificate chain"),S&&!R)throw Error("Private key must be given with accompanying certificate chain");if(!S&&R)throw Error("Certificate chain must be given with accompanying private key");return new V((0,O.createSecureContext)({ca:null!==(L=null!=T?T:(0,P.getDefaultRootsData)())&&void 0!==L?L:void 0,key:null!=S?S:void 0,cert:null!=R?R:void 0,ciphers:P.CIPHER_SUITES}),null!=N?N:{})}static createFromSecureContext(T,S){return new V(T,null!=S?S:{})}static createInsecure(){return new U}}S.ChannelCredentials=L;class U extends L{constructor(T){super(T)}compose(T){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(T){return T instanceof U}}class V extends L{constructor(T,S){super(),this.secureContext=T,this.verifyOptions=S,this.connectionOptions={secureContext:T},(null==S?void 0:S.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=S.checkServerIdentity)}compose(T){return new $(this,this.callCredentials.compose(T))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(T){return this===T||T instanceof V&&this.secureContext===T.secureContext&&this.verifyOptions.checkServerIdentity===T.verifyOptions.checkServerIdentity}}class $ extends L{constructor(T,S){super(S),this.channelCredentials=T}compose(T){let S=this.callCredentials.compose(T);return new $(this.channelCredentials,S)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(T){return this===T||T instanceof $&&this.channelCredentials._equals(T.channelCredentials)&&this.callCredentials._equals(T.callCredentials)}}},17380:(T,S)=>{"use strict";function R(T,S){let R=Object.keys(T).sort(),O=Object.keys(S).sort();if(R.length!==O.length)return!1;for(let N=0;N<R.length;N+=1)if(R[N]!==O[N]||T[R[N]]!==S[O[N]])return!1;return!0}Object.defineProperty(S,"__esModule",{value:!0}),S.channelOptionsEqual=S.recognizedOptions=void 0,S.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},S.channelOptionsEqual=R},88847:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChannelImplementation=void 0;let O=R(604),N=R(94986);class P{constructor(T,S,R){if("string"!=typeof T)throw TypeError("Channel target must be a string");if(!(S instanceof O.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(R&&"object"!=typeof R)throw TypeError("Channel options must be an object");this.internalChannel=new N.InternalChannel(T,S,R)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(T){return this.internalChannel.getConnectivityState(T)}watchConnectivityState(T,S,R){this.internalChannel.watchConnectivityState(T,S,R)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(T,S,R,O,N){if("string"!=typeof T)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof S||S instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(T,S,R,O,N)}}S.ChannelImplementation=P},2445:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.getChannelzServiceDefinition=S.getChannelzHandlers=S.unregisterChannelzRef=S.registerChannelzSocket=S.registerChannelzServer=S.registerChannelzSubchannel=S.registerChannelzChannel=S.ChannelzCallTracker=S.ChannelzChildrenTracker=S.ChannelzTrace=void 0;let O=R(41808),N=R(27894),P=R(80933),M=R(39247),L=R(44667),U=R(22785);function V(T){return{channel_id:T.id,name:T.name}}function $(T){return{subchannel_id:T.id,name:T.name}}function K(T){return{server_id:T.id}}function W(T){return{socket_id:T.id,name:T.name}}let Q=32;class Y{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(T,S,R){let O=new Date;this.events.push({description:S,severity:T,timestamp:O,childChannel:(null==R?void 0:R.kind)==="channel"?R:void 0,childSubchannel:(null==R?void 0:R.kind)==="subchannel"?R:void 0}),this.events.length>=2*Q&&(this.events=this.events.slice(Q)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:em(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(T=>({description:T.description,severity:T.severity,timestamp:em(T.timestamp),channel_ref:T.childChannel?V(T.childChannel):null,subchannel_ref:T.childSubchannel?$(T.childSubchannel):null}))}}}S.ChannelzTrace=Y;class X{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(T){var S,R,O;switch(T.kind){case"channel":{let R=null!==(S=this.channelChildren.get(T.id))&&void 0!==S?S:{ref:T,count:0};R.count+=1,this.channelChildren.set(T.id,R);break}case"subchannel":{let S=null!==(R=this.subchannelChildren.get(T.id))&&void 0!==R?R:{ref:T,count:0};S.count+=1,this.subchannelChildren.set(T.id,S);break}case"socket":{let S=null!==(O=this.socketChildren.get(T.id))&&void 0!==O?O:{ref:T,count:0};S.count+=1,this.socketChildren.set(T.id,S)}}}unrefChild(T){switch(T.kind){case"channel":{let S=this.channelChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.channelChildren.delete(T.id):this.channelChildren.set(T.id,S));break}case"subchannel":{let S=this.subchannelChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.subchannelChildren.delete(T.id):this.subchannelChildren.set(T.id,S));break}case"socket":{let S=this.socketChildren.get(T.id);void 0!==S&&(S.count-=1,0===S.count?this.socketChildren.delete(T.id):this.socketChildren.set(T.id,S))}}}getChildLists(){let T=[];for(let{ref:S}of this.channelChildren.values())T.push(S);let S=[];for(let{ref:T}of this.subchannelChildren.values())S.push(T);let R=[];for(let{ref:T}of this.socketChildren.values())R.push(T);return{channels:T,subchannels:S,sockets:R}}}S.ChannelzChildrenTracker=X;class Z{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}S.ChannelzCallTracker=Z;let ee=1;function et(){return ee++}let er=[],en=[],ei=[],es=[];function ea(T,S,R){let O=et(),N={id:O,name:T,kind:"channel"};return R&&(er[O]={ref:N,getInfo:S}),N}function eo(T,S,R){let O=et(),N={id:O,name:T,kind:"subchannel"};return R&&(en[O]={ref:N,getInfo:S}),N}function eu(T,S){let R=et(),O={id:R,kind:"server"};return S&&(ei[R]={ref:O,getInfo:T}),O}function ec(T,S,R){let O=et(),N={id:O,name:T,kind:"socket"};return R&&(es[O]={ref:N,getInfo:S}),N}function ed(T){switch(T.kind){case"channel":delete er[T.id];return;case"subchannel":delete en[T.id];return;case"server":delete ei[T.id];return;case"socket":delete es[T.id];return}}function eh(T){let S=Number.parseInt(T,16);return[S/256|0,S%256]}function ef(T){return""===T?[]:[].concat(...T.split(":").map(T=>eh(T)))}function ep(T){if((0,O.isIPv4)(T))return Buffer.from(Uint8Array.from(T.split(".").map(T=>Number.parseInt(T))));if(!(0,O.isIPv6)(T))return null;{let S,R;let O=T.indexOf("::");-1===O?(S=T,R=""):(S=T.substring(0,O),R=T.substring(O+2));let N=Buffer.from(ef(S)),P=Buffer.from(ef(R)),M=Buffer.alloc(16-N.length-P.length,0);return Buffer.concat([N,M,P])}}function eg(T){switch(T){case N.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case N.ConnectivityState.IDLE:return{state:"IDLE"};case N.ConnectivityState.READY:return{state:"READY"};case N.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case N.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function em(T){if(!T)return null;let S=T.getTime();return{seconds:S/1e3|0,nanos:S%1e3*1e6}}function ey(T){let S=T.getInfo();return{ref:V(T.ref),data:{target:S.target,state:eg(S.state),calls_started:S.callTracker.callsStarted,calls_succeeded:S.callTracker.callsSucceeded,calls_failed:S.callTracker.callsFailed,last_call_started_timestamp:em(S.callTracker.lastCallStartedTimestamp),trace:S.trace.getTraceMessage()},channel_ref:S.children.channels.map(T=>V(T)),subchannel_ref:S.children.subchannels.map(T=>$(T))}}function ev(T,S){let R=Number.parseInt(T.request.channel_id),O=er[R];if(void 0===O){S({code:P.Status.NOT_FOUND,details:"No channel data found for id "+R});return}S(null,{channel:ey(O)})}function eb(T,S){let R=Number.parseInt(T.request.max_results),O=[],N=Number.parseInt(T.request.start_channel_id);for(;N<er.length;N++){let T=er[N];if(void 0!==T&&(O.push(ey(T)),O.length>=R))break}S(null,{channel:O,end:N>=ei.length})}function eT(T){let S=T.getInfo();return{ref:K(T.ref),data:{calls_started:S.callTracker.callsStarted,calls_succeeded:S.callTracker.callsSucceeded,calls_failed:S.callTracker.callsFailed,last_call_started_timestamp:em(S.callTracker.lastCallStartedTimestamp),trace:S.trace.getTraceMessage()},listen_socket:S.listenerChildren.sockets.map(T=>W(T))}}function eS(T,S){let R=Number.parseInt(T.request.server_id),O=ei[R];if(void 0===O){S({code:P.Status.NOT_FOUND,details:"No server data found for id "+R});return}S(null,{server:eT(O)})}function e_(T,S){let R=Number.parseInt(T.request.max_results),O=[],N=Number.parseInt(T.request.start_server_id);for(;N<ei.length;N++){let T=ei[N];if(void 0!==T&&(O.push(eT(T)),O.length>=R))break}S(null,{server:O,end:N>=ei.length})}function eE(T,S){let R=Number.parseInt(T.request.subchannel_id),O=en[R];if(void 0===O){S({code:P.Status.NOT_FOUND,details:"No subchannel data found for id "+R});return}let N=O.getInfo();S(null,{subchannel:{ref:$(O.ref),data:{target:N.target,state:eg(N.state),calls_started:N.callTracker.callsStarted,calls_succeeded:N.callTracker.callsSucceeded,calls_failed:N.callTracker.callsFailed,last_call_started_timestamp:em(N.callTracker.lastCallStartedTimestamp),trace:N.trace.getTraceMessage()},socket_ref:N.children.sockets.map(T=>W(T))}})}function ew(T){var S;return(0,M.isTcpSubchannelAddress)(T)?{address:"tcpip_address",tcpip_address:{ip_address:null!==(S=ep(T.host))&&void 0!==S?S:void 0,port:T.port}}:{address:"uds_address",uds_address:{filename:T.path}}}function eC(T,S){var R,O,N,M,L;let U=Number.parseInt(T.request.socket_id),V=es[U];if(void 0===V){S({code:P.Status.NOT_FOUND,details:"No socket data found for id "+U});return}let $=V.getInfo(),K=$.security?{model:"tls",tls:{cipher_suite:$.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!==(R=$.security.cipherSuiteStandardName)&&void 0!==R?R:void 0,other_name:null!==(O=$.security.cipherSuiteOtherName)&&void 0!==O?O:void 0,local_certificate:null!==(N=$.security.localCertificate)&&void 0!==N?N:void 0,remote_certificate:null!==(M=$.security.remoteCertificate)&&void 0!==M?M:void 0}}:null;S(null,{socket:{ref:W(V.ref),local:$.localAddress?ew($.localAddress):null,remote:$.remoteAddress?ew($.remoteAddress):null,remote_name:null!==(L=$.remoteName)&&void 0!==L?L:void 0,security:K,data:{keep_alives_sent:$.keepAlivesSent,streams_started:$.streamsStarted,streams_succeeded:$.streamsSucceeded,streams_failed:$.streamsFailed,last_local_stream_created_timestamp:em($.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:em($.lastRemoteStreamCreatedTimestamp),messages_received:$.messagesReceived,messages_sent:$.messagesSent,last_message_received_timestamp:em($.lastMessageReceivedTimestamp),last_message_sent_timestamp:em($.lastMessageSentTimestamp),local_flow_control_window:$.localFlowControlWindow?{value:$.localFlowControlWindow}:null,remote_flow_control_window:$.remoteFlowControlWindow?{value:$.remoteFlowControlWindow}:null}}})}function eI(T,S){let R=Number.parseInt(T.request.server_id),O=ei[R];if(void 0===O){S({code:P.Status.NOT_FOUND,details:"No server data found for id "+R});return}let N=Number.parseInt(T.request.start_socket_id),M=Number.parseInt(T.request.max_results),L=O.getInfo().sessionChildren.sockets.sort((T,S)=>T.id-S.id),U=[],V=0;for(;V<L.length&&(!(L[V].id>=N)||(U.push(W(L[V])),!(U.length>=M)));V++);S(null,{socket_ref:U,end:V>=L.length})}function eR(){return{GetChannel:ev,GetTopChannels:eb,GetServer:eS,GetServers:e_,GetSubchannel:eE,GetSocket:eC,GetServerSockets:eI}}S.registerChannelzChannel=ea,S.registerChannelzSubchannel=eo,S.registerChannelzServer=eu,S.registerChannelzSocket=ec,S.unregisterChannelzRef=ed,S.getChannelzHandlers=eR;let eO=null;function eA(){if(eO)return eO;let T=(0,R(37486).J_)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return eO=(0,U.loadPackageDefinition)(T).grpc.channelz.v1.Channelz.service}function ek(){(0,L.registerAdminService)(eA,eR)}S.getChannelzServiceDefinition=eA,S.setup=ek},78589:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getInterceptingCall=S.InterceptingCall=S.RequesterBuilder=S.ListenerBuilder=S.InterceptorConfigurationError=void 0;let O=R(40834),N=R(25528),P=R(80933),M=R(676);class L extends Error{constructor(T){super(T),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,L)}}S.InterceptorConfigurationError=L;class U{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(T){return this.metadata=T,this}withOnReceiveMessage(T){return this.message=T,this}withOnReceiveStatus(T){return this.status=T,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}S.ListenerBuilder=U;class V{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(T){return this.start=T,this}withSendMessage(T){return this.message=T,this}withHalfClose(T){return this.halfClose=T,this}withCancel(T){return this.cancel=T,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}S.RequesterBuilder=V;let $={onReceiveMetadata:(T,S)=>{S(T)},onReceiveMessage:(T,S)=>{S(T)},onReceiveStatus:(T,S)=>{S(T)}},K={start:(T,S,R)=>{R(T,S)},sendMessage:(T,S)=>{S(T)},halfClose:T=>{T()},cancel:T=>{T()}};class W{constructor(T,S){var R,O,N,P;this.nextCall=T,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,S?this.requester={start:null!==(R=S.start)&&void 0!==R?R:K.start,sendMessage:null!==(O=S.sendMessage)&&void 0!==O?O:K.sendMessage,halfClose:null!==(N=S.halfClose)&&void 0!==N?N:K.halfClose,cancel:null!==(P=S.cancel)&&void 0!==P?P:K.cancel}:this.requester=K}cancelWithStatus(T,S){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(T,S)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(T,S){var R,O,P,M,L,U;let V={onReceiveMetadata:null!==(O=null===(R=null==S?void 0:S.onReceiveMetadata)||void 0===R?void 0:R.bind(S))&&void 0!==O?O:T=>{},onReceiveMessage:null!==(M=null===(P=null==S?void 0:S.onReceiveMessage)||void 0===P?void 0:P.bind(S))&&void 0!==M?M:T=>{},onReceiveStatus:null!==(U=null===(L=null==S?void 0:S.onReceiveStatus)||void 0===L?void 0:L.bind(S))&&void 0!==U?U:T=>{}};this.processingMetadata=!0,this.requester.start(T,V,(T,S)=>{var R,O,P;let M;if(this.processingMetadata=!1,(0,N.isInterceptingListener)(S))M=S;else{let T={onReceiveMetadata:null!==(R=S.onReceiveMetadata)&&void 0!==R?R:$.onReceiveMetadata,onReceiveMessage:null!==(O=S.onReceiveMessage)&&void 0!==O?O:$.onReceiveMessage,onReceiveStatus:null!==(P=S.onReceiveStatus)&&void 0!==P?P:$.onReceiveStatus};M=new N.InterceptingListenerImpl(T,V)}this.nextCall.start(T,M),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(T,S){this.processingMessage=!0,this.requester.sendMessage(S,R=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=T,this.pendingMessage=S):(this.nextCall.sendMessageWithContext(T,R),this.processPendingHalfClose())})}sendMessage(T){this.sendMessageWithContext({},T)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function Q(T,S,R){var O,N;let P=null!==(O=R.deadline)&&void 0!==O?O:1/0,M=R.host,L=null!==(N=R.parent)&&void 0!==N?N:null,U=R.propagate_flags,V=R.credentials,$=T.createCall(S,P,M,L,U);return V&&$.setCredentials(V),$}S.InterceptingCall=W;class Y{constructor(T,S){this.call=T,this.methodDefinition=S}cancelWithStatus(T,S){this.call.cancelWithStatus(T,S)}getPeer(){return this.call.getPeer()}sendMessageWithContext(T,S){let R;try{R=this.methodDefinition.requestSerialize(S)}catch(T){this.call.cancelWithStatus(P.Status.INTERNAL,`Request message serialization failure: ${(0,M.getErrorMessage)(T)}`);return}this.call.sendMessageWithContext(T,R)}sendMessage(T){this.sendMessageWithContext({},T)}start(T,S){let R=null;this.call.start(T,{onReceiveMetadata:T=>{var R;null===(R=null==S?void 0:S.onReceiveMetadata)||void 0===R||R.call(S,T)},onReceiveMessage:T=>{var N;let L;try{L=this.methodDefinition.responseDeserialize(T)}catch(T){R={code:P.Status.INTERNAL,details:`Response message parsing error: ${(0,M.getErrorMessage)(T)}`,metadata:new O.Metadata},this.call.cancelWithStatus(R.code,R.details);return}null===(N=null==S?void 0:S.onReceiveMessage)||void 0===N||N.call(S,L)},onReceiveStatus:T=>{var O,N;R?null===(O=null==S?void 0:S.onReceiveStatus)||void 0===O||O.call(S,R):null===(N=null==S?void 0:S.onReceiveStatus)||void 0===N||N.call(S,T)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class X extends Y{constructor(T,S){super(T,S)}start(T,S){var R,O;let N=!1,P={onReceiveMetadata:null!==(O=null===(R=null==S?void 0:S.onReceiveMetadata)||void 0===R?void 0:R.bind(S))&&void 0!==O?O:T=>{},onReceiveMessage:T=>{var R;N=!0,null===(R=null==S?void 0:S.onReceiveMessage)||void 0===R||R.call(S,T)},onReceiveStatus:T=>{var R,O;N||null===(R=null==S?void 0:S.onReceiveMessage)||void 0===R||R.call(S,null),null===(O=null==S?void 0:S.onReceiveStatus)||void 0===O||O.call(S,T)}};super.start(T,P),this.call.startRead()}}class Z extends Y{}function ee(T,S,R){let O=Q(T,R.path,S);return R.responseStream?new Z(O,R):new X(O,R)}function et(T,S,R,O){if(T.clientInterceptors.length>0&&T.clientInterceptorProviders.length>0)throw new L("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(T.callInterceptors.length>0&&T.callInterceptorProviders.length>0)throw new L("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let N=[];N=T.callInterceptors.length>0||T.callInterceptorProviders.length>0?[].concat(T.callInterceptors,T.callInterceptorProviders.map(T=>T(S))).filter(T=>T):[].concat(T.clientInterceptors,T.clientInterceptorProviders.map(T=>T(S))).filter(T=>T);let P=Object.assign({},R,{method_definition:S});return N.reduceRight((T,S)=>R=>S(R,T),T=>ee(O,T,S))(P)}S.getInterceptingCall=et},33703:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Client=void 0;let O=R(37909),N=R(88847),P=R(27894),M=R(80933),L=R(40834),U=R(78589),V=Symbol(),$=Symbol(),K=Symbol(),W=Symbol();function Q(T){return"function"==typeof T}function Y(T){return T.stack.split("\n").slice(1).join("\n")}class X{constructor(T,S,R={}){var O,P;if(R=Object.assign({},R),this[$]=null!==(O=R.interceptors)&&void 0!==O?O:[],delete R.interceptors,this[K]=null!==(P=R.interceptor_providers)&&void 0!==P?P:[],delete R.interceptor_providers,this[$].length>0&&this[K].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[W]=R.callInvocationTransformer,delete R.callInvocationTransformer,R.channelOverride)this[V]=R.channelOverride;else if(R.channelFactoryOverride){let O=R.channelFactoryOverride;delete R.channelFactoryOverride,this[V]=O(T,S,R)}else this[V]=new N.ChannelImplementation(T,S,R)}close(){this[V].close()}getChannel(){return this[V]}waitForReady(T,S){let R=O=>{let N;if(O){S(Error("Failed to connect before the deadline"));return}try{N=this[V].getConnectivityState(!0)}catch(T){S(Error("The channel has been closed"));return}if(N===P.ConnectivityState.READY)S();else try{this[V].watchConnectivityState(N,T,R)}catch(T){S(Error("The channel has been closed"))}};setImmediate(R)}checkOptionalUnaryResponseArguments(T,S,R){if(Q(T))return{metadata:new L.Metadata,options:{},callback:T};if(Q(S))return T instanceof L.Metadata?{metadata:T,options:{},callback:S}:{metadata:new L.Metadata,options:T,callback:S};if(!(T instanceof L.Metadata&&S instanceof Object&&Q(R)))throw Error("Incorrect arguments passed");return{metadata:T,options:S,callback:R}}makeUnaryRequest(T,S,R,N,P,L,Q){var X,Z;let ee=this.checkOptionalUnaryResponseArguments(P,L,Q),et={path:T,requestStream:!1,responseStream:!1,requestSerialize:S,responseDeserialize:R},er={argument:N,metadata:ee.metadata,call:new O.ClientUnaryCallImpl,channel:this[V],methodDefinition:et,callOptions:ee.options,callback:ee.callback};this[W]&&(er=this[W](er));let en=er.call,ei={clientInterceptors:this[$],clientInterceptorProviders:this[K],callInterceptors:null!==(X=er.callOptions.interceptors)&&void 0!==X?X:[],callInterceptorProviders:null!==(Z=er.callOptions.interceptor_providers)&&void 0!==Z?Z:[]},es=(0,U.getInterceptingCall)(ei,er.methodDefinition,er.callOptions,er.channel);en.call=es;let ea=null,eo=!1,eu=Error();return es.start(er.metadata,{onReceiveMetadata:T=>{en.emit("metadata",T)},onReceiveMessage(T){null!==ea&&es.cancelWithStatus(M.Status.INTERNAL,"Too many responses received"),ea=T},onReceiveStatus(T){if(!eo){if(eo=!0,T.code===M.Status.OK){if(null===ea){let S=Y(eu);er.callback((0,O.callErrorFromStatus)({code:M.Status.INTERNAL,details:"No message received",metadata:T.metadata},S))}else er.callback(null,ea)}else{let S=Y(eu);er.callback((0,O.callErrorFromStatus)(T,S))}eu=null,en.emit("status",T)}}}),es.sendMessage(N),es.halfClose(),en}makeClientStreamRequest(T,S,R,N,P,L){var Q,X;let Z=this.checkOptionalUnaryResponseArguments(N,P,L),ee={path:T,requestStream:!0,responseStream:!1,requestSerialize:S,responseDeserialize:R},et={metadata:Z.metadata,call:new O.ClientWritableStreamImpl(S),channel:this[V],methodDefinition:ee,callOptions:Z.options,callback:Z.callback};this[W]&&(et=this[W](et));let er=et.call,en={clientInterceptors:this[$],clientInterceptorProviders:this[K],callInterceptors:null!==(Q=et.callOptions.interceptors)&&void 0!==Q?Q:[],callInterceptorProviders:null!==(X=et.callOptions.interceptor_providers)&&void 0!==X?X:[]},ei=(0,U.getInterceptingCall)(en,et.methodDefinition,et.callOptions,et.channel);er.call=ei;let es=null,ea=!1,eo=Error();return ei.start(et.metadata,{onReceiveMetadata:T=>{er.emit("metadata",T)},onReceiveMessage(T){null!==es&&ei.cancelWithStatus(M.Status.INTERNAL,"Too many responses received"),es=T},onReceiveStatus(T){if(!ea){if(ea=!0,T.code===M.Status.OK){if(null===es){let S=Y(eo);et.callback((0,O.callErrorFromStatus)({code:M.Status.INTERNAL,details:"No message received",metadata:T.metadata},S))}else et.callback(null,es)}else{let S=Y(eo);et.callback((0,O.callErrorFromStatus)(T,S))}eo=null,er.emit("status",T)}}}),er}checkMetadataAndOptions(T,S){let R,O;return T instanceof L.Metadata?(R=T,O=S||{}):(O=T||{},R=new L.Metadata),{metadata:R,options:O}}makeServerStreamRequest(T,S,R,N,P,L){var Q,X;let Z=this.checkMetadataAndOptions(P,L),ee={path:T,requestStream:!1,responseStream:!0,requestSerialize:S,responseDeserialize:R},et={argument:N,metadata:Z.metadata,call:new O.ClientReadableStreamImpl(R),channel:this[V],methodDefinition:ee,callOptions:Z.options};this[W]&&(et=this[W](et));let er=et.call,en={clientInterceptors:this[$],clientInterceptorProviders:this[K],callInterceptors:null!==(Q=et.callOptions.interceptors)&&void 0!==Q?Q:[],callInterceptorProviders:null!==(X=et.callOptions.interceptor_providers)&&void 0!==X?X:[]},ei=(0,U.getInterceptingCall)(en,et.methodDefinition,et.callOptions,et.channel);er.call=ei;let es=!1,ea=Error();return ei.start(et.metadata,{onReceiveMetadata(T){er.emit("metadata",T)},onReceiveMessage(T){er.push(T)},onReceiveStatus(T){if(!es){if(es=!0,er.push(null),T.code!==M.Status.OK){let S=Y(ea);er.emit("error",(0,O.callErrorFromStatus)(T,S))}ea=null,er.emit("status",T)}}}),ei.sendMessage(N),ei.halfClose(),er}makeBidiStreamRequest(T,S,R,N,P){var L,Q;let X=this.checkMetadataAndOptions(N,P),Z={path:T,requestStream:!0,responseStream:!0,requestSerialize:S,responseDeserialize:R},ee={metadata:X.metadata,call:new O.ClientDuplexStreamImpl(S,R),channel:this[V],methodDefinition:Z,callOptions:X.options};this[W]&&(ee=this[W](ee));let et=ee.call,er={clientInterceptors:this[$],clientInterceptorProviders:this[K],callInterceptors:null!==(L=ee.callOptions.interceptors)&&void 0!==L?L:[],callInterceptorProviders:null!==(Q=ee.callOptions.interceptor_providers)&&void 0!==Q?Q:[]},en=(0,U.getInterceptingCall)(er,ee.methodDefinition,ee.callOptions,ee.channel);et.call=en;let ei=!1,es=Error();return en.start(ee.metadata,{onReceiveMetadata(T){et.emit("metadata",T)},onReceiveMessage(T){et.push(T)},onReceiveStatus(T){if(!ei){if(ei=!0,et.push(null),T.code!==M.Status.OK){let S=Y(es);et.emit("error",(0,O.callErrorFromStatus)(T,S))}es=null,et.emit("status",T)}}}),et}}S.Client=X},69485:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.CompressionAlgorithms=void 0,function(T){T[T.identity=0]="identity",T[T.deflate=1]="deflate",T[T.gzip=2]="gzip"}(R||(S.CompressionAlgorithms=R={}))},96562:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.CompressionFilterFactory=S.CompressionFilter=void 0;let O=R(59796),N=R(69485),P=R(80933),M=R(78210),L=R(90750),U=T=>"number"==typeof T&&"string"==typeof N.CompressionAlgorithms[T];class V{async writeMessage(T,S){let R=T;S&&(R=await this.compressMessage(R));let O=Buffer.allocUnsafe(R.length+5);return O.writeUInt8(S?1:0,0),O.writeUInt32BE(R.length,1),R.copy(O,5),O}async readMessage(T){let S=1===T.readUInt8(0),R=T.slice(5);return S&&(R=await this.decompressMessage(R)),R}}class $ extends V{async compressMessage(T){return T}async writeMessage(T,S){let R=Buffer.allocUnsafe(T.length+5);return R.writeUInt8(0,0),R.writeUInt32BE(T.length,1),T.copy(R,5),R}decompressMessage(T){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class K extends V{constructor(T){super(),this.maxRecvMessageLength=T}compressMessage(T){return new Promise((S,R)=>{O.deflate(T,(T,O)=>{T?R(T):S(O)})})}decompressMessage(T){return new Promise((S,R)=>{let N=0,M=[],L=O.createInflate();L.on("data",T=>{M.push(T),N+=T.byteLength,-1!==this.maxRecvMessageLength&&N>this.maxRecvMessageLength&&(L.destroy(),R({code:P.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),L.on("end",()=>{S(Buffer.concat(M))}),L.write(T),L.end()})}}class W extends V{constructor(T){super(),this.maxRecvMessageLength=T}compressMessage(T){return new Promise((S,R)=>{O.gzip(T,(T,O)=>{T?R(T):S(O)})})}decompressMessage(T){return new Promise((S,R)=>{let N=0,M=[],L=O.createGunzip();L.on("data",T=>{M.push(T),N+=T.byteLength,-1!==this.maxRecvMessageLength&&N>this.maxRecvMessageLength&&(L.destroy(),R({code:P.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),L.on("end",()=>{S(Buffer.concat(M))}),L.write(T),L.end()})}}class Q extends V{constructor(T){super(),this.compressionName=T}compressMessage(T){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(T){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function Y(T,S){switch(T){case"identity":return new $;case"deflate":return new K(S);case"gzip":return new W(S);default:return new Q(T)}}class X extends M.BaseFilter{constructor(T,S){var R,O;super(),this.sharedFilterConfig=S,this.sendCompression=new $,this.receiveCompression=new $,this.currentCompressionAlgorithm="identity";let M=T["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!==(R=T["grpc.max_receive_message_length"])&&void 0!==R?R:P.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==M){if(U(M)){let T=N.CompressionAlgorithms[M],R=null===(O=S.serverSupportedEncodingHeader)||void 0===O?void 0:O.split(",");(!R||R.includes(T))&&(this.currentCompressionAlgorithm=T,this.sendCompression=Y(this.currentCompressionAlgorithm,-1))}else L.log(P.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${M}`)}}async sendMetadata(T){let S=await T;return S.set("grpc-accept-encoding","identity,deflate,gzip"),S.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?S.remove("grpc-encoding"):S.set("grpc-encoding",this.currentCompressionAlgorithm),S}receiveMetadata(T){let S=T.get("grpc-encoding");if(S.length>0){let T=S[0];"string"==typeof T&&(this.receiveCompression=Y(T,this.maxReceiveMessageLength))}T.remove("grpc-encoding");let R=T.get("grpc-accept-encoding")[0];return R&&(this.sharedFilterConfig.serverSupportedEncodingHeader=R,R.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new $,this.currentCompressionAlgorithm="identity")),T.remove("grpc-accept-encoding"),T}async sendMessage(T){var S;let R;let O=await T;return R=!(this.sendCompression instanceof $)&&((null!==(S=O.flags)&&void 0!==S?S:0)&2)==0,{message:await this.sendCompression.writeMessage(O.message,R),flags:O.flags}}async receiveMessage(T){return this.receiveCompression.readMessage(await T)}}S.CompressionFilter=X;class Z{constructor(T,S){this.options=S,this.sharedFilterConfig={}}createFilter(){return new X(this.options,this.sharedFilterConfig)}}S.CompressionFilterFactory=Z},27894:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.ConnectivityState=void 0,function(T){T[T.IDLE=0]="IDLE",T[T.CONNECTING=1]="CONNECTING",T[T.READY=2]="READY",T[T.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",T[T.SHUTDOWN=4]="SHUTDOWN"}(R||(S.ConnectivityState=R={}))},80933:(T,S)=>{"use strict";var R,O,N;Object.defineProperty(S,"__esModule",{value:!0}),S.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=S.DEFAULT_MAX_SEND_MESSAGE_LENGTH=S.Propagate=S.LogVerbosity=S.Status=void 0,function(T){T[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(R||(S.Status=R={})),function(T){T[T.DEBUG=0]="DEBUG",T[T.INFO=1]="INFO",T[T.ERROR=2]="ERROR",T[T.NONE=3]="NONE"}(O||(S.LogVerbosity=O={})),function(T){T[T.DEADLINE=1]="DEADLINE",T[T.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",T[T.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",T[T.CANCELLATION=8]="CANCELLATION",T[T.DEFAULTS=65535]="DEFAULTS"}(N||(S.Propagate=N={})),S.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,S.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},95042:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.restrictControlPlaneStatusCode=void 0;let O=R(80933),N=[O.Status.OK,O.Status.INVALID_ARGUMENT,O.Status.NOT_FOUND,O.Status.ALREADY_EXISTS,O.Status.FAILED_PRECONDITION,O.Status.ABORTED,O.Status.OUT_OF_RANGE,O.Status.DATA_LOSS];function P(T,S){return N.includes(T)?{code:O.Status.INTERNAL,details:`Invalid status from control plane: ${T} ${O.Status[T]} ${S}`}:{code:T,details:S}}S.restrictControlPlaneStatusCode=P},21906:(T,S)=>{"use strict";function R(...T){let S=1/0;for(let R of T){let T=R instanceof Date?R.getTime():R;T<S&&(S=T)}return S}Object.defineProperty(S,"__esModule",{value:!0}),S.deadlineToString=S.getRelativeTimeout=S.getDeadlineTimeoutString=S.minDeadline=void 0,S.minDeadline=R;let O=[["m",1],["S",1e3],["M",6e4],["H",36e5]];function N(T){let S=new Date().getTime();T instanceof Date&&(T=T.getTime());let R=Math.max(T-S,0);for(let[T,S]of O){let O=R/S;if(O<1e8)return String(Math.ceil(O))+T}throw Error("Deadline is too far in the future")}S.getDeadlineTimeoutString=N;let P=2147483647;function M(T){let S=(T instanceof Date?T.getTime():T)-new Date().getTime();return S<0?0:S>P?1/0:S}function L(T){if(T instanceof Date)return T.toISOString();{let S=new Date(T);return Number.isNaN(S.getTime())?""+T:S.toISOString()}}S.getRelativeTimeout=M,S.deadlineToString=L},36383:(T,S)=>{"use strict";function R(T){return{seconds:T/1e3|0,nanos:T%1e3*1e6|0}}function O(T){return 1e3*T.seconds+T.nanos/1e6|0}function N(T){return"number"==typeof T.seconds&&"number"==typeof T.nanos}Object.defineProperty(S,"__esModule",{value:!0}),S.isDuration=S.durationToMs=S.msToDuration=void 0,S.msToDuration=R,S.durationToMs=O,S.isDuration=N},676:(T,S)=>{"use strict";function R(T){return T instanceof Error?T.message:String(T)}function O(T){return"object"==typeof T&&null!==T&&"code"in T&&"number"==typeof T.code?T.code:null}Object.defineProperty(S,"__esModule",{value:!0}),S.getErrorCode=S.getErrorMessage=void 0,S.getErrorMessage=R,S.getErrorCode=O},49865:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.OutlierDetectionLoadBalancingConfig=S.BaseSubchannelWrapper=S.registerAdminService=S.FilterStackFactory=S.BaseFilter=S.PickResultType=S.QueuePicker=S.UnavailablePicker=S.ChildLoadBalancerHandler=S.subchannelAddressToString=S.validateLoadBalancingConfig=S.getFirstUsableConfig=S.registerLoadBalancerType=S.createChildChannelControlHelper=S.BackoffTimeout=S.durationToMs=S.uriToString=S.createResolver=S.registerResolver=S.log=S.trace=void 0;var O=R(90750);Object.defineProperty(S,"trace",{enumerable:!0,get:function(){return O.trace}}),Object.defineProperty(S,"log",{enumerable:!0,get:function(){return O.log}});var N=R(77561);Object.defineProperty(S,"registerResolver",{enumerable:!0,get:function(){return N.registerResolver}}),Object.defineProperty(S,"createResolver",{enumerable:!0,get:function(){return N.createResolver}});var P=R(9442);Object.defineProperty(S,"uriToString",{enumerable:!0,get:function(){return P.uriToString}});var M=R(36383);Object.defineProperty(S,"durationToMs",{enumerable:!0,get:function(){return M.durationToMs}});var L=R(9360);Object.defineProperty(S,"BackoffTimeout",{enumerable:!0,get:function(){return L.BackoffTimeout}});var U=R(75922);Object.defineProperty(S,"createChildChannelControlHelper",{enumerable:!0,get:function(){return U.createChildChannelControlHelper}}),Object.defineProperty(S,"registerLoadBalancerType",{enumerable:!0,get:function(){return U.registerLoadBalancerType}}),Object.defineProperty(S,"getFirstUsableConfig",{enumerable:!0,get:function(){return U.getFirstUsableConfig}}),Object.defineProperty(S,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return U.validateLoadBalancingConfig}});var V=R(39247);Object.defineProperty(S,"subchannelAddressToString",{enumerable:!0,get:function(){return V.subchannelAddressToString}});var $=R(68682);Object.defineProperty(S,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return $.ChildLoadBalancerHandler}});var K=R(8815);Object.defineProperty(S,"UnavailablePicker",{enumerable:!0,get:function(){return K.UnavailablePicker}}),Object.defineProperty(S,"QueuePicker",{enumerable:!0,get:function(){return K.QueuePicker}}),Object.defineProperty(S,"PickResultType",{enumerable:!0,get:function(){return K.PickResultType}});var W=R(78210);Object.defineProperty(S,"BaseFilter",{enumerable:!0,get:function(){return W.BaseFilter}});var Q=R(95403);Object.defineProperty(S,"FilterStackFactory",{enumerable:!0,get:function(){return Q.FilterStackFactory}});var Y=R(44667);Object.defineProperty(S,"registerAdminService",{enumerable:!0,get:function(){return Y.registerAdminService}});var X=R(67098);Object.defineProperty(S,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return X.BaseSubchannelWrapper}});var Z=R(91343);Object.defineProperty(S,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return Z.OutlierDetectionLoadBalancingConfig}})},95403:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.FilterStackFactory=S.FilterStack=void 0;class R{constructor(T){this.filters=T}sendMetadata(T){let S=T;for(let T=0;T<this.filters.length;T++)S=this.filters[T].sendMetadata(S);return S}receiveMetadata(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveMetadata(S);return S}sendMessage(T){let S=T;for(let T=0;T<this.filters.length;T++)S=this.filters[T].sendMessage(S);return S}receiveMessage(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveMessage(S);return S}receiveTrailers(T){let S=T;for(let T=this.filters.length-1;T>=0;T--)S=this.filters[T].receiveTrailers(S);return S}push(T){this.filters.unshift(...T)}getFilters(){return this.filters}}S.FilterStack=R;class O{constructor(T){this.factories=T}push(T){this.factories.unshift(...T)}clone(){return new O([...this.factories])}createFilter(){return new R(this.factories.map(T=>T.createFilter()))}}S.FilterStackFactory=O},78210:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BaseFilter=void 0;class R{async sendMetadata(T){return T}receiveMetadata(T){return T}async sendMessage(T){return T}async receiveMessage(T){return T}receiveTrailers(T){return T}}S.BaseFilter=R},775:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getProxiedConnection=S.mapProxyName=void 0;let O=R(90750),N=R(80933),P=R(77561),M=R(13685),L=R(24404),U=R(90750),V=R(39247),$=R(9442),K=R(57310),W=R(61067),Q="proxy";function Y(T){U.trace(N.LogVerbosity.DEBUG,Q,T)}function X(){let T,S="",R="";if(process.env.grpc_proxy)R="grpc_proxy",S=process.env.grpc_proxy;else if(process.env.https_proxy)R="https_proxy",S=process.env.https_proxy;else{if(!process.env.http_proxy)return{};R="http_proxy",S=process.env.http_proxy}try{T=new K.URL(S)}catch(T){return(0,O.log)(N.LogVerbosity.ERROR,`cannot parse value of "${R}" env var`),{}}if("http:"!==T.protocol)return(0,O.log)(N.LogVerbosity.ERROR,`"${T.protocol}" scheme not supported in proxy URI`),{};let P=null;T.username&&(T.password?((0,O.log)(N.LogVerbosity.INFO,"userinfo found in proxy URI"),P=`${T.username}:${T.password}`):P=T.username);let M=T.hostname,L=T.port;""===L&&(L="80");let U={address:`${M}:${L}`};return P&&(U.creds=P),Y("Proxy server "+U.address+" set by environment variable "+R),U}function Z(){let T=process.env.no_grpc_proxy,S="no_grpc_proxy";return(T||(T=process.env.no_proxy,S="no_proxy"),T)?(Y("No proxy server list set by environment variable "+S),T.split(",")):[]}function ee(T,S){var R;let O={target:T,extraOptions:{}};if((null!==(R=S["grpc.enable_http_proxy"])&&void 0!==R?R:1)===0||"unix"===T.scheme)return O;let N=X();if(!N.address)return O;let P=(0,$.splitHostPort)(T.path);if(!P)return O;let M=P.host;for(let S of Z())if(S===M)return Y("Not using proxy for target in no_proxy list: "+(0,$.uriToString)(T)),O;let L={"grpc.http_connect_target":(0,$.uriToString)(T)};return N.creds&&(L["grpc.http_connect_creds"]=N.creds),{target:{scheme:"dns",path:N.address},extraOptions:L}}function et(T,S,R){var U;if(!("grpc.http_connect_target"in S))return Promise.resolve({});let K=S["grpc.http_connect_target"],Q=(0,$.parseUri)(K);if(null===Q)return Promise.resolve({});let X=(0,$.splitHostPort)(Q.path);if(null===X)return Promise.resolve({});let Z=`${X.host}:${null!==(U=X.port)&&void 0!==U?U:W.DEFAULT_PORT}`,ee={method:"CONNECT",path:Z},et={Host:Z};(0,V.isTcpSubchannelAddress)(T)?(ee.host=T.host,ee.port=T.port):ee.socketPath=T.path,"grpc.http_connect_creds"in S&&(et["Proxy-Authorization"]="Basic "+Buffer.from(S["grpc.http_connect_creds"]).toString("base64")),ee.headers=et;let er=(0,V.subchannelAddressToString)(T);return Y("Using proxy "+er+" to connect to "+ee.path),new Promise((T,S)=>{let U=M.request(ee);U.once("connect",(M,V,K)=>{var W;if(U.removeAllListeners(),V.removeAllListeners(),200===M.statusCode){if(Y("Successfully connected to "+ee.path+" through proxy "+er),"secureContext"in R){let O=(0,P.getDefaultAuthority)(Q),N=(0,$.splitHostPort)(O),M=null!==(W=null==N?void 0:N.host)&&void 0!==W?W:O,U=L.connect(Object.assign({host:M,servername:M,socket:V},R),()=>{Y("Successfully established a TLS connection to "+ee.path+" through proxy "+er),T({socket:U,realTarget:Q})});U.on("error",T=>{Y("Failed to establish a TLS connection to "+ee.path+" through proxy "+er+" with error "+T.message),S()})}else Y("Successfully established a plaintext connection to "+ee.path+" through proxy "+er),T({socket:V,realTarget:Q})}else(0,O.log)(N.LogVerbosity.ERROR,"Failed to connect to "+ee.path+" through proxy "+er+" with status "+M.statusCode),S()}),U.once("error",T=>{U.removeAllListeners(),(0,O.log)(N.LogVerbosity.ERROR,"Failed to connect to proxy "+er+" with error "+T.message),S()}),U.end()})}S.mapProxyName=ee,S.getProxiedConnection=et},13985:(T,S,R)=>{"use strict";Z={value:!0},Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=S.Rz=Z=Z=Z=Z=Z=Z=S.SF=S.K9=void 0;let O=R(92542);Z={enumerable:!0,get:function(){return O.CallCredentials}};let N=R(88847);Z={enumerable:!0,get:function(){return N.ChannelImplementation}};let P=R(69485);Z={enumerable:!0,get:function(){return P.CompressionAlgorithms}};let M=R(27894);Z={enumerable:!0,get:function(){return M.ConnectivityState}};let L=R(604);Z={enumerable:!0,get:function(){return L.ChannelCredentials}};let U=R(33703);Z={enumerable:!0,get:function(){return U.Client}};let V=R(80933);Z={enumerable:!0,get:function(){return V.LogVerbosity}},Z={enumerable:!0,get:function(){return V.Status}},Z={enumerable:!0,get:function(){return V.Propagate}};let $=R(90750),K=R(22785);Object.defineProperty(S,"Rz",{enumerable:!0,get:function(){return K.loadPackageDefinition}}),Z={enumerable:!0,get:function(){return K.makeClientConstructor}},Z={enumerable:!0,get:function(){return K.makeClientConstructor}};let W=R(40834);Object.defineProperty(S,"SF",{enumerable:!0,get:function(){return W.Metadata}});let Q=R(92826);Z={enumerable:!0,get:function(){return Q.Server}};let Y=R(31775);Z={enumerable:!0,get:function(){return Y.ServerCredentials}};let X=R(52243);Z={enumerable:!0,get:function(){return X.StatusBuilder}},S.K9={combineChannelCredentials:(T,...S)=>S.reduce((T,S)=>T.compose(S),T),combineCallCredentials:(T,...S)=>S.reduce((T,S)=>T.compose(S),T),createInsecure:L.ChannelCredentials.createInsecure,createSsl:L.ChannelCredentials.createSsl,createFromSecureContext:L.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:O.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:O.CallCredentials.createFromGoogleCredential,createEmpty:O.CallCredentials.createEmpty},Z=T=>T.close(),Z=(T,S,R)=>T.waitForReady(S,R),Z=(T,S)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},Z=(T,S,R)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},Z=T=>{$.setLogger(T)},Z=T=>{$.setLoggerVerbosity(T)},Z=T=>U.Client.prototype.getChannel.call(T);var Z,ee=R(78589);Z={enumerable:!0,get:function(){return ee.ListenerBuilder}},Z={enumerable:!0,get:function(){return ee.RequesterBuilder}},Z={enumerable:!0,get:function(){return ee.InterceptingCall}},Z={enumerable:!0,get:function(){return ee.InterceptorConfigurationError}};var et=R(2445);Z={enumerable:!0,get:function(){return et.getChannelzServiceDefinition}},Z={enumerable:!0,get:function(){return et.getChannelzHandlers}};var er=R(44667);Z={enumerable:!0,get:function(){return er.addAdminServicesToServer}},Z=R(49865);let en=R(61067),ei=R(93104),es=R(62776),ea=R(21567),eo=R(83542),eu=R(91343),ec=R(2445);(()=>{en.setup(),ei.setup(),es.setup(),ea.setup(),eo.setup(),eu.setup(),ec.setup()})()},94986:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.InternalChannel=void 0;let O=R(604),N=R(22510),P=R(54918),M=R(8815),L=R(80933),U=R(95403),V=R(96562),$=R(77561),K=R(90750),W=R(775),Q=R(9442),Y=R(27894),X=R(2445),Z=R(8055),ee=R(21906),et=R(49769),er=R(56710),en=R(95042),ei=R(75332),es=R(67098),ea=2147483647,eo=1e3,eu=18e5,ec=new Map,ed=16777216,eh=1048576;class ef extends es.BaseSubchannelWrapper{constructor(T,S){super(T),this.channel=S,this.refCount=0,this.subchannelStateListener=(T,R,O,N)=>{S.throttleKeepalive(N)},T.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class ep{constructor(T,S,R){var Z,ee,et,er,es,ep,eg,em;if(this.credentials=S,this.options=R,this.connectivityState=Y.ConnectivityState.IDLE,this.currentPicker=new M.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new X.ChannelzCallTracker,this.childrenTracker=new X.ChannelzChildrenTracker,"string"!=typeof T)throw TypeError("Channel target must be a string");if(!(S instanceof O.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(R&&"object"!=typeof R)throw TypeError("Channel options must be an object");this.originalTarget=T;let ey=(0,Q.parseUri)(T);if(null===ey)throw Error(`Could not parse target name "${T}"`);let ev=(0,$.mapUriDefaultScheme)(ey);if(null===ev)throw Error(`Could not find a default scheme for target name "${T}"`);this.callRefTimer=setInterval(()=>{},ea),null===(ee=(Z=this.callRefTimer).unref)||void 0===ee||ee.call(Z),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new X.ChannelzTrace,this.channelzRef=(0,X.registerChannelzChannel)(T,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,$.getDefaultAuthority)(ev);let eb=(0,W.mapProxyName)(ev,R);this.target=eb.target,this.options=Object.assign({},this.options,eb.extraOptions),this.subchannelPool=(0,P.getSubchannelPool)((null!==(et=R["grpc.use_local_subchannel_pool"])&&void 0!==et?et:0)===0),this.retryBufferTracker=new ei.MessageBufferTracker(null!==(er=R["grpc.retry_buffer_size"])&&void 0!==er?er:ed,null!==(es=R["grpc.per_rpc_retry_buffer_size"])&&void 0!==es?es:eh),this.keepaliveTime=null!==(ep=R["grpc.keepalive_time_ms"])&&void 0!==ep?ep:-1,this.idleTimeoutMs=Math.max(null!==(eg=R["grpc.client_idle_timeout_ms"])&&void 0!==eg?eg:eu,eo);let eT={createSubchannel:(T,S)=>{let R=this.subchannelPool.getOrCreateSubchannel(this.target,T,Object.assign({},this.options,S),this.credentials);R.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",R.getChannelzRef());let O=new ef(R,this);return this.wrappedSubchannels.add(O),O},updateState:(T,S)=>{this.currentPicker=S;let R=this.pickQueue.slice();for(let T of(this.pickQueue=[],R.length>0&&this.callRefTimerUnref(),R))T.doPick();this.updateState(T)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:T=>{this.channelzEnabled&&this.childrenTracker.refChild(T)},removeChannelzChild:T=>{this.channelzEnabled&&this.childrenTracker.unrefChild(T)}};this.resolvingLoadBalancer=new N.ResolvingLoadBalancer(this.target,eT,R,(T,S)=>{T.retryThrottling?ec.set(this.getTarget(),new ei.RetryThrottler(T.retryThrottling.maxTokens,T.retryThrottling.tokenRatio,ec.get(this.getTarget()))):ec.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=S,this.currentResolutionError=null,process.nextTick(()=>{let T=this.configSelectionQueue;for(let S of(this.configSelectionQueue=[],T.length>0&&this.callRefTimerUnref(),T))S.getConfig()})},T=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+T.code+' and details "'+T.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,en.restrictControlPlaneStatusCode)(T.code,T.details)),{metadata:T.metadata}));let S=this.configSelectionQueue;for(let R of(this.configSelectionQueue=[],S.length>0&&this.callRefTimerUnref(),S))R.reportResolverError(T)}),this.filterStackFactory=new U.FilterStackFactory([new V.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(R,void 0,2));let eS=Error();(0,K.trace)(L.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null===(em=eS.stack)||void 0===em?void 0:em.substring(eS.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(T,S){(0,K.trace)(null!=S?S:L.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Q.uriToString)(this.target)+" "+T)}callRefTimerRef(){var T,S,R,O;(null===(S=(T=this.callRefTimer).hasRef)||void 0===S?void 0:S.call(T))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(O=(R=this.callRefTimer).ref)||void 0===O||O.call(R))}callRefTimerUnref(){var T,S;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null===(S=(T=this.callRefTimer).unref)||void 0===S||S.call(T))}removeConnectivityStateWatcher(T){let S=this.connectivityStateWatchers.findIndex(S=>S===T);S>=0&&this.connectivityStateWatchers.splice(S,1)}updateState(T){for(let S of((0,K.trace)(L.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Q.uriToString)(this.target)+" "+Y.ConnectivityState[this.connectivityState]+" -> "+Y.ConnectivityState[T]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Y.ConnectivityState[T]),this.connectivityState=T,this.connectivityStateWatchers.slice()))T!==S.currentState&&(S.timer&&clearTimeout(S.timer),this.removeConnectivityStateWatcher(S),S.callback());T!==Y.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(T){if(T>this.keepaliveTime)for(let S of(this.keepaliveTime=T,this.wrappedSubchannels))S.throttleKeepalive(T)}removeWrappedSubchannel(T){this.wrappedSubchannels.delete(T)}doPick(T,S){return this.currentPicker.pick({metadata:T,extraPickInfo:S})}queueCallForPick(T){this.pickQueue.push(T),this.callRefTimerRef()}getConfig(T,S){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(T,S)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(T){this.configSelectionQueue.push(T),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Y.ConnectivityState.IDLE),this.currentPicker=new M.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(T){var S,R;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let T=new Date().valueOf()-this.lastActivityTimestamp.valueOf();T>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-T)},T),null===(R=(S=this.idleTimer).unref)||void 0===R||R.call(S)}maybeStartIdleTimer(){this.connectivityState===Y.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(T){this.channelzEnabled&&(T.code===L.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(T,S,R,O,N){let P=(0,er.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+P+'] method="'+S+'"'),new Z.LoadBalancingCall(this,T,S,R,O,N,P)}createRetryingCall(T,S,R,O,N){let P=(0,er.getNextCallNumber)();return this.trace("createRetryingCall ["+P+'] method="'+S+'"'),new ei.RetryingCall(this,T,S,R,O,N,P,this.retryBufferTracker,ec.get(this.getTarget()))}createInnerCall(T,S,R,O,N){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(T,S,R,O,N):this.createRetryingCall(T,S,R,O,N)}createResolvingCall(T,S,R,O,N){let P=(0,er.getNextCallNumber)();this.trace("createResolvingCall ["+P+'] method="'+T+'", deadline='+(0,ee.deadlineToString)(S));let M={deadline:S,flags:null!=N?N:L.Propagate.DEFAULTS,host:null!=R?R:this.defaultAuthority,parentCall:O},U=new et.ResolvingCall(this,T,M,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),P);return this.onCallStart(),U.addStatusWatcher(T=>{this.onCallEnd(T)}),U}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Y.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,X.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Q.uriToString)(this.target)}getConnectivityState(T){let S=this.connectivityState;return T&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),S}watchConnectivityState(T,S,R){if(this.connectivityState===Y.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let O=null;if(S!==1/0){let T=S instanceof Date?S:new Date(S),P=new Date;if(S===-1/0||T<=P){process.nextTick(R,Error("Deadline passed without connectivity state change"));return}O=setTimeout(()=>{this.removeConnectivityStateWatcher(N),R(Error("Deadline passed without connectivity state change"))},T.getTime()-P.getTime())}let N={currentState:T,callback:R,timer:O};this.connectivityStateWatchers.push(N)}getChannelzRef(){return this.channelzRef}createCall(T,S,R,O,N){if("string"!=typeof T)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof S||S instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Y.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(T,S,R,O,N)}}S.InternalChannel=ep},68682:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ChildLoadBalancerHandler=void 0;let O=R(75922),N=R(27894),P="child_load_balancer_helper";class M{constructor(T){this.channelControlHelper=T,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(T){this.parent=T,this.child=null}createSubchannel(T,S){return this.parent.channelControlHelper.createSubchannel(T,S)}updateState(T,S){var R;if(this.calledByPendingChild()){if(T===N.ConnectivityState.CONNECTING)return;null===(R=this.parent.currentChild)||void 0===R||R.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(T,S)}requestReresolution(){var T;let S=null!==(T=this.parent.pendingChild)&&void 0!==T?T:this.parent.currentChild;this.child===S&&this.parent.channelControlHelper.requestReresolution()}setChild(T){this.child=T}addChannelzChild(T){this.parent.channelControlHelper.addChannelzChild(T)}removeChannelzChild(T){this.parent.channelControlHelper.removeChannelzChild(T)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(T,S){return T.getLoadBalancerName()!==S.getLoadBalancerName()}updateAddressList(T,S,R){let N;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,S)){let T=new this.ChildPolicyHelper(this),R=(0,O.createLoadBalancer)(S,T);T.setChild(R),null===this.currentChild?(this.currentChild=R,N=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=R,N=this.pendingChild)}else N=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=S,N.updateAddressList(T,S,R)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return P}}S.ChildLoadBalancerHandler=M},91343:(T,S,R)=>{"use strict";var O;Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.OutlierDetectionLoadBalancer=S.OutlierDetectionLoadBalancingConfig=void 0;let N=R(27894),P=R(80933),M=R(36383),L=R(49865),U=R(75922),V=R(68682),$=R(8815),K=R(39247),W=R(67098),Q=R(90750),Y="outlier_detection";function X(T){Q.trace(P.LogVerbosity.DEBUG,Y,T)}let Z="outlier_detection",ee=(null!==(O=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)&&void 0!==O?O:"true")==="true",et={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},er={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function en(T,S,R,O){if(S in T&&typeof T[S]!==R){let N=O?`${O}.${S}`:S;throw Error(`outlier detection config ${N} parse error: expected ${R}, got ${typeof T[S]}`)}}function ei(T,S,R){let O=R?`${R}.${S}`:S;if(S in T){if(!(0,M.isDuration)(T[S]))throw Error(`outlier detection config ${O} parse error: expected Duration, got ${typeof T[S]}`);if(!(T[S].seconds>=0&&T[S].seconds<=315576e6&&T[S].nanos>=0&&T[S].nanos<=999999999))throw Error(`outlier detection config ${O} parse error: values out of range for non-negative Duaration`)}}function es(T,S,R){let O=R?`${R}.${S}`:S;if(en(T,S,"number",R),S in T&&!(T[S]>=0&&T[S]<=100))throw Error(`outlier detection config ${O} parse error: value out of range for percentage (0-100)`)}class ea{constructor(T,S,R,O,N,P,M){if(this.childPolicy=M,M.length>0&&"pick_first"===M[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=T?T:1e4,this.baseEjectionTimeMs=null!=S?S:3e4,this.maxEjectionTimeMs=null!=R?R:3e5,this.maxEjectionPercent=null!=O?O:10,this.successRateEjection=N?Object.assign(Object.assign({},et),N):null,this.failurePercentageEjection=P?Object.assign(Object.assign({},er),P):null}getLoadBalancerName(){return Z}toJsonObject(){return{interval:(0,M.msToDuration)(this.intervalMs),base_ejection_time:(0,M.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,M.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(T=>T.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(T){return new ea(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,T)}static createFromJson(T){var S;if(ei(T,"interval"),ei(T,"base_ejection_time"),ei(T,"max_ejection_time"),es(T,"max_ejection_percent"),"success_rate_ejection"in T){if("object"!=typeof T.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");en(T.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),es(T.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),en(T.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),en(T.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in T){if("object"!=typeof T.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");es(T.failure_percentage_ejection,"threshold","failure_percentage_ejection"),es(T.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),en(T.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),en(T.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new ea(T.interval?(0,M.durationToMs)(T.interval):null,T.base_ejection_time?(0,M.durationToMs)(T.base_ejection_time):null,T.max_ejection_time?(0,M.durationToMs)(T.max_ejection_time):null,null!==(S=T.max_ejection_percent)&&void 0!==S?S:null,T.success_rate_ejection,T.failure_percentage_ejection,T.child_policy.map(U.validateLoadBalancingConfig))}}S.OutlierDetectionLoadBalancingConfig=ea;class eo extends W.BaseSubchannelWrapper{constructor(T,S){super(T),this.mapEntry=S,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=T.getConnectivityState(),T.addConnectivityStateListener((T,S,R,O)=>{if(this.childSubchannelState=R,!this.ejected)for(let T of this.stateListeners)T(this,S,R,O)})}getConnectivityState(){return this.ejected?N.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(T){this.stateListeners.push(T)}removeConnectivityStateListener(T){let S=this.stateListeners.indexOf(T);S>-1&&this.stateListeners.splice(S,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let T=this.mapEntry.subchannelWrappers.indexOf(this);T>=0&&this.mapEntry.subchannelWrappers.splice(T,1)}}eject(){for(let T of(this.ejected=!0,this.stateListeners))T(this,this.childSubchannelState,N.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let T of(this.ejected=!1,this.stateListeners))T(this,N.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function eu(){return{success:0,failure:0}}class ec{constructor(){this.activeBucket=eu(),this.inactiveBucket=eu()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=eu()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class ed{constructor(T,S){this.wrappedPicker=T,this.countCalls=S}pick(T){let S=this.wrappedPicker.pick(T);if(S.pickResultType!==$.PickResultType.COMPLETE)return S;{let T=S.subchannel,R=T.getMapEntry();if(!R)return Object.assign(Object.assign({},S),{subchannel:T.getWrappedSubchannel()});{let O=S.onCallEnded;return this.countCalls&&(O=T=>{var O;T===P.Status.OK?R.counter.addSuccess():R.counter.addFailure(),null===(O=S.onCallEnded)||void 0===O||O.call(S,T)}),Object.assign(Object.assign({},S),{subchannel:T.getWrappedSubchannel(),onCallEnded:O})}}}}class eh{constructor(T){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new V.ChildLoadBalancerHandler((0,L.createChildChannelControlHelper)(T,{createSubchannel:(S,R)=>{let O=T.createSubchannel(S,R),N=this.addressMap.get((0,K.subchannelAddressToString)(S)),P=new eo(O,N);return(null==N?void 0:N.currentEjectionTimestamp)!==null&&P.eject(),null==N||N.subchannelWrappers.push(P),P},updateState:(S,R)=>{S===N.ConnectivityState.READY?T.updateState(S,new ed(R,this.isCountingEnabled())):T.updateState(S,R)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let T=0;for(let S of this.addressMap.values())null!==S.currentEjectionTimestamp&&(T+=1);return 100*T/this.addressMap.size}runSuccessRateCheck(T){if(!this.latestConfig)return;let S=this.latestConfig.getSuccessRateEjectionConfig();if(!S)return;X("Running success rate check");let R=S.request_volume,O=0,N=[];for(let[T,S]of this.addressMap){let P=S.counter.getLastSuccesses(),M=S.counter.getLastFailures();X("Stats for "+T+": successes="+P+" failures="+M+" targetRequestVolume="+R),P+M>=R&&(O+=1,N.push(P/(P+M)))}if(X("Found "+O+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+N+"]"),O<S.minimum_hosts)return;let P=N.reduce((T,S)=>T+S)/N.length,M=0;for(let T of N){let S=T-P;M+=S*S}let L=Math.sqrt(M/N.length),U=P-S.stdev_factor/1e3*L;for(let[O,N]of(X("stdev="+L+" ejectionThreshold="+U),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let P=N.counter.getLastSuccesses(),M=N.counter.getLastFailures();if(P+M<R)continue;let L=P/(P+M);if(X("Checking candidate "+O+" successRate="+L),L<U){let R=100*Math.random();X("Candidate "+O+" randomNumber="+R+" enforcement_percentage="+S.enforcement_percentage),R<S.enforcement_percentage&&(X("Ejecting candidate "+O),this.eject(N,T))}}}runFailurePercentageCheck(T){if(!this.latestConfig)return;let S=this.latestConfig.getFailurePercentageEjectionConfig();if(!S)return;X("Running failure percentage check. threshold="+S.threshold+" request volume threshold="+S.request_volume);let R=0;for(let T of this.addressMap.values())T.counter.getLastSuccesses()+T.counter.getLastFailures()>=S.request_volume&&(R+=1);if(!(R<S.minimum_hosts))for(let[R,O]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let N=O.counter.getLastSuccesses(),P=O.counter.getLastFailures();if(X("Candidate successes="+N+" failures="+P),!(N+P<S.request_volume)&&100*P/(P+N)>S.threshold){let N=100*Math.random();X("Candidate "+R+" randomNumber="+N+" enforcement_percentage="+S.enforcement_percentage),N<S.enforcement_percentage&&(X("Ejecting candidate "+R),this.eject(O,T))}}}eject(T,S){for(let S of(T.currentEjectionTimestamp=new Date,T.ejectionTimeMultiplier+=1,T.subchannelWrappers))S.eject()}uneject(T){for(let S of(T.currentEjectionTimestamp=null,T.subchannelWrappers))S.uneject()}switchAllBuckets(){for(let T of this.addressMap.values())T.counter.switchBuckets()}startTimer(T){var S,R;this.ejectionTimer=setTimeout(()=>this.runChecks(),T),null===(R=(S=this.ejectionTimer).unref)||void 0===R||R.call(S)}runChecks(){let T=new Date;if(X("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[S,R]of(this.timerStartTime=T,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(T),this.runFailurePercentageCheck(T),this.addressMap.entries()))if(null===R.currentEjectionTimestamp)R.ejectionTimeMultiplier>0&&(R.ejectionTimeMultiplier-=1);else{let T=this.latestConfig.getBaseEjectionTimeMs(),O=this.latestConfig.getMaxEjectionTimeMs(),N=new Date(R.currentEjectionTimestamp.getTime());N.setMilliseconds(N.getMilliseconds()+Math.min(T*R.ejectionTimeMultiplier,Math.max(T,O))),N<new Date&&(X("Unejecting "+S),this.uneject(R))}}updateAddressList(T,S,R){if(!(S instanceof ea))return;let O=new Set;for(let S of T)O.add((0,K.subchannelAddressToString)(S));for(let T of O)this.addressMap.has(T)||(X("Adding map entry for "+T),this.addressMap.set(T,{counter:new ec,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let T of this.addressMap.keys())O.has(T)||(X("Removing map entry for "+T),this.addressMap.delete(T));let N=(0,U.getFirstUsableConfig)(S.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(T,N,R),S.getSuccessRateEjectionConfig()||S.getFailurePercentageEjectionConfig()){if(this.timerStartTime){X("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let T=S.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(T)}else X("Starting new timer"),this.timerStartTime=new Date,this.startTimer(S.getIntervalMs()),this.switchAllBuckets()}else for(let T of(X("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(T),T.ejectionTimeMultiplier=0;this.latestConfig=S}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return Z}}function ef(){ee&&(0,L.registerLoadBalancerType)(Z,eh,ea)}S.OutlierDetectionLoadBalancer=eh,S.setup=ef},21567:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.PickFirstLoadBalancer=S.shuffled=S.PickFirstLoadBalancingConfig=void 0;let O=R(75922),N=R(27894),P=R(8815),M=R(90750),L=R(80933),U="pick_first";function V(T){M.trace(L.LogVerbosity.DEBUG,U,T)}let $="pick_first",K=250;class W{constructor(T){this.shuffleAddressList=T}getLoadBalancerName(){return $}toJsonObject(){return{[$]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(T){if("shuffleAddressList"in T&&"boolean"!=typeof T.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new W(!0===T.shuffleAddressList)}}S.PickFirstLoadBalancingConfig=W;class Q{constructor(T){this.subchannel=T}pick(T){return{pickResultType:P.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function Y(T){let S=T.slice();for(let T=S.length-1;T>1;T--){let R=Math.floor(Math.random()*(T+1)),O=S[T];S[T]=S[R],S[R]=O}return S}S.shuffled=Y;class X{constructor(T){this.channelControlHelper=T,this.children=[],this.currentState=N.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(T,S,R,O,N)=>{this.onSubchannelStateUpdate(T,S,R,N)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(T=>T.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(N.ConnectivityState.READY,new Q(this.currentPick)):0===this.children.length?this.updateState(N.ConnectivityState.IDLE,new P.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(N.ConnectivityState.TRANSIENT_FAILURE,new P.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(N.ConnectivityState.CONNECTING,new P.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:T}of(this.stickyTransientFailureMode=!0,this.children))T.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let T=this.currentPick;this.currentPick=null,T.unref(),T.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(T.getChannelzRef())}}onSubchannelStateUpdate(T,S,R,O){var P;if(null===(P=this.currentPick)||void 0===P?void 0:P.realSubchannelEquals(T)){R!==N.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[S,P]of this.children.entries())if(T.realSubchannelEquals(P.subchannel)){R===N.ConnectivityState.READY&&this.pickSubchannel(P.subchannel),R===N.ConnectivityState.TRANSIENT_FAILURE&&(P.hasReportedTransientFailure=!0,O&&(this.lastError=O),this.maybeEnterStickyTransientFailureMode(),S===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(S+1)),P.subchannel.startConnecting();return}}startNextSubchannelConnecting(T){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[S,R]of this.children.entries())if(S>=T){let T=R.subchannel.getConnectivityState();if(T===N.ConnectivityState.IDLE||T===N.ConnectivityState.CONNECTING){this.startConnecting(S);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(T){var S,R;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=T,this.children[T].subchannel.getConnectivityState()===N.ConnectivityState.IDLE&&(V("Start connecting to subchannel with address "+this.children[T].subchannel.getAddress()),process.nextTick(()=>{var S;null===(S=this.children[T])||void 0===S||S.subchannel.startConnecting()})),this.connectionDelayTimeout=null===(R=(S=setTimeout(()=>{this.startNextSubchannelConnecting(T+1)},K)).unref)||void 0===R?void 0:R.call(S)}pickSubchannel(T){this.currentPick&&T.realSubchannelEquals(this.currentPick)||(V("Pick subchannel with address "+T.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=T,T.ref(),this.channelControlHelper.addChannelzChild(T.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(T,S){V(N.ConnectivityState[this.currentState]+" -> "+N.ConnectivityState[T]),this.currentState=T,this.channelControlHelper.updateState(T,S)}resetSubchannelList(){for(let T of this.children)this.currentPick&&T.subchannel.realSubchannelEquals(this.currentPick)||T.subchannel.removeConnectivityStateListener(this.subchannelStateListener),T.subchannel.unref(),this.channelControlHelper.removeChannelzChild(T.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(T){let S=T.map(T=>({subchannel:this.channelControlHelper.createSubchannel(T,{}),hasReportedTransientFailure:!1}));for(let{subchannel:T}of S)T.ref(),this.channelControlHelper.addChannelzChild(T.getChannelzRef());for(let{subchannel:T}of(this.resetSubchannelList(),this.children=S,this.children))if(T.addConnectivityStateListener(this.subchannelStateListener),T.getConnectivityState()===N.ConnectivityState.READY){this.pickSubchannel(T);return}for(let T of this.children)T.subchannel.getConnectivityState()===N.ConnectivityState.TRANSIENT_FAILURE&&(T.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(T,S){S instanceof W&&(S.getShuffleAddressList()&&(T=Y(T)),this.latestAddressList=T,this.connectToAddressList(T))}exitIdle(){this.currentState===N.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return $}}function Z(){(0,O.registerLoadBalancerType)($,X,W),(0,O.registerDefaultLoadBalancerType)($)}S.PickFirstLoadBalancer=X,S.setup=Z},83542:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.RoundRobinLoadBalancer=void 0;let O=R(75922),N=R(27894),P=R(8815),M=R(39247),L=R(90750),U=R(80933),V="round_robin";function $(T){L.trace(U.LogVerbosity.DEBUG,V,T)}let K="round_robin";class W{getLoadBalancerName(){return K}constructor(){}toJsonObject(){return{[K]:{}}}static createFromJson(T){return new W}}class Q{constructor(T,S=0){this.subchannelList=T,this.nextIndex=S}pick(T){let S=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:P.PickResultType.COMPLETE,subchannel:S,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class Y{constructor(T){this.channelControlHelper=T,this.subchannels=[],this.currentState=N.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(T,S,R,O,P)=>{this.calculateAndUpdateState(),(R===N.ConnectivityState.TRANSIENT_FAILURE||R===N.ConnectivityState.IDLE)&&(P&&(this.lastError=P),this.channelControlHelper.requestReresolution(),T.startConnecting())}}countSubchannelsWithState(T){return this.subchannels.filter(S=>S.getConnectivityState()===T).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(N.ConnectivityState.READY)>0){let T=this.subchannels.filter(T=>T.getConnectivityState()===N.ConnectivityState.READY),S=0;null!==this.currentReadyPicker&&(S=T.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(S=0),this.updateState(N.ConnectivityState.READY,new Q(T,S))}else this.countSubchannelsWithState(N.ConnectivityState.CONNECTING)>0?this.updateState(N.ConnectivityState.CONNECTING,new P.QueuePicker(this)):this.countSubchannelsWithState(N.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(N.ConnectivityState.TRANSIENT_FAILURE,new P.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(N.ConnectivityState.IDLE,new P.QueuePicker(this))}updateState(T,S){$(N.ConnectivityState[this.currentState]+" -> "+N.ConnectivityState[T]),T===N.ConnectivityState.READY?this.currentReadyPicker=S:this.currentReadyPicker=null,this.currentState=T,this.channelControlHelper.updateState(T,S)}resetSubchannelList(){for(let T of this.subchannels)T.removeConnectivityStateListener(this.subchannelStateListener),T.unref(),this.channelControlHelper.removeChannelzChild(T.getChannelzRef());this.subchannels=[]}updateAddressList(T,S){for(let S of(this.resetSubchannelList(),$("Connect to address list "+T.map(T=>(0,M.subchannelAddressToString)(T))),this.subchannels=T.map(T=>this.channelControlHelper.createSubchannel(T,{})),this.subchannels)){S.ref(),S.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(S.getChannelzRef());let T=S.getConnectivityState();(T===N.ConnectivityState.IDLE||T===N.ConnectivityState.TRANSIENT_FAILURE)&&S.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let T of this.subchannels)T.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return K}}function X(){(0,O.registerLoadBalancerType)(K,Y,W)}S.RoundRobinLoadBalancer=Y,S.setup=X},75922:(T,S)=>{"use strict";function R(T,S){var R,O,N,P,M,L,U,V,$,K;return{createSubchannel:null!==(O=null===(R=S.createSubchannel)||void 0===R?void 0:R.bind(S))&&void 0!==O?O:T.createSubchannel.bind(T),updateState:null!==(P=null===(N=S.updateState)||void 0===N?void 0:N.bind(S))&&void 0!==P?P:T.updateState.bind(T),requestReresolution:null!==(L=null===(M=S.requestReresolution)||void 0===M?void 0:M.bind(S))&&void 0!==L?L:T.requestReresolution.bind(T),addChannelzChild:null!==(V=null===(U=S.addChannelzChild)||void 0===U?void 0:U.bind(S))&&void 0!==V?V:T.addChannelzChild.bind(T),removeChannelzChild:null!==(K=null===($=S.removeChannelzChild)||void 0===$?void 0:$.bind(S))&&void 0!==K?K:T.removeChannelzChild.bind(T)}}Object.defineProperty(S,"__esModule",{value:!0}),S.validateLoadBalancingConfig=S.getFirstUsableConfig=S.isLoadBalancerNameRegistered=S.createLoadBalancer=S.registerDefaultLoadBalancerType=S.registerLoadBalancerType=S.createChildChannelControlHelper=void 0,S.createChildChannelControlHelper=R;let O={},N=null;function P(T,S,R){O[T]={LoadBalancer:S,LoadBalancingConfig:R}}function M(T){N=T}function L(T,S){let R=T.getLoadBalancerName();return R in O?new O[R].LoadBalancer(S):null}function U(T){return T in O}function V(T,S=!1){for(let S of T)if(S.getLoadBalancerName() in O)return S;return S&&N?new O[N].LoadBalancingConfig:null}function $(T){if(!(null!==T&&"object"==typeof T))throw Error("Load balancing config must be an object");let S=Object.keys(T);if(1!==S.length)throw Error("Provided load balancing config has multiple conflicting entries");let R=S[0];if(R in O)return O[R].LoadBalancingConfig.createFromJson(T[R]);throw Error(`Unrecognized load balancing config name ${R}`)}S.registerLoadBalancerType=P,S.registerDefaultLoadBalancerType=M,S.createLoadBalancer=L,S.isLoadBalancerNameRegistered=U,S.getFirstUsableConfig=V,S.validateLoadBalancingConfig=$},8055:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.LoadBalancingCall=void 0;let O=R(27894),N=R(80933),P=R(21906),M=R(40834),L=R(8815),U=R(9442),V=R(90750),$=R(95042),K=R(85158),W="load_balancing_call";class Q{constructor(T,S,R,O,N,P,M){var L,V;this.channel=T,this.callConfig=S,this.methodName=R,this.host=O,this.credentials=N,this.deadline=P,this.callNumber=M,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let $=this.methodName.split("/"),K="";$.length>=2&&(K=$[1]);let W=null!==(V=null===(L=(0,U.splitHostPort)(this.host))||void 0===L?void 0:L.host)&&void 0!==V?V:"localhost";this.serviceUrl=`https://${W}/${K}`}trace(T){V.trace(N.LogVerbosity.DEBUG,W,"["+this.callNumber+"] "+T)}outputStatus(T,S){var R,O;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+T.code+' details="'+T.details+'"');let N=Object.assign(Object.assign({},T),{progress:S});null===(R=this.listener)||void 0===R||R.onReceiveStatus(N),null===(O=this.onCallEnded)||void 0===O||O.call(this,N.code)}}doPick(){var T,S;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let R=this.channel.doPick(this.metadata,this.callConfig.pickInformation),U=R.subchannel?"("+R.subchannel.getChannelzRef().id+") "+R.subchannel.getAddress():""+R.subchannel;switch(this.trace("Pick result: "+L.PickResultType[R.pickResultType]+" subchannel: "+U+" status: "+(null===(T=R.status)||void 0===T?void 0:T.code)+" "+(null===(S=R.status)||void 0===S?void 0:S.details)),R.pickResultType){case L.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(T=>{var S,L,V;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let $=this.metadata.clone();if($.merge(T),$.get("authorization").length>1&&this.outputStatus({code:N.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new M.Metadata},"PROCESSED"),R.subchannel.getConnectivityState()!==O.ConnectivityState.READY){this.trace("Picked subchannel "+U+" has state "+O.ConnectivityState[R.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&$.set("grpc-timeout",(0,P.getDeadlineTimeoutString)(this.deadline));try{this.child=R.subchannel.getRealSubchannel().createCall($,this.host,this.methodName,{onReceiveMetadata:T=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(T)},onReceiveMessage:T=>{this.trace("Received message"),this.listener.onReceiveMessage(T)},onReceiveStatus:T=>{this.trace("Received status"),T.rstCode===K.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(T,"REFUSED"):this.outputStatus(T,"PROCESSED")}})}catch(T){this.trace("Failed to start call on picked subchannel "+U+" with error "+T.message),this.outputStatus({code:N.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+T.message,metadata:new M.Metadata},"NOT_STARTED");return}null===(L=(S=this.callConfig).onCommitted)||void 0===L||L.call(S),null===(V=R.onCallStarted)||void 0===V||V.call(R),this.onCallEnded=R.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},T=>{let{code:S,details:R}=(0,$.restrictControlPlaneStatusCode)("number"==typeof T.code?T.code:N.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${T.message}`);this.outputStatus({code:S,details:R,metadata:new M.Metadata},"PROCESSED")});break;case L.PickResultType.DROP:let{code:V,details:W}=(0,$.restrictControlPlaneStatusCode)(R.status.code,R.status.details);setImmediate(()=>{this.outputStatus({code:V,details:W,metadata:R.status.metadata},"DROP")});break;case L.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:T,details:S}=(0,$.restrictControlPlaneStatusCode)(R.status.code,R.status.details);setImmediate(()=>{this.outputStatus({code:T,details:S,metadata:R.status.metadata},"PROCESSED")})}break;case L.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(T,S){var R;this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),null===(R=this.child)||void 0===R||R.cancelWithStatus(T,S),this.outputStatus({code:T,details:S,metadata:new M.Metadata},"PROCESSED")}getPeer(){var T,S;return null!==(S=null===(T=this.child)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:this.channel.getTarget()}start(T,S){this.trace("start called"),this.listener=S,this.metadata=T,this.doPick()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length),this.child?this.child.sendMessageWithContext(T,S):this.pendingMessage={context:T,message:S}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(T){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}S.LoadBalancingCall=Q},90750:(T,S,R)=>{"use strict";var O,N,P,M;Object.defineProperty(S,"__esModule",{value:!0}),S.isTracerEnabled=S.trace=S.log=S.setLoggerVerbosity=S.setLogger=S.getLogger=void 0;let L=R(80933),U=R(77282),V=R(81513).i8,$={error:(T,...S)=>{console.error("E "+T,...S)},info:(T,...S)=>{console.error("I "+T,...S)},debug:(T,...S)=>{console.error("D "+T,...S)}},K=L.LogVerbosity.ERROR;switch((null!==(N=null!==(O=process.env.GRPC_NODE_VERBOSITY)&&void 0!==O?O:process.env.GRPC_VERBOSITY)&&void 0!==N?N:"").toUpperCase()){case"DEBUG":K=L.LogVerbosity.DEBUG;break;case"INFO":K=L.LogVerbosity.INFO;break;case"ERROR":K=L.LogVerbosity.ERROR;break;case"NONE":K=L.LogVerbosity.NONE}let W=()=>$;S.getLogger=W;let Q=T=>{$=T};S.setLogger=Q;let Y=T=>{K=T};S.setLoggerVerbosity=Y;let X=(T,...S)=>{let R;if(T>=K){switch(T){case L.LogVerbosity.DEBUG:R=$.debug;break;case L.LogVerbosity.INFO:R=$.info;break;case L.LogVerbosity.ERROR:R=$.error}R||(R=$.error),R&&R.bind($)(...S)}};S.log=X;let Z=null!==(M=null!==(P=process.env.GRPC_NODE_TRACE)&&void 0!==P?P:process.env.GRPC_TRACE)&&void 0!==M?M:"",ee=new Set,et=new Set;for(let T of Z.split(","))T.startsWith("-")?et.add(T.substring(1)):ee.add(T);let er=ee.has("all");function en(T,R,O){ei(R)&&(0,S.log)(T,new Date().toISOString()+" | v"+V+" "+U.pid+" | "+R+" | "+O)}function ei(T){return!et.has(T)&&(er||ee.has(T))}S.trace=en,S.isTracerEnabled=ei},22785:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.loadPackageDefinition=S.makeClientConstructor=void 0;let O=R(33703),N={unary:O.Client.prototype.makeUnaryRequest,server_stream:O.Client.prototype.makeServerStreamRequest,client_stream:O.Client.prototype.makeClientStreamRequest,bidi:O.Client.prototype.makeBidiStreamRequest};function P(T){return["__proto__","prototype","constructor"].includes(T)}function M(T,S,R){R||(R={});class M extends O.Client{}return Object.keys(T).forEach(S=>{let R;if(P(S))return;let O=T[S];if("string"==typeof S&&"$"===S.charAt(0))throw Error("Method names cannot start with $");R=O.requestStream?O.responseStream?"bidi":"client_stream":O.responseStream?"server_stream":"unary";let U=O.requestSerialize,V=O.responseDeserialize,$=L(N[R],O.path,U,V);M.prototype[S]=$,Object.assign(M.prototype[S],O),O.originalName&&!P(O.originalName)&&(M.prototype[O.originalName]=M.prototype[S])}),M.service=T,M.serviceName=S,M}function L(T,S,R,O){return function(...N){return T.call(this,S,R,O,...N)}}function U(T){return"format"in T}function V(T){let S={};for(let R in T)if(Object.prototype.hasOwnProperty.call(T,R)){let O=T[R],N=R.split(".");if(N.some(T=>P(T)))continue;let L=N[N.length-1],V=S;for(let T of N.slice(0,-1))V[T]||(V[T]={}),V=V[T];U(O)?V[L]=O:V[L]=M(O,L,{})}return S}S.makeClientConstructor=M,S.loadPackageDefinition=V},40834:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Metadata=void 0;let O=R(90750),N=R(80933),P=R(676),M=/^[0-9a-z_.-]+$/,L=/^[ -~]*$/;function U(T){return M.test(T)}function V(T){return L.test(T)}function $(T){return T.endsWith("-bin")}function K(T){return!T.startsWith("grpc-")}function W(T){return T.toLowerCase()}function Q(T,S){if(!U(T))throw Error('Metadata key "'+T+'" contains illegal characters');if(null!=S){if($(T)){if(!Buffer.isBuffer(S))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(S))throw Error("keys that don't end with '-bin' must have String values");if(!V(S))throw Error('Metadata string value "'+S+'" contains illegal characters')}}}class Y{constructor(T={}){this.internalRepr=new Map,this.options=T}set(T,S){Q(T=W(T),S),this.internalRepr.set(T,[S])}add(T,S){Q(T=W(T),S);let R=this.internalRepr.get(T);void 0===R?this.internalRepr.set(T,[S]):R.push(S)}remove(T){T=W(T),this.internalRepr.delete(T)}get(T){return T=W(T),this.internalRepr.get(T)||[]}getMap(){let T={};for(let[S,R]of this.internalRepr)if(R.length>0){let O=R[0];T[S]=Buffer.isBuffer(O)?Buffer.from(O):O}return T}clone(){let T=new Y(this.options),S=T.internalRepr;for(let[T,R]of this.internalRepr){let O=R.map(T=>Buffer.isBuffer(T)?Buffer.from(T):T);S.set(T,O)}return T}merge(T){for(let[S,R]of T.internalRepr){let T=(this.internalRepr.get(S)||[]).concat(R);this.internalRepr.set(S,T)}}setOptions(T){this.options=T}getOptions(){return this.options}toHttp2Headers(){let T={};for(let[S,R]of this.internalRepr)T[S]=R.map(X);return T}toJSON(){let T={};for(let[S,R]of this.internalRepr)T[S]=R;return T}static fromHttp2Headers(T){let S=new Y;for(let R of Object.keys(T)){if(":"===R.charAt(0))continue;let M=T[R];try{$(R)?Array.isArray(M)?M.forEach(T=>{S.add(R,Buffer.from(T,"base64"))}):void 0!==M&&(K(R)?M.split(",").forEach(T=>{S.add(R,Buffer.from(T.trim(),"base64"))}):S.add(R,Buffer.from(M,"base64"))):Array.isArray(M)?M.forEach(T=>{S.add(R,T)}):void 0!==M&&S.add(R,M)}catch(S){let T=`Failed to add metadata entry ${R}: ${M}. ${(0,P.getErrorMessage)(S)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,O.log)(N.LogVerbosity.ERROR,T)}}return S}}S.Metadata=Y;let X=T=>Buffer.isBuffer(T)?T.toString("base64"):T},8815:(T,S,R)=>{"use strict";var O;Object.defineProperty(S,"__esModule",{value:!0}),S.QueuePicker=S.UnavailablePicker=S.PickResultType=void 0;let N=R(40834),P=R(80933);!function(T){T[T.COMPLETE=0]="COMPLETE",T[T.QUEUE=1]="QUEUE",T[T.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",T[T.DROP=3]="DROP"}(O||(S.PickResultType=O={}));class M{constructor(T){this.status=Object.assign({code:P.Status.UNAVAILABLE,details:"No connection established",metadata:new N.Metadata},T)}pick(T){return{pickResultType:O.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}S.UnavailablePicker=M;class L{constructor(T){this.loadBalancer=T,this.calledExitIdle=!1}pick(T){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:O.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}S.QueuePicker=L},61067:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=S.DEFAULT_PORT=void 0;let O=R(77561),N=R(9523),P=R(73837),M=R(34341),L=R(80933),U=R(40834),V=R(90750),$=R(80933),K=R(9442),W=R(41808),Q=R(9360),Y="dns_resolver";function X(T){V.trace($.LogVerbosity.DEBUG,Y,T)}S.DEFAULT_PORT=443;let Z=3e4,ee=P.promisify(N.resolveTxt),et=P.promisify(N.lookup);function er(...T){let S=[];for(let R=0;R<Math.max.apply(null,T.map(T=>T.length));R++)for(let O of T)R<O.length&&S.push(O[R]);return S}class en{constructor(T,R,O){var N,P,M;this.target=T,this.listener=R,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,X("Resolver constructed for target "+(0,K.uriToString)(T));let V=(0,K.splitHostPort)(T.path);null===V?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,W.isIPv4)(V.host)||(0,W.isIPv6)(V.host)?(this.ipResult=[{host:V.host,port:null!==(N=V.port)&&void 0!==N?N:S.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=V.host,this.port=null!==(P=V.port)&&void 0!==P?P:S.DEFAULT_PORT),this.percentage=100*Math.random(),1===O["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:L.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,K.uriToString)(this.target)}`,metadata:new U.Metadata};let $={initialDelay:O["grpc.initial_reconnect_backoff_ms"],maxDelay:O["grpc.max_reconnect_backoff_ms"]};this.backoff=new Q.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},$),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!==(M=O["grpc.dns_min_time_between_resolutions_ms"])&&void 0!==M?M:Z,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(X("Returning IP address for target "+(0,K.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)X("Failed to parse DNS address "+(0,K.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:L.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,K.uriToString)(this.target)}`,metadata:new U.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;X("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let T=this.dnsHostname;this.pendingLookupPromise=et(T,{all:!0}),this.pendingLookupPromise.then(T=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let S=T.filter(T=>4===T.family),R=T.filter(T=>6===T.family);this.latestLookupResult=er(R,S).map(T=>({host:T.address,port:+this.port}));let O="["+this.latestLookupResult.map(T=>T.host+":"+T.port).join(",")+"]";if(X("Resolved addresses for target "+(0,K.uriToString)(this.target)+": "+O),0===this.latestLookupResult.length){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},T=>{null!==this.pendingLookupPromise&&(X("Resolution error for target "+(0,K.uriToString)(this.target)+": "+T.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=ee(T),this.pendingTxtPromise.then(T=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,M.extractAndSelectServiceConfig)(T,this.percentage)}catch(T){this.latestServiceConfigError={code:L.Status.UNAVAILABLE,details:`Parsing service config failed with error ${T.message}`,metadata:new U.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},T=>{}))}}startNextResolutionTimer(){var T,S;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null===(S=(T=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)||void 0===S?void 0:S.call(T),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?X('resolution update delayed by "min time between resolutions" rate limit'):X("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(T){return T.path}}function ei(){(0,O.registerResolver)("dns",en),(0,O.registerDefaultScheme)("dns")}S.setup=ei},62776:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=void 0;let O=R(41808),N=R(80933),P=R(40834),M=R(77561),L=R(9442),U=R(90750),V="ip_resolver";function $(T){U.trace(N.LogVerbosity.DEBUG,V,T)}let K="ipv4",W="ipv6",Q=443;class Y{constructor(T,S,R){var M;this.listener=S,this.addresses=[],this.error=null,this.hasReturnedResult=!1,$("Resolver constructed for target "+(0,L.uriToString)(T));let U=[];if(!(T.scheme===K||T.scheme===W)){this.error={code:N.Status.UNAVAILABLE,details:`Unrecognized scheme ${T.scheme} in IP resolver`,metadata:new P.Metadata};return}for(let S of T.path.split(",")){let R=(0,L.splitHostPort)(S);if(null===R||T.scheme===K&&!(0,O.isIPv4)(R.host)||T.scheme===W&&!(0,O.isIPv6)(R.host)){this.error={code:N.Status.UNAVAILABLE,details:`Failed to parse ${T.scheme} address ${S}`,metadata:new P.Metadata};return}U.push({host:R.host,port:null!==(M=R.port)&&void 0!==M?M:Q})}this.addresses=U,$("Parsed "+T.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(T){return T.path.split(",")[0]}}function X(){(0,M.registerResolver)(K,Y),(0,M.registerResolver)(W,Y)}S.setup=X},93104:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.setup=void 0;let O=R(77561);class N{constructor(T,S,R){let O;this.listener=S,this.addresses=[],this.hasReturnedResult=!1,O=""===T.authority?"/"+T.path:T.path,this.addresses=[{path:O}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(T){return"localhost"}}function P(){(0,O.registerResolver)("unix",N)}S.setup=P},77561:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.mapUriDefaultScheme=S.getDefaultAuthority=S.createResolver=S.registerDefaultScheme=S.registerResolver=void 0;let O=R(9442),N={},P=null;function M(T,S){N[T]=S}function L(T){P=T}function U(T,S,R){if(void 0!==T.scheme&&T.scheme in N)return new N[T.scheme](T,S,R);throw Error(`No resolver could be created for target ${(0,O.uriToString)(T)}`)}function V(T){if(void 0!==T.scheme&&T.scheme in N)return N[T.scheme].getDefaultAuthority(T);throw Error(`Invalid target ${(0,O.uriToString)(T)}`)}function $(T){return void 0!==T.scheme&&T.scheme in N?T:null!==P?{scheme:P,authority:void 0,path:(0,O.uriToString)(T)}:null}S.registerResolver=M,S.registerDefaultScheme=L,S.createResolver=U,S.getDefaultAuthority=V,S.mapUriDefaultScheme=$},49769:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ResolvingCall=void 0;let O=R(80933),N=R(21906),P=R(40834),M=R(90750),L=R(95042),U="resolving_call";class V{constructor(T,S,R,P,M,L){this.channel=T,this.method=S,this.filterStackFactory=P,this.credentials=M,this.callNumber=L,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=R.deadline,this.host=R.host,R.parentCall&&(R.flags&O.Propagate.CANCELLATION&&R.parentCall.on("cancelled",()=>{this.cancelWithStatus(O.Status.CANCELLED,"Cancelled by parent call")}),R.flags&O.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+R.parentCall.getDeadline()),this.deadline=(0,N.minDeadline)(this.deadline,R.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(T){M.trace(O.LogVerbosity.DEBUG,U,"["+this.callNumber+"] "+T)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,N.deadlineToString)(this.deadline));let T=(0,N.getRelativeTimeout)(this.deadline);if(T!==1/0){this.trace("Deadline will be reached in "+T+"ms");let S=()=>{this.cancelWithStatus(O.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};T<=0?process.nextTick(S):this.deadlineTimer=setTimeout(S,T)}}outputStatus(T){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let S=this.filterStack.receiveTrailers(T);this.trace("ended with status: code="+S.code+' details="'+S.details+'"'),this.statusWatchers.forEach(T=>T(S)),process.nextTick(()=>{var T;null===(T=this.listener)||void 0===T||T.onReceiveStatus(S)})}}sendMessageOnChild(T,S){if(!this.child)throw Error("sendMessageonChild called with child not populated");let R=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:S,flags:T.flags})).then(S=>{this.writeFilterPending=!1,R.sendMessageWithContext(T,S.message),this.pendingHalfClose&&R.halfClose()},T=>{this.cancelWithStatus(T.code,T.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let T=this.channel.getConfig(this.method,this.metadata);if("NONE"===T.type){this.channel.queueCallForConfig(this);return}if("ERROR"===T.type){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(T.error);return}let S=T.config;if(S.status!==O.Status.OK){let{code:T,details:R}=(0,L.restrictControlPlaneStatusCode)(S.status,"Failed to route call to method "+this.method);this.outputStatus({code:T,details:R,metadata:new P.Metadata});return}if(S.methodConfig.timeout){let T=new Date;T.setSeconds(T.getSeconds()+S.methodConfig.timeout.seconds),T.setMilliseconds(T.getMilliseconds()+S.methodConfig.timeout.nanos/1e6),this.deadline=(0,N.minDeadline)(this.deadline,T),this.runDeadlineTimer()}this.filterStackFactory.push(S.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(T=>{this.child=this.channel.createInnerCall(S,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(T,{onReceiveMetadata:T=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(T))},onReceiveMessage:T=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(T).then(T=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(T),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},T=>{this.cancelWithStatus(T.code,T.details)})},onReceiveStatus:T=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=T:this.outputStatus(T)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},T=>{this.outputStatus(T)})}reportResolverError(T){var S;(null===(S=this.metadata)||void 0===S?void 0:S.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(T)}cancelWithStatus(T,S){var R;this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),null===(R=this.child)||void 0===R||R.cancelWithStatus(T,S),this.outputStatus({code:T,details:S,metadata:new P.Metadata})}getPeer(){var T,S;return null!==(S=null===(T=this.child)||void 0===T?void 0:T.getPeer())&&void 0!==S?S:this.channel.getTarget()}start(T,S){this.trace("start called"),this.metadata=T.clone(),this.listener=S,this.getConfig()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length),this.child?this.sendMessageOnChild(T,S):this.pendingMessage={context:T,message:S}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(T){this.credentials=this.credentials.compose(T)}addStatusWatcher(T){this.statusWatchers.push(T)}getCallNumber(){return this.callNumber}}S.ResolvingCall=V},22510:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ResolvingLoadBalancer=void 0;let O=R(75922),N=R(34341),P=R(27894),M=R(77561),L=R(8815),U=R(9360),V=R(80933),$=R(40834),K=R(90750),W=R(80933),Q=R(9442),Y=R(68682),X="resolving_load_balancer";function Z(T){K.trace(W.LogVerbosity.DEBUG,X,T)}let ee=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function et(T,S,R,O){for(let N of R.name)switch(O){case"EMPTY":if(!N.service&&!N.method)return!0;break;case"SERVICE":if(N.service===T&&!N.method)return!0;break;case"SERVICE_AND_METHOD":if(N.service===T&&N.method===S)return!0}return!1}function er(T,S,R,O){for(let N of R)if(et(T,S,N,O))return N;return null}function en(T){return function(S,R){var O,N;let P=S.split("/").filter(T=>T.length>0),M=null!==(O=P[0])&&void 0!==O?O:"",L=null!==(N=P[1])&&void 0!==N?N:"";if(T&&T.methodConfig)for(let S of ee){let R=er(M,L,T.methodConfig,S);if(R)return{methodConfig:R,pickInformation:{},status:V.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:V.Status.OK,dynamicFilterFactories:[]}}}class ei{constructor(T,S,R,K,W){this.target=T,this.channelControlHelper=S,this.onSuccessfulResolution=K,this.onFailedResolution=W,this.latestChildState=P.ConnectivityState.IDLE,this.latestChildPicker=new L.QueuePicker(this),this.currentState=P.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,R["grpc.service_config"]?this.defaultServiceConfig=(0,N.validateServiceConfig)(JSON.parse(R["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(P.ConnectivityState.IDLE,new L.QueuePicker(this)),this.childLoadBalancer=new Y.ChildLoadBalancerHandler({createSubchannel:S.createSubchannel.bind(S),requestReresolution:()=>{this.backoffTimeout.isRunning()?(Z("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(T,S)=>{this.latestChildState=T,this.latestChildPicker=S,this.updateState(T,S)},addChannelzChild:S.addChannelzChild.bind(S),removeChannelzChild:S.removeChannelzChild.bind(S)}),this.innerResolver=(0,M.createResolver)(T,{onSuccessfulResolution:(T,S,R,N,P)=>{var M;this.backoffTimeout.stop(),this.backoffTimeout.reset();let L=null;null===S?null===R?(this.previousServiceConfig=null,L=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(R):L=this.previousServiceConfig:(L=S,this.previousServiceConfig=S);let U=null!==(M=null==L?void 0:L.loadBalancingConfig)&&void 0!==M?M:[],K=(0,O.getFirstUsableConfig)(U,!0);if(null===K){this.handleResolutionFailure({code:V.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new $.Metadata});return}this.childLoadBalancer.updateAddressList(T,K,P);let W=null!=L?L:this.defaultServiceConfig;this.onSuccessfulResolution(W,null!=N?N:en(W))},onError:T=>{this.handleResolutionFailure(T)}},R);let Q={initialDelay:R["grpc.initial_reconnect_backoff_ms"],maxDelay:R["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new U.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},Q),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===P.ConnectivityState.IDLE&&this.updateState(P.ConnectivityState.CONNECTING,new L.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(T,S){Z((0,Q.uriToString)(this.target)+" "+P.ConnectivityState[this.currentState]+" -> "+P.ConnectivityState[T]),T===P.ConnectivityState.IDLE&&(S=new L.QueuePicker(this)),this.currentState=T,this.channelControlHelper.updateState(T,S)}handleResolutionFailure(T){this.latestChildState===P.ConnectivityState.IDLE&&(this.updateState(P.ConnectivityState.TRANSIENT_FAILURE,new L.UnavailablePicker(T)),this.onFailedResolution(T))}exitIdle(){(this.currentState===P.ConnectivityState.IDLE||this.currentState===P.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(T,S){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=P.ConnectivityState.IDLE,this.latestChildPicker=new L.QueuePicker(this),this.currentState=P.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}S.ResolvingLoadBalancer=ei},75332:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.RetryingCall=S.MessageBufferTracker=S.RetryThrottler=void 0;let O=R(80933),N=R(40834),P=R(90750),M="retrying_call";class L{constructor(T,S,R){this.maxTokens=T,this.tokenRatio=S,R?this.tokens=R.tokens*(T/R.maxTokens):this.tokens=T}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}S.RetryThrottler=L;class U{constructor(T,S){this.totalLimit=T,this.limitPerCall=S,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(T,S){var R;let O=null!==(R=this.allocatedPerCall.get(S))&&void 0!==R?R:0;return!(this.limitPerCall-O<T)&&!(this.totalLimit-this.totalAllocated<T)&&(this.allocatedPerCall.set(S,O+T),this.totalAllocated+=T,!0)}free(T,S){var R;if(this.totalAllocated<T)throw Error(`Invalid buffer allocation state: call ${S} freed ${T} > total allocated ${this.totalAllocated}`);this.totalAllocated-=T;let O=null!==(R=this.allocatedPerCall.get(S))&&void 0!==R?R:0;if(O<T)throw Error(`Invalid buffer allocation state: call ${S} freed ${T} > allocated for call ${O}`);this.allocatedPerCall.set(S,O-T)}freeAll(T){var S;let R=null!==(S=this.allocatedPerCall.get(T))&&void 0!==S?S:0;if(this.totalAllocated<R)throw Error(`Invalid buffer allocation state: call ${T} allocated ${R} > total allocated ${this.totalAllocated}`);this.totalAllocated-=R,this.allocatedPerCall.delete(T)}}S.MessageBufferTracker=U;let V="grpc-previous-rpc-attempts";class ${constructor(T,S,R,O,N,P,M,L,U){if(this.channel=T,this.callConfig=S,this.methodName=R,this.host=O,this.credentials=N,this.deadline=P,this.callNumber=M,this.bufferTracker=L,this.retryThrottler=U,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,S.methodConfig.retryPolicy){this.state="RETRY";let T=S.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(T.initialBackoff.substring(0,T.initialBackoff.length-1))}else S.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(T){P.trace(O.LogVerbosity.DEBUG,M,"["+this.callNumber+"] "+T)}reportStatus(T){this.trace("ended with status: code="+T.code+' details="'+T.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var S;null===(S=this.listener)||void 0===S||S.onReceiveStatus({code:T.code,details:T.details,metadata:T.metadata})})}cancelWithStatus(T,S){for(let{call:R}of(this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),this.reportStatus({code:T,details:S,metadata:new N.Metadata}),this.underlyingCalls))R.cancelWithStatus(T,S)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(T){var S;return null!==(S=this.writeBuffer[T-this.writeBufferOffset])&&void 0!==S?S:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let T=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let S=this.writeBufferOffset;S<T;S++){let T=this.getBufferEntry(S);T.allocated&&this.bufferTracker.free(T.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(T-this.writeBufferOffset),this.writeBufferOffset=T}commitCall(T){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[T].state){this.trace("Committing call ["+this.underlyingCalls[T].call.getCallNumber()+"] at index "+T),this.state="COMMITTED",this.committedCallIndex=T;for(let S=0;S<this.underlyingCalls.length;S++)S!==T&&"COMPLETED"!==this.underlyingCalls[S].state&&(this.underlyingCalls[S].state="COMPLETED",this.underlyingCalls[S].call.cancelWithStatus(O.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let T=-1,S=-1;for(let[R,O]of this.underlyingCalls.entries())"ACTIVE"===O.state&&O.nextMessageToSend>T&&(T=O.nextMessageToSend,S=R);-1===S?this.state="TRANSPARENT_ONLY":this.commitCall(S)}isStatusCodeInList(T,S){return T.some(T=>T===S||T.toString().toLowerCase()===O.Status[S].toLowerCase())}getNextRetryBackoffMs(){var T;let S=null===(T=this.callConfig)||void 0===T?void 0:T.methodConfig.retryPolicy;if(!S)return 0;let R=Math.random()*this.nextRetryBackoffSec*1e3,O=Number(S.maxBackoff.substring(0,S.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*S.backoffMultiplier,O),R}maybeRetryCall(T,S){let R;if("RETRY"!==this.state){S(!1);return}let O=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(O.maxAttempts,5)){S(!1);return}if(null===T)R=this.getNextRetryBackoffMs();else if(T<0){this.state="TRANSPARENT_ONLY",S(!1);return}else R=T,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var T,R;if("RETRY"!==this.state){S(!1);return}(null===(R=null===(T=this.retryThrottler)||void 0===T?void 0:T.canRetryCall())||void 0===R||R)&&(S(!0),this.attempts+=1,this.startNewAttempt())},R)}countActiveCalls(){let T=0;for(let S of this.underlyingCalls)(null==S?void 0:S.state)==="ACTIVE"&&(T+=1);return T}handleProcessedStatus(T,S,R){var O,N,P;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(S),this.reportStatus(T);break;case"HEDGING":if(this.isStatusCodeInList(null!==(O=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)&&void 0!==O?O:[],T.code)){let O;if(null===(N=this.retryThrottler)||void 0===N||N.addCallFailed(),null===R)O=0;else if(R<0){this.state="TRANSPARENT_ONLY",this.commitCall(S),this.reportStatus(T);return}else O=R;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(S),this.reportStatus(T))},O)}else this.commitCall(S),this.reportStatus(T);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,T.code)?(null===(P=this.retryThrottler)||void 0===P||P.addCallFailed(),this.maybeRetryCall(R,R=>{R||(this.commitCall(S),this.reportStatus(T))})):(this.commitCall(S),this.reportStatus(T))}}getPushback(T){let S=T.get("grpc-retry-pushback-ms");if(0===S.length)return null;try{return parseInt(S[0])}catch(T){return -1}}handleChildStatus(T,S){var R;if("COMPLETED"===this.underlyingCalls[S].state)return;if(this.trace("state="+this.state+" handling status with progress "+T.progress+" from child ["+this.underlyingCalls[S].call.getCallNumber()+"] in state "+this.underlyingCalls[S].state),this.underlyingCalls[S].state="COMPLETED",T.code===O.Status.OK){null===(R=this.retryThrottler)||void 0===R||R.addCallSucceeded(),this.commitCall(S),this.reportStatus(T);return}if("COMMITTED"===this.state){this.reportStatus(T);return}let N=this.getPushback(T.metadata);switch(T.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(T,S,N):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(S),this.reportStatus(T);break;case"PROCESSED":this.handleProcessedStatus(T,S,N)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let T=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(T.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var T,S,R;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let O=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(O.maxAttempts,5))return;let N=null!==(T=O.hedgingDelay)&&void 0!==T?T:"0s",P=Number(N.substring(0,N.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*P),null===(R=(S=this.hedgingTimer).unref)||void 0===R||R.call(S)}startNewAttempt(){let T=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+T.getCallNumber()+"] for attempt "+this.attempts);let S=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:T,nextMessageToSend:0});let R=this.attempts-1,O=this.initialMetadata.clone();R>0&&O.set(V,`${R}`);let N=!1;T.start(O,{onReceiveMetadata:O=>{this.trace("Received metadata from child ["+T.getCallNumber()+"]"),this.commitCall(S),N=!0,R>0&&O.set(V,`${R}`),"ACTIVE"===this.underlyingCalls[S].state&&this.listener.onReceiveMetadata(O)},onReceiveMessage:R=>{this.trace("Received message from child ["+T.getCallNumber()+"]"),this.commitCall(S),"ACTIVE"===this.underlyingCalls[S].state&&this.listener.onReceiveMessage(R)},onReceiveStatus:O=>{this.trace("Received status from child ["+T.getCallNumber()+"]"),!N&&R>0&&O.metadata.set(V,`${R}`),this.handleChildStatus(O,S)}}),this.sendNextChildMessage(S),this.readStarted&&T.startRead()}start(T,S){this.trace("start called"),this.listener=S,this.initialMetadata=T,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(T){var S,R;let O=this.underlyingCalls[T],N=O.nextMessageToSend;null===(R=(S=this.getBufferEntry(N)).callback)||void 0===R||R.call(S),this.clearSentMessages(),O.nextMessageToSend+=1,this.sendNextChildMessage(T)}sendNextChildMessage(T){let S=this.underlyingCalls[T];if("COMPLETED"!==S.state&&this.getBufferEntry(S.nextMessageToSend)){let R=this.getBufferEntry(S.nextMessageToSend);switch(R.entryType){case"MESSAGE":S.call.sendMessageWithContext({callback:S=>{this.handleChildWriteCompleted(T)}},R.message.message);break;case"HALF_CLOSE":S.nextMessageToSend+=1,S.call.halfClose()}}}sendMessageWithContext(T,S){var R;this.trace("write() called with message of length "+S.length);let O={message:S,flags:T.flags},N=this.getNextBufferIndex(),P={entryType:"MESSAGE",message:O,allocated:this.bufferTracker.allocate(S.length,this.callNumber)};if(this.writeBuffer.push(P),P.allocated)for(let[O,P]of(null===(R=T.callback)||void 0===R||R.call(T),this.underlyingCalls.entries()))"ACTIVE"===P.state&&P.nextMessageToSend===N&&P.call.sendMessageWithContext({callback:T=>{this.handleChildWriteCompleted(O)}},S);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let R=this.underlyingCalls[this.committedCallIndex];P.callback=T.callback,"ACTIVE"===R.state&&R.nextMessageToSend===N&&R.call.sendMessageWithContext({callback:T=>{this.handleChildWriteCompleted(this.committedCallIndex)}},S)}}startRead(){for(let T of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==T?void 0:T.state)==="ACTIVE"&&T.call.startRead()}halfClose(){this.trace("halfClose called");let T=this.getNextBufferIndex();for(let S of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==S?void 0:S.state)==="ACTIVE"&&S.nextMessageToSend===T&&(S.nextMessageToSend+=1,S.call.halfClose())}setCredentials(T){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}S.RetryingCall=$},41246:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2ServerCallStream=S.ServerDuplexStreamImpl=S.ServerWritableStreamImpl=S.ServerReadableStreamImpl=S.ServerUnaryCallImpl=void 0;let O=R(82361),N=R(85158),P=R(12781),M=R(59796),L=R(80933),U=R(40834),V=R(24729),$=R(90750),K=R(676),W="server_call";function Q(T){$.trace(L.LogVerbosity.DEBUG,W,T)}let Y="grpc-message",X="grpc-status",Z="grpc-timeout",ee=/(\d{1,8})\s*([HMSmun])/,et={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},er={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},en={[N.constants.HTTP2_HEADER_STATUS]:N.constants.HTTP_STATUS_OK,[N.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},ei={waitForTrailers:!0};class es extends O.EventEmitter{constructor(T,S,R){super(),this.call=T,this.metadata=S,this.request=R,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}S.ServerUnaryCallImpl=es;class ea extends P.Readable{constructor(T,S,R,O){super({objectMode:!0}),this.call=T,this.metadata=S,this.deserialize=R,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,O)}_read(T){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}S.ServerReadableStreamImpl=ea;class eo extends P.Writable{constructor(T,S,R,O){super({objectMode:!0}),this.call=T,this.metadata=S,this.serialize=R,this.request=O,this.cancelled=!1,this.trailingMetadata=new U.Metadata,this.call.setupSurfaceCall(this),this.on("error",T=>{this.call.sendError(T),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(T,S,R){try{let S=this.call.serializeMessage(T);if(!this.call.write(S)){this.call.once("drain",R);return}}catch(T){this.emit("error",{details:(0,K.getErrorMessage)(T),code:L.Status.INTERNAL})}R()}_final(T){this.call.sendStatus({code:L.Status.OK,details:"OK",metadata:this.trailingMetadata}),T(null)}end(T){return T&&(this.trailingMetadata=T),super.end()}}S.ServerWritableStreamImpl=eo;class eu extends P.Duplex{constructor(T,S,R,O,N){super({objectMode:!0}),this.call=T,this.metadata=S,this.serialize=R,this.deserialize=O,this.cancelled=!1,this.trailingMetadata=new U.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,N),this.on("error",T=>{this.call.sendError(T),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(T){this.call.sendMetadata(T)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(T){return T&&(this.trailingMetadata=T),super.end()}}S.ServerDuplexStreamImpl=eu,eu.prototype._read=ea.prototype._read,eu.prototype._write=eo.prototype._write,eu.prototype._final=eo.prototype._final;class ec extends O.EventEmitter{constructor(T,S,R){super(),this.stream=T,this.handler=S,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=L.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=L.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",T=>{}),this.stream.once("close",()=>{var T;Q("Request to method "+(null===(T=this.handler)||void 0===T?void 0:T.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:L.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in R&&(this.maxSendMessageSize=R["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in R&&(this.maxReceiveMessageSize=R["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(T,S){let R=T.subarray(5);if("identity"===S)return R;if("deflate"!==S&&"gzip"!==S)return Promise.reject({code:L.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${S}"`});{let T;return T="deflate"===S?M.createInflate():M.createGunzip(),new Promise((S,O)=>{let N=0,P=[];T.on("data",S=>{P.push(S),N+=S.byteLength,-1!==this.maxReceiveMessageSize&&N>this.maxReceiveMessageSize&&(T.destroy(),O({code:L.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),T.on("end",()=>{S(Buffer.concat(P))}),T.write(R),T.end()})}}sendMetadata(T){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let S=T?T.toHttp2Headers():null,R=Object.assign(Object.assign(Object.assign({},en),er),S);this.stream.respond(R,ei)}receiveMetadata(T){let S=U.Metadata.fromHttp2Headers(T);$.isTracerEnabled(W)&&Q("Request to "+this.handler.path+" received headers "+JSON.stringify(S.toJSON()));let R=S.get(Z);if(R.length>0){let T=R[0].toString().match(ee);if(null===T){let T=Error("Invalid deadline");return T.code=L.Status.OUT_OF_RANGE,this.sendError(T),S}let O=+T[1]*et[T[2]]|0,N=new Date;this.deadline=N.setMilliseconds(N.getMilliseconds()+O),this.deadlineTimer=setTimeout(ed,O,this),S.remove(Z)}return S.remove(N.constants.HTTP2_HEADER_ACCEPT_ENCODING),S.remove(N.constants.HTTP2_HEADER_TE),S.remove(N.constants.HTTP2_HEADER_CONTENT_TYPE),S.remove("grpc-accept-encoding"),S}receiveUnaryMessage(T){return new Promise((S,R)=>{let{stream:O}=this,N=0,P=this,M=[],U=this.maxReceiveMessageSize;function V(T){if(N+=T.byteLength,-1!==U&&N>U){O.removeListener("data",V),O.removeListener("end",$),O.removeListener("error",$),R({code:L.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${N} vs. ${U})`});return}M.push(T)}function $(U){if(O.removeListener("data",V),O.removeListener("end",$),O.removeListener("error",$),void 0!==U){R({code:L.Status.INTERNAL,details:U.message});return}if(0===N){R({code:L.Status.INTERNAL,details:"received empty unary message"});return}P.emit("receiveMessage");let K=Buffer.concat(M,N),W=1===K.readUInt8(0)?T:"identity",Q=P.getDecompressedMessage(K,W);if(Buffer.isBuffer(Q)){S(P.deserializeMessageWithInternalError(Q));return}Q.then(T=>S(P.deserializeMessageWithInternalError(T)),S=>R(S.code?S:{code:L.Status.INTERNAL,details:`Received "grpc-encoding" header "${T}" but ${T} decompression failed`}))}this.stream.on("data",V),this.stream.on("end",$),this.stream.on("error",$)})}async deserializeMessageWithInternalError(T){try{return this.deserializeMessage(T)}catch(T){throw{details:(0,K.getErrorMessage)(T),code:L.Status.INTERNAL}}}serializeMessage(T){let S=this.handler.serialize(T),R=S.byteLength,O=Buffer.allocUnsafe(R+5);return O.writeUInt8(0,0),O.writeUInt32BE(R,1),S.copy(O,5),O}deserializeMessage(T){return this.handler.deserialize(T)}async sendUnaryMessage(T,S,R,O){if(!this.checkCancelled()){if(void 0===R&&(R=null),T){!Object.prototype.hasOwnProperty.call(T,"metadata")&&R&&(T.metadata=R),this.sendError(T);return}try{let T=this.serializeMessage(S);this.write(T),this.sendStatus({code:L.Status.OK,details:"OK",metadata:R})}catch(T){this.sendError({details:(0,K.getErrorMessage)(T),code:L.Status.INTERNAL})}}}sendStatus(T){var S,R;if(this.emit("callEnd",T.code),this.emit("streamEnd",T.code===L.Status.OK),!this.checkCancelled()){if(Q("Request to method "+(null===(S=this.handler)||void 0===S?void 0:S.path)+" ended with status code: "+L.Status[T.code]+" details: "+T.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var S;let R=Object.assign({[X]:T.code,[Y]:encodeURI(T.details)},null===(S=T.metadata)||void 0===S?void 0:S.toHttp2Headers());this.stream.sendTrailers(R),this.statusSent=!0}),this.stream.end());else{let S=Object.assign(Object.assign({[X]:T.code,[Y]:encodeURI(T.details)},en),null===(R=T.metadata)||void 0===R?void 0:R.toHttp2Headers());this.stream.respond(S,{endStream:!0}),this.statusSent=!0}}}sendError(T){let S={code:L.Status.UNKNOWN,details:"message"in T?T.message:"Unknown Error",metadata:"metadata"in T&&void 0!==T.metadata?T.metadata:null};"code"in T&&"number"==typeof T.code&&Number.isInteger(T.code)&&(S.code=T.code,"details"in T&&"string"==typeof T.details&&(S.details=T.details)),this.sendStatus(S)}write(T){if(!this.checkCancelled()){if(-1!==this.maxSendMessageSize&&T.length>this.maxSendMessageSize){this.sendError({code:L.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${T.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(T)}}resume(){this.stream.resume()}setupSurfaceCall(T){this.once("cancelled",S=>{T.cancelled=!0,T.emit("cancelled",S)}),this.once("callEnd",S=>T.emit("callEnd",S))}setupReadable(T,S){let R=new V.StreamDecoder(this.maxReceiveMessageSize),O=!1,N=!1,P=!1,M=async()=>{P||!O||N||(P=!0,await this.pushOrBufferMessage(T,null))};this.stream.on("data",async O=>{let P;try{P=R.write(O)}catch(T){this.sendError({code:L.Status.RESOURCE_EXHAUSTED,details:T.message});return}for(let R of(N=!0,this.stream.pause(),P)){let O;this.emit("receiveMessage");let N=1===R.readUInt8(0)?S:"identity";try{O=await this.getDecompressedMessage(R,N)}catch(T){this.sendError(T);return}if(!O)return;await this.pushOrBufferMessage(T,O)}N=!1,this.stream.resume(),await M()}),this.stream.once("end",async()=>{O=!0,await M()})}consumeUnpushedMessages(T){for(this.canPush=!0;this.messagesToPush.length>0;){let S=this.messagesToPush.shift(),R=T.push(S);if(null===S||!1===R){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(T,S){this.isPushPending?this.bufferedMessages.push(S):await this.pushMessage(T,S)}async pushMessage(T,S){if(null===S){Q("Received end of stream"),this.canPush?T.push(null):this.messagesToPush.push(null);return}Q("Received message of length "+S.length),this.isPushPending=!0;try{let R=await this.deserializeMessage(S);this.canPush?T.push(R)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(R)}catch(R){this.bufferedMessages.length=0;let S=(0,K.getErrorCode)(R);(null===S||S<L.Status.OK||S>L.Status.UNAUTHENTICATED)&&(S=L.Status.INTERNAL),T.emit("error",{details:(0,K.getErrorMessage)(R),code:S})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(T,this.bufferedMessages.shift())}getPeer(){var T;let S=null===(T=this.stream.session)||void 0===T?void 0:T.socket;return null!=S&&S.remoteAddress?S.remotePort?`${S.remoteAddress}:${S.remotePort}`:S.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function ed(T){let S=Error("Deadline exceeded");S.code=L.Status.DEADLINE_EXCEEDED,T.sendError(S),T.cancelled=!0,T.emit("cancelled","deadline")}S.Http2ServerCallStream=ec},31775:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.ServerCredentials=void 0;let O=R(60459);class N{static createInsecure(){return new P}static createSsl(T,S,R=!1){if(null!==T&&!Buffer.isBuffer(T))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(S))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof R)throw TypeError("checkClientCertificate must be a boolean");let N=[],P=[];for(let T=0;T<S.length;T++){let R=S[T];if(null===R||"object"!=typeof R)throw TypeError(`keyCertPair[${T}] must be an object`);if(!Buffer.isBuffer(R.private_key))throw TypeError(`keyCertPair[${T}].private_key must be a Buffer`);if(!Buffer.isBuffer(R.cert_chain))throw TypeError(`keyCertPair[${T}].cert_chain must be a Buffer`);N.push(R.cert_chain),P.push(R.private_key)}return new M({ca:T||(0,O.getDefaultRootsData)()||void 0,cert:N,key:P,requestCert:R,ciphers:O.CIPHER_SUITES})}}S.ServerCredentials=N;class P extends N{_isSecure(){return!1}_getSettings(){return null}}class M extends N{constructor(T){super(),this.options=T}_isSecure(){return!0}_getSettings(){return this.options}}},92826:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Server=void 0;let O=R(85158),N=R(80933),P=R(41246),M=R(31775),L=R(77561),U=R(90750),V=R(39247),$=R(9442),K=R(2445),W=2147483647,Q=2147483647,Y=2e4,{HTTP2_HEADER_PATH:X}=O.constants,Z="server";function ee(){}function et(T){return{code:N.Status.UNIMPLEMENTED,details:`The server does not implement the method ${T}`}}function er(T,S){let R=et(S);switch(T){case"unary":return(T,S)=>{S(R,null)};case"clientStream":return(T,S)=>{S(R,null)};case"serverStream":return T=>{T.emit("error",R)};case"bidi":return T=>{T.emit("error",R)};default:throw Error(`Invalid handlerType ${T}`)}}class en{constructor(T){var S,R,O,N;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new K.ChannelzTrace,this.callTracker=new K.ChannelzCallTracker,this.listenerChildrenTracker=new K.ChannelzChildrenTracker,this.sessionChildrenTracker=new K.ChannelzChildrenTracker,this.options=null!=T?T:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,K.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!==(S=this.options["grpc.max_connection_age_ms"])&&void 0!==S?S:W,this.maxConnectionAgeGraceMs=null!==(R=this.options["grpc.max_connection_age_grace_ms"])&&void 0!==R?R:W,this.keepaliveTimeMs=null!==(O=this.options["grpc.keepalive_time_ms"])&&void 0!==O?O:Q,this.keepaliveTimeoutMs=null!==(N=this.options["grpc.keepalive_timeout_ms"])&&void 0!==N?N:Y,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(T){return()=>{var S,R,O;let N;let P=this.sessions.get(T),M=T.socket,L=M.remoteAddress?(0,V.stringToSubchannelAddress)(M.remoteAddress,M.remotePort):null,U=M.localAddress?(0,V.stringToSubchannelAddress)(M.localAddress,M.localPort):null;if(T.encrypted){let T=M,R=T.getCipher(),O=T.getCertificate(),P=T.getPeerCertificate();N={cipherSuiteStandardName:null!==(S=R.standardName)&&void 0!==S?S:null,cipherSuiteOtherName:R.standardName?null:R.name,localCertificate:O&&"raw"in O?O.raw:null,remoteCertificate:P&&"raw"in P?P.raw:null}}else N=null;return{remoteAddress:L,localAddress:U,security:N,remoteName:null,streamsStarted:P.streamTracker.callsStarted,streamsSucceeded:P.streamTracker.callsSucceeded,streamsFailed:P.streamTracker.callsFailed,messagesSent:P.messagesSent,messagesReceived:P.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:P.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:P.lastMessageSentTimestamp,lastMessageReceivedTimestamp:P.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(R=T.state.localWindowSize)&&void 0!==R?R:null,remoteFlowControlWindow:null!==(O=T.state.remoteWindowSize)&&void 0!==O?O:null}}}trace(T){U.trace(N.LogVerbosity.DEBUG,Z,"("+this.channelzRef.id+") "+T)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(T,S){if(null===T||"object"!=typeof T||null===S||"object"!=typeof S)throw Error("addService() requires two objects as arguments");let R=Object.keys(T);if(0===R.length)throw Error("Cannot add an empty service to a server");R.forEach(R=>{let O,N;let P=T[R];O=P.requestStream?P.responseStream?"bidi":"clientStream":P.responseStream?"serverStream":"unary";let M=S[R];if(void 0===M&&"string"==typeof P.originalName&&(M=S[P.originalName]),N=void 0!==M?M.bind(S):er(O,R),!1===this.register(P.path,N,P.responseSerialize,P.requestDeserialize,O))throw Error(`Method handler for ${P.path} already provided.`)})}removeService(T){if(null===T||"object"!=typeof T)throw Error("removeService() requires object as argument");Object.keys(T).forEach(S=>{let R=T[S];this.unregister(R.path)})}bind(T,S){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(T,S,R){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof T)throw TypeError("port must be a string");if(null===S||!(S instanceof M.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof R)throw TypeError("callback must be a function");let P=(0,$.parseUri)(T);if(null===P)throw Error(`Could not parse port "${T}"`);let W=(0,L.mapUriDefaultScheme)(P);if(null===W)throw Error(`Could not get a default scheme for port "${T}"`);let Q={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?Q.maxSessionMemory=this.options["grpc-node.max_session_memory"]:Q.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(Q.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let Y=(T,S)=>{process.nextTick(()=>R(T,S))},X=()=>{let T;if(S._isSecure()){let R=Object.assign(Q,S._getSettings());R.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(T=O.createSecureServer(R)).on("secureConnection",T=>{T.on("error",T=>{this.trace("An incoming TLS connection closed with error: "+T.message)})})}else T=O.createServer(Q);return T.setTimeout(0,ee),this._setupHandlers(T),T},Z=(T,S,R)=>0===T.length?Promise.resolve({port:S,count:R}):Promise.all(T.map(T=>{let R;this.trace("Attempting to bind "+(0,V.subchannelAddressToString)(T)),R=(0,V.isTcpSubchannelAddress)(T)?{host:T.host,port:S}:T;let O=X();return new Promise((N,P)=>{let M=S=>{this.trace("Failed to bind "+(0,V.subchannelAddressToString)(T)+" with error "+S.message),N(S)};O.once("error",M),O.listen(R,()=>{let T;if(this.shutdown){O.close(),N(Error("bindAsync failed because server is shutdown"));return}let R=O.address();T="string"==typeof R?{path:R}:{host:R.address,port:R.port};let P=(0,K.registerChannelzSocket)((0,V.subchannelAddressToString)(T),()=>({localAddress:T,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(P),this.http2ServerList.push({server:O,channelzRef:P}),this.trace("Successfully bound "+(0,V.subchannelAddressToString)(T)),N("port"in T?T.port:S),O.removeListener("error",M)})})})).then(T=>{let O=0;for(let R of T)if("number"==typeof R&&(O+=1,R!==S))throw Error("Invalid state: multiple port numbers added from single address");return{port:S,count:O+R}}),et=T=>{if(0===T.length)return Promise.resolve({port:0,count:0});let S=T[0],R=X();return new Promise((O,N)=>{let P=R=>{this.trace("Failed to bind "+(0,V.subchannelAddressToString)(S)+" with error "+R.message),O(et(T.slice(1)))};R.once("error",P),R.listen(S,()=>{if(this.shutdown){R.close(),O({port:0,count:0});return}let S=R.address(),N={host:S.address,port:S.port},M=(0,K.registerChannelzSocket)((0,V.subchannelAddressToString)(N),()=>({localAddress:N,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(M),this.http2ServerList.push({server:R,channelzRef:M}),this.trace("Successfully bound "+(0,V.subchannelAddressToString)(N)),O(Z(T.slice(1),S.port,1)),R.removeListener("error",P)})})},er={onSuccessfulResolution:(S,R,O)=>{let P;if(er.onSuccessfulResolution=()=>{},this.shutdown&&Y(Error("bindAsync failed because server is shutdown"),0),0===S.length){Y(Error(`No addresses resolved for port ${T}`),0);return}(P=(0,V.isTcpSubchannelAddress)(S[0])?0===S[0].port?et(S):Z(S,S[0].port,0):Z(S,1,0)).then(T=>{if(0===T.count){let T=`No address added out of total ${S.length} resolved`;U.log(N.LogVerbosity.ERROR,T),Y(Error(T),0)}else T.count<S.length&&U.log(N.LogVerbosity.INFO,`WARNING Only ${T.count} addresses added out of total ${S.length} resolved`),Y(null,T.port)},T=>{let R=`No address added out of total ${S.length} resolved`;U.log(N.LogVerbosity.ERROR,R),Y(Error(R),0)})},onError:T=>{Y(Error(T.details),0)}};(0,L.createResolver)(W,er,this.options).updateResolution()}forceShutdown(){for(let{server:T,channelzRef:S}of this.http2ServerList)T.listening&&T.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(S),(0,K.unregisterChannelzRef)(S))});this.started=!1,this.shutdown=!0,this.sessions.forEach((T,S)=>{S.destroy(O.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,K.unregisterChannelzRef)(this.channelzRef)}register(T,S,R,O,N){return!this.handlers.has(T)&&(this.handlers.set(T,{func:S,serialize:R,deserialize:O,type:N,path:T}),!0)}unregister(T){return this.handlers.delete(T)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:T})=>!0!==T.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(T){let S=S=>{this.channelzEnabled&&(0,K.unregisterChannelzRef)(this.channelzRef),T(S)},R=0;function O(){0==--R&&S()}for(let{server:T,channelzRef:S}of(this.started=!1,this.shutdown=!0,this.http2ServerList))T.listening&&(R++,T.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(S),(0,K.unregisterChannelzRef)(S)),O()}));this.sessions.forEach((T,S)=>{S.closed||(R+=1,S.close(O))}),0===R&&S()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(T,S){let R=S[O.constants.HTTP2_HEADER_CONTENT_TYPE];return!!("string"==typeof R&&R.startsWith("application/grpc"))||(T.respond({[O.constants.HTTP2_HEADER_STATUS]:O.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(T){this.trace("Received call to method "+T+" at address "+this.serverAddressString);let S=this.handlers.get(T);return void 0===S?(this.trace("No handler registered for method "+T+". Sending UNIMPLEMENTED status."),null):S}_respondWithError(T,S,R=null){let O=new P.Http2ServerCallStream(S,null,this.options);void 0===T.code&&(T.code=N.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==R||R.streamTracker.addCallFailed()),O.sendError(T)}_channelzHandler(T,S){let R=this.sessions.get(T.session);if(this.callTracker.addCallStarted(),null==R||R.streamTracker.addCallStarted(),!this._verifyContentType(T,S)){this.callTracker.addCallFailed(),null==R||R.streamTracker.addCallFailed();return}let O=S[X],M=this._retrieveHandler(O);if(!M){this._respondWithError(et(O),T,R);return}let L=new P.Http2ServerCallStream(T,M,this.options);L.once("callEnd",T=>{T===N.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),R&&(L.once("streamEnd",T=>{T?R.streamTracker.addCallSucceeded():R.streamTracker.addCallFailed()}),L.on("sendMessage",()=>{R.messagesSent+=1,R.lastMessageSentTimestamp=new Date}),L.on("receiveMessage",()=>{R.messagesReceived+=1,R.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(L,M,S)||(this.callTracker.addCallFailed(),null==R||R.streamTracker.addCallFailed(),L.sendError({code:N.Status.INTERNAL,details:`Unknown handler type: ${M.type}`}))}_streamHandler(T,S){if(!0!==this._verifyContentType(T,S))return;let R=S[X],O=this._retrieveHandler(R);if(!O){this._respondWithError(et(R),T,null);return}let M=new P.Http2ServerCallStream(T,O,this.options);this._runHandlerForCall(M,O,S)||M.sendError({code:N.Status.INTERNAL,details:`Unknown handler type: ${O.type}`})}_runHandlerForCall(T,S,R){var O;let N=T.receiveMetadata(R),P=null!==(O=N.get("grpc-encoding")[0])&&void 0!==O?O:"identity";N.remove("grpc-encoding");let{type:M}=S;if("unary"===M)ei(T,S,N,P);else if("clientStream"===M)es(T,S,N,P);else if("serverStream"===M)ea(T,S,N,P);else{if("bidi"!==M)return!1;eo(T,S,N,P)}return!0}_setupHandlers(T){if(null===T)return;let S=T.address(),R="null";S&&(R="string"==typeof S?S:S.address+":"+S.port),this.serverAddressString=R;let N=this.channelzEnabled?this._channelzHandler:this._streamHandler;T.on("stream",N.bind(this)),T.on("session",T=>{var S,R,N,P,M;if(!this.started){T.destroy();return}let L=(0,K.registerChannelzSocket)(null!==(S=T.socket.remoteAddress)&&void 0!==S?S:"unknown",this.getChannelzSessionInfoGetter(T),this.channelzEnabled),U={ref:L,streamTracker:new K.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(T,U);let V=T.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+V),this.sessionChildrenTracker.refChild(L));let $=null,Q=null,Y=!1;if(this.maxConnectionAgeMs!==W){let S=this.maxConnectionAgeMs/10,P=Math.random()*S*2-S;$=null===(N=(R=setTimeout(()=>{var S,R;Y=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+V);try{T.goaway(O.constants.NGHTTP2_NO_ERROR,2147483647,Buffer.from("max_age"))}catch(S){T.destroy();return}T.close(),this.maxConnectionAgeGraceMs!==W&&(Q=null===(R=(S=setTimeout(()=>{T.destroy()},this.maxConnectionAgeGraceMs)).unref)||void 0===R?void 0:R.call(S))},this.maxConnectionAgeMs+P)).unref)||void 0===N?void 0:N.call(R)}let X=null===(M=(P=setInterval(()=>{var S,R;let O=null===(R=(S=setTimeout(()=>{Y=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+V),T.close()},this.keepaliveTimeoutMs)).unref)||void 0===R?void 0:R.call(S);try{T.ping((T,S,R)=>{clearTimeout(O)})}catch(S){T.destroy()}},this.keepaliveTimeMs)).unref)||void 0===M?void 0:M.call(P);T.on("close",()=>{this.channelzEnabled&&(Y||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+V),this.sessionChildrenTracker.unrefChild(L),(0,K.unregisterChannelzRef)(L)),$&&clearTimeout($),Q&&clearTimeout(Q),X&&clearTimeout(X),this.sessions.delete(T)})})}}async function ei(T,S,R,O){try{let N=await T.receiveUnaryMessage(O);if(void 0===N||T.cancelled)return;let M=new P.ServerUnaryCallImpl(T,R,N);S.func(M,(S,R,O,N)=>{T.sendUnaryMessage(S,R,O,N)})}catch(S){T.sendError(S)}}function es(T,S,R,O){let N=new P.ServerReadableStreamImpl(T,R,S.deserialize,O);function M(S,R,O,P){N.destroy(),T.sendUnaryMessage(S,R,O,P)}T.cancelled||(N.on("error",M),S.func(N,M))}async function ea(T,S,R,O){try{let N=await T.receiveUnaryMessage(O);if(void 0===N||T.cancelled)return;let M=new P.ServerWritableStreamImpl(T,R,S.serialize,N);S.func(M)}catch(S){T.sendError(S)}}function eo(T,S,R,O){let N=new P.ServerDuplexStreamImpl(T,R,S.serialize,S.deserialize,O);T.cancelled||S.func(N)}S.Server=en},34341:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.extractAndSelectServiceConfig=S.validateServiceConfig=S.validateRetryThrottling=void 0;let O=R(22037),N=R(80933),P=R(75922),M=/^\d+(\.\d{1,9})?s$/,L="node";function U(T){if("service"in T&&""!==T.service){if("string"!=typeof T.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof T.service}`);if(!("method"in T)||""===T.method)return{service:T.service};if("string"!=typeof T.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof T.service}`);return{service:T.service,method:T.method}}if("method"in T&&void 0!==T.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function V(T){if(!("maxAttempts"in T)||!Number.isInteger(T.maxAttempts)||T.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in T)||"string"!=typeof T.initialBackoff||!M.test(T.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in T)||"string"!=typeof T.maxBackoff||!M.test(T.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in T)||"number"!=typeof T.backoffMultiplier||T.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in T&&Array.isArray(T.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===T.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let S of T.retryableStatusCodes)if("number"==typeof S){if(!Object.values(N.Status).includes(S))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof S){if(!Object.values(N.Status).includes(S.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:T.maxAttempts,initialBackoff:T.initialBackoff,maxBackoff:T.maxBackoff,backoffMultiplier:T.backoffMultiplier,retryableStatusCodes:T.retryableStatusCodes}}function $(T){if(!("maxAttempts"in T)||!Number.isInteger(T.maxAttempts)||T.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in T&&("string"!=typeof T.hedgingDelay||!M.test(T.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in T&&Array.isArray(T.nonFatalStatusCodes))for(let S of T.nonFatalStatusCodes)if("number"==typeof S){if(!Object.values(N.Status).includes(S))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof S){if(!Object.values(N.Status).includes(S.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let S={maxAttempts:T.maxAttempts};return T.hedgingDelay&&(S.hedgingDelay=T.hedgingDelay),T.nonFatalStatusCodes&&(S.nonFatalStatusCodes=T.nonFatalStatusCodes),S}function K(T){var S;let R={name:[]};if(!("name"in T)||!Array.isArray(T.name))throw Error("Invalid method config: invalid name array");for(let S of T.name)R.name.push(U(S));if("waitForReady"in T){if("boolean"!=typeof T.waitForReady)throw Error("Invalid method config: invalid waitForReady");R.waitForReady=T.waitForReady}if("timeout"in T){if("object"==typeof T.timeout){if(!("seconds"in T.timeout)||"number"!=typeof T.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in T.timeout)||"number"!=typeof T.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");R.timeout=T.timeout}else if("string"==typeof T.timeout&&M.test(T.timeout)){let O=T.timeout.substring(0,T.timeout.length-1).split(".");R.timeout={seconds:0|O[0],nanos:(null!==(S=O[1])&&void 0!==S?S:0)|0}}else throw Error("Invalid method config: invalid timeout")}if("maxRequestBytes"in T){if("number"!=typeof T.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");R.maxRequestBytes=T.maxRequestBytes}if("maxResponseBytes"in T){if("number"!=typeof T.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");R.maxResponseBytes=T.maxResponseBytes}if("retryPolicy"in T){if("hedgingPolicy"in T)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");R.retryPolicy=V(T.retryPolicy)}else"hedgingPolicy"in T&&(R.hedgingPolicy=$(T.hedgingPolicy));return R}function W(T){if(!("maxTokens"in T)||"number"!=typeof T.maxTokens||T.maxTokens<=0||T.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in T)||"number"!=typeof T.tokenRatio||T.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+T.maxTokens.toFixed(3),tokenRatio:+T.tokenRatio.toFixed(3)}}function Q(T){let S={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in T){if("string"==typeof T.loadBalancingPolicy)S.loadBalancingPolicy=T.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy")}if("loadBalancingConfig"in T){if(Array.isArray(T.loadBalancingConfig))for(let R of T.loadBalancingConfig)S.loadBalancingConfig.push((0,P.validateLoadBalancingConfig)(R));else throw Error("Invalid service config: invalid loadBalancingConfig")}if("methodConfig"in T&&Array.isArray(T.methodConfig))for(let R of T.methodConfig)S.methodConfig.push(K(R));"retryThrottling"in T&&(S.retryThrottling=W(T.retryThrottling));let R=[];for(let T of S.methodConfig)for(let S of T.name){for(let T of R)if(S.service===T.service&&S.method===T.method)throw Error(`Invalid service config: duplicate name ${S.service}/${S.method}`);R.push(S)}return S}function Y(T){if(!("serviceConfig"in T))throw Error("Invalid service config choice: missing service config");let S={serviceConfig:Q(T.serviceConfig)};if("clientLanguage"in T){if(Array.isArray(T.clientLanguage))for(let R of(S.clientLanguage=[],T.clientLanguage))if("string"==typeof R)S.clientLanguage.push(R);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage")}if("clientHostname"in T){if(Array.isArray(T.clientHostname))for(let R of(S.clientHostname=[],T.clientHostname))if("string"==typeof R)S.clientHostname.push(R);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname")}if("percentage"in T){if("number"==typeof T.percentage&&0<=T.percentage&&T.percentage<=100)S.percentage=T.percentage;else throw Error("Invalid service config choice: invalid percentage")}let R=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let S in T)if(!R.includes(S))throw Error(`Invalid service config choice: unexpected field ${S}`);return S}function X(T,S){if(!Array.isArray(T))throw Error("Invalid service config list");for(let R of T){let T=Y(R);if("number"!=typeof T.percentage||!(S>T.percentage)){if(Array.isArray(T.clientHostname)){let S=!1;for(let R of T.clientHostname)R===O.hostname()&&(S=!0);if(!S)continue}if(Array.isArray(T.clientLanguage)){let S=!1;for(let R of T.clientLanguage)R===L&&(S=!0);if(!S)continue}return T.serviceConfig}}throw Error("No matching service config found")}function Z(T,S){for(let R of T)if(R.length>0&&R[0].startsWith("grpc_config="))return X(JSON.parse(R.join("").substring(12)),S);return null}S.validateRetryThrottling=W,S.validateServiceConfig=Q,S.extractAndSelectServiceConfig=Z},52243:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.StatusBuilder=void 0;class R{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(T){return this.code=T,this}withDetails(T){return this.details=T,this}withMetadata(T){return this.metadata=T,this}build(){let T={};return null!==this.code&&(T.code=this.code),null!==this.details&&(T.details=this.details),null!==this.metadata&&(T.metadata=this.metadata),T}}S.StatusBuilder=R},24729:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),S.StreamDecoder=void 0,function(T){T[T.NO_DATA=0]="NO_DATA",T[T.READING_SIZE=1]="READING_SIZE",T[T.READING_MESSAGE=2]="READING_MESSAGE"}(R||(R={}));class O{constructor(T){this.maxReadMessageLength=T,this.readState=R.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(T){let S,O=0,N=[];for(;O<T.length;)switch(this.readState){case R.NO_DATA:this.readCompressFlag=T.slice(O,O+1),O+=1,this.readState=R.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case R.READING_SIZE:if(S=Math.min(T.length-O,this.readSizeRemaining),T.copy(this.readPartialSize,4-this.readSizeRemaining,O,O+S),this.readSizeRemaining-=S,O+=S,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=R.READING_MESSAGE;else{let T=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=R.NO_DATA,N.push(T)}}break;case R.READING_MESSAGE:if(S=Math.min(T.length-O,this.readMessageRemaining),this.readPartialMessage.push(T.slice(O,O+S)),this.readMessageRemaining-=S,O+=S,0===this.readMessageRemaining){let T=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),S=Buffer.concat(T,this.readMessageSize+5);this.readState=R.NO_DATA,N.push(S)}break;default:throw Error("Unexpected read state")}return N}}S.StreamDecoder=O},39247:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.stringToSubchannelAddress=S.subchannelAddressToString=S.subchannelAddressEqual=S.isTcpSubchannelAddress=void 0;let O=R(41808);function N(T){return"port"in T}function P(T,S){return!T&&!S||!!T&&!!S&&(N(T)?N(S)&&T.host===S.host&&T.port===S.port:!N(S)&&T.path===S.path)}function M(T){return N(T)?T.host+":"+T.port:T.path}S.isTcpSubchannelAddress=N,S.subchannelAddressEqual=P,S.subchannelAddressToString=M;let L=443;function U(T,S){return(0,O.isIP)(T)?{host:T,port:null!=S?S:L}:{path:T}}S.stringToSubchannelAddress=U},89289:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2SubchannelCall=void 0;let O=R(85158),N=R(22037),P=R(80933),M=R(40834),L=R(24729),U=R(90750),V=R(80933),$="subchannel_call";function K(T){for(let[S,R]of Object.entries(N.constants.errno))if(R===T)return S;return"Unknown system error "+T}class W{constructor(T,S,R,N,U){var V;this.http2Stream=T,this.callEventTracker=S,this.listener=R,this.transport=N,this.callId=U,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=P.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let $=null!==(V=N.getOptions()["grpc.max_receive_message_length"])&&void 0!==V?V:P.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new L.StreamDecoder($),T.on("response",(T,S)=>{let R="";for(let S of Object.keys(T))R+="		"+S+": "+T[S]+"\n";switch(this.trace("Received server headers:\n"+R),T[":status"]){case 400:this.mappedStatusCode=P.Status.INTERNAL;break;case 401:this.mappedStatusCode=P.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=P.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=P.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=P.Status.UNAVAILABLE;break;default:this.mappedStatusCode=P.Status.UNKNOWN}if(S&O.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(T);else{let S;try{S=M.Metadata.fromHttp2Headers(T)}catch(T){this.endCall({code:P.Status.UNKNOWN,details:T.message,metadata:new M.Metadata});return}this.listener.onReceiveMetadata(S)}}),T.on("trailers",T=>{this.handleTrailers(T)}),T.on("data",T=>{let S;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+T.length);try{S=this.decoder.write(T)}catch(T){this.cancelWithStatus(P.Status.RESOURCE_EXHAUSTED,T.message);return}for(let T of S)this.trace("parsed message of length "+T.length),this.callEventTracker.addMessageReceived(),this.tryPush(T)}}),T.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),T.on("close",()=>{process.nextTick(()=>{var S;let R;if(this.trace("HTTP/2 stream closed with code "+T.rstCode),(null===(S=this.finalStatus)||void 0===S?void 0:S.code)===P.Status.OK)return;let N="";switch(T.rstCode){case O.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;R=P.Status.INTERNAL,N=`Received RST_STREAM with code ${T.rstCode}`;break;case O.constants.NGHTTP2_REFUSED_STREAM:R=P.Status.UNAVAILABLE,N="Stream refused by server";break;case O.constants.NGHTTP2_CANCEL:R=P.Status.CANCELLED,N="Call cancelled";break;case O.constants.NGHTTP2_ENHANCE_YOUR_CALM:R=P.Status.RESOURCE_EXHAUSTED,N="Bandwidth exhausted or memory limit exceeded";break;case O.constants.NGHTTP2_INADEQUATE_SECURITY:R=P.Status.PERMISSION_DENIED,N="Protocol not secure enough";break;case O.constants.NGHTTP2_INTERNAL_ERROR:R=P.Status.INTERNAL,null===this.internalError?N=`Received RST_STREAM with code ${T.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(R=P.Status.UNAVAILABLE,N=this.internalError.message):N=`Received RST_STREAM with code ${T.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:R=P.Status.INTERNAL,N=`Received RST_STREAM with code ${T.rstCode}`}this.endCall({code:R,details:N,metadata:new M.Metadata,rstCode:T.rstCode})})}),T.on("error",T=>{"ERR_HTTP2_STREAM_ERROR"!==T.code&&(this.trace("Node error event: message="+T.message+" code="+T.code+" errno="+K(T.errno)+" syscall="+T.syscall),this.internalError=T),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:P.Status.UNAVAILABLE,details:"Connection dropped",metadata:new M.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(T){U.trace(V.LogVerbosity.DEBUG,$,"["+this.callId+"] "+T)}endCall(T){(null===this.finalStatus||this.finalStatus.code===P.Status.OK)&&(this.finalStatus=T,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===P.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(T){this.trace("pushing to reader message of length "+(T instanceof Buffer?T.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(T),this.maybeOutputStatus())})}tryPush(T){this.canPush?(this.http2Stream.pause(),this.push(T)):(this.trace("unpushedReadMessages.push message of length "+T.length),this.unpushedReadMessages.push(T))}handleTrailers(T){let S;this.callEventTracker.onStreamEnd(!0);let R="";for(let S of Object.keys(T))R+="		"+S+": "+T[S]+"\n";this.trace("Received server trailers:\n"+R);try{S=M.Metadata.fromHttp2Headers(T)}catch(T){S=new M.Metadata}let O=S.getMap(),N=this.mappedStatusCode;if(N===P.Status.UNKNOWN&&"string"==typeof O["grpc-status"]){let T=Number(O["grpc-status"]);T in P.Status&&(N=T,this.trace("received status code "+T+" from server")),S.remove("grpc-status")}let L="";if("string"==typeof O["grpc-message"]){try{L=decodeURI(O["grpc-message"])}catch(T){L=O["grpc-message"]}S.remove("grpc-message"),this.trace('received status details string "'+L+'" from server')}let U={code:N,details:L,metadata:S};this.endCall(U)}destroyHttp2Stream(){var T;if(!this.http2Stream.destroyed){let S;S=(null===(T=this.finalStatus)||void 0===T?void 0:T.code)===P.Status.OK?O.constants.NGHTTP2_NO_ERROR:O.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+S),this.http2Stream.close(S)}}cancelWithStatus(T,S){this.trace("cancelWithStatus code: "+T+' details: "'+S+'"'),this.endCall({code:T,details:S,metadata:new M.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==P.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let T=this.unpushedReadMessages.shift();this.push(T);return}this.http2Stream.resume()}sendMessageWithContext(T,S){this.trace("write() called with message of length "+S.length);let R=S=>{process.nextTick(()=>{var R;let O=P.Status.UNAVAILABLE;(null==S?void 0:S.code)==="ERR_STREAM_WRITE_AFTER_END"&&(O=P.Status.INTERNAL),S&&this.cancelWithStatus(O,`Write error: ${S.message}`),null===(R=T.callback)||void 0===R||R.call(T)})};this.trace("sending data chunk of length "+S.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(S,R)}catch(T){this.endCall({code:P.Status.UNAVAILABLE,details:`Write failed with error ${T.message}`,metadata:new M.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}S.Http2SubchannelCall=W},67098:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.BaseSubchannelWrapper=void 0;class R{constructor(T){this.child=T}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(T){this.child.addConnectivityStateListener(T)}removeConnectivityStateListener(T){this.child.removeConnectivityStateListener(T)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(T){this.child.throttleKeepalive(T)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(T){return this.getRealSubchannel()===T.getRealSubchannel()}}S.BaseSubchannelWrapper=R},54918:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getSubchannelPool=S.SubchannelPool=void 0;let O=R(17380),N=R(26346),P=R(39247),M=R(9442),L=R(10104),U=1e4;class V{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let T=!0;for(let S in this.pool){let R=this.pool[S].filter(T=>!T.subchannel.unrefIfOneRef());R.length>0&&(T=!1),this.pool[S]=R}T&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var T,S;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},U),null===(S=(T=this.cleanupTimer).unref)||void 0===S||S.call(T))}getOrCreateSubchannel(T,S,R,U){this.ensureCleanupTask();let V=(0,M.uriToString)(T);if(V in this.pool){for(let T of this.pool[V])if((0,P.subchannelAddressEqual)(S,T.subchannelAddress)&&(0,O.channelOptionsEqual)(R,T.channelArguments)&&U._equals(T.channelCredentials))return T.subchannel}let $=new N.Subchannel(T,S,R,U,new L.Http2SubchannelConnector(T));return V in this.pool||(this.pool[V]=[]),this.pool[V].push({subchannelAddress:S,channelArguments:R,channelCredentials:U,subchannel:$}),$.ref(),$}}S.SubchannelPool=V;let $=new V;function K(T){return T?$:new V}S.getSubchannelPool=K},26346:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Subchannel=void 0;let O=R(27894),N=R(9360),P=R(90750),M=R(80933),L=R(9442),U=R(39247),V=R(2445),$="subchannel",K=2147483647;class W{constructor(T,S,R,P,M){var L;this.channelTarget=T,this.subchannelAddress=S,this.options=R,this.credentials=P,this.connector=M,this.connectivityState=O.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new V.ChannelzCallTracker,this.childrenTracker=new V.ChannelzChildrenTracker,this.streamTracker=new V.ChannelzCallTracker;let $={initialDelay:R["grpc.initial_reconnect_backoff_ms"],maxDelay:R["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new N.BackoffTimeout(()=>{this.handleBackoffTimer()},$),this.backoffTimeout.unref(),this.subchannelAddressString=(0,U.subchannelAddressToString)(S),this.keepaliveTime=null!==(L=R["grpc.keepalive_time_ms"])&&void 0!==L?L:-1,0===R["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new V.ChannelzTrace,this.channelzRef=(0,V.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(R,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(T){P.trace(M.LogVerbosity.DEBUG,$,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}refTrace(T){P.trace(M.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([O.ConnectivityState.TRANSIENT_FAILURE],O.ConnectivityState.CONNECTING):this.transitionToState([O.ConnectivityState.TRANSIENT_FAILURE],O.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let T=this.options;if(T["grpc.keepalive_time_ms"]){let S=Math.min(this.keepaliveTime,K);T=Object.assign(Object.assign({},T),{"grpc.keepalive_time_ms":S})}this.connector.connect(this.subchannelAddress,this.credentials,T).then(T=>{this.transitionToState([O.ConnectivityState.CONNECTING],O.ConnectivityState.READY)?(this.transport=T,this.channelzEnabled&&this.childrenTracker.refChild(T.getChannelzRef()),T.addDisconnectListener(T=>{this.transitionToState([O.ConnectivityState.READY],O.ConnectivityState.IDLE),T&&this.keepaliveTime>0&&(this.keepaliveTime*=2,P.log(M.LogVerbosity.ERROR,`Connection to ${(0,L.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):T.shutdown()},T=>{this.transitionToState([O.ConnectivityState.CONNECTING],O.ConnectivityState.TRANSIENT_FAILURE,`${T}`)})}transitionToState(T,S,R){var N,P;if(-1===T.indexOf(this.connectivityState))return!1;this.trace(O.ConnectivityState[this.connectivityState]+" -> "+O.ConnectivityState[S]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+O.ConnectivityState[S]);let M=this.connectivityState;switch(this.connectivityState=S,S){case O.ConnectivityState.READY:this.stopBackoff();break;case O.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case O.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(N=this.transport)||void 0===N||N.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case O.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null===(P=this.transport)||void 0===P||P.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${S}`)}for(let T of this.stateListeners)T(this,M,S,this.keepaliveTime,R);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,V.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([O.ConnectivityState.CONNECTING,O.ConnectivityState.READY],O.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(T,S,R,O){let N;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),N={onCallEnd:T=>{T.code===M.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):N={},this.transport.createCall(T,S,R,O,N)}startConnecting(){process.nextTick(()=>{this.transitionToState([O.ConnectivityState.IDLE],O.ConnectivityState.CONNECTING)||this.connectivityState!==O.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(T){this.stateListeners.add(T)}removeConnectivityStateListener(T){this.stateListeners.delete(T)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([O.ConnectivityState.TRANSIENT_FAILURE],O.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(T){return T.getRealSubchannel()===this}throttleKeepalive(T){T>this.keepaliveTime&&(this.keepaliveTime=T)}}S.Subchannel=W},60459:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.getDefaultRootsData=S.CIPHER_SUITES=void 0;let O=R(57147);S.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let N=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,P=null;function M(){return N?(null===P&&(P=O.readFileSync(N)),P):null}S.getDefaultRootsData=M},10104:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.Http2SubchannelConnector=void 0;let O=R(85158),N=R(24404),P=R(2445),M=R(80933),L=R(775),U=R(90750),V=R(77561),$=R(39247),K=R(9442),W=R(41808),Q=R(89289),Y=R(56710),X="transport",Z="transport_flowctrl",ee=R(81513).i8,{HTTP2_HEADER_AUTHORITY:et,HTTP2_HEADER_CONTENT_TYPE:er,HTTP2_HEADER_METHOD:en,HTTP2_HEADER_PATH:ei,HTTP2_HEADER_TE:es,HTTP2_HEADER_USER_AGENT:ea}=O.constants,eo=2e4,eu=Buffer.from("too_many_pings","ascii");class ec{constructor(T,S,R,N){this.session=T,this.options=R,this.remoteName=N,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=eo,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new P.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,$.subchannelAddressToString)(S),0===R["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,P.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[R["grpc.primary_user_agent"],`grpc-node-js/${ee}`,R["grpc.secondary_user_agent"]].filter(T=>T).join(" "),"grpc.keepalive_time_ms"in R&&(this.keepaliveTimeMs=R["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in R&&(this.keepaliveTimeoutMs=R["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in R?this.keepaliveWithoutCalls=1===R["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,T.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),T.once("goaway",(T,S,R)=>{let N=!1;T===O.constants.NGHTTP2_ENHANCE_YOUR_CALM&&R&&R.equals(eu)&&(N=!0),this.trace("connection closed by GOAWAY with code "+T+" and data "+(null==R?void 0:R.toString())),this.reportDisconnectToOwner(N)}),T.once("error",T=>{this.trace("connection closed with error "+T.message)}),U.isTracerEnabled(X)&&(T.on("remoteSettings",S=>{this.trace("new settings received"+(this.session!==T?" on the old connection":"")+": "+JSON.stringify(S))}),T.on("localSettings",S=>{this.trace("local settings acknowledged by remote"+(this.session!==T?" on the old connection":"")+": "+JSON.stringify(S))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var T,S,R;let O;let N=this.session.socket,P=N.remoteAddress?(0,$.stringToSubchannelAddress)(N.remoteAddress,N.remotePort):null,M=N.localAddress?(0,$.stringToSubchannelAddress)(N.localAddress,N.localPort):null;if(this.session.encrypted){let S=N,R=S.getCipher(),P=S.getCertificate(),M=S.getPeerCertificate();O={cipherSuiteStandardName:null!==(T=R.standardName)&&void 0!==T?T:null,cipherSuiteOtherName:R.standardName?null:R.name,localCertificate:P&&"raw"in P?P.raw:null,remoteCertificate:M&&"raw"in M?M.raw:null}}else O=null;return{remoteAddress:P,localAddress:M,security:O,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!==(S=this.session.state.localWindowSize)&&void 0!==S?S:null,remoteFlowControlWindow:null!==(R=this.session.state.remoteWindowSize)&&void 0!==R?R:null}}trace(T){U.trace(M.LogVerbosity.DEBUG,X,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}keepaliveTrace(T){U.trace(M.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}flowControlTrace(T){U.trace(M.LogVerbosity.DEBUG,Z,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}internalsTrace(T){U.trace(M.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+T)}reportDisconnectToOwner(T){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(S=>S(T)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let T of this.activeCalls)T.onDisconnect()})}addDisconnectListener(T){this.disconnectListeners.push(T)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var T,S;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null===(S=(T=this.keepaliveTimeoutId).unref)||void 0===S||S.call(T));try{this.session.ping((T,S,R)=>{T&&(this.keepaliveTrace("Ping failed with error "+T.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(T){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var T,S;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null===(S=(T=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)||void 0===S?void 0:S.call(T)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(T){this.activeCalls.delete(T),0===this.activeCalls.size&&this.session.unref()}addActiveCall(T){this.activeCalls.add(T),1!==this.activeCalls.size||(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(T,S,R,O,N){let P,M,L;let U=T.toHttp2Headers();U[et]=S,U[ea]=this.userAgent,U[er]="application/grpc",U[en]="POST",U[ei]=R,U[es]="trailers";try{P=this.session.request(U)}catch(T){throw this.handleDisconnect(),T}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),M={addMessageSent:()=>{var T;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null===(T=N.addMessageSent)||void 0===T||T.call(N)},addMessageReceived:()=>{var T;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null===(T=N.addMessageReceived)||void 0===T||T.call(N)},onCallEnd:T=>{var S;null===(S=N.onCallEnd)||void 0===S||S.call(N,T),this.removeActiveCall(L)},onStreamEnd:T=>{var S;T?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null===(S=N.onStreamEnd)||void 0===S||S.call(N,T)}}):M={addMessageSent:()=>{var T;null===(T=N.addMessageSent)||void 0===T||T.call(N)},addMessageReceived:()=>{var T;null===(T=N.addMessageReceived)||void 0===T||T.call(N)},onCallEnd:T=>{var S;null===(S=N.onCallEnd)||void 0===S||S.call(N,T),this.removeActiveCall(L)},onStreamEnd:T=>{var S;null===(S=N.onStreamEnd)||void 0===S||S.call(N,T)}},L=new Q.Http2SubchannelCall(P,M,O,this,(0,Y.getNextCallNumber)()),this.addActiveCall(L),L}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,P.unregisterChannelzRef)(this.channelzRef)}}class ed{constructor(T){this.channelTarget=T,this.session=null,this.isShutdown=!1}trace(T){U.trace(M.LogVerbosity.DEBUG,X,(0,K.uriToString)(this.channelTarget)+" "+T)}createSession(T,S,R,P){return this.isShutdown?Promise.reject():new Promise((M,L)=>{var U,Q,Y;let X;P.realTarget?(X=(0,K.uriToString)(P.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,K.uriToString)(P.realTarget))):(X=null,this.trace("creating HTTP/2 session to "+(0,$.subchannelAddressToString)(T)));let Z=(0,V.getDefaultAuthority)(null!==(U=P.realTarget)&&void 0!==U?U:this.channelTarget),ee=S._getConnectionOptions()||{};ee.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in R?ee.maxSessionMemory=R["grpc-node.max_session_memory"]:ee.maxSessionMemory=Number.MAX_SAFE_INTEGER;let et="http://";if("secureContext"in ee){if(et="https://",R["grpc.ssl_target_name_override"]){let T=R["grpc.ssl_target_name_override"];ee.checkServerIdentity=(S,R)=>(0,N.checkServerIdentity)(T,R),ee.servername=T}else{let T=null!==(Y=null===(Q=(0,K.splitHostPort)(Z))||void 0===Q?void 0:Q.host)&&void 0!==Y?Y:"localhost";ee.servername=T}P.socket&&(ee.createConnection=(T,S)=>P.socket)}else ee.createConnection=(S,R)=>P.socket?P.socket:W.connect(T);ee=Object.assign(Object.assign(Object.assign({},ee),T),{enableTrace:1===R["grpc-node.tls_enable_trace"]});let er=O.connect(et+Z,ee);this.session=er;let en="Failed to connect";er.unref(),er.once("connect",()=>{er.removeAllListeners(),M(new ec(er,T,R,X)),this.session=null}),er.once("close",()=>{this.session=null,setImmediate(()=>{L(`${en} (${new Date().toISOString()})`)})}),er.once("error",T=>{en=T.message,this.trace("connection failed with error "+en)})})}connect(T,S,R){var O,P;if(this.isShutdown)return Promise.reject();let M=S._getConnectionOptions()||{};if("secureContext"in M){if(M.ALPNProtocols=["h2"],R["grpc.ssl_target_name_override"]){let T=R["grpc.ssl_target_name_override"];M.checkServerIdentity=(S,R)=>(0,N.checkServerIdentity)(T,R),M.servername=T}else if("grpc.http_connect_target"in R){let T=(0,V.getDefaultAuthority)(null!==(O=(0,K.parseUri)(R["grpc.http_connect_target"]))&&void 0!==O?O:{path:"localhost"}),S=(0,K.splitHostPort)(T);M.servername=null!==(P=null==S?void 0:S.host)&&void 0!==P?P:T}R["grpc-node.tls_enable_trace"]&&(M.enableTrace=!0)}return(0,L.getProxiedConnection)(T,R,M).then(O=>this.createSession(T,S,R,O))}shutdown(){var T;this.isShutdown=!0,null===(T=this.session)||void 0===T||T.close(),this.session=null}}S.Http2SubchannelConnector=ed},9442:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),S.uriToString=S.splitHostPort=S.parseUri=void 0;let R=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function O(T){let S=R.exec(T);return null===S?null:{scheme:S[1],authority:S[2],path:S[3]}}S.parseUri=O;let N=/^\d+$/;function P(T){if(T.startsWith("[")){let S=T.indexOf("]");if(-1===S)return null;let R=T.substring(1,S);if(-1===R.indexOf(":"))return null;if(!(T.length>S+1))return{host:R};if(":"!==T[S+1])return null;{let O=T.substring(S+2);return N.test(O)?{host:R,port:+O}:null}}{let S=T.split(":");return 2!==S.length?{host:T}:N.test(S[1])?{host:S[0],port:+S[1]}:null}}function M(T){let S="";return void 0!==T.scheme&&(S+=T.scheme+":"),void 0!==T.authority&&(S+="//"+T.authority+"/"),S+=T.path}S.splitHostPort=P,S.uriToString=M},37486:(T,S,R)=>{"use strict";var O,N;/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */O={value:!0},O=O=S.im=S.J_=O=S.Cp=O=O=void 0;let P=R(91628),M=R(17682),L=R(65062),U=R(57958);O=R(52189),O=function(T){return"@type"in T&&"string"==typeof T["@type"]},function(T){T.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",T.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",T.IDEMPOTENT="IDEMPOTENT"}(N=S.Cp||(S.Cp={}));let V={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function $(T,S){return""===T?S:T+"."+S}function K(T){return T instanceof M.Service||T instanceof M.Type||T instanceof M.Enum}function W(T){return T instanceof M.Namespace||T instanceof M.Root}function Q(T,S){let R=$(S,T.name);return K(T)?[[R,T]]:W(T)&&void 0!==T.nested?Object.keys(T.nested).map(S=>Q(T.nested[S],R)).reduce((T,S)=>T.concat(S),[]):[]}function Y(T,S){return function(R){return T.toObject(T.decode(R),S)}}function X(T){return function(S){if(Array.isArray(S))throw Error(`Failed to serialize message: expected object with ${T.name} structure, got array instead`);let R=T.fromObject(S);return T.encode(R).finish()}}function Z(T){return(T||[]).reduce((T,S)=>{for(let[R,O]of Object.entries(S))"uninterpreted_option"===R?T.uninterpreted_option.push(S.uninterpreted_option):T[R]=O;return T},{deprecated:!1,idempotency_level:N.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function ee(T,S,R,O){let N=T.resolvedRequestType,M=T.resolvedResponseType;return{path:"/"+S+"/"+T.name,requestStream:!!T.requestStream,responseStream:!!T.responseStream,requestSerialize:X(N),requestDeserialize:Y(N,R),responseSerialize:X(M),responseDeserialize:Y(M,R),originalName:P(T.name),requestType:er(N,O),responseType:er(M,O),options:Z(T.parsedOptions)}}function et(T,S,R,O){let N={};for(let P of T.methodsArray)N[P.name]=ee(P,S,R,O);return N}function er(T,S){let R=T.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:R.$type.toObject(R,V),fileDescriptorProtos:S}}function en(T,S){let R=T.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:R.$type.toObject(R,V),fileDescriptorProtos:S}}function ei(T,S,R,O){if(T instanceof M.Service)return et(T,S,R,O);if(T instanceof M.Type)return er(T,O);if(T instanceof M.Enum)return en(T,O);throw Error("Type mismatch in reflection object handling")}function es(T,S){let R={};T.resolveAll();let O=T.toDescriptor("proto3").file.map(T=>Buffer.from(L.FileDescriptorProto.encode(T).finish()));for(let[N,P]of Q(T,""))R[N]=ei(P,N,S,O);return R}function ea(T,S){S=S||{};let R=M.Root.fromDescriptor(T);return R.resolveAll(),es(R,S)}function eo(T,S){return es((0,U.loadProtosWithOptionsSync)(T,S),S)}function eu(T,S){S=S||{};let R=M.Root.fromJSON(T);return R.resolveAll(),es(R,S)}O=function(T,S){return(0,U.loadProtosWithOptions)(T,S).then(T=>es(T,S))},S.J_=eo,S.im=eu,O=function(T,S){return ea(L.FileDescriptorSet.decode(T),S)},O=function(T,S){return ea(L.FileDescriptorSet.fromObject(T),S)},(0,U.addCommonProtos)()},57958:(T,S,R)=>{"use strict";/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */Object.defineProperty(S,"__esModule",{value:!0}),S.addCommonProtos=S.loadProtosWithOptionsSync=S.loadProtosWithOptions=void 0;let O=R(57147),N=R(71017),P=R(17682);function M(T,S){let R=T.resolvePath;T.resolvePath=(T,P)=>{if(N.isAbsolute(P))return P;for(let T of S){let S=N.join(T,P);try{return O.accessSync(S,O.constants.R_OK),S}catch(T){continue}}return process.emitWarning(`${P} not found in any of the include paths ${S}`),R(T,P)}}async function L(T,S){let R=new P.Root;if((S=S||{}).includeDirs){if(!Array.isArray(S.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));M(R,S.includeDirs)}let O=await R.load(T,S);return O.resolveAll(),O}function U(T,S){let R=new P.Root;if((S=S||{}).includeDirs){if(!Array.isArray(S.includeDirs))throw Error("The includeDirs option must be an array");M(R,S.includeDirs)}let O=R.loadSync(T,S);return O.resolveAll(),O}function V(){let T=R(56541),S=R(89987),O=R(57674),N=R(73795);P.common("api",T.nested.google.nested.protobuf.nested),P.common("descriptor",S.nested.google.nested.protobuf.nested),P.common("source_context",O.nested.google.nested.protobuf.nested),P.common("type",N.nested.google.nested.protobuf.nested)}S.loadProtosWithOptions=L,S.loadProtosWithOptionsSync=U,S.addCommonProtos=V},84608:T=>{"use strict";function S(T,S){for(var R=Array(arguments.length-1),O=0,N=2,P=!0;N<arguments.length;)R[O++]=arguments[N++];return new Promise(function(N,M){R[O]=function(T){if(P){if(P=!1,T)M(T);else{for(var S=Array(arguments.length-1),R=0;R<S.length;)S[R++]=arguments[R];N.apply(null,S)}}};try{T.apply(S||null,R)}catch(T){P&&(P=!1,M(T))}})}T.exports=S},41585:(T,S)=>{"use strict";var R=S;R.length=function(T){var S=T.length;if(!S)return 0;for(var R=0;--S%4>1&&"="===T.charAt(S);)++R;return Math.ceil(3*T.length)/4-R};for(var O=Array(64),N=Array(123),P=0;P<64;)N[O[P]=P<26?P+65:P<52?P+71:P<62?P-4:P-59|43]=P++;R.encode=function(T,S,R){for(var N,P=null,M=[],L=0,U=0;S<R;){var V=T[S++];switch(U){case 0:M[L++]=O[V>>2],N=(3&V)<<4,U=1;break;case 1:M[L++]=O[N|V>>4],N=(15&V)<<2,U=2;break;case 2:M[L++]=O[N|V>>6],M[L++]=O[63&V],U=0}L>8191&&((P||(P=[])).push(String.fromCharCode.apply(String,M)),L=0)}return(U&&(M[L++]=O[N],M[L++]=61,1===U&&(M[L++]=61)),P)?(L&&P.push(String.fromCharCode.apply(String,M.slice(0,L))),P.join("")):String.fromCharCode.apply(String,M.slice(0,L))};var M="invalid encoding";R.decode=function(T,S,R){for(var O,P=R,L=0,U=0;U<T.length;){var V=T.charCodeAt(U++);if(61===V&&L>1)break;if(void 0===(V=N[V]))throw Error(M);switch(L){case 0:O=V,L=1;break;case 1:S[R++]=O<<2|(48&V)>>4,O=V,L=2;break;case 2:S[R++]=(15&O)<<4|(60&V)>>2,O=V,L=3;break;case 3:S[R++]=(3&O)<<6|V,L=0}}if(1===L)throw Error(M);return R-P},R.test=function(T){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(T)}},91445:T=>{"use strict";function S(T,R){"string"==typeof T&&(R=T,T=void 0);var O=[];function N(T){if("string"!=typeof T){var R=P();if(S.verbose&&console.log("codegen: "+R),R="return "+R,T){for(var M=Object.keys(T),L=Array(M.length+1),U=Array(M.length),V=0;V<M.length;)L[V]=M[V],U[V]=T[M[V++]];return L[V]=R,Function.apply(null,L).apply(null,U)}return Function(R)()}for(var $=Array(arguments.length-1),K=0;K<$.length;)$[K]=arguments[++K];if(K=0,T=T.replace(/%([%dfijs])/g,function(T,S){var R=$[K++];switch(S){case"d":case"f":return String(Number(R));case"i":return String(Math.floor(R));case"j":return JSON.stringify(R);case"s":return String(R)}return"%"}),K!==$.length)throw Error("parameter count mismatch");return O.push(T),N}function P(S){return"function "+(S||R||"")+"("+(T&&T.join(",")||"")+"){\n  "+O.join("\n  ")+"\n}"}return N.toString=P,N}T.exports=S,S.verbose=!1},17539:T=>{"use strict";function S(){this._listeners={}}T.exports=S,S.prototype.on=function(T,S,R){return(this._listeners[T]||(this._listeners[T]=[])).push({fn:S,ctx:R||this}),this},S.prototype.off=function(T,S){if(void 0===T)this._listeners={};else if(void 0===S)this._listeners[T]=[];else for(var R=this._listeners[T],O=0;O<R.length;)R[O].fn===S?R.splice(O,1):++O;return this},S.prototype.emit=function(T){var S=this._listeners[T];if(S){for(var R=[],O=1;O<arguments.length;)R.push(arguments[O++]);for(O=0;O<S.length;)S[O].fn.apply(S[O++].ctx,R)}return this}},14269:(T,S,R)=>{"use strict";T.exports=P;var O=R(84608),N=R(79701)("fs");function P(T,S,R){return("function"==typeof S?(R=S,S={}):S||(S={}),R)?!S.xhr&&N&&N.readFile?N.readFile(T,function(O,N){return O&&"undefined"!=typeof XMLHttpRequest?P.xhr(T,S,R):O?R(O):R(null,S.binary?N:N.toString("utf8"))}):P.xhr(T,S,R):O(P,this,T,S)}P.xhr=function(T,S,R){var O=new XMLHttpRequest;O.onreadystatechange=function(){if(4===O.readyState){if(0!==O.status&&200!==O.status)return R(Error("status "+O.status));if(S.binary){var T=O.response;if(!T){T=[];for(var N=0;N<O.responseText.length;++N)T.push(255&O.responseText.charCodeAt(N))}return R(null,"undefined"!=typeof Uint8Array?new Uint8Array(T):T)}return R(null,O.responseText)}},S.binary&&("overrideMimeType"in O&&O.overrideMimeType("text/plain; charset=x-user-defined"),O.responseType="arraybuffer"),O.open("GET",T),O.send()}},19162:T=>{"use strict";function S(T){return"undefined"!=typeof Float32Array?function(){var S=new Float32Array([-0]),R=new Uint8Array(S.buffer),O=128===R[3];function N(T,O,N){S[0]=T,O[N]=R[0],O[N+1]=R[1],O[N+2]=R[2],O[N+3]=R[3]}function P(T,O,N){S[0]=T,O[N]=R[3],O[N+1]=R[2],O[N+2]=R[1],O[N+3]=R[0]}function M(T,O){return R[0]=T[O],R[1]=T[O+1],R[2]=T[O+2],R[3]=T[O+3],S[0]}function L(T,O){return R[3]=T[O],R[2]=T[O+1],R[1]=T[O+2],R[0]=T[O+3],S[0]}T.writeFloatLE=O?N:P,T.writeFloatBE=O?P:N,T.readFloatLE=O?M:L,T.readFloatBE=O?L:M}():function(){function S(T,S,R,O){var N=S<0?1:0;if(N&&(S=-S),0===S)T(1/S>0?0:2147483648,R,O);else if(isNaN(S))T(2143289344,R,O);else if(S>34028234663852886e22)T((N<<31|2139095040)>>>0,R,O);else if(S<11754943508222875e-54)T((N<<31|Math.round(S/1401298464324817e-60))>>>0,R,O);else{var P=Math.floor(Math.log(S)/Math.LN2),M=8388607&Math.round(S*Math.pow(2,-P)*8388608);T((N<<31|P+127<<23|M)>>>0,R,O)}}function M(T,S,R){var O=T(S,R),N=(O>>31)*2+1,P=O>>>23&255,M=8388607&O;return 255===P?M?NaN:1/0*N:0===P?1401298464324817e-60*N*M:N*Math.pow(2,P-150)*(M+8388608)}T.writeFloatLE=S.bind(null,R),T.writeFloatBE=S.bind(null,O),T.readFloatLE=M.bind(null,N),T.readFloatBE=M.bind(null,P)}(),"undefined"!=typeof Float64Array?function(){var S=new Float64Array([-0]),R=new Uint8Array(S.buffer),O=128===R[7];function N(T,O,N){S[0]=T,O[N]=R[0],O[N+1]=R[1],O[N+2]=R[2],O[N+3]=R[3],O[N+4]=R[4],O[N+5]=R[5],O[N+6]=R[6],O[N+7]=R[7]}function P(T,O,N){S[0]=T,O[N]=R[7],O[N+1]=R[6],O[N+2]=R[5],O[N+3]=R[4],O[N+4]=R[3],O[N+5]=R[2],O[N+6]=R[1],O[N+7]=R[0]}function M(T,O){return R[0]=T[O],R[1]=T[O+1],R[2]=T[O+2],R[3]=T[O+3],R[4]=T[O+4],R[5]=T[O+5],R[6]=T[O+6],R[7]=T[O+7],S[0]}function L(T,O){return R[7]=T[O],R[6]=T[O+1],R[5]=T[O+2],R[4]=T[O+3],R[3]=T[O+4],R[2]=T[O+5],R[1]=T[O+6],R[0]=T[O+7],S[0]}T.writeDoubleLE=O?N:P,T.writeDoubleBE=O?P:N,T.readDoubleLE=O?M:L,T.readDoubleBE=O?L:M}():function(){function S(T,S,R,O,N,P){var M,L=O<0?1:0;if(L&&(O=-O),0===O)T(0,N,P+S),T(1/O>0?0:2147483648,N,P+R);else if(isNaN(O))T(0,N,P+S),T(2146959360,N,P+R);else if(O>17976931348623157e292)T(0,N,P+S),T((L<<31|2146435072)>>>0,N,P+R);else if(O<22250738585072014e-324)T((M=O/5e-324)>>>0,N,P+S),T((L<<31|M/4294967296)>>>0,N,P+R);else{var U=Math.floor(Math.log(O)/Math.LN2);1024===U&&(U=1023),T(4503599627370496*(M=O*Math.pow(2,-U))>>>0,N,P+S),T((L<<31|U+1023<<20|1048576*M&1048575)>>>0,N,P+R)}}function M(T,S,R,O,N){var P=T(O,N+S),M=T(O,N+R),L=(M>>31)*2+1,U=M>>>20&2047,V=4294967296*(1048575&M)+P;return 2047===U?V?NaN:1/0*L:0===U?5e-324*L*V:L*Math.pow(2,U-1075)*(V+4503599627370496)}T.writeDoubleLE=S.bind(null,R,0,4),T.writeDoubleBE=S.bind(null,O,4,0),T.readDoubleLE=M.bind(null,N,0,4),T.readDoubleBE=M.bind(null,P,4,0)}(),T}function R(T,S,R){S[R]=255&T,S[R+1]=T>>>8&255,S[R+2]=T>>>16&255,S[R+3]=T>>>24}function O(T,S,R){S[R]=T>>>24,S[R+1]=T>>>16&255,S[R+2]=T>>>8&255,S[R+3]=255&T}function N(T,S){return(T[S]|T[S+1]<<8|T[S+2]<<16|T[S+3]<<24)>>>0}function P(T,S){return(T[S]<<24|T[S+1]<<16|T[S+2]<<8|T[S+3])>>>0}T.exports=S(S)},79701:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},93275:(T,S)=>{"use strict";var R=S,O=R.isAbsolute=function(T){return/^(?:\/|\w+:)/.test(T)},N=R.normalize=function(T){var S=(T=T.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),R=O(T),N="";R&&(N=S.shift()+"/");for(var P=0;P<S.length;)".."===S[P]?P>0&&".."!==S[P-1]?S.splice(--P,2):R?S.splice(P,1):++P:"."===S[P]?S.splice(P,1):++P;return N+S.join("/")};R.resolve=function(T,S,R){return(R||(S=N(S)),O(S))?S:(R||(T=N(T)),(T=T.replace(/(?:\/|^)[^/]+$/,"")).length?N(T+"/"+S):S)}},60117:T=>{"use strict";function S(T,S,R){var O=R||8192,N=O>>>1,P=null,M=O;return function(R){if(R<1||R>N)return T(R);M+R>O&&(P=T(O),M=0);var L=S.call(P,M,M+=R);return 7&M&&(M=(7|M)+1),L}}T.exports=S},1562:(T,S)=>{"use strict";var R=S;R.length=function(T){for(var S=0,R=0,O=0;O<T.length;++O)(R=T.charCodeAt(O))<128?S+=1:R<2048?S+=2:(64512&R)==55296&&(64512&T.charCodeAt(O+1))==56320?(++O,S+=4):S+=3;return S},R.read=function(T,S,R){if(R-S<1)return"";for(var O,N=null,P=[],M=0;S<R;)(O=T[S++])<128?P[M++]=O:O>191&&O<224?P[M++]=(31&O)<<6|63&T[S++]:O>239&&O<365?(O=((7&O)<<18|(63&T[S++])<<12|(63&T[S++])<<6|63&T[S++])-65536,P[M++]=55296+(O>>10),P[M++]=56320+(1023&O)):P[M++]=(15&O)<<12|(63&T[S++])<<6|63&T[S++],M>8191&&((N||(N=[])).push(String.fromCharCode.apply(String,P)),M=0);return N?(M&&N.push(String.fromCharCode.apply(String,P.slice(0,M))),N.join("")):String.fromCharCode.apply(String,P.slice(0,M))},R.write=function(T,S,R){for(var O,N,P=R,M=0;M<T.length;++M)(O=T.charCodeAt(M))<128?S[R++]=O:(O<2048?S[R++]=O>>6|192:((64512&O)==55296&&(64512&(N=T.charCodeAt(M+1)))==56320?(O=65536+((1023&O)<<10)+(1023&N),++M,S[R++]=O>>18|240,S[R++]=O>>12&63|128):S[R++]=O>>12|224,S[R++]=O>>6&63|128),S[R++]=63&O|128);return R-P}},91628:T=>{var S=1/0,R="[object Symbol]",O=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,N=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,P="\ud800-\udfff",M="\\u0300-\\u036f\\ufe20-\\ufe23",L="\\u20d0-\\u20f0",U="\\u2700-\\u27bf",V="a-z\\xdf-\\xf6\\xf8-\\xff",$="A-Z\\xc0-\\xd6\\xd8-\\xde",K="\\ufe0e\\ufe0f",W="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Q="[']",Y="["+P+"]",X="["+W+"]",Z="["+M+L+"]",ee="\\d+",et="["+U+"]",er="["+V+"]",en="[^"+P+W+ee+U+V+$+"]",ei="\ud83c[\udffb-\udfff]",es="[^"+P+"]",ea="(?:\ud83c[\udde6-\uddff]){2}",eo="[\ud800-\udbff][\udc00-\udfff]",eu="["+$+"]",ec="\\u200d",ed="(?:"+er+"|"+en+")",eh="(?:"+eu+"|"+en+")",ef="(?:"+Q+"(?:d|ll|m|re|s|t|ve))?",ep="(?:"+Q+"(?:D|LL|M|RE|S|T|VE))?",eg="(?:"+Z+"|"+ei+")?",em="["+K+"]?",ey="(?:"+ec+"(?:"+[es,ea,eo].join("|")+")"+em+eg+")*",ev=em+eg+ey,eb="(?:"+[et,ea,eo].join("|")+")"+ev,eT="(?:"+[es+Z+"?",Z,ea,eo,Y].join("|")+")",eS=RegExp(Q,"g"),e_=RegExp(Z,"g"),eE=RegExp(ei+"(?="+ei+")|"+eT+ev,"g"),ew=RegExp([eu+"?"+er+"+"+ef+"(?="+[X,eu,"$"].join("|")+")",eh+"+"+ep+"(?="+[X,eu+ed,"$"].join("|")+")",eu+"?"+ed+"+"+ef,eu+"+"+ep,ee,eb].join("|"),"g"),eC=RegExp("["+ec+P+M+L+K+"]"),eI=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eR={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},eO="object"==typeof global&&global&&global.Object===Object&&global,eA="object"==typeof self&&self&&self.Object===Object&&self,ek=eO||eA||Function("return this")();function eN(T,S,R,O){var N=-1,P=T?T.length:0;for(O&&P&&(R=T[++N]);++N<P;)R=S(R,T[N],N,T);return R}function eD(T){return T.split("")}function eP(T){return T.match(O)||[]}var ex=function(T){return function(S){return null==T?void 0:T[S]}}(eR);function eM(T){return eC.test(T)}function eL(T){return eI.test(T)}function eF(T){return eM(T)?ej(T):eD(T)}function ej(T){return T.match(eE)||[]}function eU(T){return T.match(ew)||[]}var eB=Object.prototype.toString,eV=ek.Symbol,ez=eV?eV.prototype:void 0,eq=ez?ez.toString:void 0;function eG(T,S,R){var O=-1,N=T.length;S<0&&(S=-S>N?0:N+S),(R=R>N?N:R)<0&&(R+=N),N=S>R?0:R-S>>>0,S>>>=0;for(var P=Array(N);++O<N;)P[O]=T[O+S];return P}function eH(T){if("string"==typeof T)return T;if(eQ(T))return eq?eq.call(T):"";var R=T+"";return"0"==R&&1/T==-S?"-0":R}function e$(T,S,R){var O=T.length;return R=void 0===R?O:R,!S&&R>=O?T:eG(T,S,R)}function eK(T){return function(S){var R=eM(S=eY(S))?eF(S):void 0,O=R?R[0]:S.charAt(0),N=R?e$(R,1).join(""):S.slice(1);return O[T]()+N}}function eW(T){return!!T&&"object"==typeof T}function eQ(T){return"symbol"==typeof T||eW(T)&&eB.call(T)==R}function eY(T){return null==T?"":eH(T)}var eJ=function(T){return function(S){return eN(e1(eZ(S).replace(eS,"")),T,"")}}(function(T,S,R){return S=S.toLowerCase(),T+(R?eX(S):S)});function eX(T){return e0(eY(T).toLowerCase())}function eZ(T){return(T=eY(T))&&T.replace(N,ex).replace(e_,"")}var e0=eK("toUpperCase");function e1(T,S,R){return(T=eY(T),void 0===(S=R?void 0:S))?eL(T)?eU(T):eP(T):T.match(S)||[]}T.exports=eJ},50216:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"addBasePath",{enumerable:!0,get:function(){return M}});let O=R(61124),N=R(92038),P="";function M(T,S){return(0,N.normalizePathTrailingSlash)((0,O.addPathPrefix)(T,P))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},2377:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"callServer",{enumerable:!0,get:function(){return N}});let O=R(53579);async function N(T,S){let R=(0,O.getServerActionDispatcher)();if(!R)throw Error("Invariant: missing action dispatcher.");return new Promise((O,N)=>{R({actionId:T,actionArgs:S,resolve:O,reject:N})})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},92438:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"AppRouterAnnouncer",{enumerable:!0,get:function(){return U}});let O=R(34218),N=R(73638),P="next-route-announcer",M="__next-route-announcer__";function L(){var T;let S=document.getElementsByName(P)[0];if(null==S?void 0:null==(T=S.shadowRoot)?void 0:T.childNodes[0])return S.shadowRoot.childNodes[0];{let T=document.createElement(P);T.style.cssText="position:absolute";let S=document.createElement("div");return S.ariaLive="assertive",S.id=M,S.role="alert",S.style.cssText="position:absolute;border:0;height:1px;margin:-1px;padding:0;width:1px;clip:rect(0 0 0 0);overflow:hidden;white-space:nowrap;word-wrap:normal",T.attachShadow({mode:"open"}).appendChild(S),document.body.appendChild(T),S}}function U(T){let{tree:S}=T,[R,M]=(0,O.useState)(null);(0,O.useEffect)(()=>(M(L()),()=>{let T=document.getElementsByTagName(P)[0];(null==T?void 0:T.isConnected)&&document.body.removeChild(T)}),[]);let[U,V]=(0,O.useState)(""),$=(0,O.useRef)();return(0,O.useEffect)(()=>{let T="";if(document.title)T=document.title;else{let S=document.querySelector("h1");S&&(T=S.innerText||S.textContent||"")}void 0!==$.current&&$.current!==T&&V(T),$.current=T},[S]),R?(0,N.createPortal)(U,R):null}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},17328:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{RSC_HEADER:function(){return R},ACTION:function(){return O},NEXT_ROUTER_STATE_TREE:function(){return N},NEXT_ROUTER_PREFETCH_HEADER:function(){return P},NEXT_URL:function(){return M},RSC_CONTENT_TYPE_HEADER:function(){return L},RSC_VARY_HEADER:function(){return U},FLIGHT_PARAMETERS:function(){return V},NEXT_RSC_UNION_QUERY:function(){return $},NEXT_DID_POSTPONE_HEADER:function(){return K}});let R="RSC",O="Next-Action",N="Next-Router-State-Tree",P="Next-Router-Prefetch",M="Next-Url",L="text/x-component",U=R+", "+N+", "+P+", "+M,V=[[R],[N],[P]],$="_rsc",K="x-nextjs-postponed";("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},53579:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{getServerActionDispatcher:function(){return ea},urlToUrlWithoutFlightMarker:function(){return eu},createEmptyCacheNode:function(){return eh},default:function(){return ey}});let O=R(42212)._(R(34218)),N=R(49236),P=R(52247),M=R(79286),L=R(75075),U=R(56320),V=R(30619),$=R(13980),K=R(99415),W=R(50216),Q=R(92438),Y=R(73825),X=R(18281),Z=R(6631),ee=R(17328),et=R(81151),er=R(68423),en=!0,ei=null,es=null;function ea(){return es}let eo={};function eu(T){let S=new URL(T,location.origin);return S.searchParams.delete(ee.NEXT_RSC_UNION_QUERY),S}function ec(T){return T.origin!==window.location.origin}function ed(T){let{appRouterState:S,sync:R}=T;return(0,O.useInsertionEffect)(()=>{let{tree:T,pushRef:O,canonicalUrl:N}=S,P={__NA:!0,__PRIVATE_NEXTJS_INTERNALS_TREE:T};O.pendingPush&&(0,M.createHrefFromUrl)(new URL(window.location.href))!==N?(O.pendingPush=!1,window.history.pushState(P,"",N)):window.history.replaceState(P,"",N),R(S)},[S,R]),null}let eh=()=>({status:N.CacheStates.LAZY_INITIALIZED,data:null,subTreeData:null,parallelRoutes:new Map});function ef(T){es=(0,O.useCallback)(S=>{(0,O.startTransition)(()=>{T({...S,type:P.ACTION_SERVER_ACTION})})},[T])}function ep(T){return(0,O.useCallback)((S,R,N)=>{(0,O.startTransition)(()=>{T({type:P.ACTION_SERVER_PATCH,flightData:R,previousTree:S,overrideCanonicalUrl:N})})},[T])}function eg(T){return(0,O.useCallback)((S,R,O)=>{let N=new URL((0,W.addBasePath)(S),location.href);return T({type:P.ACTION_NAVIGATE,url:N,isExternalUrl:ec(N),locationSearch:location.search,shouldScroll:null==O||O,navigateType:R})},[T])}function em(T){let{buildId:S,initialHead:R,initialTree:M,initialCanonicalUrl:V,initialSeedData:ee,assetPrefix:es}=T,ea=(0,O.useMemo)(()=>(0,$.createInitialRouterState)({buildId:S,initialSeedData:ee,initialCanonicalUrl:V,initialTree:M,initialParallelRoutes:ei,isServer:en,location:en?null:window.location,initialHead:R}),[S,ee,V,M,R]),[eu,eh,em]=(0,U.useReducerWithReduxDevtools)(ea);(0,O.useEffect)(()=>{ei=null},[]);let{canonicalUrl:ey}=(0,U.useUnwrapState)(eu),{searchParams:ev,pathname:eb}=(0,O.useMemo)(()=>{let T=new URL(ey,"http://n");return{searchParams:T.searchParams,pathname:(0,er.hasBasePath)(T.pathname)?(0,et.removeBasePath)(T.pathname):T.pathname}},[ey]),eT=ep(eh),eS=eg(eh);ef(eh);let e_=(0,O.useMemo)(()=>({back:()=>window.history.back(),forward:()=>window.history.forward(),prefetch:(T,S)=>{if((0,K.isBot)(window.navigator.userAgent))return;let R=new URL((0,W.addBasePath)(T),window.location.href);ec(R)||(0,O.startTransition)(()=>{var T;eh({type:P.ACTION_PREFETCH,url:R,kind:null!=(T=null==S?void 0:S.kind)?T:P.PrefetchKind.FULL})})},replace:(T,S)=>{void 0===S&&(S={}),(0,O.startTransition)(()=>{var R;eS(T,"replace",null==(R=S.scroll)||R)})},push:(T,S)=>{void 0===S&&(S={}),(0,O.startTransition)(()=>{var R;eS(T,"push",null==(R=S.scroll)||R)})},refresh:()=>{(0,O.startTransition)(()=>{eh({type:P.ACTION_REFRESH,origin:window.location.origin})})},fastRefresh:()=>{throw Error("fastRefresh can only be used in development mode. Please use refresh instead.")}}),[eh,eS]);(0,O.useEffect)(()=>{window.next&&(window.next.router=e_)},[e_]),(0,O.useEffect)(()=>{function T(T){var S;T.persisted&&(null==(S=window.history.state)?void 0:S.__PRIVATE_NEXTJS_INTERNALS_TREE)&&eh({type:P.ACTION_RESTORE,url:new URL(window.location.href),tree:window.history.state.__PRIVATE_NEXTJS_INTERNALS_TREE})}return window.addEventListener("pageshow",T),()=>{window.removeEventListener("pageshow",T)}},[eh]);let{pushRef:eE}=(0,U.useUnwrapState)(eu);if(eE.mpaNavigation){if(eo.pendingMpaPath!==ey){let T=window.location;eE.pendingPush?T.assign(ey):T.replace(ey),eo.pendingMpaPath=ey}(0,O.use)((0,Z.createInfinitePromise)())}(0,O.useEffect)(()=>{window.history.pushState.bind(window.history),window.history.replaceState.bind(window.history);let T=T=>{let{state:S}=T;if(S){if(!S.__NA){window.location.reload();return}(0,O.startTransition)(()=>{eh({type:P.ACTION_RESTORE,url:new URL(window.location.href),tree:S.__PRIVATE_NEXTJS_INTERNALS_TREE})})}};return window.addEventListener("popstate",T),()=>{window.removeEventListener("popstate",T)}},[eh]);let{cache:ew,tree:eC,nextUrl:eI,focusAndScrollRef:eR}=(0,U.useUnwrapState)(eu),eO=(0,O.useMemo)(()=>(0,X.findHeadInCache)(ew,eC[1]),[ew,eC]),eA=O.default.createElement(Y.RedirectBoundary,null,eO,ew.subTreeData,O.default.createElement(Q.AppRouterAnnouncer,{tree:eC}));return O.default.createElement(O.default.Fragment,null,O.default.createElement(ed,{appRouterState:(0,U.useUnwrapState)(eu),sync:em}),O.default.createElement(L.PathnameContext.Provider,{value:eb},O.default.createElement(L.SearchParamsContext.Provider,{value:ev},O.default.createElement(N.GlobalLayoutRouterContext.Provider,{value:{buildId:S,changeByServerResponse:eT,tree:eC,focusAndScrollRef:eR,nextUrl:eI}},O.default.createElement(N.AppRouterContext.Provider,{value:e_},O.default.createElement(N.LayoutRouterContext.Provider,{value:{childNodes:ew.parallelRoutes,tree:eC,url:ey}},eA))))))}function ey(T){let{globalErrorComponent:S,...R}=T;return O.default.createElement(V.ErrorBoundary,{errorComponent:S},O.default.createElement(em,R))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},91720:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"bailoutToClientRendering",{enumerable:!0,get:function(){return P}});let O=R(95158),N=R(94749);function P(){let T=N.staticGenerationAsyncStorage.getStore();(null==T||!T.forceStatic)&&(null==T?void 0:T.isStaticGeneration)&&(0,O.throwWithNoSSR)()}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},15523:(T,S,R)=>{"use strict";function O(T){}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"clientHookInServerComponentError",{enumerable:!0,get:function(){return O}}),R(10143),R(34218),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},30619:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{ErrorBoundaryHandler:function(){return L},GlobalError:function(){return U},default:function(){return V},ErrorBoundary:function(){return $}});let O=R(10143)._(R(34218)),N=R(27804),P={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},text:{fontSize:"14px",fontWeight:400,lineHeight:"28px",margin:"0 8px"}};function M(T){let{error:S}=T;if("function"==typeof fetch.__nextGetStaticStore){var R;let T=null==(R=fetch.__nextGetStaticStore())?void 0:R.getStore();if((null==T?void 0:T.isRevalidate)||(null==T?void 0:T.isStaticGeneration))throw console.error(S),S}return null}class L extends O.default.Component{static getDerivedStateFromError(T){return{error:T}}static getDerivedStateFromProps(T,S){return T.pathname!==S.previousPathname&&S.error?{error:null,previousPathname:T.pathname}:{error:S.error,previousPathname:T.pathname}}render(){return this.state.error?O.default.createElement(O.default.Fragment,null,O.default.createElement(M,{error:this.state.error}),this.props.errorStyles,this.props.errorScripts,O.default.createElement(this.props.errorComponent,{error:this.state.error,reset:this.reset})):this.props.children}constructor(T){super(T),this.reset=()=>{this.setState({error:null})},this.state={error:null,previousPathname:this.props.pathname}}}function U(T){let{error:S}=T,R=null==S?void 0:S.digest;return O.default.createElement("html",{id:"__next_error__"},O.default.createElement("head",null),O.default.createElement("body",null,O.default.createElement(M,{error:S}),O.default.createElement("div",{style:P.error},O.default.createElement("div",null,O.default.createElement("h2",{style:P.text},"Application error: a "+(R?"server":"client")+"-side exception has occurred (see the "+(R?"server logs":"browser console")+" for more information)."),R?O.default.createElement("p",{style:P.text},"Digest: "+R):null))))}let V=U;function $(T){let{errorComponent:S,errorStyles:R,errorScripts:P,children:M}=T,U=(0,N.usePathname)();return S?O.default.createElement(L,{pathname:U,errorComponent:S,errorStyles:R,errorScripts:P},M):O.default.createElement(O.default.Fragment,null,M)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},95432:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{DYNAMIC_ERROR_CODE:function(){return R},DynamicServerError:function(){return O}});let R="DYNAMIC_SERVER_USAGE";class O extends Error{constructor(T){super("Dynamic server usage: "+T),this.digest=R}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},6631:(T,S)=>{"use strict";let R;function O(){return R||(R=new Promise(()=>{})),R}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createInfinitePromise",{enumerable:!0,get:function(){return O}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},81459:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return eo}}),R(10143);let O=R(42212)._(R(34218));R(73638);let N=R(49236),P=R(75400),M=R(6631),L=R(30619),U=R(70765),V=R(15244),$=R(73825),K=R(13456),W=R(42888),Q=R(53075);function Y(T,S){if(T){let[R,O]=T,N=2===T.length;if((0,U.matchSegment)(S[0],R)&&S[1].hasOwnProperty(O)){if(N){let T=Y(void 0,S[1][O]);return[S[0],{...S[1],[O]:[T[0],T[1],T[2],"refetch"]}]}return[S[0],{...S[1],[O]:Y(T.slice(2),S[1][O])}]}}return S}function X(T){return null}let Z=["bottom","height","left","right","top","width","x","y"];function ee(T){if(["sticky","fixed"].includes(getComputedStyle(T).position))return!0;let S=T.getBoundingClientRect();return Z.every(T=>0===S[T])}function et(T,S){let R=T.getBoundingClientRect();return R.top>=0&&R.top<=S}function er(T){var S;return"top"===T?document.body:null!=(S=document.getElementById(T))?S:document.getElementsByName(T)[0]}class en extends O.default.Component{componentDidMount(){this.handlePotentialScroll()}componentDidUpdate(){this.props.focusAndScrollRef.apply&&this.handlePotentialScroll()}render(){return this.props.children}constructor(...T){super(...T),this.handlePotentialScroll=()=>{let{focusAndScrollRef:T,segmentPath:S}=this.props;if(T.apply){if(0!==T.segmentPaths.length&&!T.segmentPaths.some(T=>S.every((S,R)=>(0,U.matchSegment)(S,T[R]))))return;let R=null,O=T.hashFragment;if(O&&(R=er(O)),R||(R=X(this)),!(R instanceof Element))return;for(;!(R instanceof HTMLElement)||ee(R);){if(null===R.nextElementSibling)return;R=R.nextElementSibling}T.apply=!1,T.hashFragment=null,T.segmentPaths=[],(0,V.handleSmoothScroll)(()=>{if(O){R.scrollIntoView();return}let T=document.documentElement,S=T.clientHeight;!et(R,S)&&(T.scrollTop=0,et(R,S)||R.scrollIntoView())},{dontForceLayout:!0,onlyHashChange:T.onlyHashChange}),T.onlyHashChange=!1,R.focus()}}}}function ei(T){let{segmentPath:S,children:R}=T,P=(0,O.useContext)(N.GlobalLayoutRouterContext);if(!P)throw Error("invariant global layout router not mounted");return O.default.createElement(en,{segmentPath:S,focusAndScrollRef:P.focusAndScrollRef},R)}function es(T){let{parallelRouterKey:S,url:R,childNodes:L,segmentPath:U,tree:V,cacheKey:$}=T,K=(0,O.useContext)(N.GlobalLayoutRouterContext);if(!K)throw Error("invariant global layout router not mounted");let{buildId:W,changeByServerResponse:Q,tree:X}=K,Z=L.get($);if(!Z||Z.status===N.CacheStates.LAZY_INITIALIZED){let T=Y(["",...U],X);Z={status:N.CacheStates.DATA_FETCH,data:(0,P.fetchServerResponse)(new URL(R,location.origin),T,K.nextUrl,W),subTreeData:null,head:Z&&Z.status===N.CacheStates.LAZY_INITIALIZED?Z.head:void 0,parallelRoutes:Z&&Z.status===N.CacheStates.LAZY_INITIALIZED?Z.parallelRoutes:new Map},L.set($,Z)}if(!Z)throw Error("Child node should always exist");if(Z.subTreeData&&Z.data)throw Error("Child node should not have both subTreeData and data");if(Z.data){let[T,S]=(0,O.use)(Z.data);Z.data=null,setTimeout(()=>{(0,O.startTransition)(()=>{Q(X,T,S)})}),(0,O.use)((0,M.createInfinitePromise)())}return Z.subTreeData||(0,O.use)((0,M.createInfinitePromise)()),O.default.createElement(N.LayoutRouterContext.Provider,{value:{tree:V[1][S],childNodes:Z.parallelRoutes,url:R}},Z.subTreeData)}function ea(T){let{children:S,loading:R,loadingStyles:N,loadingScripts:P,hasLoading:M}=T;return M?O.default.createElement(O.Suspense,{fallback:O.default.createElement(O.default.Fragment,null,N,P,R)},S):O.default.createElement(O.default.Fragment,null,S)}function eo(T){let{parallelRouterKey:S,segmentPath:R,error:P,errorStyles:M,errorScripts:U,templateStyles:V,templateScripts:Y,loading:X,loadingStyles:Z,loadingScripts:ee,hasLoading:et,template:er,notFound:en,notFoundStyles:eo,styles:eu}=T,ec=(0,O.useContext)(N.LayoutRouterContext);if(!ec)throw Error("invariant expected layout router to be mounted");let{childNodes:ed,tree:eh,url:ef}=ec,ep=ed.get(S);ep||(ep=new Map,ed.set(S,ep));let eg=eh[1][S][0],em=(0,W.getSegmentValue)(eg),ey=[eg];return O.default.createElement(O.default.Fragment,null,eu,ey.map(T=>{let eu=(0,W.getSegmentValue)(T),ec=(0,Q.createRouterCacheKey)(T);return O.default.createElement(N.TemplateContext.Provider,{key:(0,Q.createRouterCacheKey)(T,!0),value:O.default.createElement(ei,{segmentPath:R},O.default.createElement(L.ErrorBoundary,{errorComponent:P,errorStyles:M,errorScripts:U},O.default.createElement(ea,{hasLoading:et,loading:X,loadingStyles:Z,loadingScripts:ee},O.default.createElement(K.NotFoundBoundary,{notFound:en,notFoundStyles:eo},O.default.createElement($.RedirectBoundary,null,O.default.createElement(es,{parallelRouterKey:S,url:ef,tree:eh,childNodes:ep,segmentPath:R,cacheKey:ec,isActive:em===eu}))))))},V,Y,er)}))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},70765:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{matchSegment:function(){return N},canSegmentBeOverridden:function(){return P}});let O=R(70799),N=(T,S)=>"string"==typeof T?"string"==typeof S&&T===S:"string"!=typeof S&&T[0]===S[0]&&T[1]===S[1],P=(T,S)=>{var R;return!Array.isArray(T)&&!!Array.isArray(S)&&(null==(R=(0,O.getSegmentParam)(T))?void 0:R.param)===S[0]};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},27804:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{ReadonlyURLSearchParams:function(){return Q},useSearchParams:function(){return Y},usePathname:function(){return X},ServerInsertedHTMLContext:function(){return U.ServerInsertedHTMLContext},useServerInsertedHTML:function(){return U.useServerInsertedHTML},useRouter:function(){return Z},useParams:function(){return et},useSelectedLayoutSegments:function(){return en},useSelectedLayoutSegment:function(){return ei},redirect:function(){return V.redirect},permanentRedirect:function(){return V.permanentRedirect},RedirectType:function(){return V.RedirectType},notFound:function(){return $.notFound}});let O=R(34218),N=R(49236),P=R(75075),M=R(15523),L=R(42888),U=R(35853),V=R(90976),$=R(97265),K=Symbol("internal for urlsearchparams readonly");function W(){return Error("ReadonlyURLSearchParams cannot be modified")}class Q{[Symbol.iterator](){return this[K][Symbol.iterator]()}append(){throw W()}delete(){throw W()}set(){throw W()}sort(){throw W()}constructor(T){this[K]=T,this.entries=T.entries.bind(T),this.forEach=T.forEach.bind(T),this.get=T.get.bind(T),this.getAll=T.getAll.bind(T),this.has=T.has.bind(T),this.keys=T.keys.bind(T),this.values=T.values.bind(T),this.toString=T.toString.bind(T),this.size=T.size}}function Y(){(0,M.clientHookInServerComponentError)("useSearchParams");let T=(0,O.useContext)(P.SearchParamsContext),S=(0,O.useMemo)(()=>T?new Q(T):null,[T]);{let{bailoutToClientRendering:T}=R(91720);T()}return S}function X(){return(0,M.clientHookInServerComponentError)("usePathname"),(0,O.useContext)(P.PathnameContext)}function Z(){(0,M.clientHookInServerComponentError)("useRouter");let T=(0,O.useContext)(N.AppRouterContext);if(null===T)throw Error("invariant expected app router to be mounted");return T}function ee(T,S){for(let R of(void 0===S&&(S={}),Object.values(T[1]))){let T=R[0],O=Array.isArray(T),N=O?T[1]:T;!N||N.startsWith("__PAGE__")||(O&&("c"===T[2]||"oc"===T[2])?S[T[0]]=T[1].split("/"):O&&(S[T[0]]=T[1]),S=ee(R,S))}return S}function et(){(0,M.clientHookInServerComponentError)("useParams");let T=(0,O.useContext)(N.GlobalLayoutRouterContext),S=(0,O.useContext)(P.PathParamsContext);return(0,O.useMemo)(()=>(null==T?void 0:T.tree)?ee(T.tree):S,[null==T?void 0:T.tree,S])}function er(T,S,R,O){let N;if(void 0===R&&(R=!0),void 0===O&&(O=[]),R)N=T[1][S];else{var P;let S=T[1];N=null!=(P=S.children)?P:Object.values(S)[0]}if(!N)return O;let M=N[0],U=(0,L.getSegmentValue)(M);return!U||U.startsWith("__PAGE__")?O:(O.push(U),er(N,S,!1,O))}function en(T){void 0===T&&(T="children"),(0,M.clientHookInServerComponentError)("useSelectedLayoutSegments");let{tree:S}=(0,O.useContext)(N.LayoutRouterContext);return er(S,T)}function ei(T){void 0===T&&(T="children"),(0,M.clientHookInServerComponentError)("useSelectedLayoutSegment");let S=en(T);return 0===S.length?null:S[0]}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},13456:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"NotFoundBoundary",{enumerable:!0,get:function(){return M}});let O=R(10143)._(R(34218)),N=R(27804);class P extends O.default.Component{static getDerivedStateFromError(T){if((null==T?void 0:T.digest)==="NEXT_NOT_FOUND")return{notFoundTriggered:!0};throw T}static getDerivedStateFromProps(T,S){return T.pathname!==S.previousPathname&&S.notFoundTriggered?{notFoundTriggered:!1,previousPathname:T.pathname}:{notFoundTriggered:S.notFoundTriggered,previousPathname:T.pathname}}render(){return this.state.notFoundTriggered?O.default.createElement(O.default.Fragment,null,O.default.createElement("meta",{name:"robots",content:"noindex"}),!1,this.props.notFoundStyles,this.props.notFound):this.props.children}constructor(T){super(T),this.state={notFoundTriggered:!!T.asNotFound,previousPathname:T.pathname}}}function M(T){let{notFound:S,notFoundStyles:R,asNotFound:M,children:L}=T,U=(0,N.usePathname)();return S?O.default.createElement(P,{pathname:U,notFound:S,notFoundStyles:R,asNotFound:M},L):O.default.createElement(O.default.Fragment,null,L)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},97265:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{notFound:function(){return O},isNotFoundError:function(){return N}});let R="NEXT_NOT_FOUND";function O(){let T=Error(R);throw T.digest=R,T}function N(T){return(null==T?void 0:T.digest)===R}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},80527:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"PromiseQueue",{enumerable:!0,get:function(){return V}});let O=R(40051),N=R(82581);var P=N._("_maxConcurrency"),M=N._("_runningCount"),L=N._("_queue"),U=N._("_processNext");class V{enqueue(T){let S,R;let N=new Promise((T,O)=>{S=T,R=O}),P={promiseFn:N,task:async()=>{try{O._(this,M)[M]++;let R=await T();S(R)}catch(T){R(T)}finally{O._(this,M)[M]--,O._(this,U)[U]()}}};return O._(this,L)[L].push(P),O._(this,U)[U](),N}bump(T){let S=O._(this,L)[L].findIndex(S=>S.promiseFn===T);if(S>-1){let T=O._(this,L)[L].splice(S,1)[0];O._(this,L)[L].unshift(T),O._(this,U)[U](!0)}}constructor(T=5){Object.defineProperty(this,U,{value:$}),Object.defineProperty(this,P,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),O._(this,P)[P]=T,O._(this,M)[M]=0,O._(this,L)[L]=[]}}function $(T){if(void 0===T&&(T=!1),(O._(this,M)[M]<O._(this,P)[P]||T)&&O._(this,L)[L].length>0){var S;null==(S=O._(this,L)[L].shift())||S.task()}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},73825:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{RedirectErrorBoundary:function(){return L},RedirectBoundary:function(){return U}});let O=R(42212)._(R(34218)),N=R(27804),P=R(90976);function M(T){let{redirect:S,reset:R,redirectType:M}=T,L=(0,N.useRouter)();return(0,O.useEffect)(()=>{O.default.startTransition(()=>{M===P.RedirectType.push?L.push(S,{}):L.replace(S,{}),R()})},[S,M,R,L]),null}class L extends O.default.Component{static getDerivedStateFromError(T){if((0,P.isRedirectError)(T))return{redirect:(0,P.getURLFromRedirectError)(T),redirectType:(0,P.getRedirectTypeFromError)(T)};throw T}render(){let{redirect:T,redirectType:S}=this.state;return null!==T&&null!==S?O.default.createElement(M,{redirect:T,redirectType:S,reset:()=>this.setState({redirect:null})}):this.props.children}constructor(T){super(T),this.state={redirect:null,redirectType:null}}}function U(T){let{children:S}=T,R=(0,N.useRouter)();return O.default.createElement(L,{router:R},S)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},37934:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"RedirectStatusCode",{enumerable:!0,get:function(){return R}}),function(T){T[T.SeeOther=303]="SeeOther",T[T.TemporaryRedirect=307]="TemporaryRedirect",T[T.PermanentRedirect=308]="PermanentRedirect"}(R||(R={})),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},90976:(T,S,R)=>{"use strict";var O;Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{RedirectType:function(){return O},getRedirectError:function(){return U},redirect:function(){return V},permanentRedirect:function(){return $},isRedirectError:function(){return K},getURLFromRedirectError:function(){return W},getRedirectTypeFromError:function(){return Q},getRedirectStatusCodeFromError:function(){return Y}});let N=R(55403),P=R(47849),M=R(37934),L="NEXT_REDIRECT";function U(T,S,R){void 0===R&&(R=M.RedirectStatusCode.TemporaryRedirect);let O=Error(L);O.digest=L+";"+S+";"+T+";"+R+";";let P=N.requestAsyncStorage.getStore();return P&&(O.mutableCookies=P.mutableCookies),O}function V(T,S){void 0===S&&(S="replace");let R=P.actionAsyncStorage.getStore();throw U(T,S,(null==R?void 0:R.isAction)?M.RedirectStatusCode.SeeOther:M.RedirectStatusCode.TemporaryRedirect)}function $(T,S){void 0===S&&(S="replace");let R=P.actionAsyncStorage.getStore();throw U(T,S,(null==R?void 0:R.isAction)?M.RedirectStatusCode.SeeOther:M.RedirectStatusCode.PermanentRedirect)}function K(T){if("string"!=typeof(null==T?void 0:T.digest))return!1;let[S,R,O,N]=T.digest.split(";",4),P=Number(N);return S===L&&("replace"===R||"push"===R)&&"string"==typeof O&&!isNaN(P)&&P in M.RedirectStatusCode}function W(T){return K(T)?T.digest.split(";",3)[2]:null}function Q(T){if(!K(T))throw Error("Not a redirect error");return T.digest.split(";",2)[1]}function Y(T){if(!K(T))throw Error("Not a redirect error");return Number(T.digest.split(";",4)[3])}(function(T){T.push="push",T.replace="replace"})(O||(O={})),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},50847:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return P}});let O=R(42212)._(R(34218)),N=R(49236);function P(){let T=(0,O.useContext)(N.TemplateContext);return O.default.createElement(O.default.Fragment,null,T)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},58994:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"applyFlightData",{enumerable:!0,get:function(){return M}});let O=R(49236),N=R(85601),P=R(86800);function M(T,S,R,M){void 0===M&&(M=!1);let[L,U,V]=R.slice(-3);if(null===U)return!1;if(3===R.length){let R=U[2];S.status=O.CacheStates.READY,S.subTreeData=R,(0,N.fillLazyItemsTillLeafWithHead)(S,T,L,U,V,M)}else S.status=O.CacheStates.READY,S.subTreeData=T.subTreeData,S.parallelRoutes=new Map(T.parallelRoutes),(0,P.fillCacheWithNewSubTreeData)(S,T,R,M);return!0}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},91155:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"applyRouterStatePatchToTree",{enumerable:!0,get:function(){return P}});let O=R(70765);function N(T,S){let[R,P]=T,[M,L]=S;if("__DEFAULT__"===M&&"__DEFAULT__"!==R)return T;if((0,O.matchSegment)(R,M)){let S={};for(let T in P)void 0!==L[T]?S[T]=N(P[T],L[T]):S[T]=P[T];for(let T in L)S[T]||(S[T]=L[T]);let O=[R,S];return T[2]&&(O[2]=T[2]),T[3]&&(O[3]=T[3]),T[4]&&(O[4]=T[4]),O}return S}function P(T,S,R){let M;let[L,U,,,V]=S;if(1===T.length)return N(S,R);let[$,K]=T;if(!(0,O.matchSegment)($,L))return null;if(2===T.length)M=N(U[K],R);else if(null===(M=P(T.slice(2),U[K],R)))return null;let W=[T[0],{...U,[K]:M}];return V&&(W[4]=!0),W}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},21705:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{extractPathFromFlightRouterState:function(){return V},computeChangedPath:function(){return K}});let O=R(45513),N=R(41516),P=R(70765),M=T=>"/"===T[0]?T.slice(1):T,L=T=>"string"==typeof T?T:T[1];function U(T){return T.reduce((T,S)=>""===(S=M(S))||(0,N.isGroupSegment)(S)?T:T+"/"+S,"")||"/"}function V(T){var S;let R=Array.isArray(T[0])?T[0][1]:T[0];if("__DEFAULT__"===R||O.INTERCEPTION_ROUTE_MARKERS.some(T=>R.startsWith(T)))return;if(R.startsWith("__PAGE__"))return"";let N=[R],P=null!=(S=T[1])?S:{},M=P.children?V(P.children):void 0;if(void 0!==M)N.push(M);else for(let[T,S]of Object.entries(P)){if("children"===T)continue;let R=V(S);void 0!==R&&N.push(R)}return U(N)}function $(T,S){let[R,N]=T,[M,U]=S,K=L(R),W=L(M);if(O.INTERCEPTION_ROUTE_MARKERS.some(T=>K.startsWith(T)||W.startsWith(T)))return"";if(!(0,P.matchSegment)(R,M)){var Q;return null!=(Q=V(S))?Q:""}for(let T in N)if(U[T]){let S=$(N[T],U[T]);if(null!==S)return L(M)+"/"+S}return null}function K(T,S){let R=$(T,S);return null==R||"/"===R?R:U(R.split("/"))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},79286:(T,S)=>{"use strict";function R(T,S){return void 0===S&&(S=!0),T.pathname+T.search+(S?T.hash:"")}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createHrefFromUrl",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},13980:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createInitialRouterState",{enumerable:!0,get:function(){return L}});let O=R(49236),N=R(79286),P=R(85601),M=R(21705);function L(T){var S;let{buildId:R,initialTree:L,initialSeedData:U,initialCanonicalUrl:V,initialParallelRoutes:$,isServer:K,location:W,initialHead:Q}=T,Y=U[2],X={status:O.CacheStates.READY,data:null,subTreeData:Y,parallelRoutes:K?new Map:$};return(null===$||0===$.size)&&(0,P.fillLazyItemsTillLeafWithHead)(X,void 0,L,U,Q),{buildId:R,tree:L,cache:X,prefetchCache:new Map,pushRef:{pendingPush:!1,mpaNavigation:!1,preserveCustomHistoryState:!0},focusAndScrollRef:{apply:!1,onlyHashChange:!1,hashFragment:null,segmentPaths:[]},canonicalUrl:W?(0,N.createHrefFromUrl)(W):V,nextUrl:null!=(S=(0,M.extractPathFromFlightRouterState)(L)||(null==W?void 0:W.pathname))?S:null}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},53075:(T,S)=>{"use strict";function R(T,S){return void 0===S&&(S=!1),Array.isArray(T)?(T[0]+"|"+T[1]+"|"+T[2]).toLowerCase():S&&T.startsWith("__PAGE__")?"__PAGE__":T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createRouterCacheKey",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},75400:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fetchServerResponse",{enumerable:!0,get:function(){return $}});let O=R(17328),N=R(53579),P=R(2377),M=R(52247),L=R(32948),{createFromFetch:U}=R(49530);function V(T){return[(0,N.urlToUrlWithoutFlightMarker)(T).toString(),void 0]}async function $(T,S,R,$,K){let W={[O.RSC_HEADER]:"1",[O.NEXT_ROUTER_STATE_TREE]:encodeURIComponent(JSON.stringify(S))};K===M.PrefetchKind.AUTO&&(W[O.NEXT_ROUTER_PREFETCH_HEADER]="1"),R&&(W[O.NEXT_URL]=R);let Q=(0,L.hexHash)([W[O.NEXT_ROUTER_PREFETCH_HEADER]||"0",W[O.NEXT_ROUTER_STATE_TREE],W[O.NEXT_URL]].join(","));try{let S=new URL(T);S.searchParams.set(O.NEXT_RSC_UNION_QUERY,Q);let R=await fetch(S,{credentials:"same-origin",headers:W}),M=(0,N.urlToUrlWithoutFlightMarker)(R.url),L=R.redirected?M:void 0,K=R.headers.get("content-type")||"",Y=!!R.headers.get(O.NEXT_DID_POSTPONE_HEADER);if(K!==O.RSC_CONTENT_TYPE_HEADER||!R.ok)return T.hash&&(M.hash=T.hash),V(M.toString());let[X,Z]=await U(Promise.resolve(R),{callServer:P.callServer});if($!==X)return V(R.url);return[Z,L,Y]}catch(S){return console.error("Failed to fetch RSC payload for "+T+". Falling back to browser navigation.",S),[T.toString(),void 0]}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},35474:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fillCacheWithDataProperty",{enumerable:!0,get:function(){return P}});let O=R(49236),N=R(53075);function P(T,S,R,M){let L=R.length<=2,[U,V]=R,$=(0,N.createRouterCacheKey)(V),K=S.parallelRoutes.get(U),W=T.parallelRoutes.get(U);W&&W!==K||(W=new Map(K),T.parallelRoutes.set(U,W));let Q=null==K?void 0:K.get($),Y=W.get($);if(L){Y&&Y.data&&Y!==Q||W.set($,{status:O.CacheStates.DATA_FETCH,data:M(),subTreeData:null,parallelRoutes:new Map});return}if(!Y||!Q){Y||W.set($,{status:O.CacheStates.DATA_FETCH,data:M(),subTreeData:null,parallelRoutes:new Map});return}return Y===Q&&(Y={status:Y.status,data:Y.data,subTreeData:Y.subTreeData,parallelRoutes:new Map(Y.parallelRoutes)},W.set($,Y)),P(Y,Q,R.slice(2),M)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},86800:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fillCacheWithNewSubTreeData",{enumerable:!0,get:function(){return L}});let O=R(49236),N=R(68131),P=R(85601),M=R(53075);function L(T,S,R,U){let V=R.length<=5,[$,K]=R,W=(0,M.createRouterCacheKey)(K),Q=S.parallelRoutes.get($);if(!Q)return;let Y=T.parallelRoutes.get($);Y&&Y!==Q||(Y=new Map(Q),T.parallelRoutes.set($,Y));let X=Q.get(W),Z=Y.get(W);if(V){if(!Z||!Z.data||Z===X){let T=R[3],S=T[2];Z={status:O.CacheStates.READY,data:null,subTreeData:S,parallelRoutes:X?new Map(X.parallelRoutes):new Map},X&&(0,N.invalidateCacheByRouterState)(Z,X,R[2]),(0,P.fillLazyItemsTillLeafWithHead)(Z,X,R[2],T,R[4],U),Y.set(W,Z)}return}Z&&X&&(Z===X&&(Z={status:Z.status,data:Z.data,subTreeData:Z.subTreeData,parallelRoutes:new Map(Z.parallelRoutes)},Y.set(W,Z)),L(Z,X,R.slice(2),U))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},85601:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fillLazyItemsTillLeafWithHead",{enumerable:!0,get:function(){return P}});let O=R(49236),N=R(53075);function P(T,S,R,M,L,U){if(0===Object.keys(R[1]).length){T.head=L;return}for(let V in R[1]){let $;let K=R[1][V],W=K[0],Q=(0,N.createRouterCacheKey)(W),Y=null!==M&&null!==M[1]&&void 0!==M[1][V]?M[1][V]:null;if(S){let R=S.parallelRoutes.get(V);if(R){let S,N=new Map(R),M=N.get(Q);if(null!==Y){let T=Y[2];S={status:O.CacheStates.READY,data:null,subTreeData:T,parallelRoutes:new Map(null==M?void 0:M.parallelRoutes)}}else S=U&&M?{status:M.status,data:M.data,subTreeData:M.subTreeData,parallelRoutes:new Map(M.parallelRoutes)}:{status:O.CacheStates.LAZY_INITIALIZED,data:null,subTreeData:null,parallelRoutes:new Map(null==M?void 0:M.parallelRoutes)};N.set(Q,S),P(S,M,K,Y||null,L,U),T.parallelRoutes.set(V,N);continue}}if(null!==Y){let T=Y[2];$={status:O.CacheStates.READY,data:null,subTreeData:T,parallelRoutes:new Map}}else $={status:O.CacheStates.LAZY_INITIALIZED,data:null,subTreeData:null,parallelRoutes:new Map};let X=T.parallelRoutes.get(V);X?X.set(Q,$):T.parallelRoutes.set(V,new Map([[Q,$]])),P($,void 0,K,Y,L,U)}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},3933:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{PrefetchCacheEntryStatus:function(){return R},getPrefetchEntryCacheStatus:function(){return P}});let O=3e5,N=3e4;function P(T){let{kind:S,prefetchTime:R,lastUsedTime:P}=T;return Date.now()<(null!=P?P:R)+N?P?"reusable":"fresh":"auto"===S&&Date.now()<R+O?"stale":"full"===S&&Date.now()<R+O?"reusable":"expired"}(function(T){T.fresh="fresh",T.reusable="reusable",T.expired="expired",T.stale="stale"})(R||(R={})),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},18974:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"handleMutable",{enumerable:!0,get:function(){return P}});let O=R(21705);function N(T){return void 0!==T}function P(T,S){var R,P,M;let L=null==(P=S.shouldScroll)||P,U=T.nextUrl;if(N(S.patchedTree)){let R=(0,O.computeChangedPath)(T.tree,S.patchedTree);R?U=R:U||(U=T.canonicalUrl)}return{buildId:T.buildId,canonicalUrl:N(S.canonicalUrl)?S.canonicalUrl===T.canonicalUrl?T.canonicalUrl:S.canonicalUrl:T.canonicalUrl,pushRef:{pendingPush:N(S.pendingPush)?S.pendingPush:T.pushRef.pendingPush,mpaNavigation:N(S.mpaNavigation)?S.mpaNavigation:T.pushRef.mpaNavigation,preserveCustomHistoryState:N(S.preserveCustomHistoryState)?S.preserveCustomHistoryState:T.pushRef.preserveCustomHistoryState},focusAndScrollRef:{apply:!!L&&(!!N(null==S?void 0:S.scrollableSegments)||T.focusAndScrollRef.apply),onlyHashChange:!!S.hashFragment&&T.canonicalUrl.split("#",1)[0]===(null==(R=S.canonicalUrl)?void 0:R.split("#",1)[0]),hashFragment:L?S.hashFragment&&""!==S.hashFragment?decodeURIComponent(S.hashFragment.slice(1)):T.focusAndScrollRef.hashFragment:null,segmentPaths:L?null!=(M=null==S?void 0:S.scrollableSegments)?M:T.focusAndScrollRef.segmentPaths:[]},cache:S.cache?S.cache:T.cache,prefetchCache:S.prefetchCache?S.prefetchCache:T.prefetchCache,tree:N(S.patchedTree)?S.patchedTree:T.tree,nextUrl:U}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},76241:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"invalidateCacheBelowFlightSegmentPath",{enumerable:!0,get:function(){return N}});let O=R(53075);function N(T,S,R){let P=R.length<=2,[M,L]=R,U=(0,O.createRouterCacheKey)(L),V=S.parallelRoutes.get(M);if(!V)return;let $=T.parallelRoutes.get(M);if($&&$!==V||($=new Map(V),T.parallelRoutes.set(M,$)),P){$.delete(U);return}let K=V.get(U),W=$.get(U);W&&K&&(W===K&&(W={status:W.status,data:W.data,subTreeData:W.subTreeData,parallelRoutes:new Map(W.parallelRoutes)},$.set(U,W)),N(W,K,R.slice(2)))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},68131:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"invalidateCacheByRouterState",{enumerable:!0,get:function(){return N}});let O=R(53075);function N(T,S,R){for(let N in R[1]){let P=R[1][N][0],M=(0,O.createRouterCacheKey)(P),L=S.parallelRoutes.get(N);if(L){let S=new Map(L);S.delete(M),T.parallelRoutes.set(N,S)}}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},83534:(T,S)=>{"use strict";function R(T,S){let O=T[0],N=S[0];if(Array.isArray(O)&&Array.isArray(N)){if(O[0]!==N[0]||O[2]!==N[2])return!0}else if(O!==N)return!0;if(T[4])return!S[4];if(S[4])return!0;let P=Object.values(T[1])[0],M=Object.values(S[1])[0];return!P||!M||R(P,M)}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"isNavigatingToNewRootLayout",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},92877:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"fastRefreshReducer",{enumerable:!0,get:function(){return O}}),R(75400),R(79286),R(91155),R(83534),R(48024),R(18974),R(58994),R(53579);let O=function(T,S){return T};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},18281:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"findHeadInCache",{enumerable:!0,get:function(){return N}});let O=R(53075);function N(T,S){if(0===Object.keys(S).length)return T.head;for(let R in S){let[P,M]=S[R],L=T.parallelRoutes.get(R);if(!L)continue;let U=(0,O.createRouterCacheKey)(P),V=L.get(U);if(!V)continue;let $=N(V,M);if($)return $}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},42888:(T,S)=>{"use strict";function R(T){return Array.isArray(T)?T[1]:T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"getSegmentValue",{enumerable:!0,get:function(){return R}}),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},48024:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{handleExternalUrl:function(){return et},navigateReducer:function(){return ei}});let O=R(49236),N=R(75400),P=R(79286),M=R(76241),L=R(35474),U=R(91155),V=R(91151),$=R(83534),K=R(52247),W=R(18974),Q=R(58994),Y=R(3933),X=R(73732),Z=R(37003),ee=R(53579);function et(T,S,R,O){return S.mpaNavigation=!0,S.canonicalUrl=R,S.pendingPush=O,S.scrollableSegments=void 0,(0,W.handleMutable)(T,S)}function er(T){let S=[],[R,O]=T;if(0===Object.keys(O).length)return[[R]];for(let[T,N]of Object.entries(O))for(let O of er(N))""===R?S.push([T,...O]):S.push([R,T,...O]);return S}function en(T,S,R,N,P){let M=!1;for(let U of(T.status=O.CacheStates.READY,T.subTreeData=S.subTreeData,T.parallelRoutes=new Map(S.parallelRoutes),er(N).map(T=>[...R,...T])))(0,L.fillCacheWithDataProperty)(T,S,U,P),M=!0;return M}function ei(T,S){let{url:R,isExternalUrl:L,navigateType:ei,shouldScroll:es}=S,ea={},{hash:eo}=R,eu=(0,P.createHrefFromUrl)(R),ec="push"===ei;if((0,X.prunePrefetchCache)(T.prefetchCache),ea.preserveCustomHistoryState=!1,L)return et(T,ea,R.toString(),ec);let ed=T.prefetchCache.get((0,P.createHrefFromUrl)(R,!1));if(!ed){let S={data:(0,N.fetchServerResponse)(R,T.tree,T.nextUrl,T.buildId,void 0),kind:K.PrefetchKind.TEMPORARY,prefetchTime:Date.now(),treeAtTimeOfPrefetch:T.tree,lastUsedTime:null};T.prefetchCache.set((0,P.createHrefFromUrl)(R,!1),S),ed=S}let eh=(0,Y.getPrefetchEntryCacheStatus)(ed),{treeAtTimeOfPrefetch:ef,data:ep}=ed;return Z.prefetchQueue.bump(ep),ep.then(S=>{let[L,K,X]=S;if(ed&&!ed.lastUsedTime&&(ed.lastUsedTime=Date.now()),"string"==typeof L)return et(T,ea,L,ec);let Z=T.tree,ei=T.cache,ep=[];for(let S of L){let P=S.slice(0,-4),L=S.slice(-3)[0],K=["",...P],W=(0,U.applyRouterStatePatchToTree)(K,Z,L);if(null===W&&(W=(0,U.applyRouterStatePatchToTree)(K,ef,L)),null!==W){if((0,$.isNavigatingToNewRootLayout)(Z,W))return et(T,ea,eu,ec);let U=(0,ee.createEmptyCacheNode)(),es=(0,Q.applyFlightData)(ei,U,S,(null==ed?void 0:ed.kind)==="auto"&&eh===Y.PrefetchCacheEntryStatus.reusable);for(let S of((!es&&eh===Y.PrefetchCacheEntryStatus.stale||X)&&(es=en(U,ei,P,L,()=>(0,N.fetchServerResponse)(R,Z,T.nextUrl,T.buildId))),(0,V.shouldHardNavigate)(K,Z)?(U.status=O.CacheStates.READY,U.subTreeData=ei.subTreeData,(0,M.invalidateCacheBelowFlightSegmentPath)(U,ei,P),ea.cache=U):es&&(ea.cache=U),ei=U,Z=W,er(L))){let T=[...P,...S];"__DEFAULT__"!==T[T.length-1]&&ep.push(T)}}}return ea.patchedTree=Z,ea.canonicalUrl=K?(0,P.createHrefFromUrl)(K):eu,ea.pendingPush=ec,ea.scrollableSegments=ep,ea.hashFragment=eo,ea.shouldScroll=es,(0,W.handleMutable)(T,ea)},()=>T)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},37003:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{prefetchQueue:function(){return U},prefetchReducer:function(){return V}});let O=R(79286),N=R(75400),P=R(52247),M=R(73732),L=R(17328),U=new(R(80527)).PromiseQueue(5);function V(T,S){(0,M.prunePrefetchCache)(T.prefetchCache);let{url:R}=S;R.searchParams.delete(L.NEXT_RSC_UNION_QUERY);let V=(0,O.createHrefFromUrl)(R,!1),$=T.prefetchCache.get(V);if($&&($.kind===P.PrefetchKind.TEMPORARY&&T.prefetchCache.set(V,{...$,kind:S.kind}),!($.kind===P.PrefetchKind.AUTO&&S.kind===P.PrefetchKind.FULL)))return T;let K=U.enqueue(()=>(0,N.fetchServerResponse)(R,T.tree,T.nextUrl,T.buildId,S.kind));return T.prefetchCache.set(V,{treeAtTimeOfPrefetch:T.tree,data:K,kind:S.kind,prefetchTime:Date.now(),lastUsedTime:null}),T}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},73732:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"prunePrefetchCache",{enumerable:!0,get:function(){return N}});let O=R(3933);function N(T){for(let[S,R]of T)(0,O.getPrefetchEntryCacheStatus)(R)===O.PrefetchCacheEntryStatus.expired&&T.delete(S)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},28929:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"refreshReducer",{enumerable:!0,get:function(){return W}});let O=R(75400),N=R(79286),P=R(91155),M=R(83534),L=R(48024),U=R(18974),V=R(49236),$=R(85601),K=R(53579);function W(T,S){let{origin:R}=S,W={},Q=T.canonicalUrl,Y=T.tree;W.preserveCustomHistoryState=!1;let X=(0,K.createEmptyCacheNode)();return X.data=(0,O.fetchServerResponse)(new URL(Q,R),[Y[0],Y[1],Y[2],"refetch"],T.nextUrl,T.buildId),X.data.then(S=>{let[R,O]=S;if("string"==typeof R)return(0,L.handleExternalUrl)(T,W,R,T.pushRef.pendingPush);for(let S of(X.data=null,R)){if(3!==S.length)return console.log("REFRESH FAILED"),T;let[R]=S,U=(0,P.applyRouterStatePatchToTree)([""],Y,R);if(null===U)throw Error("SEGMENT MISMATCH");if((0,M.isNavigatingToNewRootLayout)(Y,U))return(0,L.handleExternalUrl)(T,W,Q,T.pushRef.pendingPush);let K=O?(0,N.createHrefFromUrl)(O):void 0;O&&(W.canonicalUrl=K);let[Z,ee]=S.slice(-2);if(null!==Z){let T=Z[2];X.status=V.CacheStates.READY,X.subTreeData=T,(0,$.fillLazyItemsTillLeafWithHead)(X,void 0,R,Z,ee),W.cache=X,W.prefetchCache=new Map}W.patchedTree=U,W.canonicalUrl=Q,Y=U}return(0,U.handleMutable)(T,W)},()=>T)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},68333:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"restoreReducer",{enumerable:!0,get:function(){return P}});let O=R(79286),N=R(21705);function P(T,S){var R;let{url:P,tree:M}=S,L=(0,O.createHrefFromUrl)(P);return{buildId:T.buildId,canonicalUrl:L,pushRef:{pendingPush:!1,mpaNavigation:!1,preserveCustomHistoryState:!0},focusAndScrollRef:T.focusAndScrollRef,cache:T.cache,prefetchCache:T.prefetchCache,tree:M,nextUrl:null!=(R=(0,N.extractPathFromFlightRouterState)(M))?R:P.pathname}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},97023:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"serverActionReducer",{enumerable:!0,get:function(){return et}});let O=R(2377),N=R(17328),P=R(50216),M=R(79286),L=R(48024),U=R(91155),V=R(83534),$=R(49236),K=R(18974),W=R(85601),Q=R(53579),Y=R(21705),{createFromFetch:X,encodeReply:Z}=R(49530);async function ee(T,S){let R,{actionId:M,actionArgs:L}=S,U=await Z(L),V=(0,Y.extractPathFromFlightRouterState)(T.tree),$=T.nextUrl&&T.nextUrl!==V,K=await fetch("",{method:"POST",headers:{Accept:N.RSC_CONTENT_TYPE_HEADER,[N.ACTION]:M,[N.NEXT_ROUTER_STATE_TREE]:encodeURIComponent(JSON.stringify(T.tree)),...$?{[N.NEXT_URL]:T.nextUrl}:{}},body:U}),W=K.headers.get("x-action-redirect");try{let T=JSON.parse(K.headers.get("x-action-revalidated")||"[[],0,0]");R={paths:T[0]||[],tag:!!T[1],cookie:T[2]}}catch(T){R={paths:[],tag:!1,cookie:!1}}let Q=W?new URL((0,P.addBasePath)(W),new URL(T.canonicalUrl,window.location.href)):void 0;if(K.headers.get("content-type")===N.RSC_CONTENT_TYPE_HEADER){let T=await X(Promise.resolve(K),{callServer:O.callServer});if(W){let[,S]=null!=T?T:[];return{actionFlightData:S,redirectLocation:Q,revalidatedParts:R}}let[S,[,N]]=null!=T?T:[];return{actionResult:S,actionFlightData:N,redirectLocation:Q,revalidatedParts:R}}return{redirectLocation:Q,revalidatedParts:R}}function et(T,S){let{resolve:R,reject:O}=S,N={},P=T.canonicalUrl,Y=T.tree;return N.preserveCustomHistoryState=!1,N.inFlightServerAction=ee(T,S),N.inFlightServerAction.then(S=>{let{actionResult:O,actionFlightData:X,redirectLocation:Z}=S;if(Z&&(T.pushRef.pendingPush=!0,N.pendingPush=!0),!X)return(N.actionResultResolved||(R(O),N.actionResultResolved=!0),Z)?(0,L.handleExternalUrl)(T,N,Z.href,T.pushRef.pendingPush):T;if("string"==typeof X)return(0,L.handleExternalUrl)(T,N,X,T.pushRef.pendingPush);for(let S of(N.inFlightServerAction=null,X)){if(3!==S.length)return console.log("SERVER ACTION APPLY FAILED"),T;let[R]=S,O=(0,U.applyRouterStatePatchToTree)([""],Y,R);if(null===O)throw Error("SEGMENT MISMATCH");if((0,V.isNavigatingToNewRootLayout)(Y,O))return(0,L.handleExternalUrl)(T,N,P,T.pushRef.pendingPush);let[M,K]=S.slice(-2),X=null!==M?M[2]:null;if(null!==X){let T=(0,Q.createEmptyCacheNode)();T.status=$.CacheStates.READY,T.subTreeData=X,(0,W.fillLazyItemsTillLeafWithHead)(T,void 0,R,M,K),N.cache=T,N.prefetchCache=new Map}N.patchedTree=O,N.canonicalUrl=P,Y=O}if(Z){let T=(0,M.createHrefFromUrl)(Z,!1);N.canonicalUrl=T}return N.actionResultResolved||(R(O),N.actionResultResolved=!0),(0,K.handleMutable)(T,N)},S=>{if("rejected"===S.status)return N.actionResultResolved||(O(S.reason),N.actionResultResolved=!0),T;throw S})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},80507:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"serverPatchReducer",{enumerable:!0,get:function(){return $}});let O=R(79286),N=R(91155),P=R(83534),M=R(48024),L=R(58994),U=R(18974),V=R(53579);function $(T,S){let{flightData:R,overrideCanonicalUrl:$}=S,K={};if(K.preserveCustomHistoryState=!1,"string"==typeof R)return(0,M.handleExternalUrl)(T,K,R,T.pushRef.pendingPush);let W=T.tree,Q=T.cache;for(let S of R){let R=S.slice(0,-4),[U]=S.slice(-3,-2),Y=(0,N.applyRouterStatePatchToTree)(["",...R],W,U);if(null===Y)throw Error("SEGMENT MISMATCH");if((0,P.isNavigatingToNewRootLayout)(W,Y))return(0,M.handleExternalUrl)(T,K,T.canonicalUrl,T.pushRef.pendingPush);let X=$?(0,O.createHrefFromUrl)($):void 0;X&&(K.canonicalUrl=X);let Z=(0,V.createEmptyCacheNode)();(0,L.applyFlightData)(Q,Z,S),K.patchedTree=Y,K.cache=Z,Q=Z,W=Y}return(0,U.handleMutable)(T,K)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},52247:(T,S)=>{"use strict";var R;Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{PrefetchKind:function(){return R},ACTION_REFRESH:function(){return O},ACTION_NAVIGATE:function(){return N},ACTION_RESTORE:function(){return P},ACTION_SERVER_PATCH:function(){return M},ACTION_PREFETCH:function(){return L},ACTION_FAST_REFRESH:function(){return U},ACTION_SERVER_ACTION:function(){return V},isThenable:function(){return $}});let O="refresh",N="navigate",P="restore",M="server-patch",L="prefetch",U="fast-refresh",V="server-action";function $(T){return T&&("object"==typeof T||"function"==typeof T)&&"function"==typeof T.then}(function(T){T.AUTO="auto",T.FULL="full",T.TEMPORARY="temporary"})(R||(R={})),("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},9474:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"reducer",{enumerable:!0,get:function(){return O}}),R(52247),R(48024),R(80507),R(68333),R(28929),R(37003),R(92877),R(97023);let O=function(T,S){return T};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},91151:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"shouldHardNavigate",{enumerable:!0,get:function(){return N}});let O=R(70765);function N(T,S){let[R,P]=S,[M,L]=T;return(0,O.matchSegment)(M,R)?!(T.length<=2)&&N(T.slice(2),P[L]):!!Array.isArray(M)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},95318:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createSearchParamsBailoutProxy",{enumerable:!0,get:function(){return N}});let O=R(28608);function N(){return new Proxy({},{get(T,S){"string"==typeof S&&(0,O.staticGenerationBailout)("searchParams."+S)}})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},28608:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"staticGenerationBailout",{enumerable:!0,get:function(){return L}});let O=R(95432),N=R(94749);class P extends Error{constructor(...T){super(...T),this.code="NEXT_STATIC_GEN_BAILOUT"}}function M(T,S){let{dynamic:R,link:O}=S||{};return"Page"+(R?' with `dynamic = "'+R+'"`':"")+" couldn't be rendered statically because it used `"+T+"`."+(O?" See more info here: "+O:"")}let L=(T,S)=>{let{dynamic:R,link:L}=void 0===S?{}:S,U=N.staticGenerationAsyncStorage.getStore();if(!U)return!1;if(U.forceStatic)return!0;if(U.dynamicShouldError)throw new P(M(T,{link:L,dynamic:null!=R?R:"error"}));let V=M(T,{dynamic:R,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if(null==U.postpone||U.postpone.call(U,T),U.revalidate=0,U.isStaticGeneration){let S=new O.DynamicServerError(V);throw U.dynamicUsageDescription=T,U.dynamicUsageStack=S.stack,S}return!1};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},57303:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return P}});let O=R(10143)._(R(34218)),N=R(95318);function P(T){let{Component:S,propsForComponent:R,isStaticGeneration:P}=T;if(P){let T=(0,N.createSearchParamsBailoutProxy)();return O.default.createElement(S,{searchParams:T,...R})}return O.default.createElement(S,R)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},56320:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{useUnwrapState:function(){return M},useReducerWithReduxDevtools:function(){return L}});let O=R(42212)._(R(34218)),N=R(52247);function P(T){if(T instanceof Map){let S={};for(let[R,O]of T.entries()){if("function"==typeof O){S[R]="fn()";continue}if("object"==typeof O&&null!==O){if(O.$$typeof){S[R]=O.$$typeof.toString();continue}if(O._bundlerConfig){S[R]="FlightData";continue}}S[R]=P(O)}return S}if("object"==typeof T&&null!==T){let S={};for(let R in T){let O=T[R];if("function"==typeof O){S[R]="fn()";continue}if("object"==typeof O&&null!==O){if(O.$$typeof){S[R]=O.$$typeof.toString();continue}if(O.hasOwnProperty("_bundlerConfig")){S[R]="FlightData";continue}}S[R]=P(O)}return S}return Array.isArray(T)?T.map(P):T}function M(T){return(0,N.isThenable)(T)?(0,O.use)(T):T}R(67485);let L=function(T){return[T,()=>{},()=>{}]};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},68423:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"hasBasePath",{enumerable:!0,get:function(){return P}});let O=R(98869),N="";function P(T){return(0,O.pathHasPrefix)(T,N)}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},92038:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"normalizePathTrailingSlash",{enumerable:!0,get:function(){return P}});let O=R(64538),N=R(81242),P=T=>{if(!T.startsWith("/"))return T;let{pathname:S,query:R,hash:P}=(0,N.parsePath)(T);return""+(0,O.removeTrailingSlash)(S)+R+P};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},81151:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"removeBasePath",{enumerable:!0,get:function(){return N}}),R(68423);let O="";function N(T){return 0===O.length||(T=T.slice(O.length)).startsWith("/")||(T="/"+T),T}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},70799:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"getSegmentParam",{enumerable:!0,get:function(){return N}});let O=R(45513);function N(T){let S=O.INTERCEPTION_ROUTE_MARKERS.find(S=>T.startsWith(S));return(S&&(T=T.slice(S.length)),T.startsWith("[[...")&&T.endsWith("]]"))?{type:"optional-catchall",param:T.slice(5,-2)}:T.startsWith("[...")&&T.endsWith("]")?{type:"catchall",param:T.slice(4,-1)}:T.startsWith("[")&&T.endsWith("]")?{type:"dynamic",param:T.slice(1,-1)}:null}},45513:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{INTERCEPTION_ROUTE_MARKERS:function(){return N},isInterceptionRouteAppPath:function(){return P},extractInterceptionRouteInformation:function(){return M}});let O=R(91356),N=["(..)(..)","(.)","(..)","(...)"];function P(T){return void 0!==T.split("/").find(T=>N.find(S=>T.startsWith(S)))}function M(T){let S,R,P;for(let O of T.split("/"))if(R=N.find(T=>O.startsWith(T))){[S,P]=T.split(R,2);break}if(!S||!R||!P)throw Error(`Invalid interception route: ${T}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`);switch(S=(0,O.normalizeAppPath)(S),R){case"(.)":P="/"===S?`/${P}`:S+"/"+P;break;case"(..)":if("/"===S)throw Error(`Invalid interception route: ${T}. Cannot use (..) marker at the root level, use (.) instead.`);P=S.split("/").slice(0,-1).concat(P).join("/");break;case"(...)":P="/"+P;break;case"(..)(..)":let M=S.split("/");if(M.length<=2)throw Error(`Invalid interception route: ${T}. Cannot use (..)(..) marker at the root level or one level up.`);P=M.slice(0,-2).concat(P).join("/");break;default:throw Error("Invariant: unexpected marker")}return{interceptingRoute:S,interceptedRoute:P}}},62337:(T,S,R)=>{"use strict";T.exports=R(20399)},49236:(T,S,R)=>{"use strict";T.exports=R(62337).vendored.contexts.AppRouterContext},75075:(T,S,R)=>{"use strict";T.exports=R(62337).vendored.contexts.HooksClientContext},35853:(T,S,R)=>{"use strict";T.exports=R(62337).vendored.contexts.ServerInsertedHtml},73638:(T,S,R)=>{"use strict";T.exports=R(62337).vendored["react-ssr"].ReactDOM},53854:(T,S,R)=>{"use strict";T.exports=R(62337).vendored["react-ssr"].ReactJsxRuntime},49530:(T,S,R)=>{"use strict";T.exports=R(62337).vendored["react-ssr"].ReactServerDOMWebpackClientEdge},34218:(T,S,R)=>{"use strict";T.exports=R(62337).vendored["react-ssr"].React},32948:(T,S)=>{"use strict";function R(T){let S=5381;for(let R=0;R<T.length;R++)S=(S<<5)+S+T.charCodeAt(R)&4294967295;return S>>>0}function O(T){return R(T).toString(36).slice(0,5)}Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{djb2Hash:function(){return R},hexHash:function(){return O}})},95158:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{NEXT_DYNAMIC_NO_SSR_CODE:function(){return R},throwWithNoSSR:function(){return O}});let R="NEXT_DYNAMIC_NO_SSR_CODE";function O(){let T=Error(R);throw T.digest=R,T}},8755:(T,S)=>{"use strict";function R(T){return T.startsWith("/")?T:"/"+T}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"ensureLeadingSlash",{enumerable:!0,get:function(){return R}})},67485:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{ActionQueueContext:function(){return L},createMutableActionQueue:function(){return K}});let O=R(42212),N=R(52247),P=R(9474),M=O._(R(34218)),L=M.default.createContext(null);function U(T,S){null!==T.pending&&(T.pending=T.pending.next,null!==T.pending&&V({actionQueue:T,action:T.pending,setState:S}))}async function V(T){let{actionQueue:S,action:R,setState:O}=T,P=S.state;if(!P)throw Error("Invariant: Router state not initialized");S.pending=R;let M=R.payload,L=S.action(P,M);function V(T){if(R.discarded){S.needsRefresh&&null===S.pending&&(S.needsRefresh=!1,S.dispatch({type:N.ACTION_REFRESH,origin:window.location.origin},O));return}S.state=T,S.devToolsInstance&&S.devToolsInstance.send(M,T),U(S,O),R.resolve(T)}(0,N.isThenable)(L)?L.then(V,T=>{U(S,O),R.reject(T)}):V(L)}function $(T,S,R){let O={resolve:R,reject:()=>{}};if(S.type!==N.ACTION_RESTORE){let T=new Promise((T,S)=>{O={resolve:T,reject:S}});(0,M.startTransition)(()=>{R(T)})}let P={payload:S,next:null,resolve:O.resolve,reject:O.reject};null===T.pending?(T.last=P,V({actionQueue:T,action:P,setState:R})):S.type===N.ACTION_NAVIGATE?(T.pending.discarded=!0,T.last=P,T.pending.payload.type===N.ACTION_SERVER_ACTION&&(T.needsRefresh=!0),V({actionQueue:T,action:P,setState:R})):(null!==T.last&&(T.last.next=P),T.last=P)}function K(){let T={state:null,dispatch:(S,R)=>$(T,S,R),action:async(T,S)=>{if(null===T)throw Error("Invariant: Router state not initialized");return(0,P.reducer)(T,S)},pending:null,last:null};return T}},61124:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"addPathPrefix",{enumerable:!0,get:function(){return N}});let O=R(81242);function N(T,S){if(!T.startsWith("/")||!S)return T;let{pathname:R,query:N,hash:P}=(0,O.parsePath)(T);return""+S+R+N+P}},91356:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{normalizeAppPath:function(){return P},normalizeRscURL:function(){return M}});let O=R(8755),N=R(41516);function P(T){return(0,O.ensureLeadingSlash)(T.split("/").reduce((T,S,R,O)=>!S||(0,N.isGroupSegment)(S)||"@"===S[0]||("page"===S||"route"===S)&&R===O.length-1?T:T+"/"+S,""))}function M(T){return T.replace(/\.rsc($|\?)/,"$1")}},15244:(T,S)=>{"use strict";function R(T,S){if(void 0===S&&(S={}),S.onlyHashChange){T();return}let R=document.documentElement,O=R.style.scrollBehavior;R.style.scrollBehavior="auto",S.dontForceLayout||R.getClientRects(),T(),R.style.scrollBehavior=O}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"handleSmoothScroll",{enumerable:!0,get:function(){return R}})},99415:(T,S)=>{"use strict";function R(T){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(T)}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"isBot",{enumerable:!0,get:function(){return R}})},81242:(T,S)=>{"use strict";function R(T){let S=T.indexOf("#"),R=T.indexOf("?"),O=R>-1&&(S<0||R<S);return O||S>-1?{pathname:T.substring(0,O?R:S),query:O?T.substring(R,S>-1?S:void 0):"",hash:S>-1?T.slice(S):""}:{pathname:T,query:"",hash:""}}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"parsePath",{enumerable:!0,get:function(){return R}})},98869:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"pathHasPrefix",{enumerable:!0,get:function(){return N}});let O=R(81242);function N(T,S){if("string"!=typeof T)return!1;let{pathname:R}=(0,O.parsePath)(T);return R===S||R.startsWith(S+"/")}},64538:(T,S)=>{"use strict";function R(T){return T.replace(/\/$/,"")||"/"}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"removeTrailingSlash",{enumerable:!0,get:function(){return R}})},41516:(T,S)=>{"use strict";function R(T){return"("===T[0]&&T.endsWith(")")}Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"isGroupSegment",{enumerable:!0,get:function(){return R}})},65062:(T,S,R)=>{"use strict";var O=R(17682);T.exports=S=O.descriptor=O.Root.fromJSON(R(89987)).lookup(".google.protobuf");var N=O.Namespace,P=O.Root,M=O.Enum,L=O.Type,U=O.Field,V=O.MapField,$=O.OneOf,K=O.Service,W=O.Method;function Q(T,R,O){var V=S.FileDescriptorProto.create({name:T.filename||(T.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});ep(O,V),T instanceof P||(V.package=T.fullName.substring(1));for(var $,W=0;W<T.nestedArray.length;++W)($=T._nestedArray[W])instanceof L?V.messageType.push($.toDescriptor(O)):$ instanceof M?V.enumType.push($.toDescriptor()):$ instanceof U?V.extension.push($.toDescriptor(O)):$ instanceof K?V.service.push($.toDescriptor()):$ instanceof N&&Q($,R,O);V.options=ec(T.options,S.FileOptions),V.messageType.length+V.enumType.length+V.extension.length+V.service.length&&R.push(V)}P.fromDescriptor=function(T){"number"==typeof T.length&&(T=S.FileDescriptorSet.decode(T));var R=new P;if(T.file)for(var O,N,V,$=0;$<T.file.length;++$){N=R,(O=T.file[$]).package&&O.package.length&&(N=R.define(O.package));var W=ef(O);if(O.name&&O.name.length&&R.files.push(N.filename=O.name),O.messageType)for(V=0;V<O.messageType.length;++V)N.add(L.fromDescriptor(O.messageType[V],W));if(O.enumType)for(V=0;V<O.enumType.length;++V)N.add(M.fromDescriptor(O.enumType[V],W));if(O.extension)for(V=0;V<O.extension.length;++V)N.add(U.fromDescriptor(O.extension[V],W));if(O.service)for(V=0;V<O.service.length;++V)N.add(K.fromDescriptor(O.service[V],W));var Q=eo(O.options,S.FileOptions);if(Q){var Y=Object.keys(Q);for(V=0;V<Y.length;++V)N.setOption(Y[V],Q[Y[V]])}}return R.resolveAll()},P.prototype.toDescriptor=function(T){var R=S.FileDescriptorSet.create();return Q(this,R.file,T),R};var Y=0;L.fromDescriptor=function(T,R,O){"number"==typeof T.length&&(T=S.DescriptorProto.decode(T));var N,P=new L(T.name.length?T.name:"Type"+Y++,eo(T.options,S.MessageOptions));if(O||(P._edition=R),T.oneofDecl)for(N=0;N<T.oneofDecl.length;++N)P.add($.fromDescriptor(T.oneofDecl[N]));if(T.field)for(N=0;N<T.field.length;++N){var V=U.fromDescriptor(T.field[N],R,!0);P.add(V),T.field[N].hasOwnProperty("oneofIndex")&&P.oneofsArray[T.field[N].oneofIndex].add(V)}if(T.extension)for(N=0;N<T.extension.length;++N)P.add(U.fromDescriptor(T.extension[N],R,!0));if(T.nestedType)for(N=0;N<T.nestedType.length;++N)P.add(L.fromDescriptor(T.nestedType[N],R,!0)),T.nestedType[N].options&&T.nestedType[N].options.mapEntry&&P.setOption("map_entry",!0);if(T.enumType)for(N=0;N<T.enumType.length;++N)P.add(M.fromDescriptor(T.enumType[N],R,!0));if(T.extensionRange&&T.extensionRange.length)for(N=0,P.extensions=[];N<T.extensionRange.length;++N)P.extensions.push([T.extensionRange[N].start,T.extensionRange[N].end]);if(T.reservedRange&&T.reservedRange.length||T.reservedName&&T.reservedName.length){if(P.reserved=[],T.reservedRange)for(N=0;N<T.reservedRange.length;++N)P.reserved.push([T.reservedRange[N].start,T.reservedRange[N].end]);if(T.reservedName)for(N=0;N<T.reservedName.length;++N)P.reserved.push(T.reservedName[N])}return P},L.prototype.toDescriptor=function(T){var R,O,N=S.DescriptorProto.create({name:this.name});for(O=0;O<this.fieldsArray.length;++O)if(N.field.push(R=this._fieldsArray[O].toDescriptor(T)),this._fieldsArray[O]instanceof V){var P=es(this._fieldsArray[O].keyType,this._fieldsArray[O].resolvedKeyType,!1),$=es(this._fieldsArray[O].type,this._fieldsArray[O].resolvedType,!1),K=11===$||14===$?this._fieldsArray[O].resolvedType&&ed(this.parent,this._fieldsArray[O].resolvedType)||this._fieldsArray[O].type:void 0;N.nestedType.push(S.DescriptorProto.create({name:R.typeName,field:[S.FieldDescriptorProto.create({name:"key",number:1,label:1,type:P}),S.FieldDescriptorProto.create({name:"value",number:2,label:1,type:$,typeName:K})],options:S.MessageOptions.create({mapEntry:!0})}))}for(O=0;O<this.oneofsArray.length;++O)N.oneofDecl.push(this._oneofsArray[O].toDescriptor());for(O=0;O<this.nestedArray.length;++O)this._nestedArray[O]instanceof U?N.field.push(this._nestedArray[O].toDescriptor(T)):this._nestedArray[O]instanceof L?N.nestedType.push(this._nestedArray[O].toDescriptor(T)):this._nestedArray[O]instanceof M&&N.enumType.push(this._nestedArray[O].toDescriptor());if(this.extensions)for(O=0;O<this.extensions.length;++O)N.extensionRange.push(S.DescriptorProto.ExtensionRange.create({start:this.extensions[O][0],end:this.extensions[O][1]}));if(this.reserved)for(O=0;O<this.reserved.length;++O)"string"==typeof this.reserved[O]?N.reservedName.push(this.reserved[O]):N.reservedRange.push(S.DescriptorProto.ReservedRange.create({start:this.reserved[O][0],end:this.reserved[O][1]}));return N.options=ec(this.options,S.MessageOptions),N};var X=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;U.fromDescriptor=function(T,R,O){if("number"==typeof T.length&&(T=S.DescriptorProto.decode(T)),"number"!=typeof T.number)throw Error("missing field id");switch(N=T.typeName&&T.typeName.length?T.typeName:en(T.type),T.label){case 1:P=void 0;break;case 2:P="required";break;case 3:P="repeated";break;default:throw Error("illegal label: "+T.label)}var N,P,M=T.extendee;void 0!==T.extendee&&(M=M.length?M:void 0);var L=new U(T.name.length?T.name:"field"+T.number,T.number,N,P,M);if(O||(L._edition=R),L.options=eo(T.options,S.FieldOptions),T.proto3_optional&&(L.options.proto3_optional=!0),T.defaultValue&&T.defaultValue.length){var V=T.defaultValue;switch(V){case"true":case"TRUE":V=!0;break;case"false":case"FALSE":V=!1;break;default:X.exec(V)&&(V=parseInt(V))}L.setOption("default",V)}return ei(T.type)&&("proto3"===R?T.options&&!T.options.packed&&L.setOption("packed",!1):(!R||"proto2"===R)&&T.options&&T.options.packed&&L.setOption("packed",!0)),L},U.prototype.toDescriptor=function(T){var R=S.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)R.type=11,R.typeName=O.util.ucFirst(this.name),R.label=3;else{switch(R.type=es(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:R.typeName=this.resolvedType?ed(this.parent,this.resolvedType):this.type}"repeated"===this.rule?R.label=3:this.required&&"proto2"===T?R.label=2:R.label=1}if(R.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(R.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(R.options=ec(this.options,S.FieldOptions),null!=this.options.default&&(R.defaultValue=String(this.options.default)),this.options.proto3_optional&&(R.proto3_optional=!0)),"proto3"===T?this.packed||((R.options||(R.options=S.FieldOptions.create())).packed=!1):(!T||"proto2"===T)&&this.packed&&((R.options||(R.options=S.FieldOptions.create())).packed=!0),R};var Z=0;M.fromDescriptor=function(T,R,O){"number"==typeof T.length&&(T=S.EnumDescriptorProto.decode(T));var N={};if(T.value)for(var P=0;P<T.value.length;++P){var L=T.value[P].name,U=T.value[P].number||0;N[L&&L.length?L:"NAME"+U]=U}var V=new M(T.name&&T.name.length?T.name:"Enum"+Z++,N,eo(T.options,S.EnumOptions));return O||(V._edition=R),V},M.prototype.toDescriptor=function(){for(var T=[],R=0,O=Object.keys(this.values);R<O.length;++R)T.push(S.EnumValueDescriptorProto.create({name:O[R],number:this.values[O[R]]}));return S.EnumDescriptorProto.create({name:this.name,value:T,options:ec(this.options,S.EnumOptions)})};var ee=0;$.fromDescriptor=function(T){return"number"==typeof T.length&&(T=S.OneofDescriptorProto.decode(T)),new $(T.name&&T.name.length?T.name:"oneof"+ee++)},$.prototype.toDescriptor=function(){return S.OneofDescriptorProto.create({name:this.name})};var et=0;K.fromDescriptor=function(T,R,O){"number"==typeof T.length&&(T=S.ServiceDescriptorProto.decode(T));var N=new K(T.name&&T.name.length?T.name:"Service"+et++,eo(T.options,S.ServiceOptions));if(O||(N._edition=R),T.method)for(var P=0;P<T.method.length;++P)N.add(W.fromDescriptor(T.method[P]));return N},K.prototype.toDescriptor=function(){for(var T=[],R=0;R<this.methodsArray.length;++R)T.push(this._methodsArray[R].toDescriptor());return S.ServiceDescriptorProto.create({name:this.name,method:T,options:ec(this.options,S.ServiceOptions)})};var er=0;function en(T){switch(T){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+T)}function ei(T){switch(T){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function es(T,S,R){switch(T){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(S instanceof M)return 14;if(S instanceof L)return R?10:11;throw Error("illegal type: "+T)}function ea(T,S){for(var R,O,N={},P=0;P<S.fieldsArray.length;++P)if("uninterpretedOption"!==(O=(R=S._fieldsArray[P]).name)&&Object.prototype.hasOwnProperty.call(T,O)){var U=eh(O);R.resolvedType instanceof L?N[U]=ea(T[O],R.resolvedType):R.resolvedType instanceof M?N[U]=R.resolvedType.valuesById[T[O]]:N[U]=T[O]}return N}function eo(T,S){if(T)return ea(S.toObject(T),S)}function eu(T,S){for(var R={},N=Object.keys(T),P=0;P<N.length;++P){var M=N[P],U=O.util.camelCase(M);if(Object.prototype.hasOwnProperty.call(S.fields,U)){var V=S.fields[U];V.resolvedType instanceof L?R[U]=eu(T[M],V.resolvedType):R[U]=T[M],V.repeated&&!Array.isArray(R[U])&&(R[U]=[R[U]])}}return R}function ec(T,S){if(T)return S.fromObject(eu(T,S))}function ed(T,S){var R=T.fullName.split("."),O=S.fullName.split("."),M=0,L=0,U=O.length-1;if(!(T instanceof P)&&S instanceof N)for(;M<R.length&&L<U&&R[M]===O[L];){var V=S.lookup(R[M++],!0);if(null!==V&&V!==S)break;++L}else for(;M<R.length&&L<U&&R[M]===O[L];++M,++L);return O.slice(L).join(".")}function eh(T){return T.substring(0,1)+T.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(T,S){return"_"+S.toLowerCase()})}function ef(T){if("editions"===T.syntax){if(T.edition===S.Edition.EDITION_2023)return"2023";throw Error("Unsupported edition "+T.edition)}return"proto3"===T.syntax?"proto3":"proto2"}function ep(T,R){if(T){if("proto2"===T||"proto3"===T)R.syntax=T;else if(R.syntax="editions","2023"===T)R.edition=S.Edition.EDITION_2023;else throw Error("Unsupported edition "+T)}}W.fromDescriptor=function(T){return"number"==typeof T.length&&(T=S.MethodDescriptorProto.decode(T)),new W(T.name&&T.name.length?T.name:"Method"+er++,"rpc",T.inputType,T.outputType,!!T.clientStreaming,!!T.serverStreaming,eo(T.options,S.MethodOptions))},W.prototype.toDescriptor=function(){return S.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:ec(this.options,S.MethodOptions)})}},17682:(T,S,R)=>{"use strict";T.exports=R(50778)},6605:T=>{"use strict";T.exports=O;var S,R=/\/|\./;function O(T,S){R.test(T)||(T="google/protobuf/"+T+".proto",S={nested:{google:{nested:{protobuf:{nested:S}}}}}),O[T]=S}O("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),O("duration",{Duration:S={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),O("timestamp",{Timestamp:S}),O("empty",{Empty:{fields:{}}}),O("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),O("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),O("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),O.get=function(T){return O[T]||null}},38031:(T,S,R)=>{"use strict";var O=S,N=R(45688),P=R(64332);function M(T,S,R,O){var P=!1;if(S.resolvedType){if(S.resolvedType instanceof N){T("switch(d%s){",O);for(var M=S.resolvedType.values,L=Object.keys(M),U=0;U<L.length;++U)M[L[U]]!==S.typeDefault||P||(T("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',O,O,O),S.repeated||T("break"),P=!0),T("case%j:",L[U])("case %i:",M[L[U]])("m%s=%j",O,M[L[U]])("break");T("}")}else T('if(typeof d%s!=="object")',O)("throw TypeError(%j)",S.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",O,R,O)}else{var V=!1;switch(S.type){case"double":case"float":T("m%s=Number(d%s)",O,O);break;case"uint32":case"fixed32":T("m%s=d%s>>>0",O,O);break;case"int32":case"sint32":case"sfixed32":T("m%s=d%s|0",O,O);break;case"uint64":V=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":T("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",O,O,V)('else if(typeof d%s==="string")',O)("m%s=parseInt(d%s,10)",O,O)('else if(typeof d%s==="number")',O)("m%s=d%s",O,O)('else if(typeof d%s==="object")',O)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",O,O,O,V?"true":"");break;case"bytes":T('if(typeof d%s==="string")',O)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",O,O,O)("else if(d%s.length >= 0)",O)("m%s=d%s",O,O);break;case"string":T("m%s=String(d%s)",O,O);break;case"bool":T("m%s=Boolean(d%s)",O,O)}}return T}function L(T,S,R,O){if(S.resolvedType)S.resolvedType instanceof N?T("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",O,R,O,O,R,O,O):T("d%s=types[%i].toObject(m%s,o)",O,R,O);else{var P=!1;switch(S.type){case"double":case"float":T("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",O,O,O,O);break;case"uint64":P=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":T('if(typeof m%s==="number")',O)("d%s=o.longs===String?String(m%s):m%s",O,O,O)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",O,O,O,O,P?"true":"",O);break;case"bytes":T("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",O,O,O,O,O);break;default:T("d%s=m%s",O,O)}}return T}O.fromObject=function(T){var S=T.fieldsArray,R=P.codegen(["d"],T.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!S.length)return R("return new this.ctor");R("var m=new this.ctor");for(var O=0;O<S.length;++O){var L=S[O].resolve(),U=P.safeProp(L.name);L.map?(R("if(d%s){",U)('if(typeof d%s!=="object")',U)("throw TypeError(%j)",L.fullName+": object expected")("m%s={}",U)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",U),M(R,L,O,U+"[ks[i]]")("}")("}")):L.repeated?(R("if(d%s){",U)("if(!Array.isArray(d%s))",U)("throw TypeError(%j)",L.fullName+": array expected")("m%s=[]",U)("for(var i=0;i<d%s.length;++i){",U),M(R,L,O,U+"[i]")("}")("}")):(L.resolvedType instanceof N||R("if(d%s!=null){",U),M(R,L,O,U),L.resolvedType instanceof N||R("}"))}return R("return m")},O.toObject=function(T){var S=T.fieldsArray.slice().sort(P.compareFieldsById);if(!S.length)return P.codegen()("return {}");for(var R=P.codegen(["m","o"],T.name+"$toObject")("if(!o)")("o={}")("var d={}"),O=[],M=[],U=[],V=0;V<S.length;++V)S[V].partOf||(S[V].resolve().repeated?O:S[V].map?M:U).push(S[V]);if(O.length){for(R("if(o.arrays||o.defaults){"),V=0;V<O.length;++V)R("d%s=[]",P.safeProp(O[V].name));R("}")}if(M.length){for(R("if(o.objects||o.defaults){"),V=0;V<M.length;++V)R("d%s={}",P.safeProp(M[V].name));R("}")}if(U.length){for(R("if(o.defaults){"),V=0;V<U.length;++V){var $=U[V],K=P.safeProp($.name);if($.resolvedType instanceof N)R("d%s=o.enums===String?%j:%j",K,$.resolvedType.valuesById[$.typeDefault],$.typeDefault);else if($.long)R("if(util.Long){")("var n=new util.Long(%i,%i,%j)",$.typeDefault.low,$.typeDefault.high,$.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",K)("}else")("d%s=o.longs===String?%j:%i",K,$.typeDefault.toString(),$.typeDefault.toNumber());else if($.bytes){var W="["+Array.prototype.slice.call($.typeDefault).join(",")+"]";R("if(o.bytes===String)d%s=%j",K,String.fromCharCode.apply(String,$.typeDefault))("else{")("d%s=%s",K,W)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",K,K)("}")}else R("d%s=%j",K,$.typeDefault)}R("}")}var Q=!1;for(V=0;V<S.length;++V){var $=S[V],Y=T._fieldsArray.indexOf($),K=P.safeProp($.name);$.map?(Q||(Q=!0,R("var ks2")),R("if(m%s&&(ks2=Object.keys(m%s)).length){",K,K)("d%s={}",K)("for(var j=0;j<ks2.length;++j){"),L(R,$,Y,K+"[ks2[j]]")("}")):$.repeated?(R("if(m%s&&m%s.length){",K,K)("d%s=[]",K)("for(var j=0;j<m%s.length;++j){",K),L(R,$,Y,K+"[j]")("}")):(R("if(m%s!=null&&m.hasOwnProperty(%j)){",K,$.name),L(R,$,Y,K),$.partOf&&R("if(o.oneofs)")("d%s=%j",P.safeProp($.partOf.name),$.name)),R("}")}return R("return d")}},94137:(T,S,R)=>{"use strict";T.exports=L;var O=R(45688),N=R(20889),P=R(64332);function M(T){return"missing required '"+T.name+"'"}function L(T){for(var S=P.codegen(["r","l","e"],T.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(T.fieldsArray.filter(function(T){return T.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),R=0;R<T.fieldsArray.length;++R){var L=T._fieldsArray[R].resolve(),U=L.resolvedType instanceof O?"int32":L.type,V="m"+P.safeProp(L.name);S("case %i: {",L.id),L.map?(S("if(%s===util.emptyObject)",V)("%s={}",V)("var c2 = r.uint32()+r.pos"),void 0!==N.defaults[L.keyType]?S("k=%j",N.defaults[L.keyType]):S("k=null"),void 0!==N.defaults[U]?S("value=%j",N.defaults[U]):S("value=null"),S("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",L.keyType)("case 2:"),void 0===N.basic[U]?S("value=types[%i].decode(r,r.uint32())",R):S("value=r.%s()",U),S("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),S(void 0!==N.long[L.keyType]?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",V)):L.repeated?(S("if(!(%s&&%s.length))",V,V)("%s=[]",V),void 0!==N.packed[U]&&S("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",V,U)("}else"),void 0===N.basic[U]?S(L.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",V,R):S("%s.push(r.%s())",V,U)):void 0===N.basic[U]?S(L.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",V,R):S("%s=r.%s()",V,U),S("break")("}")}for(S("default:")("r.skipType(t&7)")("break")("}")("}"),R=0;R<T._fieldsArray.length;++R){var $=T._fieldsArray[R];$.required&&S("if(!m.hasOwnProperty(%j))",$.name)("throw util.ProtocolError(%j,{instance:m})",M($))}return S("return m")}},25142:(T,S,R)=>{"use strict";T.exports=L;var O=R(45688),N=R(20889),P=R(64332);function M(T,S,R,O){return S.delimited?T("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",R,O,(S.id<<3|3)>>>0,(S.id<<3|4)>>>0):T("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",R,O,(S.id<<3|2)>>>0)}function L(T){for(var S,R,L=P.codegen(["m","w"],T.name+"$encode")("if(!w)")("w=Writer.create()"),U=T.fieldsArray.slice().sort(P.compareFieldsById),S=0;S<U.length;++S){var V=U[S].resolve(),$=T._fieldsArray.indexOf(V),K=V.resolvedType instanceof O?"int32":V.type,W=N.basic[K];R="m"+P.safeProp(V.name),V.map?(L("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",R,V.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",R)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(V.id<<3|2)>>>0,8|N.mapKey[V.keyType],V.keyType),void 0===W?L("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",$,R):L(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|W,K,R),L("}")("}")):V.repeated?(L("if(%s!=null&&%s.length){",R,R),V.packed&&void 0!==N.packed[K]?L("w.uint32(%i).fork()",(V.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",R)("w.%s(%s[i])",K,R)("w.ldelim()"):(L("for(var i=0;i<%s.length;++i)",R),void 0===W?M(L,V,$,R+"[i]"):L("w.uint32(%i).%s(%s[i])",(V.id<<3|W)>>>0,K,R)),L("}")):(V.optional&&L("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",R,V.name),void 0===W?M(L,V,$,R):L("w.uint32(%i).%s(%s)",(V.id<<3|W)>>>0,K,R))}return L("return w")}},45688:(T,S,R)=>{"use strict";T.exports=M;var O=R(27813);((M.prototype=Object.create(O.prototype)).constructor=M).className="Enum";var N=R(81456),P=R(64332);function M(T,S,R,N,P,M){if(O.call(this,T,R),S&&"object"!=typeof S)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=N,this.comments=P||{},this.valuesOptions=M,this._valuesFeatures={},this.reserved=void 0,S)for(var L=Object.keys(S),U=0;U<L.length;++U)"number"==typeof S[L[U]]&&(this.valuesById[this.values[L[U]]=S[L[U]]]=L[U])}M.prototype._resolveFeatures=function(T){return T=this._edition||T,O.prototype._resolveFeatures.call(this,T),Object.keys(this.values).forEach(T=>{var S=Object.assign({},this._features);this._valuesFeatures[T]=Object.assign(S,this.valuesOptions&&this.valuesOptions[T]&&this.valuesOptions[T].features)}),this},M.fromJSON=function(T,S){var R=new M(T,S.values,S.options,S.comment,S.comments);return R.reserved=S.reserved,S.edition&&(R._edition=S.edition),R._defaultEdition="proto3",R},M.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return P.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",S?this.comment:void 0,"comments",S?this.comments:void 0])},M.prototype.add=function(T,S,R,O){if(!P.isString(T))throw TypeError("name must be a string");if(!P.isInteger(S))throw TypeError("id must be an integer");if(void 0!==this.values[T])throw Error("duplicate name '"+T+"' in "+this);if(this.isReservedId(S))throw Error("id "+S+" is reserved in "+this);if(this.isReservedName(T))throw Error("name '"+T+"' is reserved in "+this);if(void 0!==this.valuesById[S]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+S+" in "+this);this.values[T]=S}else this.valuesById[this.values[T]=S]=T;return O&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[T]=O||null),this.comments[T]=R||null,this},M.prototype.remove=function(T){if(!P.isString(T))throw TypeError("name must be a string");var S=this.values[T];if(null==S)throw Error("name '"+T+"' does not exist in "+this);return delete this.valuesById[S],delete this.values[T],delete this.comments[T],this.valuesOptions&&delete this.valuesOptions[T],this},M.prototype.isReservedId=function(T){return N.isReservedId(this.reserved,T)},M.prototype.isReservedName=function(T){return N.isReservedName(this.reserved,T)}},82565:(T,S,R)=>{"use strict";T.exports=V;var O,N=R(27813);((V.prototype=Object.create(N.prototype)).constructor=V).className="Field";var P=R(45688),M=R(20889),L=R(64332),U=/^required|optional|repeated$/;function V(T,S,R,O,P,V,$){if(L.isObject(O)?($=P,V=O,O=P=void 0):L.isObject(P)&&($=V,V=P,P=void 0),N.call(this,T,V),!L.isInteger(S)||S<0)throw TypeError("id must be a non-negative integer");if(!L.isString(R))throw TypeError("type must be a string");if(void 0!==O&&!U.test(O=O.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==P&&!L.isString(P))throw TypeError("extend must be a string");"proto3_optional"===O&&(O="optional"),this.rule=O&&"optional"!==O?O:void 0,this.type=R,this.id=S,this.extend=P||void 0,this.repeated="repeated"===O,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!L.Long&&void 0!==M.long[R],this.bytes="bytes"===R,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=$}V.fromJSON=function(T,S){var R=new V(T,S.id,S.type,S.rule,S.extend,S.options,S.comment);return S.edition&&(R._edition=S.edition),R._defaultEdition="proto3",R},Object.defineProperty(V.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(V.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(V.prototype,"delimited",{get:function(){return this.resolvedType instanceof O&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(V.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(V.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),V.prototype.setOption=function(T,S,R){return N.prototype.setOption.call(this,T,S,R)},V.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return L.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",S?this.comment:void 0])},V.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=M.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof O?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof P&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof P||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=L.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var T;L.base64.test(this.typeDefault)?L.base64.decode(this.typeDefault,T=L.newBuffer(L.base64.length(this.typeDefault)),0):L.utf8.write(this.typeDefault,T=L.newBuffer(L.utf8.length(this.typeDefault)),0),this.typeDefault=T}return this.map?this.defaultValue=L.emptyObject:this.repeated?this.defaultValue=L.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof O&&(this.parent.ctor.prototype[this.name]=this.defaultValue),N.prototype.resolve.call(this)},V.prototype._inferLegacyProtoFeatures=function(T){if("proto2"!==T&&"proto3"!==T)return{};var S={};if("required"===this.rule&&(S.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===M.defaults[this.type]){var R=this.parent.get(this.type.split(".").pop());R&&R instanceof O&&R.group&&(S.message_encoding="DELIMITED")}return!0===this.getOption("packed")?S.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(S.repeated_field_encoding="EXPANDED"),S},V.prototype._resolveFeatures=function(T){return N.prototype._resolveFeatures.call(this,this._edition||T)},V.d=function(T,S,R,O){return"function"==typeof S?S=L.decorateType(S).name:S&&"object"==typeof S&&(S=L.decorateEnum(S).name),function(N,P){L.decorateType(N.constructor).add(new V(P,T,S,R,{default:O}))}},V._configure=function(T){O=T}},61206:(T,S,R)=>{"use strict";var O=T.exports=R(24535);function N(T,S,R){return"function"==typeof S?(R=S,S=new O.Root):S||(S=new O.Root),S.load(T,R)}function P(T,S){return S||(S=new O.Root),S.loadSync(T)}O.build="light",O.load=N,O.loadSync=P,O.encoder=R(25142),O.decoder=R(94137),O.verifier=R(83980),O.converter=R(38031),O.ReflectionObject=R(27813),O.Namespace=R(81456),O.Root=R(97296),O.Enum=R(45688),O.Type=R(5166),O.Field=R(82565),O.OneOf=R(80405),O.MapField=R(82688),O.Service=R(13101),O.Method=R(7430),O.Message=R(68231),O.wrappers=R(93824),O.types=R(20889),O.util=R(64332),O.ReflectionObject._configure(O.Root),O.Namespace._configure(O.Type,O.Service,O.Enum),O.Root._configure(O.Type),O.Field._configure(O.Type)},24535:(T,S,R)=>{"use strict";var O=S;function N(){O.util._configure(),O.Writer._configure(O.BufferWriter),O.Reader._configure(O.BufferReader)}O.build="minimal",O.Writer=R(22316),O.BufferWriter=R(81445),O.Reader=R(3199),O.BufferReader=R(23985),O.util=R(28290),O.rpc=R(57201),O.roots=R(46357),O.configure=N,N()},50778:(T,S,R)=>{"use strict";var O=T.exports=R(61206);O.build="full",O.tokenize=R(29035),O.parse=R(86770),O.common=R(6605),O.Root._configure(O.Type,O.parse,O.common)},82688:(T,S,R)=>{"use strict";T.exports=M;var O=R(82565);((M.prototype=Object.create(O.prototype)).constructor=M).className="MapField";var N=R(20889),P=R(64332);function M(T,S,R,N,M,L){if(O.call(this,T,S,N,void 0,void 0,M,L),!P.isString(R))throw TypeError("keyType must be a string");this.keyType=R,this.resolvedKeyType=null,this.map=!0}M.fromJSON=function(T,S){return new M(T,S.id,S.keyType,S.type,S.options,S.comment)},M.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return P.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",S?this.comment:void 0])},M.prototype.resolve=function(){if(this.resolved)return this;if(void 0===N.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return O.prototype.resolve.call(this)},M.d=function(T,S,R){return"function"==typeof R?R=P.decorateType(R).name:R&&"object"==typeof R&&(R=P.decorateEnum(R).name),function(O,N){P.decorateType(O.constructor).add(new M(N,T,S,R))}}},68231:(T,S,R)=>{"use strict";T.exports=N;var O=R(28290);function N(T){if(T)for(var S=Object.keys(T),R=0;R<S.length;++R)this[S[R]]=T[S[R]]}N.create=function(T){return this.$type.create(T)},N.encode=function(T,S){return this.$type.encode(T,S)},N.encodeDelimited=function(T,S){return this.$type.encodeDelimited(T,S)},N.decode=function(T){return this.$type.decode(T)},N.decodeDelimited=function(T){return this.$type.decodeDelimited(T)},N.verify=function(T){return this.$type.verify(T)},N.fromObject=function(T){return this.$type.fromObject(T)},N.toObject=function(T,S){return this.$type.toObject(T,S)},N.prototype.toJSON=function(){return this.$type.toObject(this,O.toJSONOptions)}},7430:(T,S,R)=>{"use strict";T.exports=P;var O=R(27813);((P.prototype=Object.create(O.prototype)).constructor=P).className="Method";var N=R(64332);function P(T,S,R,P,M,L,U,V,$){if(N.isObject(M)?(U=M,M=L=void 0):N.isObject(L)&&(U=L,L=void 0),!(void 0===S||N.isString(S)))throw TypeError("type must be a string");if(!N.isString(R))throw TypeError("requestType must be a string");if(!N.isString(P))throw TypeError("responseType must be a string");O.call(this,T,U),this.type=S||"rpc",this.requestType=R,this.requestStream=!!M||void 0,this.responseType=P,this.responseStream=!!L||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=V,this.parsedOptions=$}P.fromJSON=function(T,S){return new P(T,S.type,S.requestType,S.responseType,S.requestStream,S.responseStream,S.options,S.comment,S.parsedOptions)},P.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return N.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",S?this.comment:void 0,"parsedOptions",this.parsedOptions])},P.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),O.prototype.resolve.call(this))}},81456:(T,S,R)=>{"use strict";T.exports=K;var O,N,P,M=R(27813);((K.prototype=Object.create(M.prototype)).constructor=K).className="Namespace";var L=R(82565),U=R(64332),V=R(80405);function $(T,S){if(T&&T.length){for(var R={},O=0;O<T.length;++O)R[T[O].name]=T[O].toJSON(S);return R}}function K(T,S){M.call(this,T,S),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function W(T){T._nestedArray=null,T._lookupCache={};for(var S=T;S=S.parent;)S._lookupCache={};return T}K.fromJSON=function(T,S){return new K(T,S.options).addJSON(S.nested)},K.arrayToJSON=$,K.isReservedId=function(T,S){if(T){for(var R=0;R<T.length;++R)if("string"!=typeof T[R]&&T[R][0]<=S&&T[R][1]>S)return!0}return!1},K.isReservedName=function(T,S){if(T){for(var R=0;R<T.length;++R)if(T[R]===S)return!0}return!1},Object.defineProperty(K.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=U.toArray(this.nested))}}),K.prototype.toJSON=function(T){return U.toObject(["options",this.options,"nested",$(this.nestedArray,T)])},K.prototype.addJSON=function(T){var S=this;if(T)for(var R,M=Object.keys(T),U=0;U<M.length;++U)R=T[M[U]],S.add((void 0!==R.fields?O.fromJSON:void 0!==R.values?P.fromJSON:void 0!==R.methods?N.fromJSON:void 0!==R.id?L.fromJSON:K.fromJSON)(M[U],R));return this},K.prototype.get=function(T){return this.nested&&this.nested[T]||null},K.prototype.getEnum=function(T){if(this.nested&&this.nested[T]instanceof P)return this.nested[T].values;throw Error("no such enum: "+T)},K.prototype.add=function(T){if(!(T instanceof L&&void 0!==T.extend||T instanceof O||T instanceof V||T instanceof P||T instanceof N||T instanceof K))throw TypeError("object must be a valid nested object");if(this.nested){var S=this.get(T.name);if(S){if(S instanceof K&&T instanceof K&&!(S instanceof O||S instanceof N)){for(var R=S.nestedArray,M=0;M<R.length;++M)T.add(R[M]);this.remove(S),this.nested||(this.nested={}),T.setOptions(S.options,!0)}else throw Error("duplicate name '"+T.name+"' in "+this)}}else this.nested={};this.nested[T.name]=T,this instanceof O||this instanceof N||this instanceof P||this instanceof L||T._edition||(T._edition=T._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var U=this;U=U.parent;)U._needsRecursiveFeatureResolution=!0,U._needsRecursiveResolve=!0;return T.onAdd(this),W(this)},K.prototype.remove=function(T){if(!(T instanceof M))throw TypeError("object must be a ReflectionObject");if(T.parent!==this)throw Error(T+" is not a member of "+this);return delete this.nested[T.name],Object.keys(this.nested).length||(this.nested=void 0),T.onRemove(this),W(this)},K.prototype.define=function(T,S){if(U.isString(T))T=T.split(".");else if(!Array.isArray(T))throw TypeError("illegal path");if(T&&T.length&&""===T[0])throw Error("path must be relative");for(var R=this;T.length>0;){var O=T.shift();if(R.nested&&R.nested[O]){if(!((R=R.nested[O])instanceof K))throw Error("path conflicts with non-namespace objects")}else R.add(R=new K(O))}return S&&R.addJSON(S),R},K.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var T=this.nestedArray,S=0;for(this.resolve();S<T.length;)T[S]instanceof K?T[S++].resolveAll():T[S++].resolve();return this._needsRecursiveResolve=!1,this},K.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(this._needsRecursiveFeatureResolution=!1,T=this._edition||T,M.prototype._resolveFeaturesRecursive.call(this,T),this.nestedArray.forEach(S=>{S._resolveFeaturesRecursive(T)})),this},K.prototype.lookup=function(T,S,R){if("boolean"==typeof S?(R=S,S=void 0):S&&!Array.isArray(S)&&(S=[S]),U.isString(T)&&T.length){if("."===T)return this.root;T=T.split(".")}else if(!T.length)return this;var O=T.join(".");if(""===T[0])return this.root.lookup(T.slice(1),S);var N=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+O];if(N&&(!S||S.indexOf(N.constructor)>-1)||(N=this._lookupImpl(T,O))&&(!S||S.indexOf(N.constructor)>-1))return N;if(R)return null;for(var P=this;P.parent;){if((N=P.parent._lookupImpl(T,O))&&(!S||S.indexOf(N.constructor)>-1))return N;P=P.parent}return null},K.prototype._lookupImpl=function(T,S){if(Object.prototype.hasOwnProperty.call(this._lookupCache,S))return this._lookupCache[S];var R=this.get(T[0]),O=null;if(R)1===T.length?O=R:R instanceof K&&(T=T.slice(1),O=R._lookupImpl(T,T.join(".")));else for(var N=0;N<this.nestedArray.length;++N)this._nestedArray[N]instanceof K&&(R=this._nestedArray[N]._lookupImpl(T,S))&&(O=R);return this._lookupCache[S]=O,O},K.prototype.lookupType=function(T){var S=this.lookup(T,[O]);if(!S)throw Error("no such type: "+T);return S},K.prototype.lookupEnum=function(T){var S=this.lookup(T,[P]);if(!S)throw Error("no such Enum '"+T+"' in "+this);return S},K.prototype.lookupTypeOrEnum=function(T){var S=this.lookup(T,[O,P]);if(!S)throw Error("no such Type or Enum '"+T+"' in "+this);return S},K.prototype.lookupService=function(T){var S=this.lookup(T,[N]);if(!S)throw Error("no such Service '"+T+"' in "+this);return S},K._configure=function(T,S,R){O=T,N=S,P=R}},27813:(T,S,R)=>{"use strict";T.exports=V,V.className="ReflectionObject";let O=R(80405);var N,P=R(64332),M={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},L={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},U={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function V(T,S){if(!P.isString(T))throw TypeError("name must be a string");if(S&&!P.isObject(S))throw TypeError("options must be an object");this.options=S,this.parsedOptions=null,this.name=T,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(V.prototype,{root:{get:function(){for(var T=this;null!==T.parent;)T=T.parent;return T}},fullName:{get:function(){for(var T=[this.name],S=this.parent;S;)T.unshift(S.name),S=S.parent;return T.join(".")}}}),V.prototype.toJSON=function(){throw Error()},V.prototype.onAdd=function(T){this.parent&&this.parent!==T&&this.parent.remove(this),this.parent=T,this.resolved=!1;var S=T.root;S instanceof N&&S._handleAdd(this)},V.prototype.onRemove=function(T){var S=T.root;S instanceof N&&S._handleRemove(this),this.parent=null,this.resolved=!1},V.prototype.resolve=function(){return this.resolved||this.root instanceof N&&(this.resolved=!0),this},V.prototype._resolveFeaturesRecursive=function(T){return this._resolveFeatures(this._edition||T)},V.prototype._resolveFeatures=function(T){if(!this._featuresResolved){var S={};if(!T)throw Error("Unknown edition for "+this.fullName);var R=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(T));if(this._edition){if("proto2"===T)S=Object.assign({},L);else if("proto3"===T)S=Object.assign({},U);else if("2023"===T)S=Object.assign({},M);else throw Error("Unknown edition: "+T);this._features=Object.assign(S,R||{}),this._featuresResolved=!0;return}if(this.partOf instanceof O){var N=Object.assign({},this.partOf._features);this._features=Object.assign(N,R||{})}else if(this.declaringField);else if(this.parent){var P=Object.assign({},this.parent._features);this._features=Object.assign(P,R||{})}else throw Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},V.prototype._inferLegacyProtoFeatures=function(){return{}},V.prototype.getOption=function(T){if(this.options)return this.options[T]},V.prototype.setOption=function(T,S,R){return this.options||(this.options={}),/^features\./.test(T)?P.setProperty(this.options,T,S,R):R&&void 0!==this.options[T]||(this.getOption(T)!==S&&(this.resolved=!1),this.options[T]=S),this},V.prototype.setParsedOption=function(T,S,R){this.parsedOptions||(this.parsedOptions=[]);var O=this.parsedOptions;if(R){var N=O.find(function(S){return Object.prototype.hasOwnProperty.call(S,T)});if(N){var M=N[T];P.setProperty(M,R,S)}else(N={})[T]=P.setProperty({},R,S),O.push(N)}else{var L={};L[T]=S,O.push(L)}return this},V.prototype.setOptions=function(T,S){if(T)for(var R=Object.keys(T),O=0;O<R.length;++O)this.setOption(R[O],T[R[O]],S);return this},V.prototype.toString=function(){var T=this.constructor.className,S=this.fullName;return S.length?T+" "+S:T},V.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},V._configure=function(T){N=T}},80405:(T,S,R)=>{"use strict";T.exports=M;var O=R(27813);((M.prototype=Object.create(O.prototype)).constructor=M).className="OneOf";var N=R(82565),P=R(64332);function M(T,S,R,N){if(Array.isArray(S)||(R=S,S=void 0),O.call(this,T,R),!(void 0===S||Array.isArray(S)))throw TypeError("fieldNames must be an Array");this.oneof=S||[],this.fieldsArray=[],this.comment=N}function L(T){if(T.parent)for(var S=0;S<T.fieldsArray.length;++S)T.fieldsArray[S].parent||T.parent.add(T.fieldsArray[S])}M.fromJSON=function(T,S){return new M(T,S.oneof,S.options,S.comment)},M.prototype.toJSON=function(T){var S=!!T&&!!T.keepComments;return P.toObject(["options",this.options,"oneof",this.oneof,"comment",S?this.comment:void 0])},M.prototype.add=function(T){if(!(T instanceof N))throw TypeError("field must be a Field");return T.parent&&T.parent!==this.parent&&T.parent.remove(T),this.oneof.push(T.name),this.fieldsArray.push(T),T.partOf=this,L(this),this},M.prototype.remove=function(T){if(!(T instanceof N))throw TypeError("field must be a Field");var S=this.fieldsArray.indexOf(T);if(S<0)throw Error(T+" is not a member of "+this);return this.fieldsArray.splice(S,1),(S=this.oneof.indexOf(T.name))>-1&&this.oneof.splice(S,1),T.partOf=null,this},M.prototype.onAdd=function(T){O.prototype.onAdd.call(this,T);for(var S=this,R=0;R<this.oneof.length;++R){var N=T.get(this.oneof[R]);N&&!N.partOf&&(N.partOf=S,S.fieldsArray.push(N))}L(this)},M.prototype.onRemove=function(T){for(var S,R=0;R<this.fieldsArray.length;++R)(S=this.fieldsArray[R]).parent&&S.parent.remove(S);O.prototype.onRemove.call(this,T)},Object.defineProperty(M.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var T=this.fieldsArray[0];return null!=T.options&&!0===T.options.proto3_optional}}),M.d=function(){for(var T=Array(arguments.length),S=0;S<arguments.length;)T[S]=arguments[S++];return function(S,R){P.decorateType(S.constructor).add(new M(R,T)),Object.defineProperty(S,R,{get:P.oneOfGetter(T),set:P.oneOfSetter(T)})}}},86770:(T,S,R)=>{"use strict";T.exports=eo,eo.filename=null,eo.defaults={keepCase:!1};var O=R(29035),N=R(97296),P=R(5166),M=R(82565),L=R(82688),U=R(80405),V=R(45688),$=R(13101),K=R(7430),W=R(27813),Q=R(20889),Y=R(64332),X=/^[1-9][0-9]*$/,Z=/^-?[1-9][0-9]*$/,ee=/^0[x][0-9a-fA-F]+$/,et=/^-?0[x][0-9a-fA-F]+$/,er=/^0[0-7]+$/,en=/^-?0[0-7]+$/,ei=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,es=/^[a-zA-Z_][a-zA-Z_0-9]*$/,ea=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function eo(T,S,R){S instanceof N||(R=S,S=new N),R||(R=eo.defaults);var eu,ec,ed,eh,ef=R.preferTrailingComment||!1,ep=O(T,R.alternateCommentMode||!1),eg=ep.next,em=ep.push,ey=ep.peek,ev=ep.skip,eb=ep.cmnt,eT=!0,eS="proto2",e_=S,eE=[],ew={},eC=R.keepCase?function(T){return T}:Y.camelCase;function eI(){eE.forEach(T=>{T._edition=eS,Object.keys(ew).forEach(S=>{void 0===T.getOption(S)&&T.setOption(S,ew[S],!0)})})}function eR(T,S,R){var O=eo.filename;return R||(eo.filename=null),Error("illegal "+(S||"token")+" '"+T+"' ("+(O?O+", ":"")+"line "+ep.line+")")}function eO(){var T,S=[];do{if('"'!==(T=eg())&&"'"!==T)throw eR(T);S.push(eg()),ev(T),T=ey()}while('"'===T||"'"===T);return S.join("")}function eA(T){var S=eg();switch(S){case"'":case'"':return em(S),eO();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return eN(S,!0)}catch(R){if(T&&ea.test(S))return S;throw eR(S,"value")}}function ek(T,S){do if(S&&('"'===(R=ey())||"'"===R)){var R,O,N=eO();if(T.push(N),eS>=2023)throw eR(N,"id")}else try{T.push([O=eD(eg()),ev("to",!0)?eD(eg()):O])}catch(O){if(S&&ea.test(R)&&eS>=2023)T.push(R);else throw O}while(ev(",",!0));var P={options:void 0};P.setOption=function(T,S){void 0===this.options&&(this.options={}),this.options[T]=S},ej(P,function(T){if("option"===T)e$(P,T),ev(";");else throw eR(T)},function(){eY(P)})}function eN(T,S){var R=1;switch("-"===T.charAt(0)&&(R=-1,T=T.substring(1)),T){case"inf":case"INF":case"Inf":return 1/0*R;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(X.test(T))return R*parseInt(T,10);if(ee.test(T))return R*parseInt(T,16);if(er.test(T))return R*parseInt(T,8);if(ei.test(T))return R*parseFloat(T);throw eR(T,"number",S)}function eD(T,S){switch(T){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!S&&"-"===T.charAt(0))throw eR(T,"id");if(Z.test(T))return parseInt(T,10);if(et.test(T))return parseInt(T,16);if(en.test(T))return parseInt(T,8);throw eR(T,"id")}function eP(){if(void 0!==ec)throw eR("package");if(ec=eg(),!ea.test(ec))throw eR(ec,"name");e_=e_.define(ec),ev(";")}function ex(){var T,S=ey();switch(S){case"weak":T=eh||(eh=[]),eg();break;case"public":eg();default:T=ed||(ed=[])}S=eO(),ev(";"),T.push(S)}function eM(){if(ev("="),(eS=eO())<2023)throw eR(eS,"syntax");ev(";")}function eL(){if(ev("="),!["2023"].includes(eS=eO()))throw eR(eS,"edition");ev(";")}function eF(T,S){switch(S){case"option":return e$(T,S),ev(";"),!0;case"message":return eU(T,S),!0;case"enum":return eG(T,S),!0;case"service":return eJ(T,S),!0;case"extend":return eZ(T,S),!0}return!1}function ej(T,S,R){var O,N=ep.line;if(T&&("string"!=typeof T.comment&&(T.comment=eb()),T.filename=eo.filename),ev("{",!0)){for(;"}"!==(O=eg());)S(O);ev(";",!0)}else R&&R(),ev(";"),T&&("string"!=typeof T.comment||ef)&&(T.comment=eb(N)||T.comment)}function eU(T,S){if(!es.test(S=eg()))throw eR(S,"type name");var R=new P(S);ej(R,function(T){if(!eF(R,T))switch(T){case"map":ez(R,T);break;case"required":if("proto2"!==eS)throw eR(T);case"repeated":eB(R,T);break;case"optional":if("proto3"===eS)eB(R,"proto3_optional");else if("proto2"!==eS)throw eR(T);else eB(R,"optional");break;case"oneof":eq(R,T);break;case"extensions":ek(R.extensions||(R.extensions=[]));break;case"reserved":ek(R.reserved||(R.reserved=[]),!0);break;default:if("proto2"===eS||!ea.test(T))throw eR(T);em(T),eB(R,"optional")}}),T.add(R),T===e_&&eE.push(R)}function eB(T,S,R){var O=eg();if("group"===O){eV(T,S);return}for(;O.endsWith(".")||ey().startsWith(".");)O+=eg();if(!ea.test(O))throw eR(O,"type");var N=eg();if(!es.test(N))throw eR(N,"name");N=eC(N),ev("=");var P=new M(N,eD(eg()),O,S,R);if(ej(P,function(T){if("option"===T)e$(P,T),ev(";");else throw eR(T)},function(){eY(P)}),"proto3_optional"===S){var L=new U("_"+N);P.setOption("proto3_optional",!0),L.add(P),T.add(L)}else T.add(P);T===e_&&eE.push(P)}function eV(T,S){if(eS>=2023)throw eR("group");var R=eg();if(!es.test(R))throw eR(R,"name");var O=Y.lcFirst(R);R===O&&(R=Y.ucFirst(R)),ev("=");var N=eD(eg()),L=new P(R);L.group=!0;var U=new M(O,N,R,S);U.filename=eo.filename,ej(L,function(T){switch(T){case"option":e$(L,T),ev(";");break;case"required":case"repeated":eB(L,T);break;case"optional":"proto3"===eS?eB(L,"proto3_optional"):eB(L,"optional");break;case"message":eU(L,T);break;case"enum":eG(L,T);break;case"reserved":ek(L.reserved||(L.reserved=[]),!0);break;default:throw eR(T)}}),T.add(L).add(U)}function ez(T){ev("<");var S=eg();if(void 0===Q.mapKey[S])throw eR(S,"type");ev(",");var R=eg();if(!ea.test(R))throw eR(R,"type");ev(">");var O=eg();if(!es.test(O))throw eR(O,"name");ev("=");var N=new L(eC(O),eD(eg()),S,R);ej(N,function(T){if("option"===T)e$(N,T),ev(";");else throw eR(T)},function(){eY(N)}),T.add(N)}function eq(T,S){if(!es.test(S=eg()))throw eR(S,"name");var R=new U(eC(S));ej(R,function(T){"option"===T?(e$(R,T),ev(";")):(em(T),eB(R,"optional"))}),T.add(R)}function eG(T,S){if(!es.test(S=eg()))throw eR(S,"name");var R=new V(S);ej(R,function(T){switch(T){case"option":e$(R,T),ev(";");break;case"reserved":ek(R.reserved||(R.reserved=[]),!0),void 0===R.reserved&&(R.reserved=[]);break;default:eH(R,T)}}),T.add(R),T===e_&&eE.push(R)}function eH(T,S){if(!es.test(S))throw eR(S,"name");ev("=");var R=eD(eg(),!0),O={options:void 0};O.getOption=function(T){return this.options[T]},O.setOption=function(T,S){W.prototype.setOption.call(O,T,S)},O.setParsedOption=function(){},ej(O,function(T){if("option"===T)e$(O,T),ev(";");else throw eR(T)},function(){eY(O)}),T.add(S,R,O.comment,O.parsedOptions||O.options)}function e$(T,S){var R,O,N=!0;for("option"===S&&(S=eg());"="!==S;){if("("===S){var P=eg();ev(")"),S="("+P+")"}if(N){if(N=!1,S.includes(".")&&!S.includes("(")){var M=S.split(".");R=M[0]+".",S=M[1];continue}R=S}else O=O?O+=S:S;S=eg()}var L=eK(T,O?R.concat(O):R);O=O&&"."===O[0]?O.slice(1):O,eQ(T,R=R&&"."===R[R.length-1]?R.slice(0,-1):R,L,O)}function eK(T,S){if(ev("{",!0)){for(var R={};!ev("}",!0);){if(!es.test(eu=eg()))throw eR(eu,"name");if(null===eu)throw eR(eu,"end of input");var O,N,P=eu;if(ev(":",!0),"{"===ey())O=eK(T,S+"."+eu);else if("["===ey()){if(O=[],ev("[",!0)){do N=eA(!0),O.push(N);while(ev(",",!0));ev("]"),void 0!==N&&eW(T,S+"."+eu,N)}}else O=eA(!0),eW(T,S+"."+eu,O);var M=R[P];M&&(O=[].concat(M).concat(O)),R[P]=O,ev(",",!0),ev(";",!0)}return R}var L=eA(!0);return eW(T,S,L),L}function eW(T,S,R){if(e_===T&&/^features\./.test(S)){ew[S]=R;return}T.setOption&&T.setOption(S,R)}function eQ(T,S,R,O){T.setParsedOption&&T.setParsedOption(S,R,O)}function eY(T){if(ev("[",!0)){do e$(T,"option");while(ev(",",!0));ev("]")}return T}function eJ(T,S){if(!es.test(S=eg()))throw eR(S,"service name");var R=new $(S);ej(R,function(T){if(!eF(R,T)){if("rpc"===T)eX(R,T);else throw eR(T)}}),T.add(R),T===e_&&eE.push(R)}function eX(T,S){var R=eb(),O=S;if(!es.test(S=eg()))throw eR(S,"name");var N,P,M,L,U=S;if(ev("("),ev("stream",!0)&&(P=!0),!ea.test(S=eg())||(N=S,ev(")"),ev("returns"),ev("("),ev("stream",!0)&&(L=!0),!ea.test(S=eg())))throw eR(S);M=S,ev(")");var V=new K(U,O,N,M,P,L);V.comment=R,ej(V,function(T){if("option"===T)e$(V,T),ev(";");else throw eR(T)}),T.add(V)}function eZ(T,S){if(!ea.test(S=eg()))throw eR(S,"reference");var R=S;ej(null,function(S){switch(S){case"required":case"repeated":eB(T,S,R);break;case"optional":"proto3"===eS?eB(T,"proto3_optional",R):eB(T,"optional",R);break;default:if("proto2"===eS||!ea.test(S))throw eR(S);em(S),eB(T,"optional",R)}})}for(;null!==(eu=eg());)switch(eu){case"package":if(!eT)throw eR(eu);eP();break;case"import":if(!eT)throw eR(eu);ex();break;case"syntax":if(!eT)throw eR(eu);eM();break;case"edition":if(!eT)throw eR(eu);eL();break;case"option":e$(e_,eu),ev(";",!0);break;default:if(eF(e_,eu)){eT=!1;continue}throw eR(eu)}return eI(),eo.filename=null,{package:ec,imports:ed,weakImports:eh,root:S}}},3199:(T,S,R)=>{"use strict";T.exports=U;var O,N=R(28290),P=N.LongBits,M=N.utf8;function L(T,S){return RangeError("index out of range: "+T.pos+" + "+(S||1)+" > "+T.len)}function U(T){this.buf=T,this.pos=0,this.len=T.length}var V="undefined"!=typeof Uint8Array?function(T){if(T instanceof Uint8Array||Array.isArray(T))return new U(T);throw Error("illegal buffer")}:function(T){if(Array.isArray(T))return new U(T);throw Error("illegal buffer")},$=function(){return N.Buffer?function(T){return(U.create=function(T){return N.Buffer.isBuffer(T)?new O(T):V(T)})(T)}:V};function K(){var T=new P(0,0),S=0;if(this.len-this.pos>4){for(;S<4;++S)if(T.lo=(T.lo|(127&this.buf[this.pos])<<7*S)>>>0,this.buf[this.pos++]<128)return T;if(T.lo=(T.lo|(127&this.buf[this.pos])<<28)>>>0,T.hi=(T.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return T;S=0}else{for(;S<3;++S){if(this.pos>=this.len)throw L(this);if(T.lo=(T.lo|(127&this.buf[this.pos])<<7*S)>>>0,this.buf[this.pos++]<128)return T}return T.lo=(T.lo|(127&this.buf[this.pos++])<<7*S)>>>0,T}if(this.len-this.pos>4){for(;S<5;++S)if(T.hi=(T.hi|(127&this.buf[this.pos])<<7*S+3)>>>0,this.buf[this.pos++]<128)return T}else for(;S<5;++S){if(this.pos>=this.len)throw L(this);if(T.hi=(T.hi|(127&this.buf[this.pos])<<7*S+3)>>>0,this.buf[this.pos++]<128)return T}throw Error("invalid varint encoding")}function W(T,S){return(T[S-4]|T[S-3]<<8|T[S-2]<<16|T[S-1]<<24)>>>0}function Q(){if(this.pos+8>this.len)throw L(this,8);return new P(W(this.buf,this.pos+=4),W(this.buf,this.pos+=4))}U.create=$(),U.prototype._slice=N.Array.prototype.subarray||N.Array.prototype.slice,U.prototype.uint32=function(){var T=4294967295;return function(){if(T=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(T=(T|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(T=(T|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(T=(T|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(T=(T|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return T;if((this.pos+=5)>this.len)throw this.pos=this.len,L(this,10);return T}}(),U.prototype.int32=function(){return 0|this.uint32()},U.prototype.sint32=function(){var T=this.uint32();return T>>>1^-(1&T)|0},U.prototype.bool=function(){return 0!==this.uint32()},U.prototype.fixed32=function(){if(this.pos+4>this.len)throw L(this,4);return W(this.buf,this.pos+=4)},U.prototype.sfixed32=function(){if(this.pos+4>this.len)throw L(this,4);return 0|W(this.buf,this.pos+=4)},U.prototype.float=function(){if(this.pos+4>this.len)throw L(this,4);var T=N.float.readFloatLE(this.buf,this.pos);return this.pos+=4,T},U.prototype.double=function(){if(this.pos+8>this.len)throw L(this,4);var T=N.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,T},U.prototype.bytes=function(){var T=this.uint32(),S=this.pos,R=this.pos+T;if(R>this.len)throw L(this,T);if(this.pos+=T,Array.isArray(this.buf))return this.buf.slice(S,R);if(S===R){var O=N.Buffer;return O?O.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,S,R)},U.prototype.string=function(){var T=this.bytes();return M.read(T,0,T.length)},U.prototype.skip=function(T){if("number"==typeof T){if(this.pos+T>this.len)throw L(this,T);this.pos+=T}else do if(this.pos>=this.len)throw L(this);while(128&this.buf[this.pos++]);return this},U.prototype.skipType=function(T){switch(T){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(T=7&this.uint32());)this.skipType(T);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+T+" at offset "+this.pos)}return this},U._configure=function(T){O=T,U.create=$(),O._configure();var S=N.Long?"toLong":"toNumber";N.merge(U.prototype,{int64:function(){return K.call(this)[S](!1)},uint64:function(){return K.call(this)[S](!0)},sint64:function(){return K.call(this).zzDecode()[S](!1)},fixed64:function(){return Q.call(this)[S](!0)},sfixed64:function(){return Q.call(this)[S](!1)}})}},23985:(T,S,R)=>{"use strict";T.exports=P;var O=R(3199);(P.prototype=Object.create(O.prototype)).constructor=P;var N=R(28290);function P(T){O.call(this,T)}P._configure=function(){N.Buffer&&(P.prototype._slice=N.Buffer.prototype.slice)},P.prototype.string=function(){var T=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+T,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+T,this.len))},P._configure()},97296:(T,S,R)=>{"use strict";T.exports=K;var O,N,P,M=R(81456);((K.prototype=Object.create(M.prototype)).constructor=K).className="Root";var L=R(82565),U=R(45688),V=R(80405),$=R(64332);function K(T){M.call(this,"",T),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function W(){}K.fromJSON=function(T,S){return S||(S=new K),T.options&&S.setOptions(T.options),S.addJSON(T.nested).resolveAll()},K.prototype.resolvePath=$.path.resolve,K.prototype.fetch=$.fetch,K.prototype.load=function T(S,R,O){"function"==typeof R&&(O=R,R=void 0);var M=this;if(!O)return $.asPromise(T,M,S,R);var L=O===W;function U(T,S){if(O){if(L)throw T;S&&S.resolveAll();var R=O;O=null,R(T,S)}}function V(T){var S=T.lastIndexOf("google/protobuf/");if(S>-1){var R=T.substring(S);if(R in P)return R}return null}function K(T,S){try{if($.isString(S)&&"{"===S.charAt(0)&&(S=JSON.parse(S)),$.isString(S)){N.filename=T;var O,P=N(S,M,R),K=0;if(P.imports)for(;K<P.imports.length;++K)(O=V(P.imports[K])||M.resolvePath(T,P.imports[K]))&&Q(O);if(P.weakImports)for(K=0;K<P.weakImports.length;++K)(O=V(P.weakImports[K])||M.resolvePath(T,P.weakImports[K]))&&Q(O,!0)}else M.setOptions(S.options).addJSON(S.nested)}catch(T){U(T)}L||Y||U(null,M)}function Q(T,S){if(T=V(T)||T,!(M.files.indexOf(T)>-1)){if(M.files.push(T),T in P){L?K(T,P[T]):(++Y,setTimeout(function(){--Y,K(T,P[T])}));return}if(L){var R;try{R=$.fs.readFileSync(T).toString("utf8")}catch(T){S||U(T);return}K(T,R)}else++Y,M.fetch(T,function(R,N){if(--Y,O){if(R){S?Y||U(null,M):U(R);return}K(T,N)}})}}var Y=0;$.isString(S)&&(S=[S]);for(var X,Z=0;Z<S.length;++Z)(X=M.resolvePath("",S[Z]))&&Q(X);return L?M.resolveAll():Y||U(null,M),M},K.prototype.loadSync=function(T,S){if(!$.isNode)throw Error("not supported");return this.load(T,S,W)},K.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(T){return"'extend "+T.extend+"' in "+T.parent.fullName}).join(", "));return M.prototype.resolveAll.call(this)};var Q=/^[A-Z]/;function Y(T,S){var R=S.parent.lookup(S.extend);if(R){var O=new L(S.fullName,S.id,S.type,S.rule,void 0,S.options);return!!R.get(O.name)||(O.declaringField=S,S.extensionField=O,R.add(O),!0)}return!1}K.prototype._handleAdd=function(T){if(T instanceof L)void 0===T.extend||T.extensionField||Y(this,T)||this.deferred.push(T);else if(T instanceof U)Q.test(T.name)&&(T.parent[T.name]=T.values);else if(!(T instanceof V)){if(T instanceof O)for(var S=0;S<this.deferred.length;)Y(this,this.deferred[S])?this.deferred.splice(S,1):++S;for(var R=0;R<T.nestedArray.length;++R)this._handleAdd(T._nestedArray[R]);Q.test(T.name)&&(T.parent[T.name]=T)}(T instanceof O||T instanceof U||T instanceof L)&&(this._fullyQualifiedObjects[T.fullName]=T)},K.prototype._handleRemove=function(T){if(T instanceof L){if(void 0!==T.extend){if(T.extensionField)T.extensionField.parent.remove(T.extensionField),T.extensionField=null;else{var S=this.deferred.indexOf(T);S>-1&&this.deferred.splice(S,1)}}}else if(T instanceof U)Q.test(T.name)&&delete T.parent[T.name];else if(T instanceof M){for(var R=0;R<T.nestedArray.length;++R)this._handleRemove(T._nestedArray[R]);Q.test(T.name)&&delete T.parent[T.name]}delete this._fullyQualifiedObjects[T.fullName]},K._configure=function(T,S,R){O=T,N=S,P=R}},46357:T=>{"use strict";T.exports={}},57201:(T,S,R)=>{"use strict";S.Service=R(15842)},15842:(T,S,R)=>{"use strict";T.exports=N;var O=R(28290);function N(T,S,R){if("function"!=typeof T)throw TypeError("rpcImpl must be a function");O.EventEmitter.call(this),this.rpcImpl=T,this.requestDelimited=!!S,this.responseDelimited=!!R}(N.prototype=Object.create(O.EventEmitter.prototype)).constructor=N,N.prototype.rpcCall=function T(S,R,N,P,M){if(!P)throw TypeError("request must be specified");var L=this;if(!M)return O.asPromise(T,L,S,R,N,P);if(!L.rpcImpl){setTimeout(function(){M(Error("already ended"))},0);return}try{return L.rpcImpl(S,R[L.requestDelimited?"encodeDelimited":"encode"](P).finish(),function(T,R){if(T)return L.emit("error",T,S),M(T);if(null===R){L.end(!0);return}if(!(R instanceof N))try{R=N[L.responseDelimited?"decodeDelimited":"decode"](R)}catch(T){return L.emit("error",T,S),M(T)}return L.emit("data",R,S),M(null,R)})}catch(T){L.emit("error",T,S),setTimeout(function(){M(T)},0);return}},N.prototype.end=function(T){return this.rpcImpl&&(T||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},13101:(T,S,R)=>{"use strict";T.exports=L;var O=R(81456);((L.prototype=Object.create(O.prototype)).constructor=L).className="Service";var N=R(7430),P=R(64332),M=R(57201);function L(T,S){O.call(this,T,S),this.methods={},this._methodsArray=null}function U(T){return T._methodsArray=null,T}L.fromJSON=function(T,S){var R=new L(T,S.options);if(S.methods)for(var O=Object.keys(S.methods),P=0;P<O.length;++P)R.add(N.fromJSON(O[P],S.methods[O[P]]));return S.nested&&R.addJSON(S.nested),S.edition&&(R._edition=S.edition),R.comment=S.comment,R._defaultEdition="proto3",R},L.prototype.toJSON=function(T){var S=O.prototype.toJSON.call(this,T),R=!!T&&!!T.keepComments;return P.toObject(["edition",this._editionToJSON(),"options",S&&S.options||void 0,"methods",O.arrayToJSON(this.methodsArray,T)||{},"nested",S&&S.nested||void 0,"comment",R?this.comment:void 0])},Object.defineProperty(L.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=P.toArray(this.methods))}}),L.prototype.get=function(T){return this.methods[T]||O.prototype.get.call(this,T)},L.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;O.prototype.resolve.call(this);for(var T=this.methodsArray,S=0;S<T.length;++S)T[S].resolve();return this},L.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(T=this._edition||T,O.prototype._resolveFeaturesRecursive.call(this,T),this.methodsArray.forEach(S=>{S._resolveFeaturesRecursive(T)})),this},L.prototype.add=function(T){if(this.get(T.name))throw Error("duplicate name '"+T.name+"' in "+this);return T instanceof N?(this.methods[T.name]=T,T.parent=this,U(this)):O.prototype.add.call(this,T)},L.prototype.remove=function(T){if(T instanceof N){if(this.methods[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.methods[T.name],T.parent=null,U(this)}return O.prototype.remove.call(this,T)},L.prototype.create=function(T,S,R){for(var O,N=new M.Service(T,S,R),L=0;L<this.methodsArray.length;++L){var U=P.lcFirst((O=this._methodsArray[L]).resolve().name).replace(/[^$\w_]/g,"");N[U]=P.codegen(["r","c"],P.isReserved(U)?U+"_":U)("return this.rpcCall(m,q,s,r,c)")({m:O,q:O.resolvedRequestType.ctor,s:O.resolvedResponseType.ctor})}return N}},29035:T=>{"use strict";T.exports=K;var S=/[\s{}=;:[\],'"()<>]/g,R=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,O=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,N=/^ *[*/]+ */,P=/^\s*\*?\/*/,M=/\n/g,L=/\s/,U=/\\(.?)/g,V={0:"\x00",r:"\r",n:"\n",t:"	"};function $(T){return T.replace(U,function(T,S){switch(S){case"\\":case"":return S;default:return V[S]||""}})}function K(T,U){T=T.toString();var V=0,K=T.length,W=1,Q=0,Y={},X=[],Z=null;function ee(T){return Error("illegal "+T+" (line "+W+")")}function et(){var S="'"===Z?O:R;S.lastIndex=V-1;var N=S.exec(T);if(!N)throw ee("string");return V=S.lastIndex,eo(Z),Z=null,$(N[1])}function er(S){return T.charAt(S)}function en(S,R,O){var L,V,$={type:T.charAt(S++),lineEmpty:!1,leading:O},K=S-(L=U?2:3);do if(--K<0||"\n"===(V=T.charAt(K))){$.lineEmpty=!0;break}while(" "===V||"	"===V);for(var X=T.substring(S,R).split(M),Z=0;Z<X.length;++Z)X[Z]=X[Z].replace(U?P:N,"").trim();$.text=X.join("\n").trim(),Y[W]=$,Q=W}function ei(S){var R=es(S),O=T.substring(S,R);return/^\s*\/\//.test(O)}function es(T){for(var S=T;S<K&&"\n"!==er(S);)S++;return S}function ea(){if(X.length>0)return X.shift();if(Z)return et();var R,O,N,P,M,$=0===V;do{if(V===K)return null;for(R=!1;L.test(N=er(V));)if("\n"===N&&($=!0,++W),++V===K)return null;if("/"===er(V)){if(++V===K)throw ee("comment");if("/"===er(V)){if(U){if(P=V,M=!1,ei(V-1)){M=!0;do if((V=es(V))===K||(V++,!$))break;while(ei(V))}else V=Math.min(K,es(V)+1);M&&(en(P,V,$),$=!0),W++,R=!0}else{for(M="/"===er(P=V+1);"\n"!==er(++V);)if(V===K)return null;++V,M&&(en(P,V-1,$),$=!0),++W,R=!0}}else{if("*"!==(N=er(V)))return"/";P=V+1,M=U||"*"===er(P);do{if("\n"===N&&++W,++V===K)throw ee("comment");O=N,N=er(V)}while("*"!==O||"/"!==N);++V,M&&(en(P,V-2,$),$=!0),R=!0}}}while(R);var Q=V;if(S.lastIndex=0,!S.test(er(Q++)))for(;Q<K&&!S.test(er(Q));)++Q;var Y=T.substring(V,V=Q);return('"'===Y||"'"===Y)&&(Z=Y),Y}function eo(T){X.push(T)}function eu(){if(!X.length){var T=ea();if(null===T)return null;eo(T)}return X[0]}function ec(T,S){var R=eu();if(R===T)return ea(),!0;if(!S)throw ee("token '"+R+"', '"+T+"' expected");return!1}function ed(T){var S,R=null;return void 0===T?(S=Y[W-1],delete Y[W-1],S&&(U||"*"===S.type||S.lineEmpty)&&(R=S.leading?S.text:null)):(Q<T&&eu(),S=Y[T],delete Y[T],S&&!S.lineEmpty&&(U||"/"===S.type)&&(R=S.leading?null:S.text)),R}return Object.defineProperty({next:ea,peek:eu,push:eo,skip:ec,cmnt:ed},"line",{get:function(){return W}})}K.unescape=$},5166:(T,S,R)=>{"use strict";T.exports=et;var O=R(81456);((et.prototype=Object.create(O.prototype)).constructor=et).className="Type";var N=R(45688),P=R(80405),M=R(82565),L=R(82688),U=R(13101),V=R(68231),$=R(3199),K=R(22316),W=R(64332),Q=R(25142),Y=R(94137),X=R(83980),Z=R(38031),ee=R(93824);function et(T,S){O.call(this,T,S),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function er(T){return T._fieldsById=T._fieldsArray=T._oneofsArray=null,delete T.encode,delete T.decode,delete T.verify,T}Object.defineProperties(et.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var T=Object.keys(this.fields),S=0;S<T.length;++S){var R=this.fields[T[S]],O=R.id;if(this._fieldsById[O])throw Error("duplicate id "+O+" in "+this);this._fieldsById[O]=R}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=W.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=W.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=et.generateConstructor(this)())},set:function(T){var S=T.prototype;S instanceof V||((T.prototype=new V).constructor=T,W.merge(T.prototype,S)),T.$type=T.prototype.$type=this,W.merge(T,V,!0),this._ctor=T;for(var R=0;R<this.fieldsArray.length;++R)this._fieldsArray[R].resolve();var O={};for(R=0;R<this.oneofsArray.length;++R)O[this._oneofsArray[R].resolve().name]={get:W.oneOfGetter(this._oneofsArray[R].oneof),set:W.oneOfSetter(this._oneofsArray[R].oneof)};R&&Object.defineProperties(T.prototype,O)}}}),et.generateConstructor=function(T){for(var S,R=W.codegen(["p"],T.name),O=0;O<T.fieldsArray.length;++O)(S=T._fieldsArray[O]).map?R("this%s={}",W.safeProp(S.name)):S.repeated&&R("this%s=[]",W.safeProp(S.name));return R("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},et.fromJSON=function(T,S){var R=new et(T,S.options);R.extensions=S.extensions,R.reserved=S.reserved;for(var V=Object.keys(S.fields),$=0;$<V.length;++$)R.add((void 0!==S.fields[V[$]].keyType?L.fromJSON:M.fromJSON)(V[$],S.fields[V[$]]));if(S.oneofs)for(V=Object.keys(S.oneofs),$=0;$<V.length;++$)R.add(P.fromJSON(V[$],S.oneofs[V[$]]));if(S.nested)for(V=Object.keys(S.nested),$=0;$<V.length;++$){var K=S.nested[V[$]];R.add((void 0!==K.id?M.fromJSON:void 0!==K.fields?et.fromJSON:void 0!==K.values?N.fromJSON:void 0!==K.methods?U.fromJSON:O.fromJSON)(V[$],K))}return S.extensions&&S.extensions.length&&(R.extensions=S.extensions),S.reserved&&S.reserved.length&&(R.reserved=S.reserved),S.group&&(R.group=!0),S.comment&&(R.comment=S.comment),S.edition&&(R._edition=S.edition),R._defaultEdition="proto3",R},et.prototype.toJSON=function(T){var S=O.prototype.toJSON.call(this,T),R=!!T&&!!T.keepComments;return W.toObject(["edition",this._editionToJSON(),"options",S&&S.options||void 0,"oneofs",O.arrayToJSON(this.oneofsArray,T),"fields",O.arrayToJSON(this.fieldsArray.filter(function(T){return!T.declaringField}),T)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",S&&S.nested||void 0,"comment",R?this.comment:void 0])},et.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;O.prototype.resolveAll.call(this);var T=this.oneofsArray;for(R=0;R<T.length;)T[R++].resolve();for(var S=this.fieldsArray,R=0;R<S.length;)S[R++].resolve();return this},et.prototype._resolveFeaturesRecursive=function(T){return this._needsRecursiveFeatureResolution&&(T=this._edition||T,O.prototype._resolveFeaturesRecursive.call(this,T),this.oneofsArray.forEach(S=>{S._resolveFeatures(T)}),this.fieldsArray.forEach(S=>{S._resolveFeatures(T)})),this},et.prototype.get=function(T){return this.fields[T]||this.oneofs&&this.oneofs[T]||this.nested&&this.nested[T]||null},et.prototype.add=function(T){if(this.get(T.name))throw Error("duplicate name '"+T.name+"' in "+this);if(T instanceof M&&void 0===T.extend){if(this._fieldsById?this._fieldsById[T.id]:this.fieldsById[T.id])throw Error("duplicate id "+T.id+" in "+this);if(this.isReservedId(T.id))throw Error("id "+T.id+" is reserved in "+this);if(this.isReservedName(T.name))throw Error("name '"+T.name+"' is reserved in "+this);return T.parent&&T.parent.remove(T),this.fields[T.name]=T,T.message=this,T.onAdd(this),er(this)}return T instanceof P?(this.oneofs||(this.oneofs={}),this.oneofs[T.name]=T,T.onAdd(this),er(this)):O.prototype.add.call(this,T)},et.prototype.remove=function(T){if(T instanceof M&&void 0===T.extend){if(!this.fields||this.fields[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.fields[T.name],T.parent=null,T.onRemove(this),er(this)}if(T instanceof P){if(!this.oneofs||this.oneofs[T.name]!==T)throw Error(T+" is not a member of "+this);return delete this.oneofs[T.name],T.parent=null,T.onRemove(this),er(this)}return O.prototype.remove.call(this,T)},et.prototype.isReservedId=function(T){return O.isReservedId(this.reserved,T)},et.prototype.isReservedName=function(T){return O.isReservedName(this.reserved,T)},et.prototype.create=function(T){return new this.ctor(T)},et.prototype.setup=function(){for(var T=this.fullName,S=[],R=0;R<this.fieldsArray.length;++R)S.push(this._fieldsArray[R].resolve().resolvedType);this.encode=Q(this)({Writer:K,types:S,util:W}),this.decode=Y(this)({Reader:$,types:S,util:W}),this.verify=X(this)({types:S,util:W}),this.fromObject=Z.fromObject(this)({types:S,util:W}),this.toObject=Z.toObject(this)({types:S,util:W});var O=ee[T];if(O){var N=Object.create(this);N.fromObject=this.fromObject,this.fromObject=O.fromObject.bind(N),N.toObject=this.toObject,this.toObject=O.toObject.bind(N)}return this},et.prototype.encode=function(T,S){return this.setup().encode(T,S)},et.prototype.encodeDelimited=function(T,S){return this.encode(T,S&&S.len?S.fork():S).ldelim()},et.prototype.decode=function(T,S){return this.setup().decode(T,S)},et.prototype.decodeDelimited=function(T){return T instanceof $||(T=$.create(T)),this.decode(T,T.uint32())},et.prototype.verify=function(T){return this.setup().verify(T)},et.prototype.fromObject=function(T){return this.setup().fromObject(T)},et.prototype.toObject=function(T,S){return this.setup().toObject(T,S)},et.d=function(T){return function(S){W.decorateType(S,T)}}},20889:(T,S,R)=>{"use strict";var O=S,N=R(64332),P=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function M(T,S){var R=0,O={};for(S|=0;R<T.length;)O[P[R+S]]=T[R++];return O}O.basic=M([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),O.defaults=M([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",N.emptyArray,null]),O.long=M([0,0,0,1,1],7),O.mapKey=M([0,0,0,5,5,0,0,0,1,1,0,2],2),O.packed=M([1,5,0,0,0,5,5,0,0,0,1,1,0])},64332:(T,S,R)=>{"use strict";var O,N,P=T.exports=R(28290),M=R(46357);P.codegen=R(91445),P.fetch=R(14269),P.path=R(93275),P.fs=P.inquire("fs"),P.toArray=function(T){if(T){for(var S=Object.keys(T),R=Array(S.length),O=0;O<S.length;)R[O]=T[S[O++]];return R}return[]},P.toObject=function(T){for(var S={},R=0;R<T.length;){var O=T[R++],N=T[R++];void 0!==N&&(S[O]=N)}return S};var L=/\\/g,U=/"/g;P.isReserved=function(T){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(T)},P.safeProp=function(T){return!/^[$\w_]+$/.test(T)||P.isReserved(T)?'["'+T.replace(L,"\\\\").replace(U,'\\"')+'"]':"."+T},P.ucFirst=function(T){return T.charAt(0).toUpperCase()+T.substring(1)};var V=/_([a-z])/g;P.camelCase=function(T){return T.substring(0,1)+T.substring(1).replace(V,function(T,S){return S.toUpperCase()})},P.compareFieldsById=function(T,S){return T.id-S.id},P.decorateType=function(T,S){if(T.$type)return S&&T.$type.name!==S&&(P.decorateRoot.remove(T.$type),T.$type.name=S,P.decorateRoot.add(T.$type)),T.$type;O||(O=R(5166));var N=new O(S||T.name);return P.decorateRoot.add(N),N.ctor=T,Object.defineProperty(T,"$type",{value:N,enumerable:!1}),Object.defineProperty(T.prototype,"$type",{value:N,enumerable:!1}),N};var $=0;P.decorateEnum=function(T){if(T.$type)return T.$type;N||(N=R(45688));var S=new N("Enum"+$++,T);return P.decorateRoot.add(S),Object.defineProperty(T,"$type",{value:S,enumerable:!1}),S},P.setProperty=function(T,S,R,O){function N(T,S,R){var P=S.shift();if("__proto__"===P||"prototype"===P)return T;if(S.length>0)T[P]=N(T[P]||{},S,R);else{var M=T[P];if(M&&O)return T;M&&(R=[].concat(M).concat(R)),T[P]=R}return T}if("object"!=typeof T)throw TypeError("dst must be an object");if(!S)throw TypeError("path must be specified");return N(T,S=S.split("."),R)},Object.defineProperty(P,"decorateRoot",{get:function(){return M.decorated||(M.decorated=new(R(97296)))}})},3498:(T,S,R)=>{"use strict";T.exports=N;var O=R(28290);function N(T,S){this.lo=T>>>0,this.hi=S>>>0}var P=N.zero=new N(0,0);P.toNumber=function(){return 0},P.zzEncode=P.zzDecode=function(){return this},P.length=function(){return 1};var M=N.zeroHash="\x00\x00\x00\x00\x00\x00\x00\x00";N.fromNumber=function(T){if(0===T)return P;var S=T<0;S&&(T=-T);var R=T>>>0,O=(T-R)/4294967296>>>0;return S&&(O=~O>>>0,R=~R>>>0,++R>4294967295&&(R=0,++O>4294967295&&(O=0))),new N(R,O)},N.from=function(T){if("number"==typeof T)return N.fromNumber(T);if(O.isString(T)){if(!O.Long)return N.fromNumber(parseInt(T,10));T=O.Long.fromString(T)}return T.low||T.high?new N(T.low>>>0,T.high>>>0):P},N.prototype.toNumber=function(T){if(!T&&this.hi>>>31){var S=~this.lo+1>>>0,R=~this.hi>>>0;return S||(R=R+1>>>0),-(S+4294967296*R)}return this.lo+4294967296*this.hi},N.prototype.toLong=function(T){return O.Long?new O.Long(0|this.lo,0|this.hi,!!T):{low:0|this.lo,high:0|this.hi,unsigned:!!T}};var L=String.prototype.charCodeAt;N.fromHash=function(T){return T===M?P:new N((L.call(T,0)|L.call(T,1)<<8|L.call(T,2)<<16|L.call(T,3)<<24)>>>0,(L.call(T,4)|L.call(T,5)<<8|L.call(T,6)<<16|L.call(T,7)<<24)>>>0)},N.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},N.prototype.zzEncode=function(){var T=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^T)>>>0,this.lo=(this.lo<<1^T)>>>0,this},N.prototype.zzDecode=function(){var T=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^T)>>>0,this.hi=(this.hi>>>1^T)>>>0,this},N.prototype.length=function(){var T=this.lo,S=(this.lo>>>28|this.hi<<4)>>>0,R=this.hi>>>24;return 0===R?0===S?T<16384?T<128?1:2:T<2097152?3:4:S<16384?S<128?5:6:S<2097152?7:8:R<128?9:10}},28290:function(T,S,R){"use strict";var O=S;function N(T,S,R){for(var O=Object.keys(S),N=0;N<O.length;++N)void 0!==T[O[N]]&&R||(T[O[N]]=S[O[N]]);return T}function P(T){function S(T,R){if(!(this instanceof S))return new S(T,R);Object.defineProperty(this,"message",{get:function(){return T}}),Error.captureStackTrace?Error.captureStackTrace(this,S):Object.defineProperty(this,"stack",{value:Error().stack||""}),R&&N(this,R)}return S.prototype=Object.create(Error.prototype,{constructor:{value:S,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return T},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),S}O.asPromise=R(84608),O.base64=R(41585),O.EventEmitter=R(17539),O.float=R(19162),O.inquire=R(79701),O.utf8=R(1562),O.pool=R(60117),O.LongBits=R(3498),O.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),O.global=O.isNode&&global||"undefined"!=typeof self&&self||this,O.emptyArray=Object.freeze?Object.freeze([]):[],O.emptyObject=Object.freeze?Object.freeze({}):{},O.isInteger=Number.isInteger||function(T){return"number"==typeof T&&isFinite(T)&&Math.floor(T)===T},O.isString=function(T){return"string"==typeof T||T instanceof String},O.isObject=function(T){return T&&"object"==typeof T},O.isset=O.isSet=function(T,S){var R=T[S];return!!(null!=R&&T.hasOwnProperty(S))&&("object"!=typeof R||(Array.isArray(R)?R.length:Object.keys(R).length)>0)},O.Buffer=function(){try{var T=O.inquire("buffer").Buffer;return T.prototype.utf8Write?T:null}catch(T){return null}}(),O._Buffer_from=null,O._Buffer_allocUnsafe=null,O.newBuffer=function(T){return"number"==typeof T?O.Buffer?O._Buffer_allocUnsafe(T):new O.Array(T):O.Buffer?O._Buffer_from(T):"undefined"==typeof Uint8Array?T:new Uint8Array(T)},O.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,O.Long=O.global.dcodeIO&&O.global.dcodeIO.Long||O.global.Long||O.inquire("long"),O.key2Re=/^true|false|0|1$/,O.key32Re=/^-?(?:0|[1-9][0-9]*)$/,O.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,O.longToHash=function(T){return T?O.LongBits.from(T).toHash():O.LongBits.zeroHash},O.longFromHash=function(T,S){var R=O.LongBits.fromHash(T);return O.Long?O.Long.fromBits(R.lo,R.hi,S):R.toNumber(!!S)},O.merge=N,O.lcFirst=function(T){return T.charAt(0).toLowerCase()+T.substring(1)},O.newError=P,O.ProtocolError=P("ProtocolError"),O.oneOfGetter=function(T){for(var S={},R=0;R<T.length;++R)S[T[R]]=1;return function(){for(var T=Object.keys(this),R=T.length-1;R>-1;--R)if(1===S[T[R]]&&void 0!==this[T[R]]&&null!==this[T[R]])return T[R]}},O.oneOfSetter=function(T){return function(S){for(var R=0;R<T.length;++R)T[R]!==S&&delete this[T[R]]}},O.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},O._configure=function(){var T=O.Buffer;if(!T){O._Buffer_from=O._Buffer_allocUnsafe=null;return}O._Buffer_from=T.from!==Uint8Array.from&&T.from||function(S,R){return new T(S,R)},O._Buffer_allocUnsafe=T.allocUnsafe||function(S){return new T(S)}}},83980:(T,S,R)=>{"use strict";T.exports=U;var O=R(45688),N=R(64332);function P(T,S){return T.name+": "+S+(T.repeated&&"array"!==S?"[]":T.map&&"object"!==S?"{k:"+T.keyType+"}":"")+" expected"}function M(T,S,R,N){if(S.resolvedType){if(S.resolvedType instanceof O){T("switch(%s){",N)("default:")("return%j",P(S,"enum value"));for(var M=Object.keys(S.resolvedType.values),L=0;L<M.length;++L)T("case %i:",S.resolvedType.values[M[L]]);T("break")("}")}else T("{")("var e=types[%i].verify(%s);",R,N)("if(e)")("return%j+e",S.name+".")("}")}else switch(S.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":T("if(!util.isInteger(%s))",N)("return%j",P(S,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":T("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",N,N,N,N)("return%j",P(S,"integer|Long"));break;case"float":case"double":T('if(typeof %s!=="number")',N)("return%j",P(S,"number"));break;case"bool":T('if(typeof %s!=="boolean")',N)("return%j",P(S,"boolean"));break;case"string":T("if(!util.isString(%s))",N)("return%j",P(S,"string"));break;case"bytes":T('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',N,N,N)("return%j",P(S,"buffer"))}return T}function L(T,S,R){switch(S.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":T("if(!util.key32Re.test(%s))",R)("return%j",P(S,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":T("if(!util.key64Re.test(%s))",R)("return%j",P(S,"integer|Long key"));break;case"bool":T("if(!util.key2Re.test(%s))",R)("return%j",P(S,"boolean key"))}return T}function U(T){var S=N.codegen(["m"],T.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),R=T.oneofsArray,O={};R.length&&S("var p={}");for(var U=0;U<T.fieldsArray.length;++U){var V=T._fieldsArray[U].resolve(),$="m"+N.safeProp(V.name);if(V.optional&&S("if(%s!=null&&m.hasOwnProperty(%j)){",$,V.name),V.map)S("if(!util.isObject(%s))",$)("return%j",P(V,"object"))("var k=Object.keys(%s)",$)("for(var i=0;i<k.length;++i){"),L(S,V,"k[i]"),M(S,V,U,$+"[k[i]]")("}");else if(V.repeated)S("if(!Array.isArray(%s))",$)("return%j",P(V,"array"))("for(var i=0;i<%s.length;++i){",$),M(S,V,U,$+"[i]")("}");else{if(V.partOf){var K=N.safeProp(V.partOf.name);1===O[V.partOf.name]&&S("if(p%s===1)",K)("return%j",V.partOf.name+": multiple values"),O[V.partOf.name]=1,S("p%s=1",K)}M(S,V,U,$)}V.optional&&S("}")}return S("return null")}},93824:(T,S,R)=>{"use strict";var O=S,N=R(68231);O[".google.protobuf.Any"]={fromObject:function(T){if(T&&T["@type"]){var S=T["@type"].substring(T["@type"].lastIndexOf("/")+1),R=this.lookup(S);if(R){var O="."===T["@type"].charAt(0)?T["@type"].slice(1):T["@type"];return -1===O.indexOf("/")&&(O="/"+O),this.create({type_url:O,value:R.encode(R.fromObject(T)).finish()})}}return this.fromObject(T)},toObject:function(T,S){var R="type.googleapis.com/",O="",P="";if(S&&S.json&&T.type_url&&T.value){P=T.type_url.substring(T.type_url.lastIndexOf("/")+1),O=T.type_url.substring(0,T.type_url.lastIndexOf("/")+1);var M=this.lookup(P);M&&(T=M.decode(T.value))}if(!(T instanceof this.ctor)&&T instanceof N){var L=T.$type.toObject(T,S),U="."===T.$type.fullName[0]?T.$type.fullName.slice(1):T.$type.fullName;return""===O&&(O=R),P=O+U,L["@type"]=P,L}return this.toObject(T,S)}}},22316:(T,S,R)=>{"use strict";T.exports=K;var O,N=R(28290),P=N.LongBits,M=N.base64,L=N.utf8;function U(T,S,R){this.fn=T,this.len=S,this.next=void 0,this.val=R}function V(){}function $(T){this.head=T.head,this.tail=T.tail,this.len=T.len,this.next=T.states}function K(){this.len=0,this.head=new U(V,0,0),this.tail=this.head,this.states=null}var W=function(){return N.Buffer?function(){return(K.create=function(){return new O})()}:function(){return new K}};function Q(T,S,R){S[R]=255&T}function Y(T,S,R){for(;T>127;)S[R++]=127&T|128,T>>>=7;S[R]=T}function X(T,S){this.len=T,this.next=void 0,this.val=S}function Z(T,S,R){for(;T.hi;)S[R++]=127&T.lo|128,T.lo=(T.lo>>>7|T.hi<<25)>>>0,T.hi>>>=7;for(;T.lo>127;)S[R++]=127&T.lo|128,T.lo=T.lo>>>7;S[R++]=T.lo}function ee(T,S,R){S[R]=255&T,S[R+1]=T>>>8&255,S[R+2]=T>>>16&255,S[R+3]=T>>>24}K.create=W(),K.alloc=function(T){return new N.Array(T)},N.Array!==Array&&(K.alloc=N.pool(K.alloc,N.Array.prototype.subarray)),K.prototype._push=function(T,S,R){return this.tail=this.tail.next=new U(T,S,R),this.len+=S,this},X.prototype=Object.create(U.prototype),X.prototype.fn=Y,K.prototype.uint32=function(T){return this.len+=(this.tail=this.tail.next=new X((T>>>=0)<128?1:T<16384?2:T<2097152?3:T<268435456?4:5,T)).len,this},K.prototype.int32=function(T){return T<0?this._push(Z,10,P.fromNumber(T)):this.uint32(T)},K.prototype.sint32=function(T){return this.uint32((T<<1^T>>31)>>>0)},K.prototype.uint64=function(T){var S=P.from(T);return this._push(Z,S.length(),S)},K.prototype.int64=K.prototype.uint64,K.prototype.sint64=function(T){var S=P.from(T).zzEncode();return this._push(Z,S.length(),S)},K.prototype.bool=function(T){return this._push(Q,1,T?1:0)},K.prototype.fixed32=function(T){return this._push(ee,4,T>>>0)},K.prototype.sfixed32=K.prototype.fixed32,K.prototype.fixed64=function(T){var S=P.from(T);return this._push(ee,4,S.lo)._push(ee,4,S.hi)},K.prototype.sfixed64=K.prototype.fixed64,K.prototype.float=function(T){return this._push(N.float.writeFloatLE,4,T)},K.prototype.double=function(T){return this._push(N.float.writeDoubleLE,8,T)};var et=N.Array.prototype.set?function(T,S,R){S.set(T,R)}:function(T,S,R){for(var O=0;O<T.length;++O)S[R+O]=T[O]};K.prototype.bytes=function(T){var S=T.length>>>0;if(!S)return this._push(Q,1,0);if(N.isString(T)){var R=K.alloc(S=M.length(T));M.decode(T,R,0),T=R}return this.uint32(S)._push(et,S,T)},K.prototype.string=function(T){var S=L.length(T);return S?this.uint32(S)._push(L.write,S,T):this._push(Q,1,0)},K.prototype.fork=function(){return this.states=new $(this),this.head=this.tail=new U(V,0,0),this.len=0,this},K.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new U(V,0,0),this.len=0),this},K.prototype.ldelim=function(){var T=this.head,S=this.tail,R=this.len;return this.reset().uint32(R),R&&(this.tail.next=T.next,this.tail=S,this.len+=R),this},K.prototype.finish=function(){for(var T=this.head.next,S=this.constructor.alloc(this.len),R=0;T;)T.fn(T.val,S,R),R+=T.len,T=T.next;return S},K._configure=function(T){O=T,K.create=W(),O._configure()}},81445:(T,S,R)=>{"use strict";T.exports=P;var O=R(22316);(P.prototype=Object.create(O.prototype)).constructor=P;var N=R(28290);function P(){O.call(this)}function M(T,S,R){T.length<40?N.utf8.write(T,S,R):S.utf8Write?S.utf8Write(T,R):S.write(T,R)}P._configure=function(){P.alloc=N._Buffer_allocUnsafe,P.writeBytesBuffer=N.Buffer&&N.Buffer.prototype instanceof Uint8Array&&"set"===N.Buffer.prototype.set.name?function(T,S,R){S.set(T,R)}:function(T,S,R){if(T.copy)T.copy(S,R,0,T.length);else for(var O=0;O<T.length;)S[R++]=T[O++]}},P.prototype.bytes=function(T){N.isString(T)&&(T=N._Buffer_from(T,"base64"));var S=T.length>>>0;return this.uint32(S),S&&this._push(P.writeBytesBuffer,S,T),this},P.prototype.string=function(T){var S=N.Buffer.byteLength(T);return this.uint32(S),S&&this._push(M,S,T),this},P._configure()},95153:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createProxy",{enumerable:!0,get:function(){return O}});let O=R(55951).createClientModuleProxy},28730:(T,S,R)=>{let{createProxy:O}=R(95153);T.exports=O("/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/node_modules/next/dist/client/components/app-router.js")},37284:(T,S,R)=>{let{createProxy:O}=R(95153);T.exports=O("/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/node_modules/next/dist/client/components/error-boundary.js")},79195:(T,S)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{DYNAMIC_ERROR_CODE:function(){return R},DynamicServerError:function(){return O}});let R="DYNAMIC_SERVER_USAGE";class O extends Error{constructor(T){super("Dynamic server usage: "+T),this.digest=R}}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},68165:(T,S,R)=>{let{createProxy:O}=R(95153);T.exports=O("/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/node_modules/next/dist/client/components/layout-router.js")},24009:(T,S,R)=>{let{createProxy:O}=R(95153);T.exports=O("/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/node_modules/next/dist/client/components/not-found-boundary.js")},9291:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"default",{enumerable:!0,get:function(){return P}});let O=R(95196)._(R(3542)),N={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},desc:{display:"inline-block"},h1:{display:"inline-block",margin:"0 20px 0 0",padding:"0 23px 0 0",fontSize:24,fontWeight:500,verticalAlign:"top",lineHeight:"49px"},h2:{fontSize:14,fontWeight:400,lineHeight:"49px",margin:0}};function P(){return O.default.createElement(O.default.Fragment,null,O.default.createElement("title",null,"404: This page could not be found."),O.default.createElement("div",{style:N.error},O.default.createElement("div",null,O.default.createElement("style",{dangerouslySetInnerHTML:{__html:"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}),O.default.createElement("h1",{className:"next-error-h1",style:N.h1},"404"),O.default.createElement("div",{style:N.desc},O.default.createElement("h2",{style:N.h2},"This page could not be found.")))))}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},85676:(T,S,R)=>{let{createProxy:O}=R(95153);T.exports=O("/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/node_modules/next/dist/client/components/render-from-template-context.js")},31263:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"createSearchParamsBailoutProxy",{enumerable:!0,get:function(){return N}});let O=R(3657);function N(){return new Proxy({},{get(T,S){"string"==typeof S&&(0,O.staticGenerationBailout)("searchParams."+S)}})}("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},3657:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),Object.defineProperty(S,"staticGenerationBailout",{enumerable:!0,get:function(){return L}});let O=R(79195),N=R(45869);class P extends Error{constructor(...T){super(...T),this.code="NEXT_STATIC_GEN_BAILOUT"}}function M(T,S){let{dynamic:R,link:O}=S||{};return"Page"+(R?' with `dynamic = "'+R+'"`':"")+" couldn't be rendered statically because it used `"+T+"`."+(O?" See more info here: "+O:"")}let L=(T,S)=>{let{dynamic:R,link:L}=void 0===S?{}:S,U=N.staticGenerationAsyncStorage.getStore();if(!U)return!1;if(U.forceStatic)return!0;if(U.dynamicShouldError)throw new P(M(T,{link:L,dynamic:null!=R?R:"error"}));let V=M(T,{dynamic:R,link:"https://nextjs.org/docs/messages/dynamic-server-error"});if(null==U.postpone||U.postpone.call(U,T),U.revalidate=0,U.isStaticGeneration){let S=new O.DynamicServerError(V);throw U.dynamicUsageDescription=T,U.dynamicUsageStack=S.stack,S}return!1};("function"==typeof S.default||"object"==typeof S.default&&null!==S.default)&&void 0===S.default.__esModule&&(Object.defineProperty(S.default,"__esModule",{value:!0}),Object.assign(S.default,S),T.exports=S.default)},37701:(T,S,R)=>{let{createProxy:O}=R(95153);T.exports=O("/Users/brahimamzil/Downloads/DEV_APPS/----3arida/3arida-app/node_modules/next/dist/client/components/static-generation-searchparams-bailout-provider.js")},32564:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{renderToReadableStream:function(){return O.renderToReadableStream},decodeReply:function(){return O.decodeReply},decodeAction:function(){return O.decodeAction},decodeFormState:function(){return O.decodeFormState},AppRouter:function(){return N.default},LayoutRouter:function(){return P.default},RenderFromTemplateContext:function(){return M.default},staticGenerationAsyncStorage:function(){return L.staticGenerationAsyncStorage},requestAsyncStorage:function(){return U.requestAsyncStorage},actionAsyncStorage:function(){return V.actionAsyncStorage},staticGenerationBailout:function(){return $.staticGenerationBailout},createSearchParamsBailoutProxy:function(){return W.createSearchParamsBailoutProxy},serverHooks:function(){return Q},preloadStyle:function(){return Z.preloadStyle},preloadFont:function(){return Z.preloadFont},preconnect:function(){return Z.preconnect},taintObjectReference:function(){return ee.taintObjectReference},StaticGenerationSearchParamsBailoutProvider:function(){return K.default},NotFoundBoundary:function(){return Y.NotFoundBoundary},patchFetch:function(){return ei}});let O=R(55951),N=et(R(28730)),P=et(R(68165)),M=et(R(85676)),L=R(45869),U=R(54580),V=R(72934),$=R(3657),K=et(R(37701)),W=R(31263),Q=en(R(79195)),Y=R(24009),X=R(21040);R(37284);let Z=R(48483),ee=R(13369);function et(T){return T&&T.__esModule?T:{default:T}}function er(T){if("function"!=typeof WeakMap)return null;var S=new WeakMap,R=new WeakMap;return(er=function(T){return T?R:S})(T)}function en(T,S){if(!S&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var R=er(S);if(R&&R.has(T))return R.get(T);var O={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in T)if("default"!==P&&Object.prototype.hasOwnProperty.call(T,P)){var M=N?Object.getOwnPropertyDescriptor(T,P):null;M&&(M.get||M.set)?Object.defineProperty(O,P,M):O[P]=T[P]}return O.default=T,R&&R.set(T,O),O}function ei(){return(0,X.patchFetch)({serverHooks:Q,staticGenerationAsyncStorage:L.staticGenerationAsyncStorage})}},48483:(T,S,R)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{preloadStyle:function(){return P},preloadFont:function(){return M},preconnect:function(){return L}});let O=N(R(58337));function N(T){return T&&T.__esModule?T:{default:T}}function P(T,S){let R={as:"style"};"string"==typeof S&&(R.crossOrigin=S),O.default.preload(T,R)}function M(T,S,R){let N={as:"font",type:S};"string"==typeof R&&(N.crossOrigin=R),O.default.preload(T,N)}function L(T,S){O.default.preconnect(T,"string"==typeof S?{crossOrigin:S}:void 0)}},13369:(T,S,R)=>{"use strict";function O(){throw Error("Taint can only be used with the taint flag.")}Object.defineProperty(S,"__esModule",{value:!0}),function(T,S){for(var R in S)Object.defineProperty(T,R,{enumerable:!0,get:S[R]})}(S,{taintObjectReference:function(){return N},taintUniqueValue:function(){return P}}),R(3542);let N=O,P=O},67096:(T,S,R)=>{"use strict";T.exports=R(20399)},58337:(T,S,R)=>{"use strict";T.exports=R(67096).vendored["react-rsc"].ReactDOM},4656:(T,S,R)=>{"use strict";T.exports=R(67096).vendored["react-rsc"].ReactJsxRuntime},55951:(T,S,R)=>{"use strict";T.exports=R(67096).vendored["react-rsc"].ReactServerDOMWebpackServerEdge},3542:(T,S,R)=>{"use strict";T.exports=R(67096).vendored["react-rsc"].React},52189:function(T,S){var R;!function(O,N){function P(T){return T.default||T}void 0!==(R=(function(){var T={};return N(T),P(T)}).apply(S,[]))&&(T.exports=R)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(T){"use strict";Object.defineProperty(T,"__esModule",{value:!0}),T.default=void 0;/**
     * @license
     * Copyright 2009 The Closure Library Authors
     * Copyright 2020 Daniel Wirtz / The long.js Authors.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     *
     * SPDX-License-Identifier: Apache-2.0
     */var S=null;try{S=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function R(T,S,R){this.low=0|T,this.high=0|S,this.unsigned=!!R}function O(T){return!0===(T&&T.__isLong__)}function N(T){var S=Math.clz32(T&-T);return T?31-S:S}R.prototype.__isLong__,Object.defineProperty(R.prototype,"__isLong__",{value:!0}),R.isLong=O;var P={},M={};function L(T,S){var R,O,N;return S?(T>>>=0,(N=0<=T&&T<256)&&(O=M[T]))?O:(R=V(T,0,!0),N&&(M[T]=R),R):(T|=0,(N=-128<=T&&T<128)&&(O=P[T]))?O:(R=V(T,T<0?-1:0,!1),N&&(P[T]=R),R)}function U(T,S){if(isNaN(T))return S?et:ee;if(S){if(T<0)return et;if(T>=Y)return ea}else{if(T<=-X)return eo;if(T+1>=X)return es}return T<0?U(-T,S).neg():V(T%Q|0,T/Q|0,S)}function V(T,S,O){return new R(T,S,O)}R.fromInt=L,R.fromNumber=U,R.fromBits=V;var $=Math.pow;function K(T,S,R){if(0===T.length)throw Error("empty string");if("number"==typeof S?(R=S,S=!1):S=!!S,"NaN"===T||"Infinity"===T||"+Infinity"===T||"-Infinity"===T)return S?et:ee;if((R=R||10)<2||36<R)throw RangeError("radix");if((O=T.indexOf("-"))>0)throw Error("interior hyphen");if(0===O)return K(T.substring(1),S,R).neg();for(var O,N=U($(R,8)),P=ee,M=0;M<T.length;M+=8){var L=Math.min(8,T.length-M),V=parseInt(T.substring(M,M+L),R);if(L<8){var W=U($(R,L));P=P.mul(W).add(U(V))}else P=(P=P.mul(N)).add(U(V))}return P.unsigned=S,P}function W(T,S){return"number"==typeof T?U(T,S):"string"==typeof T?K(T,S):V(T.low,T.high,"boolean"==typeof S?S:T.unsigned)}R.fromString=K,R.fromValue=W;var Q=4294967296,Y=18446744073709552e3,X=0x7fffffffffffffff,Z=L(16777216),ee=L(0);R.ZERO=ee;var et=L(0,!0);R.UZERO=et;var er=L(1);R.ONE=er;var en=L(1,!0);R.UONE=en;var ei=L(-1);R.NEG_ONE=ei;var es=V(-1,2147483647,!1);R.MAX_VALUE=es;var ea=V(-1,-1,!0);R.MAX_UNSIGNED_VALUE=ea;var eo=V(0,-2147483648,!1);R.MIN_VALUE=eo;var eu=R.prototype;eu.toInt=function(){return this.unsigned?this.low>>>0:this.low},eu.toNumber=function(){return this.unsigned?(this.high>>>0)*Q+(this.low>>>0):this.high*Q+(this.low>>>0)},eu.toString=function(T){if((T=T||10)<2||36<T)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(eo))return"-"+this.neg().toString(T);var S=U(T),R=this.div(S),O=R.mul(S).sub(this);return R.toString(T)+O.toInt().toString(T)}for(var N=U($(T,6),this.unsigned),P=this,M="";;){var L=P.div(N),V=(P.sub(L.mul(N)).toInt()>>>0).toString(T);if((P=L).isZero())return V+M;for(;V.length<6;)V="0"+V;M=""+V+M}},eu.getHighBits=function(){return this.high},eu.getHighBitsUnsigned=function(){return this.high>>>0},eu.getLowBits=function(){return this.low},eu.getLowBitsUnsigned=function(){return this.low>>>0},eu.getNumBitsAbs=function(){if(this.isNegative())return this.eq(eo)?64:this.neg().getNumBitsAbs();for(var T=0!=this.high?this.high:this.low,S=31;S>0&&(T&1<<S)==0;S--);return 0!=this.high?S+33:S+1},eu.isSafeInteger=function(){var T=this.high>>21;return!T||!this.unsigned&&-1===T&&!(0===this.low&&-2097152===this.high)},eu.isZero=function(){return 0===this.high&&0===this.low},eu.eqz=eu.isZero,eu.isNegative=function(){return!this.unsigned&&this.high<0},eu.isPositive=function(){return this.unsigned||this.high>=0},eu.isOdd=function(){return(1&this.low)==1},eu.isEven=function(){return(1&this.low)==0},eu.equals=function(T){return O(T)||(T=W(T)),(this.unsigned===T.unsigned||this.high>>>31!=1||T.high>>>31!=1)&&this.high===T.high&&this.low===T.low},eu.eq=eu.equals,eu.notEquals=function(T){return!this.eq(T)},eu.neq=eu.notEquals,eu.ne=eu.notEquals,eu.lessThan=function(T){return 0>this.comp(T)},eu.lt=eu.lessThan,eu.lessThanOrEqual=function(T){return 0>=this.comp(T)},eu.lte=eu.lessThanOrEqual,eu.le=eu.lessThanOrEqual,eu.greaterThan=function(T){return this.comp(T)>0},eu.gt=eu.greaterThan,eu.greaterThanOrEqual=function(T){return this.comp(T)>=0},eu.gte=eu.greaterThanOrEqual,eu.ge=eu.greaterThanOrEqual,eu.compare=function(T){if(O(T)||(T=W(T)),this.eq(T))return 0;var S=this.isNegative(),R=T.isNegative();return S&&!R?-1:!S&&R?1:this.unsigned?T.high>>>0>this.high>>>0||T.high===this.high&&T.low>>>0>this.low>>>0?-1:1:this.sub(T).isNegative()?-1:1},eu.comp=eu.compare,eu.negate=function(){return!this.unsigned&&this.eq(eo)?eo:this.not().add(er)},eu.neg=eu.negate,eu.add=function(T){O(T)||(T=W(T));var S,R,N=this.high>>>16,P=65535&this.high,M=this.low>>>16,L=65535&this.low,U=T.high>>>16,$=65535&T.high,K=T.low>>>16,Q=65535&T.low,Y=0,X=0;return S=0+((R=0+(L+Q))>>>16),R&=65535,S+=M+K,X+=S>>>16,S&=65535,X+=P+$,Y+=X>>>16,X&=65535,Y+=N+U,V(S<<16|R,(Y&=65535)<<16|X,this.unsigned)},eu.subtract=function(T){return O(T)||(T=W(T)),this.add(T.neg())},eu.sub=eu.subtract,eu.multiply=function(T){if(this.isZero())return this;if(O(T)||(T=W(T)),S)return V(S.mul(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned);if(T.isZero())return this.unsigned?et:ee;if(this.eq(eo))return T.isOdd()?eo:ee;if(T.eq(eo))return this.isOdd()?eo:ee;if(this.isNegative())return T.isNegative()?this.neg().mul(T.neg()):this.neg().mul(T).neg();if(T.isNegative())return this.mul(T.neg()).neg();if(this.lt(Z)&&T.lt(Z))return U(this.toNumber()*T.toNumber(),this.unsigned);var R,N,P=this.high>>>16,M=65535&this.high,L=this.low>>>16,$=65535&this.low,K=T.high>>>16,Q=65535&T.high,Y=T.low>>>16,X=65535&T.low,er=0,en=0;return R=0+((N=0+$*X)>>>16),N&=65535,R+=L*X,en+=R>>>16,R&=65535,R+=$*Y,en+=R>>>16,R&=65535,en+=M*X,er+=en>>>16,en&=65535,en+=L*Y,er+=en>>>16,en&=65535,en+=$*Q,er+=en>>>16,en&=65535,er+=P*X+M*Y+L*Q+$*K,V(R<<16|N,(er&=65535)<<16|en,this.unsigned)},eu.mul=eu.multiply,eu.divide=function(T){if(O(T)||(T=W(T)),T.isZero())throw Error("division by zero");if(S){var R,N,P;return this.unsigned||-2147483648!==this.high||-1!==T.low||-1!==T.high?V((this.unsigned?S.div_u:S.div_s)(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?et:ee;if(this.unsigned){if(T.unsigned||(T=T.toUnsigned()),T.gt(this))return et;if(T.gt(this.shru(1)))return en;P=et}else{if(this.eq(eo))return T.eq(er)||T.eq(ei)?eo:T.eq(eo)?er:(R=this.shr(1).div(T).shl(1)).eq(ee)?T.isNegative()?er:ei:(N=this.sub(T.mul(R)),P=R.add(N.div(T)));if(T.eq(eo))return this.unsigned?et:ee;if(this.isNegative())return T.isNegative()?this.neg().div(T.neg()):this.neg().div(T).neg();if(T.isNegative())return this.div(T.neg()).neg();P=ee}for(N=this;N.gte(T);){for(var M=Math.ceil(Math.log(R=Math.max(1,Math.floor(N.toNumber()/T.toNumber())))/Math.LN2),L=M<=48?1:$(2,M-48),K=U(R),Q=K.mul(T);Q.isNegative()||Q.gt(N);)R-=L,Q=(K=U(R,this.unsigned)).mul(T);K.isZero()&&(K=er),P=P.add(K),N=N.sub(Q)}return P},eu.div=eu.divide,eu.modulo=function(T){return(O(T)||(T=W(T)),S)?V((this.unsigned?S.rem_u:S.rem_s)(this.low,this.high,T.low,T.high),S.get_high(),this.unsigned):this.sub(this.div(T).mul(T))},eu.mod=eu.modulo,eu.rem=eu.modulo,eu.not=function(){return V(~this.low,~this.high,this.unsigned)},eu.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},eu.clz=eu.countLeadingZeros,eu.countTrailingZeros=function(){return this.low?N(this.low):N(this.high)+32},eu.ctz=eu.countTrailingZeros,eu.and=function(T){return O(T)||(T=W(T)),V(this.low&T.low,this.high&T.high,this.unsigned)},eu.or=function(T){return O(T)||(T=W(T)),V(this.low|T.low,this.high|T.high,this.unsigned)},eu.xor=function(T){return O(T)||(T=W(T)),V(this.low^T.low,this.high^T.high,this.unsigned)},eu.shiftLeft=function(T){return(O(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?V(this.low<<T,this.high<<T|this.low>>>32-T,this.unsigned):V(0,this.low<<T-32,this.unsigned)},eu.shl=eu.shiftLeft,eu.shiftRight=function(T){return(O(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?V(this.low>>>T|this.high<<32-T,this.high>>T,this.unsigned):V(this.high>>T-32,this.high>=0?0:-1,this.unsigned)},eu.shr=eu.shiftRight,eu.shiftRightUnsigned=function(T){return(O(T)&&(T=T.toInt()),0==(T&=63))?this:T<32?V(this.low>>>T|this.high<<32-T,this.high>>>T,this.unsigned):32===T?V(this.high,0,this.unsigned):V(this.high>>>T-32,0,this.unsigned)},eu.shru=eu.shiftRightUnsigned,eu.shr_u=eu.shiftRightUnsigned,eu.rotateLeft=function(T){var S;return(O(T)&&(T=T.toInt()),0==(T&=63))?this:32===T?V(this.high,this.low,this.unsigned):T<32?(S=32-T,V(this.low<<T|this.high>>>S,this.high<<T|this.low>>>S,this.unsigned)):(T-=32,S=32-T,V(this.high<<T|this.low>>>S,this.low<<T|this.high>>>S,this.unsigned))},eu.rotl=eu.rotateLeft,eu.rotateRight=function(T){var S;return(O(T)&&(T=T.toInt()),0==(T&=63))?this:32===T?V(this.high,this.low,this.unsigned):T<32?(S=32-T,V(this.high<<S|this.low>>>T,this.low<<S|this.high>>>T,this.unsigned)):(T-=32,S=32-T,V(this.low<<S|this.high>>>T,this.high<<S|this.low>>>T,this.unsigned))},eu.rotr=eu.rotateRight,eu.toSigned=function(){return this.unsigned?V(this.low,this.high,!1):this},eu.toUnsigned=function(){return this.unsigned?this:V(this.low,this.high,!0)},eu.toBytes=function(T){return T?this.toBytesLE():this.toBytesBE()},eu.toBytesLE=function(){var T=this.high,S=this.low;return[255&S,S>>>8&255,S>>>16&255,S>>>24,255&T,T>>>8&255,T>>>16&255,T>>>24]},eu.toBytesBE=function(){var T=this.high,S=this.low;return[T>>>24,T>>>16&255,T>>>8&255,255&T,S>>>24,S>>>16&255,S>>>8&255,255&S]},R.fromBytes=function(T,S,O){return O?R.fromBytesLE(T,S):R.fromBytesBE(T,S)},R.fromBytesLE=function(T,S){return new R(T[0]|T[1]<<8|T[2]<<16|T[3]<<24,T[4]|T[5]<<8|T[6]<<16|T[7]<<24,S)},R.fromBytesBE=function(T,S){return new R(T[4]<<24|T[5]<<16|T[6]<<8|T[7],T[0]<<24|T[1]<<16|T[2]<<8|T[3],S)},"function"==typeof BigInt&&(R.fromBigInt=function(T,S){return V(Number(BigInt.asIntN(32,T)),Number(BigInt.asIntN(32,T>>BigInt(32))),S)},R.fromValue=function(T,S){return"bigint"==typeof T?R.fromBigInt(T,S):W(T,S)},eu.toBigInt=function(){var T=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|T}),T.default=R})},20662:(T,S,R)=>{"use strict";R.d(S,{C6:()=>eh,Jn:()=>eu,KN:()=>ef,Mq:()=>ed,Xd:()=>er,ZF:()=>ec,qX:()=>en,rh:()=>ei});var O=R(84803),N=R(61062),P=R(62646),M=R(82912);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(T){this.container=T}getPlatformInfoString(){return this.container.getProviders().map(T=>{if(!U(T))return null;{let S=T.getImmediate();return`${S.library}/${S.version}`}}).filter(T=>T).join(" ")}}function U(T){let S=T.getComponent();return(null==S?void 0:S.type)==="VERSION"}let V="@firebase/app",$="0.10.13",K=new N.Yd("@firebase/app"),W="10.14.1",Q="[DEFAULT]",Y={[V]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai-preview":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},X=new Map,Z=new Map,ee=new Map;function et(T,S){try{T.container.addComponent(S)}catch(R){K.debug(`Component ${S.name} failed to register with FirebaseApp ${T.name}`,R)}}function er(T){let S=T.name;if(ee.has(S))return K.debug(`There were multiple attempts to register component ${S}.`),!1;for(let R of(ee.set(S,T),X.values()))et(R,T);for(let S of Z.values())et(S,T);return!0}function en(T,S){let R=T.container.getProvider("heartbeat").getImmediate({optional:!0});return R&&R.triggerHeartbeat(),T.container.getProvider(S)}function ei(T){return void 0!==T.settings}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let es={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ea=new P.LL("app","Firebase",es);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(T,S,R){this._isDeleted=!1,this._options=Object.assign({},T),this._config=Object.assign({},S),this._name=S.name,this._automaticDataCollectionEnabled=S.automaticDataCollectionEnabled,this._container=R,this.container.addComponent(new O.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(T){this.checkDestroyed(),this._automaticDataCollectionEnabled=T}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(T){this._isDeleted=T}checkDestroyed(){if(this.isDeleted)throw ea.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eu=W;function ec(T,S={}){let R=T;"object"!=typeof S&&(S={name:S});let N=Object.assign({name:Q,automaticDataCollectionEnabled:!1},S),M=N.name;if("string"!=typeof M||!M)throw ea.create("bad-app-name",{appName:String(M)});if(R||(R=(0,P.aH)()),!R)throw ea.create("no-options");let L=X.get(M);if(L){if((0,P.vZ)(R,L.options)&&(0,P.vZ)(N,L.config))return L;throw ea.create("duplicate-app",{appName:M})}let U=new O.H0(M);for(let T of ee.values())U.addComponent(T);let V=new eo(R,N,U);return X.set(M,V),V}function ed(T=Q){let S=X.get(T);if(!S&&T===Q&&(0,P.aH)())return ec();if(!S)throw ea.create("no-app",{appName:T});return S}function eh(){return Array.from(X.values())}function ef(T,S,R){var N;let P=null!==(N=Y[T])&&void 0!==N?N:T;R&&(P+=`-${R}`);let M=P.match(/\s|\//),L=S.match(/\s|\//);if(M||L){let T=[`Unable to register library "${P}" with version "${S}":`];M&&T.push(`library name "${P}" contains illegal characters (whitespace or "/")`),M&&L&&T.push("and"),L&&T.push(`version name "${S}" contains illegal characters (whitespace or "/")`),K.warn(T.join(" "));return}er(new O.wA(`${P}-version`,()=>({library:P,version:S}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep="firebase-heartbeat-database",eg=1,em="firebase-heartbeat-store",ey=null;function ev(){return ey||(ey=(0,M.X3)(ep,eg,{upgrade:(T,S)=>{if(0===S)try{T.createObjectStore(em)}catch(T){console.warn(T)}}}).catch(T=>{throw ea.create("idb-open",{originalErrorMessage:T.message})})),ey}async function eb(T){try{let S=(await ev()).transaction(em),R=await S.objectStore(em).get(eS(T));return await S.done,R}catch(T){if(T instanceof P.ZR)K.warn(T.message);else{let S=ea.create("idb-get",{originalErrorMessage:null==T?void 0:T.message});K.warn(S.message)}}}async function eT(T,S){try{let R=(await ev()).transaction(em,"readwrite"),O=R.objectStore(em);await O.put(S,eS(T)),await R.done}catch(T){if(T instanceof P.ZR)K.warn(T.message);else{let S=ea.create("idb-set",{originalErrorMessage:null==T?void 0:T.message});K.warn(S.message)}}}function eS(T){return`${T.name}!${T.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e_=1024,eE=2592e6;class ew{constructor(T){this.container=T,this._heartbeatsCache=null;let S=this.container.getProvider("app").getImmediate();this._storage=new eR(S),this._heartbeatsCachePromise=this._storage.read().then(T=>(this._heartbeatsCache=T,T))}async triggerHeartbeat(){var T,S;try{let R=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),O=eC();if((null===(T=this._heartbeatsCache)||void 0===T?void 0:T.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null===(S=this._heartbeatsCache)||void 0===S?void 0:S.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===O||this._heartbeatsCache.heartbeats.some(T=>T.date===O))return;return this._heartbeatsCache.heartbeats.push({date:O,agent:R}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(T=>{let S=new Date(T.date).valueOf();return Date.now()-S<=eE}),this._storage.overwrite(this._heartbeatsCache)}catch(T){K.warn(T)}}async getHeartbeatsHeader(){var T;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null===(T=this._heartbeatsCache)||void 0===T?void 0:T.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let S=eC(),{heartbeatsToSend:R,unsentEntries:O}=eI(this._heartbeatsCache.heartbeats),N=(0,P.L)(JSON.stringify({version:2,heartbeats:R}));return this._heartbeatsCache.lastSentHeartbeatDate=S,O.length>0?(this._heartbeatsCache.heartbeats=O,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),N}catch(T){return K.warn(T),""}}}function eC(){return new Date().toISOString().substring(0,10)}function eI(T,S=e_){let R=[],O=T.slice();for(let N of T){let T=R.find(T=>T.agent===N.agent);if(T){if(T.dates.push(N.date),eO(R)>S){T.dates.pop();break}}else if(R.push({agent:N.agent,dates:[N.date]}),eO(R)>S){R.pop();break}O=O.slice(1)}return{heartbeatsToSend:R,unsentEntries:O}}class eR{constructor(T){this.app=T,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,P.hl)()&&(0,P.eu)().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let T=await eb(this.app);return(null==T?void 0:T.heartbeats)?T:{heartbeats:[]}}}async overwrite(T){var S;if(await this._canUseIndexedDBPromise){let R=await this.read();return eT(this.app,{lastSentHeartbeatDate:null!==(S=T.lastSentHeartbeatDate)&&void 0!==S?S:R.lastSentHeartbeatDate,heartbeats:T.heartbeats})}}async add(T){var S;if(await this._canUseIndexedDBPromise){let R=await this.read();return eT(this.app,{lastSentHeartbeatDate:null!==(S=T.lastSentHeartbeatDate)&&void 0!==S?S:R.lastSentHeartbeatDate,heartbeats:[...R.heartbeats,...T.heartbeats]})}}}function eO(T){return(0,P.L)(JSON.stringify({version:2,heartbeats:T})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(T){er(new O.wA("platform-logger",T=>new L(T),"PRIVATE")),er(new O.wA("heartbeat",T=>new ew(T),"PRIVATE")),ef(V,$,""),ef(V,$,"esm2017"),ef("fire-js","")})(0)},84803:(T,S,R)=>{"use strict";R.d(S,{H0:()=>V,wA:()=>N});var O=R(62646);class N{constructor(T,S,R){this.name=T,this.instanceFactory=S,this.type=R,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(T){return this.instantiationMode=T,this}setMultipleInstances(T){return this.multipleInstances=T,this}setServiceProps(T){return this.serviceProps=T,this}setInstanceCreatedCallback(T){return this.onInstanceCreated=T,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(T,S){this.name=T,this.container=S,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(T){let S=this.normalizeInstanceIdentifier(T);if(!this.instancesDeferred.has(S)){let T=new O.BH;if(this.instancesDeferred.set(S,T),this.isInitialized(S)||this.shouldAutoInitialize())try{let R=this.getOrInitializeService({instanceIdentifier:S});R&&T.resolve(R)}catch(T){}}return this.instancesDeferred.get(S).promise}getImmediate(T){var S;let R=this.normalizeInstanceIdentifier(null==T?void 0:T.identifier),O=null!==(S=null==T?void 0:T.optional)&&void 0!==S&&S;if(this.isInitialized(R)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:R})}catch(T){if(O)return null;throw T}else{if(O)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(T){if(T.name!==this.name)throw Error(`Mismatching Component ${T.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=T,this.shouldAutoInitialize()){if(U(T))try{this.getOrInitializeService({instanceIdentifier:P})}catch(T){}for(let[T,S]of this.instancesDeferred.entries()){let R=this.normalizeInstanceIdentifier(T);try{let T=this.getOrInitializeService({instanceIdentifier:R});S.resolve(T)}catch(T){}}}}clearInstance(T=P){this.instancesDeferred.delete(T),this.instancesOptions.delete(T),this.instances.delete(T)}async delete(){let T=Array.from(this.instances.values());await Promise.all([...T.filter(T=>"INTERNAL"in T).map(T=>T.INTERNAL.delete()),...T.filter(T=>"_delete"in T).map(T=>T._delete())])}isComponentSet(){return null!=this.component}isInitialized(T=P){return this.instances.has(T)}getOptions(T=P){return this.instancesOptions.get(T)||{}}initialize(T={}){let{options:S={}}=T,R=this.normalizeInstanceIdentifier(T.instanceIdentifier);if(this.isInitialized(R))throw Error(`${this.name}(${R}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let O=this.getOrInitializeService({instanceIdentifier:R,options:S});for(let[T,S]of this.instancesDeferred.entries())R===this.normalizeInstanceIdentifier(T)&&S.resolve(O);return O}onInit(T,S){var R;let O=this.normalizeInstanceIdentifier(S),N=null!==(R=this.onInitCallbacks.get(O))&&void 0!==R?R:new Set;N.add(T),this.onInitCallbacks.set(O,N);let P=this.instances.get(O);return P&&T(P,O),()=>{N.delete(T)}}invokeOnInitCallbacks(T,S){let R=this.onInitCallbacks.get(S);if(R)for(let O of R)try{O(T,S)}catch(T){}}getOrInitializeService({instanceIdentifier:T,options:S={}}){let R=this.instances.get(T);if(!R&&this.component&&(R=this.component.instanceFactory(this.container,{instanceIdentifier:L(T),options:S}),this.instances.set(T,R),this.instancesOptions.set(T,S),this.invokeOnInitCallbacks(R,T),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,T,R)}catch(T){}return R||null}normalizeInstanceIdentifier(T=P){return this.component?this.component.multipleInstances?T:P:T}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function L(T){return T===P?void 0:T}function U(T){return"EAGER"===T.instantiationMode}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(T){this.name=T,this.providers=new Map}addComponent(T){let S=this.getProvider(T.name);if(S.isComponentSet())throw Error(`Component ${T.name} has already been registered with ${this.name}`);S.setComponent(T)}addOrOverwriteComponent(T){this.getProvider(T.name).isComponentSet()&&this.providers.delete(T.name),this.addComponent(T)}getProvider(T){if(this.providers.has(T))return this.providers.get(T);let S=new M(T,this);return this.providers.set(T,S),S}getProviders(){return Array.from(this.providers.values())}}},35890:(T,S,R)=>{"use strict";var O=R(20662),N=R(84803),P=R(62646),M=R(82912);let L="@firebase/installations",U="0.6.9",V=1e4,$=`w:${U}`,K="FIS_v2",W="https://firebaseinstallations.googleapis.com/v1",Q=36e5,Y="installations",X="Installations",Z={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ee=new P.LL(Y,X,Z);function et(T){return T instanceof P.ZR&&T.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er({projectId:T}){return`${W}/projects/${T}/installations`}function en(T){return{token:T.token,requestStatus:2,expiresIn:eu(T.expiresIn),creationTime:Date.now()}}async function ei(T,S){let R=(await S.json()).error;return ee.create("request-failed",{requestName:T,serverCode:R.code,serverMessage:R.message,serverStatus:R.status})}function es({apiKey:T}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":T})}function ea(T,{refreshToken:S}){let R=es(T);return R.append("Authorization",ec(S)),R}async function eo(T){let S=await T();return S.status>=500&&S.status<600?T():S}function eu(T){return Number(T.replace("s","000"))}function ec(T){return`${K} ${T}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ed({appConfig:T,heartbeatServiceProvider:S},{fid:R}){let O=er(T),N=es(T),P=S.getImmediate({optional:!0});if(P){let T=await P.getHeartbeatsHeader();T&&N.append("x-firebase-client",T)}let M={method:"POST",headers:N,body:JSON.stringify({fid:R,authVersion:K,appId:T.appId,sdkVersion:$})},L=await eo(()=>fetch(O,M));if(L.ok){let T=await L.json();return{fid:T.fid||R,registrationStatus:2,refreshToken:T.refreshToken,authToken:en(T.authToken)}}throw await ei("Create Installation",L)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(T){return new Promise(S=>{setTimeout(S,T)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(T){return btoa(String.fromCharCode(...T)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep=/^[cdef][\w-]{21}$/,eg="";function em(){try{let T=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(T),T[0]=112+T[0]%16;let S=ey(T);return ep.test(S)?S:eg}catch(T){return eg}}function ey(T){return ef(T).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(T){return`${T.appName}!${T.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eb=new Map;function eT(T,S){let R=ev(T);eS(R,S),e_(R,S)}function eS(T,S){let R=eb.get(T);if(R)for(let T of R)T(S)}function e_(T,S){let R=ew();R&&R.postMessage({key:T,fid:S}),eC()}let eE=null;function ew(){return!eE&&"BroadcastChannel"in self&&((eE=new BroadcastChannel("[Firebase] FID Change")).onmessage=T=>{eS(T.data.key,T.data.fid)}),eE}function eC(){0===eb.size&&eE&&(eE.close(),eE=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eI="firebase-installations-database",eR=1,eO="firebase-installations-store",eA=null;function ek(){return eA||(eA=(0,M.X3)(eI,eR,{upgrade:(T,S)=>{0===S&&T.createObjectStore(eO)}})),eA}async function eN(T,S){let R=ev(T),O=(await ek()).transaction(eO,"readwrite"),N=O.objectStore(eO),P=await N.get(R);return await N.put(S,R),await O.done,P&&P.fid===S.fid||eT(T,S.fid),S}async function eD(T){let S=ev(T),R=(await ek()).transaction(eO,"readwrite");await R.objectStore(eO).delete(S),await R.done}async function eP(T,S){let R=ev(T),O=(await ek()).transaction(eO,"readwrite"),N=O.objectStore(eO),P=await N.get(R),M=S(P);return void 0===M?await N.delete(R):await N.put(M,R),await O.done,M&&(!P||P.fid!==M.fid)&&eT(T,M.fid),M}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ex(T){let S;let R=await eP(T.appConfig,R=>{let O=eL(T,eM(R));return S=O.registrationPromise,O.installationEntry});return R.fid===eg?{installationEntry:await S}:{installationEntry:R,registrationPromise:S}}function eM(T){return eB(T||{fid:em(),registrationStatus:0})}function eL(T,S){if(0===S.registrationStatus){if(!navigator.onLine)return{installationEntry:S,registrationPromise:Promise.reject(ee.create("app-offline"))};let R={fid:S.fid,registrationStatus:1,registrationTime:Date.now()},O=eF(T,R);return{installationEntry:R,registrationPromise:O}}return 1===S.registrationStatus?{installationEntry:S,registrationPromise:ej(T)}:{installationEntry:S}}async function eF(T,S){try{let R=await ed(T,S);return eN(T.appConfig,R)}catch(R){throw et(R)&&409===R.customData.serverCode?await eD(T.appConfig):await eN(T.appConfig,{fid:S.fid,registrationStatus:0}),R}}async function ej(T){let S=await eU(T.appConfig);for(;1===S.registrationStatus;)await eh(100),S=await eU(T.appConfig);if(0===S.registrationStatus){let{installationEntry:S,registrationPromise:R}=await ex(T);return R||S}return S}function eU(T){return eP(T,T=>{if(!T)throw ee.create("installation-not-found");return eB(T)})}function eB(T){return eV(T)?{fid:T.fid,registrationStatus:0}:T}function eV(T){return 1===T.registrationStatus&&T.registrationTime+V<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ez({appConfig:T,heartbeatServiceProvider:S},R){let O=eq(T,R),N=ea(T,R),P=S.getImmediate({optional:!0});if(P){let T=await P.getHeartbeatsHeader();T&&N.append("x-firebase-client",T)}let M={method:"POST",headers:N,body:JSON.stringify({installation:{sdkVersion:$,appId:T.appId}})},L=await eo(()=>fetch(O,M));if(L.ok)return en(await L.json());throw await ei("Generate Auth Token",L)}function eq(T,{fid:S}){return`${er(T)}/${S}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eG(T,S=!1){let R;let O=await eP(T.appConfig,O=>{if(!eW(O))throw ee.create("not-registered");let N=O.authToken;if(!S&&eQ(N))return O;if(1===N.requestStatus)return R=eH(T,S),O;{if(!navigator.onLine)throw ee.create("app-offline");let S=eJ(O);return R=eK(T,S),S}});return R?await R:O.authToken}async function eH(T,S){let R=await e$(T.appConfig);for(;1===R.authToken.requestStatus;)await eh(100),R=await e$(T.appConfig);let O=R.authToken;return 0===O.requestStatus?eG(T,S):O}function e$(T){return eP(T,T=>{if(!eW(T))throw ee.create("not-registered");return eX(T.authToken)?Object.assign(Object.assign({},T),{authToken:{requestStatus:0}}):T})}async function eK(T,S){try{let R=await ez(T,S),O=Object.assign(Object.assign({},S),{authToken:R});return await eN(T.appConfig,O),R}catch(R){if(et(R)&&(401===R.customData.serverCode||404===R.customData.serverCode))await eD(T.appConfig);else{let R=Object.assign(Object.assign({},S),{authToken:{requestStatus:0}});await eN(T.appConfig,R)}throw R}}function eW(T){return void 0!==T&&2===T.registrationStatus}function eQ(T){return 2===T.requestStatus&&!eY(T)}function eY(T){let S=Date.now();return S<T.creationTime||T.creationTime+T.expiresIn<S+Q}function eJ(T){let S={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},T),{authToken:S})}function eX(T){return 1===T.requestStatus&&T.requestTime+V<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eZ(T){let S=T,{installationEntry:R,registrationPromise:O}=await ex(S);return O?O.catch(console.error):eG(S).catch(console.error),R.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e0(T,S=!1){let R=T;return await e1(R),(await eG(R,S)).token}async function e1(T){let{registrationPromise:S}=await ex(T);S&&await S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(T){if(!T||!T.options)throw e3("App Configuration");if(!T.name)throw e3("App Name");for(let S of["projectId","apiKey","appId"])if(!T.options[S])throw e3(S);return{appName:T.name,projectId:T.options.projectId,apiKey:T.options.apiKey,appId:T.options.appId}}function e3(T){return ee.create("missing-app-config-values",{valueName:T})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e4="installations",e6="installations-internal",e9=T=>{let S=T.getProvider("app").getImmediate(),R=e2(S),N=(0,O.qX)(S,"heartbeat");return{app:S,appConfig:R,heartbeatServiceProvider:N,_delete:()=>Promise.resolve()}},e5=T=>{let S=T.getProvider("app").getImmediate(),R=(0,O.qX)(S,e4).getImmediate();return{getId:()=>eZ(R),getToken:T=>e0(R,T)}};(function(){(0,O.Xd)(new N.wA(e4,e9,"PUBLIC")),(0,O.Xd)(new N.wA(e6,e5,"PRIVATE"))})(),(0,O.KN)(L,U),(0,O.KN)(L,U,"esm2017")},61062:(T,S,R)=>{"use strict";var O;R.d(S,{Yd:()=>V,in:()=>O});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N=[];!function(T){T[T.DEBUG=0]="DEBUG",T[T.VERBOSE=1]="VERBOSE",T[T.INFO=2]="INFO",T[T.WARN=3]="WARN",T[T.ERROR=4]="ERROR",T[T.SILENT=5]="SILENT"}(O||(O={}));let P={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},M=O.INFO,L={[O.DEBUG]:"log",[O.VERBOSE]:"log",[O.INFO]:"info",[O.WARN]:"warn",[O.ERROR]:"error"},U=(T,S,...R)=>{if(S<T.logLevel)return;let O=new Date().toISOString(),N=L[S];if(N)console[N](`[${O}]  ${T.name}:`,...R);else throw Error(`Attempted to log a message with an invalid logType (value: ${S})`)};class V{constructor(T){this.name=T,this._logLevel=M,this._logHandler=U,this._userLogHandler=null,N.push(this)}get logLevel(){return this._logLevel}set logLevel(T){if(!(T in O))throw TypeError(`Invalid value "${T}" assigned to \`logLevel\``);this._logLevel=T}setLogLevel(T){this._logLevel="string"==typeof T?P[T]:T}get logHandler(){return this._logHandler}set logHandler(T){if("function"!=typeof T)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=T}get userLogHandler(){return this._userLogHandler}set userLogHandler(T){this._userLogHandler=T}debug(...T){this._userLogHandler&&this._userLogHandler(this,O.DEBUG,...T),this._logHandler(this,O.DEBUG,...T)}log(...T){this._userLogHandler&&this._userLogHandler(this,O.VERBOSE,...T),this._logHandler(this,O.VERBOSE,...T)}info(...T){this._userLogHandler&&this._userLogHandler(this,O.INFO,...T),this._logHandler(this,O.INFO,...T)}warn(...T){this._userLogHandler&&this._userLogHandler(this,O.WARN,...T),this._logHandler(this,O.WARN,...T)}error(...T){this._userLogHandler&&this._userLogHandler(this,O.ERROR,...T),this._logHandler(this,O.ERROR,...T)}}},62646:(T,S,R)=>{"use strict";R.d(S,{$s:()=>eP,BH:()=>er,G6:()=>ed,L:()=>V,LL:()=>ey,L_:()=>eo,P0:()=>ee,Sg:()=>en,ZR:()=>em,aH:()=>et,b$:()=>ec,eu:()=>ef,hl:()=>eh,m9:()=>ex,ne:()=>eC,pd:()=>ew,q4:()=>Z,ru:()=>eu,tV:()=>$,uI:()=>es,vZ:()=>eT,xO:()=>e_,z$:()=>ei,zI:()=>ep,zd:()=>eE});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O={NODE_CLIENT:!1},N=function(T){let S=[],R=0;for(let O=0;O<T.length;O++){let N=T.charCodeAt(O);N<128?S[R++]=N:(N<2048?S[R++]=N>>6|192:((64512&N)==55296&&O+1<T.length&&(64512&T.charCodeAt(O+1))==56320?(N=65536+((1023&N)<<10)+(1023&T.charCodeAt(++O)),S[R++]=N>>18|240,S[R++]=N>>12&63|128):S[R++]=N>>12|224,S[R++]=N>>6&63|128),S[R++]=63&N|128)}return S},P=function(T){let S=[],R=0,O=0;for(;R<T.length;){let N=T[R++];if(N<128)S[O++]=String.fromCharCode(N);else if(N>191&&N<224){let P=T[R++];S[O++]=String.fromCharCode((31&N)<<6|63&P)}else if(N>239&&N<365){let P=((7&N)<<18|(63&T[R++])<<12|(63&T[R++])<<6|63&T[R++])-65536;S[O++]=String.fromCharCode(55296+(P>>10)),S[O++]=String.fromCharCode(56320+(1023&P))}else{let P=T[R++],M=T[R++];S[O++]=String.fromCharCode((15&N)<<12|(63&P)<<6|63&M)}}return S.join("")},M={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(T,S){if(!Array.isArray(T))throw Error("encodeByteArray takes an array as a parameter");this.init_();let R=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,O=[];for(let S=0;S<T.length;S+=3){let N=T[S],P=S+1<T.length,M=P?T[S+1]:0,L=S+2<T.length,U=L?T[S+2]:0,V=N>>2,$=(3&N)<<4|M>>4,K=(15&M)<<2|U>>6,W=63&U;L||(W=64,P||(K=64)),O.push(R[V],R[$],R[K],R[W])}return O.join("")},encodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(T):this.encodeByteArray(N(T),S)},decodeString(T,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(T):P(this.decodeStringToByteArray(T,S))},decodeStringToByteArray(T,S){this.init_();let R=S?this.charToByteMapWebSafe_:this.charToByteMap_,O=[];for(let S=0;S<T.length;){let N=R[T.charAt(S++)],P=S<T.length?R[T.charAt(S)]:0,M=++S<T.length?R[T.charAt(S)]:64,U=++S<T.length?R[T.charAt(S)]:64;if(++S,null==N||null==P||null==M||null==U)throw new L;let V=N<<2|P>>4;if(O.push(V),64!==M){let T=P<<4&240|M>>2;if(O.push(T),64!==U){let T=M<<6&192|U;O.push(T)}}}return O},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let T=0;T<this.ENCODED_VALS.length;T++)this.byteToCharMap_[T]=this.ENCODED_VALS.charAt(T),this.charToByteMap_[this.byteToCharMap_[T]]=T,this.byteToCharMapWebSafe_[T]=this.ENCODED_VALS_WEBSAFE.charAt(T),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[T]]=T,T>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(T)]=T,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(T)]=T)}}};class L extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let U=function(T){let S=N(T);return M.encodeByteArray(S,!0)},V=function(T){return U(T).replace(/\./g,"")},$=function(T){try{return M.decodeString(T,!0)}catch(T){console.error("base64Decode failed: ",T)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(){if("undefined"!=typeof self)return self;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let W=()=>K().__FIREBASE_DEFAULTS__,Q=()=>{if("undefined"==typeof process||void 0===process.env)return;let T=process.env.__FIREBASE_DEFAULTS__;if(T)return JSON.parse(T)},Y=()=>{let T;if("undefined"==typeof document)return;try{T=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(T){return}let S=T&&$(T[1]);return S&&JSON.parse(S)},X=()=>{try{return W()||Q()||Y()}catch(T){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${T}`);return}},Z=T=>{var S,R;return null===(R=null===(S=X())||void 0===S?void 0:S.emulatorHosts)||void 0===R?void 0:R[T]},ee=T=>{let S=Z(T);if(!S)return;let R=S.lastIndexOf(":");if(R<=0||R+1===S.length)throw Error(`Invalid host ${S} with no separate hostname and port!`);let O=parseInt(S.substring(R+1),10);return"["===S[0]?[S.substring(1,R-1),O]:[S.substring(0,R),O]},et=()=>{var T;return null===(T=X())||void 0===T?void 0:T.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((T,S)=>{this.resolve=T,this.reject=S})}wrapCallback(T){return(S,R)=>{S?this.reject(S):this.resolve(R),"function"==typeof T&&(this.promise.catch(()=>{}),1===T.length?T(S):T(S,R))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(T,S){if(T.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let R={alg:"none",type:"JWT"},O=S||"demo-project",N=T.iat||0,P=T.sub||T.user_id;if(!P)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let M=Object.assign({iss:`https://securetoken.google.com/${O}`,aud:O,iat:N,exp:N+3600,auth_time:N,sub:P,user_id:P,firebase:{sign_in_provider:"custom",identities:{}}},T),L="";return[V(JSON.stringify(R)),V(JSON.stringify(M)),L].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function es(){return!1}function ea(){var T;let S=null===(T=X())||void 0===T?void 0:T.forceEnvironment;if("node"===S)return!0;if("browser"===S)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(T){return!1}}function eo(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function eu(){let T="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof T&&void 0!==T.id}function ec(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ed(){return!ea()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function eh(){try{return"object"==typeof indexedDB}catch(T){return!1}}function ef(){return new Promise((T,S)=>{try{let R=!0,O="validate-browser-context-for-indexeddb-analytics-module",N=self.indexedDB.open(O);N.onsuccess=()=>{N.result.close(),R||self.indexedDB.deleteDatabase(O),T(!0)},N.onupgradeneeded=()=>{R=!1},N.onerror=()=>{var T;S((null===(T=N.error)||void 0===T?void 0:T.message)||"")}}catch(T){S(T)}})}function ep(){return"undefined"!=typeof navigator&&!!navigator.cookieEnabled}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eg="FirebaseError";class em extends Error{constructor(T,S,R){super(S),this.code=T,this.customData=R,this.name=eg,Object.setPrototypeOf(this,em.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ey.prototype.create)}}class ey{constructor(T,S,R){this.service=T,this.serviceName=S,this.errors=R}create(T,...S){let R=S[0]||{},O=`${this.service}/${T}`,N=this.errors[T],P=N?ev(N,R):"Error",M=`${this.serviceName}: ${P} (${O}).`;return new em(O,M,R)}}function ev(T,S){return T.replace(eb,(T,R)=>{let O=S[R];return null!=O?String(O):`<${R}?>`})}let eb=/\{\$([^}]+)}/g;function eT(T,S){if(T===S)return!0;let R=Object.keys(T),O=Object.keys(S);for(let N of R){if(!O.includes(N))return!1;let R=T[N],P=S[N];if(eS(R)&&eS(P)){if(!eT(R,P))return!1}else if(R!==P)return!1}for(let T of O)if(!R.includes(T))return!1;return!0}function eS(T){return null!==T&&"object"==typeof T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(T){let S=[];for(let[R,O]of Object.entries(T))Array.isArray(O)?O.forEach(T=>{S.push(encodeURIComponent(R)+"="+encodeURIComponent(T))}):S.push(encodeURIComponent(R)+"="+encodeURIComponent(O));return S.length?"&"+S.join("&"):""}function eE(T){let S={};return T.replace(/^\?/,"").split("&").forEach(T=>{if(T){let[R,O]=T.split("=");S[decodeURIComponent(R)]=decodeURIComponent(O)}}),S}function ew(T){let S=T.indexOf("?");if(!S)return"";let R=T.indexOf("#",S);return T.substring(S,R>0?R:void 0)}function eC(T,S){let R=new eI(T,S);return R.subscribe.bind(R)}class eI{constructor(T,S){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=S,this.task.then(()=>{T(this)}).catch(T=>{this.error(T)})}next(T){this.forEachObserver(S=>{S.next(T)})}error(T){this.forEachObserver(S=>{S.error(T)}),this.close(T)}complete(){this.forEachObserver(T=>{T.complete()}),this.close()}subscribe(T,S,R){let O;if(void 0===T&&void 0===S&&void 0===R)throw Error("Missing Observer.");void 0===(O=eR(T,["next","error","complete"])?T:{next:T,error:S,complete:R}).next&&(O.next=eO),void 0===O.error&&(O.error=eO),void 0===O.complete&&(O.complete=eO);let N=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?O.error(this.finalError):O.complete()}catch(T){}}),this.observers.push(O),N}unsubscribeOne(T){void 0!==this.observers&&void 0!==this.observers[T]&&(delete this.observers[T],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(T){if(!this.finalized)for(let S=0;S<this.observers.length;S++)this.sendOne(S,T)}sendOne(T,S){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[T])try{S(this.observers[T])}catch(T){"undefined"!=typeof console&&console.error&&console.error(T)}})}close(T){this.finalized||(this.finalized=!0,void 0!==T&&(this.finalError=T),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function eR(T,S){if("object"!=typeof T||null===T)return!1;for(let R of S)if(R in T&&"function"==typeof T[R])return!0;return!1}function eO(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eA=1e3,ek=2,eN=144e5,eD=.5;function eP(T,S=eA,R=ek){let O=S*Math.pow(R,T),N=Math.round(eD*O*(Math.random()-.5)*2);return Math.min(eN,O+N)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(T){return T&&T._delegate?T._delegate:T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */O.NODE_CLIENT=!0},40051:(T,S,R)=>{"use strict";function O(T,S){if(!Object.prototype.hasOwnProperty.call(T,S))throw TypeError("attempted to use private field on non-instance");return T}R.r(S),R.d(S,{_:()=>O,_class_private_field_loose_base:()=>O})},82581:(T,S,R)=>{"use strict";R.r(S),R.d(S,{_:()=>N,_class_private_field_loose_key:()=>N});var O=0;function N(T){return"__private_"+O+++"_"+T}},10143:(T,S,R)=>{"use strict";function O(T){return T&&T.__esModule?T:{default:T}}R.r(S),R.d(S,{_:()=>O,_interop_require_default:()=>O})},42212:(T,S,R)=>{"use strict";function O(T){if("function"!=typeof WeakMap)return null;var S=new WeakMap,R=new WeakMap;return(O=function(T){return T?R:S})(T)}function N(T,S){if(!S&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var R=O(S);if(R&&R.has(T))return R.get(T);var N={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var M in T)if("default"!==M&&Object.prototype.hasOwnProperty.call(T,M)){var L=P?Object.getOwnPropertyDescriptor(T,M):null;L&&(L.get||L.set)?Object.defineProperty(N,M,L):N[M]=T[M]}return N.default=T,R&&R.set(T,N),N}R.r(S),R.d(S,{_:()=>N,_interop_require_wildcard:()=>N})},22863:(T,S,R)=>{"use strict";R.d(S,{Mq:()=>O.Mq,getApps:()=>O.C6,initializeApp:()=>O.ZF});var O=R(20662),N="firebase",P="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(0,O.KN)(N,P,"app")},9308:(T,S,R)=>{"use strict";R.d(S,{w9:()=>tL,hJ:()=>tB,lI:()=>rS,iA:()=>t3,Xb:()=>t4,getAuth:()=>rg,Aj:()=>rr,aF:()=>tJ,w$:()=>t9,e5:()=>t6,$g:()=>rb,rh:()=>rT,w7:()=>rn,gQ:()=>t7,ck:()=>t8});var O=R(20662),N=R(62646);function P(T,S){var R={};for(var O in T)Object.prototype.hasOwnProperty.call(T,O)&&0>S.indexOf(O)&&(R[O]=T[O]);if(null!=T&&"function"==typeof Object.getOwnPropertySymbols)for(var N=0,O=Object.getOwnPropertySymbols(T);N<O.length;N++)0>S.indexOf(O[N])&&Object.prototype.propertyIsEnumerable.call(T,O[N])&&(R[O[N]]=T[O[N]]);return R}Object.create,Object.create;var M=("function"==typeof SuppressedError&&SuppressedError,R(84803)),L=R(76833),U=R(61062);function V(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let $=V,K=new N.LL("auth","Firebase",V()),W=new U.Yd("@firebase/auth");function Q(T,...S){W.logLevel<=U.in.WARN&&W.warn(`Auth (${O.Jn}): ${T}`,...S)}function Y(T,...S){W.logLevel<=U.in.ERROR&&W.error(`Auth (${O.Jn}): ${T}`,...S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(T,...S){throw er(T,...S)}function Z(T,...S){return er(T,...S)}function ee(T,S,R){let O=Object.assign(Object.assign({},$()),{[S]:R});return new N.LL("auth","Firebase",O).create(S,{appName:T.name})}function et(T){return ee(T,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function er(T,...S){if("string"!=typeof T){let R=S[0],O=[...S.slice(1)];return O[0]&&(O[0].appName=T.name),T._errorFactory.create(R,...O)}return K.create(T,...S)}function en(T,S,...R){if(!T)throw er(S,...R)}function ei(T){let S="INTERNAL ASSERTION FAILED: "+T;throw Y(S),Error(S)}function es(T,S){T||ei(S)}function ea(){return"http:"===eo()||"https:"===eo()}function eo(){var T;return"undefined"!=typeof self&&(null===(T=self.location)||void 0===T?void 0:T.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(ea()||(0,N.ru)()||"connection"in navigator))||navigator.onLine}function ec(){if("undefined"==typeof navigator)return null;let T=navigator;return T.languages&&T.languages[0]||T.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(T,S){this.shortDelay=T,this.longDelay=S,es(S>T,"Short delay should be less than long delay!"),this.isMobile=(0,N.uI)()||(0,N.b$)()}get(){return eu()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(T,S){es(T.emulator,"Emulator should always be set here");let{url:R}=T.emulator;return S?`${R}${S.startsWith("/")?S.slice(1):S}`:R}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{static initialize(T,S,R){this.fetchImpl=T,S&&(this.headersImpl=S),R&&(this.responseImpl=R)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},eg=new ed(3e4,6e4);function em(T,S){return T.tenantId&&!S.tenantId?Object.assign(Object.assign({},S),{tenantId:T.tenantId}):S}async function ey(T,S,R,O,P={}){return ev(T,P,async()=>{let P={},M={};O&&("GET"===S?M=O:P={body:JSON.stringify(O)});let L=(0,N.xO)(Object.assign({key:T.config.apiKey},M)).slice(1),U=await T._getAdditionalHeaders();U["Content-Type"]="application/json",T.languageCode&&(U["X-Firebase-Locale"]=T.languageCode);let V=Object.assign({method:S,headers:U},P);return(0,N.L_)()||(V.referrerPolicy="no-referrer"),ef.fetch()(eT(T,T.config.apiHost,R,L),V)})}async function ev(T,S,R){T._canInitEmulator=!1;let O=Object.assign(Object.assign({},ep),S);try{let S=new e_(T),N=await Promise.race([R(),S.promise]);S.clearNetworkTimeout();let P=await N.json();if("needConfirmation"in P)throw eE(T,"account-exists-with-different-credential",P);if(N.ok&&!("errorMessage"in P))return P;{let[S,R]=(N.ok?P.errorMessage:P.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===S)throw eE(T,"credential-already-in-use",P);if("EMAIL_EXISTS"===S)throw eE(T,"email-already-in-use",P);if("USER_DISABLED"===S)throw eE(T,"user-disabled",P);let M=O[S]||S.toLowerCase().replace(/[_\s]+/g,"-");if(R)throw ee(T,M,R);X(T,M)}}catch(S){if(S instanceof N.ZR)throw S;X(T,"network-request-failed",{message:String(S)})}}async function eb(T,S,R,O,N={}){let P=await ey(T,S,R,O,N);return"mfaPendingCredential"in P&&X(T,"multi-factor-auth-required",{_serverResponse:P}),P}function eT(T,S,R,O){let N=`${S}${R}?${O}`;return T.config.emulator?eh(T.config,N):`${T.config.apiScheme}://${N}`}function eS(T){switch(T){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class e_{constructor(T){this.auth=T,this.timer=null,this.promise=new Promise((T,S)=>{this.timer=setTimeout(()=>S(Z(this.auth,"network-request-failed")),eg.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function eE(T,S,R){let O={appName:T.name};R.email&&(O.email=R.email),R.phoneNumber&&(O.phoneNumber=R.phoneNumber);let N=Z(T,S,O);return N.customData._tokenResponse=R,N}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(T){return void 0!==T&&void 0!==T.enterprise}class eC{constructor(T){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===T.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=T.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=T.recaptchaEnforcementState}getProviderEnforcementState(T){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let S of this.recaptchaEnforcementState)if(S.provider&&S.provider===T)return eS(S.enforcementState);return null}isProviderEnabled(T){return"ENFORCE"===this.getProviderEnforcementState(T)||"AUDIT"===this.getProviderEnforcementState(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eI(T,S){return ey(T,"GET","/v2/recaptchaConfig",em(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eR(T,S){return ey(T,"POST","/v1/accounts:delete",S)}async function eO(T,S){return ey(T,"POST","/v1/accounts:lookup",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eA(T){if(T)try{let S=new Date(Number(T));if(!isNaN(S.getTime()))return S.toUTCString()}catch(T){}}async function ek(T,S=!1){let R=(0,N.m9)(T),O=await R.getIdToken(S),P=eD(O);en(P&&P.exp&&P.auth_time&&P.iat,R.auth,"internal-error");let M="object"==typeof P.firebase?P.firebase:void 0,L=null==M?void 0:M.sign_in_provider;return{claims:P,token:O,authTime:eA(eN(P.auth_time)),issuedAtTime:eA(eN(P.iat)),expirationTime:eA(eN(P.exp)),signInProvider:L||null,signInSecondFactor:(null==M?void 0:M.sign_in_second_factor)||null}}function eN(T){return 1e3*Number(T)}function eD(T){let[S,R,O]=T.split(".");if(void 0===S||void 0===R||void 0===O)return Y("JWT malformed, contained fewer than 3 sections"),null;try{let T=(0,N.tV)(R);if(!T)return Y("Failed to decode base64 JWT payload"),null;return JSON.parse(T)}catch(T){return Y("Caught error parsing JWT payload as JSON",null==T?void 0:T.toString()),null}}function eP(T){let S=eD(T);return en(S,"internal-error"),en(void 0!==S.exp,"internal-error"),en(void 0!==S.iat,"internal-error"),Number(S.exp)-Number(S.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ex(T,S,R=!1){if(R)return S;try{return await S}catch(S){throw S instanceof N.ZR&&eM(S)&&T.auth.currentUser===T&&await T.auth.signOut(),S}}function eM({code:T}){return"auth/user-disabled"===T||"auth/user-token-expired"===T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(T){this.user=T,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(T){var S;if(!T)return this.errorBackoff=3e4,Math.max(0,(null!==(S=this.user.stsTokenManager.expirationTime)&&void 0!==S?S:0)-Date.now()-3e5);{let T=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),T}}schedule(T=!1){if(!this.isRunning)return;let S=this.getInterval(T);this.timerId=setTimeout(async()=>{await this.iteration()},S)}async iteration(){try{await this.user.getIdToken(!0)}catch(T){(null==T?void 0:T.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(T,S){this.createdAt=T,this.lastLoginAt=S,this._initializeTime()}_initializeTime(){this.lastSignInTime=eA(this.lastLoginAt),this.creationTime=eA(this.createdAt)}_copy(T){this.createdAt=T.createdAt,this.lastLoginAt=T.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ej(T){var S;let R=T.auth,O=await T.getIdToken(),N=await ex(T,eO(R,{idToken:O}));en(null==N?void 0:N.users.length,R,"internal-error");let P=N.users[0];T._notifyReloadListener(P);let M=(null===(S=P.providerUserInfo)||void 0===S?void 0:S.length)?eV(P.providerUserInfo):[],L=eB(T.providerData,M),U=T.isAnonymous,V=!(T.email&&P.passwordHash)&&!(null==L?void 0:L.length),$=!!U&&V;Object.assign(T,{uid:P.localId,displayName:P.displayName||null,photoURL:P.photoUrl||null,email:P.email||null,emailVerified:P.emailVerified||!1,phoneNumber:P.phoneNumber||null,tenantId:P.tenantId||null,providerData:L,metadata:new eF(P.createdAt,P.lastLoginAt),isAnonymous:$})}async function eU(T){let S=(0,N.m9)(T);await ej(S),await S.auth._persistUserIfCurrent(S),S.auth._notifyListenersIfCurrent(S)}function eB(T,S){return[...T.filter(T=>!S.some(S=>S.providerId===T.providerId)),...S]}function eV(T){return T.map(T=>{var{providerId:S}=T,R=P(T,["providerId"]);return{providerId:S,uid:R.rawId||"",displayName:R.displayName||null,email:R.email||null,phoneNumber:R.phoneNumber||null,photoURL:R.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ez(T,S){let R=await ev(T,{},async()=>{let R=(0,N.xO)({grant_type:"refresh_token",refresh_token:S}).slice(1),{tokenApiHost:O,apiKey:P}=T.config,M=eT(T,O,"/v1/token",`key=${P}`),L=await T._getAdditionalHeaders();return L["Content-Type"]="application/x-www-form-urlencoded",ef.fetch()(M,{method:"POST",headers:L,body:R})});return{accessToken:R.access_token,expiresIn:R.expires_in,refreshToken:R.refresh_token}}async function eq(T,S){return ey(T,"POST","/v2/accounts:revokeToken",em(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(T){en(T.idToken,"internal-error"),en(void 0!==T.idToken,"internal-error"),en(void 0!==T.refreshToken,"internal-error");let S="expiresIn"in T&&void 0!==T.expiresIn?Number(T.expiresIn):eP(T.idToken);this.updateTokensAndExpiration(T.idToken,T.refreshToken,S)}updateFromIdToken(T){en(0!==T.length,"internal-error");let S=eP(T);this.updateTokensAndExpiration(T,null,S)}async getToken(T,S=!1){return S||!this.accessToken||this.isExpired?(en(this.refreshToken,T,"user-token-expired"),this.refreshToken)?(await this.refresh(T,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(T,S){let{accessToken:R,refreshToken:O,expiresIn:N}=await ez(T,S);this.updateTokensAndExpiration(R,O,Number(N))}updateTokensAndExpiration(T,S,R){this.refreshToken=S||null,this.accessToken=T||null,this.expirationTime=Date.now()+1e3*R}static fromJSON(T,S){let{refreshToken:R,accessToken:O,expirationTime:N}=S,P=new eG;return R&&(en("string"==typeof R,"internal-error",{appName:T}),P.refreshToken=R),O&&(en("string"==typeof O,"internal-error",{appName:T}),P.accessToken=O),N&&(en("number"==typeof N,"internal-error",{appName:T}),P.expirationTime=N),P}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(T){this.accessToken=T.accessToken,this.refreshToken=T.refreshToken,this.expirationTime=T.expirationTime}_clone(){return Object.assign(new eG,this.toJSON())}_performRefresh(){return ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eH(T,S){en("string"==typeof T||void 0===T,"internal-error",{appName:S})}class e${constructor(T){var{uid:S,auth:R,stsTokenManager:O}=T,N=P(T,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new eL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=S,this.auth=R,this.stsTokenManager=O,this.accessToken=O.accessToken,this.displayName=N.displayName||null,this.email=N.email||null,this.emailVerified=N.emailVerified||!1,this.phoneNumber=N.phoneNumber||null,this.photoURL=N.photoURL||null,this.isAnonymous=N.isAnonymous||!1,this.tenantId=N.tenantId||null,this.providerData=N.providerData?[...N.providerData]:[],this.metadata=new eF(N.createdAt||void 0,N.lastLoginAt||void 0)}async getIdToken(T){let S=await ex(this,this.stsTokenManager.getToken(this.auth,T));return en(S,this.auth,"internal-error"),this.accessToken!==S&&(this.accessToken=S,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),S}getIdTokenResult(T){return ek(this,T)}reload(){return eU(this)}_assign(T){this!==T&&(en(this.uid===T.uid,this.auth,"internal-error"),this.displayName=T.displayName,this.photoURL=T.photoURL,this.email=T.email,this.emailVerified=T.emailVerified,this.phoneNumber=T.phoneNumber,this.isAnonymous=T.isAnonymous,this.tenantId=T.tenantId,this.providerData=T.providerData.map(T=>Object.assign({},T)),this.metadata._copy(T.metadata),this.stsTokenManager._assign(T.stsTokenManager))}_clone(T){let S=new e$(Object.assign(Object.assign({},this),{auth:T,stsTokenManager:this.stsTokenManager._clone()}));return S.metadata._copy(this.metadata),S}_onReload(T){en(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=T,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(T){this.reloadListener?this.reloadListener(T):this.reloadUserInfo=T}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(T,S=!1){let R=!1;T.idToken&&T.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(T),R=!0),S&&await ej(this),await this.auth._persistUserIfCurrent(this),R&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,O.rh)(this.auth.app))return Promise.reject(et(this.auth));let T=await this.getIdToken();return await ex(this,eR(this.auth,{idToken:T})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(T=>Object.assign({},T)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(T,S){var R,O,N,P,M,L,U,V;let $=null!==(R=S.displayName)&&void 0!==R?R:void 0,K=null!==(O=S.email)&&void 0!==O?O:void 0,W=null!==(N=S.phoneNumber)&&void 0!==N?N:void 0,Q=null!==(P=S.photoURL)&&void 0!==P?P:void 0,Y=null!==(M=S.tenantId)&&void 0!==M?M:void 0,X=null!==(L=S._redirectEventId)&&void 0!==L?L:void 0,Z=null!==(U=S.createdAt)&&void 0!==U?U:void 0,ee=null!==(V=S.lastLoginAt)&&void 0!==V?V:void 0,{uid:et,emailVerified:er,isAnonymous:ei,providerData:es,stsTokenManager:ea}=S;en(et&&ea,T,"internal-error");let eo=eG.fromJSON(this.name,ea);en("string"==typeof et,T,"internal-error"),eH($,T.name),eH(K,T.name),en("boolean"==typeof er,T,"internal-error"),en("boolean"==typeof ei,T,"internal-error"),eH(W,T.name),eH(Q,T.name),eH(Y,T.name),eH(X,T.name),eH(Z,T.name),eH(ee,T.name);let eu=new e$({uid:et,auth:T,email:K,emailVerified:er,displayName:$,isAnonymous:ei,photoURL:Q,phoneNumber:W,tenantId:Y,stsTokenManager:eo,createdAt:Z,lastLoginAt:ee});return es&&Array.isArray(es)&&(eu.providerData=es.map(T=>Object.assign({},T))),X&&(eu._redirectEventId=X),eu}static async _fromIdTokenResponse(T,S,R=!1){let O=new eG;O.updateFromServerResponse(S);let N=new e$({uid:S.localId,auth:T,stsTokenManager:O,isAnonymous:R});return await ej(N),N}static async _fromGetAccountInfoResponse(T,S,R){let O=S.users[0];en(void 0!==O.localId,"internal-error");let N=void 0!==O.providerUserInfo?eV(O.providerUserInfo):[],P=!(O.email&&O.passwordHash)&&!(null==N?void 0:N.length),M=new eG;M.updateFromIdToken(R);let L=new e$({uid:O.localId,auth:T,stsTokenManager:M,isAnonymous:P});return Object.assign(L,{uid:O.localId,displayName:O.displayName||null,photoURL:O.photoUrl||null,email:O.email||null,emailVerified:O.emailVerified||!1,phoneNumber:O.phoneNumber||null,tenantId:O.tenantId||null,providerData:N,metadata:new eF(O.createdAt,O.lastLoginAt),isAnonymous:!(O.email&&O.passwordHash)&&!(null==N?void 0:N.length)}),L}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eK=new Map;function eW(T){es(T instanceof Function,"Expected a class definition");let S=eK.get(T);return S?es(S instanceof T,"Instance stored in cache mismatched with class"):(S=new T,eK.set(T,S)),S}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eQ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(T,S){this.storage[T]=S}async _get(T){let S=this.storage[T];return void 0===S?null:S}async _remove(T){delete this.storage[T]}_addListener(T,S){}_removeListener(T,S){}}eQ.type="NONE";let eY=eQ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eJ(T,S,R){return`firebase:${T}:${S}:${R}`}class eX{constructor(T,S,R){this.persistence=T,this.auth=S,this.userKey=R;let{config:O,name:N}=this.auth;this.fullUserKey=eJ(this.userKey,O.apiKey,N),this.fullPersistenceKey=eJ("persistence",O.apiKey,N),this.boundEventHandler=S._onStorageEvent.bind(S),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(T){return this.persistence._set(this.fullUserKey,T.toJSON())}async getCurrentUser(){let T=await this.persistence._get(this.fullUserKey);return T?e$._fromJSON(this.auth,T):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(T){if(this.persistence===T)return;let S=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=T,S)return this.setCurrentUser(S)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(T,S,R="authUser"){if(!S.length)return new eX(eW(eY),T,R);let O=(await Promise.all(S.map(async T=>{if(await T._isAvailable())return T}))).filter(T=>T),N=O[0]||eW(eY),P=eJ(R,T.config.apiKey,T.name),M=null;for(let R of S)try{let S=await R._get(P);if(S){let O=e$._fromJSON(T,S);R!==N&&(M=O),N=R;break}}catch(T){}let L=O.filter(T=>T._shouldAllowMigration);return N._shouldAllowMigration&&L.length&&(N=L[0],M&&await N._set(P,M.toJSON()),await Promise.all(S.map(async T=>{if(T!==N)try{await T._remove(P)}catch(T){}}))),new eX(N,T,R)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eZ(T){let S=T.toLowerCase();if(S.includes("opera/")||S.includes("opr/")||S.includes("opios/"))return"Opera";if(e3(S))return"IEMobile";if(S.includes("msie")||S.includes("trident/"))return"IE";{if(S.includes("edge/"))return"Edge";if(e0(S))return"Firefox";if(S.includes("silk/"))return"Silk";if(e6(S))return"Blackberry";if(e9(S))return"Webos";if(e1(S))return"Safari";if((S.includes("chrome/")||e2(S))&&!S.includes("edge/"))return"Chrome";if(e4(S))return"Android";let R=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,O=T.match(R);if((null==O?void 0:O.length)===2)return O[1]}return"Other"}function e0(T=(0,N.z$)()){return/firefox\//i.test(T)}function e1(T=(0,N.z$)()){let S=T.toLowerCase();return S.includes("safari/")&&!S.includes("chrome/")&&!S.includes("crios/")&&!S.includes("android")}function e2(T=(0,N.z$)()){return/crios\//i.test(T)}function e3(T=(0,N.z$)()){return/iemobile/i.test(T)}function e4(T=(0,N.z$)()){return/android/i.test(T)}function e6(T=(0,N.z$)()){return/blackberry/i.test(T)}function e9(T=(0,N.z$)()){return/webos/i.test(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e5(T,S=[]){let R;switch(T){case"Browser":R=eZ((0,N.z$)());break;case"Worker":R=`${eZ((0,N.z$)())}-${T}`;break;default:R=T}let P=S.length?S.join(","):"FirebaseCore-web";return`${R}/JsCore/${O.Jn}/${P}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(T){this.auth=T,this.queue=[]}pushCallback(T,S){let R=S=>new Promise((R,O)=>{try{let O=T(S);R(O)}catch(T){O(T)}});R.onAbort=S,this.queue.push(R);let O=this.queue.length-1;return()=>{this.queue[O]=()=>Promise.resolve()}}async runMiddleware(T){if(this.auth.currentUser===T)return;let S=[];try{for(let R of this.queue)await R(T),R.onAbort&&S.push(R.onAbort)}catch(T){for(let T of(S.reverse(),S))try{T()}catch(T){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==T?void 0:T.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e7(T,S={}){return ey(T,"GET","/v2/passwordPolicy",em(T,S))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let te=6;class tt{constructor(T){var S,R,O,N;let P=T.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(S=P.minPasswordLength)&&void 0!==S?S:te,P.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=P.maxPasswordLength),void 0!==P.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=P.containsLowercaseCharacter),void 0!==P.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=P.containsUppercaseCharacter),void 0!==P.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=P.containsNumericCharacter),void 0!==P.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=P.containsNonAlphanumericCharacter),this.enforcementState=T.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(O=null===(R=T.allowedNonAlphanumericCharacters)||void 0===R?void 0:R.join(""))&&void 0!==O?O:"",this.forceUpgradeOnSignin=null!==(N=T.forceUpgradeOnSignin)&&void 0!==N&&N,this.schemaVersion=T.schemaVersion}validatePassword(T){var S,R,O,N,P,M;let L={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(T,L),this.validatePasswordCharacterOptions(T,L),L.isValid&&(L.isValid=null===(S=L.meetsMinPasswordLength)||void 0===S||S),L.isValid&&(L.isValid=null===(R=L.meetsMaxPasswordLength)||void 0===R||R),L.isValid&&(L.isValid=null===(O=L.containsLowercaseLetter)||void 0===O||O),L.isValid&&(L.isValid=null===(N=L.containsUppercaseLetter)||void 0===N||N),L.isValid&&(L.isValid=null===(P=L.containsNumericCharacter)||void 0===P||P),L.isValid&&(L.isValid=null===(M=L.containsNonAlphanumericCharacter)||void 0===M||M),L}validatePasswordLengthOptions(T,S){let R=this.customStrengthOptions.minPasswordLength,O=this.customStrengthOptions.maxPasswordLength;R&&(S.meetsMinPasswordLength=T.length>=R),O&&(S.meetsMaxPasswordLength=T.length<=O)}validatePasswordCharacterOptions(T,S){let R;this.updatePasswordCharacterOptionsStatuses(S,!1,!1,!1,!1);for(let O=0;O<T.length;O++)R=T.charAt(O),this.updatePasswordCharacterOptionsStatuses(S,R>="a"&&R<="z",R>="A"&&R<="Z",R>="0"&&R<="9",this.allowedNonAlphanumericCharacters.includes(R))}updatePasswordCharacterOptionsStatuses(T,S,R,O,N){this.customStrengthOptions.containsLowercaseLetter&&(T.containsLowercaseLetter||(T.containsLowercaseLetter=S)),this.customStrengthOptions.containsUppercaseLetter&&(T.containsUppercaseLetter||(T.containsUppercaseLetter=R)),this.customStrengthOptions.containsNumericCharacter&&(T.containsNumericCharacter||(T.containsNumericCharacter=O)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(T.containsNonAlphanumericCharacter||(T.containsNonAlphanumericCharacter=N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(T,S,R,O){this.app=T,this.heartbeatServiceProvider=S,this.appCheckServiceProvider=R,this.config=O,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ts(this),this.idTokenSubscription=new ts(this),this.beforeStateQueue=new e8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=K,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=T.name,this.clientVersion=O.sdkClientVersion}_initializeWithPersistence(T,S){return S&&(this._popupRedirectResolver=eW(S)),this._initializationPromise=this.queue(async()=>{var R,O;if(!this._deleted&&(this.persistenceManager=await eX.create(this,T),!this._deleted)){if(null===(R=this._popupRedirectResolver)||void 0===R?void 0:R._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(T){}await this.initializeCurrentUser(S),this.lastNotifiedUid=(null===(O=this.currentUser)||void 0===O?void 0:O.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let T=await this.assertedPersistence.getCurrentUser();if(this.currentUser||T){if(this.currentUser&&T&&this.currentUser.uid===T.uid){this._currentUser._assign(T),await this.currentUser.getIdToken();return}await this._updateCurrentUser(T,!0)}}async initializeCurrentUserFromIdToken(T){try{let S=await eO(this,{idToken:T}),R=await e$._fromGetAccountInfoResponse(this,S,T);await this.directlySetCurrentUser(R)}catch(T){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",T),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(T){var S;if((0,O.rh)(this.app)){let T=this.app.settings.authIdToken;return T?new Promise(S=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(T).then(S,S))}):this.directlySetCurrentUser(null)}let R=await this.assertedPersistence.getCurrentUser(),N=R,P=!1;if(T&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let R=null===(S=this.redirectUser)||void 0===S?void 0:S._redirectEventId,O=null==N?void 0:N._redirectEventId,M=await this.tryRedirectSignIn(T);(!R||R===O)&&(null==M?void 0:M.user)&&(N=M.user,P=!0)}if(!N)return this.directlySetCurrentUser(null);if(!N._redirectEventId){if(P)try{await this.beforeStateQueue.runMiddleware(N)}catch(T){N=R,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(T))}return N?this.reloadAndSetCurrentUserOrClear(N):this.directlySetCurrentUser(null)}return(en(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===N._redirectEventId)?this.directlySetCurrentUser(N):this.reloadAndSetCurrentUserOrClear(N)}async tryRedirectSignIn(T){let S=null;try{S=await this._popupRedirectResolver._completeRedirectFn(this,T,!0)}catch(T){await this._setRedirectUser(null)}return S}async reloadAndSetCurrentUserOrClear(T){try{await ej(T)}catch(T){if((null==T?void 0:T.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(T)}useDeviceLanguage(){this.languageCode=ec()}async _delete(){this._deleted=!0}async updateCurrentUser(T){if((0,O.rh)(this.app))return Promise.reject(et(this));let S=T?(0,N.m9)(T):null;return S&&en(S.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(S&&S._clone(this))}async _updateCurrentUser(T,S=!1){if(!this._deleted)return T&&en(this.tenantId===T.tenantId,this,"tenant-id-mismatch"),S||await this.beforeStateQueue.runMiddleware(T),this.queue(async()=>{await this.directlySetCurrentUser(T),this.notifyAuthListeners()})}async signOut(){return(0,O.rh)(this.app)?Promise.reject(et(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(T){return(0,O.rh)(this.app)?Promise.reject(et(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(eW(T))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(T){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let S=this._getPasswordPolicyInternal();return S.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):S.validatePassword(T)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let T=new tt(await e7(this));null===this.tenantId?this._projectPasswordPolicy=T:this._tenantPasswordPolicies[this.tenantId]=T}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(T){this._errorFactory=new N.LL("auth","Firebase",T())}onAuthStateChanged(T,S,R){return this.registerStateListener(this.authStateSubscription,T,S,R)}beforeAuthStateChanged(T,S){return this.beforeStateQueue.pushCallback(T,S)}onIdTokenChanged(T,S,R){return this.registerStateListener(this.idTokenSubscription,T,S,R)}authStateReady(){return new Promise((T,S)=>{if(this.currentUser)T();else{let R=this.onAuthStateChanged(()=>{R(),T()},S)}})}async revokeAccessToken(T){if(this.currentUser){let S={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:T,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(S.tenantId=this.tenantId),await eq(this,S)}}toJSON(){var T;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(T=this._currentUser)||void 0===T?void 0:T.toJSON()}}async _setRedirectUser(T,S){let R=await this.getOrInitRedirectPersistenceManager(S);return null===T?R.removeCurrentUser():R.setCurrentUser(T)}async getOrInitRedirectPersistenceManager(T){if(!this.redirectPersistenceManager){let S=T&&eW(T)||this._popupRedirectResolver;en(S,this,"argument-error"),this.redirectPersistenceManager=await eX.create(this,[eW(S._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(T){var S,R;return(this._isInitialized&&await this.queue(async()=>{}),(null===(S=this._currentUser)||void 0===S?void 0:S._redirectEventId)===T)?this._currentUser:(null===(R=this.redirectUser)||void 0===R?void 0:R._redirectEventId)===T?this.redirectUser:null}async _persistUserIfCurrent(T){if(T===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(T))}_notifyListenersIfCurrent(T){T===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var T,S;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let R=null!==(S=null===(T=this.currentUser)||void 0===T?void 0:T.uid)&&void 0!==S?S:null;this.lastNotifiedUid!==R&&(this.lastNotifiedUid=R,this.authStateSubscription.next(this.currentUser))}registerStateListener(T,S,R,O){if(this._deleted)return()=>{};let N="function"==typeof S?S:S.next.bind(S),P=!1,M=this._isInitialized?Promise.resolve():this._initializationPromise;if(en(M,this,"internal-error"),M.then(()=>{P||N(this.currentUser)}),"function"==typeof S){let N=T.addObserver(S,R,O);return()=>{P=!0,N()}}{let R=T.addObserver(S);return()=>{P=!0,R()}}}async directlySetCurrentUser(T){this.currentUser&&this.currentUser!==T&&this._currentUser._stopProactiveRefresh(),T&&this.isProactiveRefreshEnabled&&T._startProactiveRefresh(),this.currentUser=T,T?await this.assertedPersistence.setCurrentUser(T):await this.assertedPersistence.removeCurrentUser()}queue(T){return this.operations=this.operations.then(T,T),this.operations}get assertedPersistence(){return en(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(T){!T||this.frameworks.includes(T)||(this.frameworks.push(T),this.frameworks.sort(),this.clientVersion=e5(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var T;let S={"X-Client-Version":this.clientVersion};this.app.options.appId&&(S["X-Firebase-gmpid"]=this.app.options.appId);let R=await (null===(T=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===T?void 0:T.getHeartbeatsHeader());R&&(S["X-Firebase-Client"]=R);let O=await this._getAppCheckToken();return O&&(S["X-Firebase-AppCheck"]=O),S}async _getAppCheckToken(){var T;let S=await (null===(T=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===T?void 0:T.getToken());return(null==S?void 0:S.error)&&Q(`Error while retrieving App Check token: ${S.error}`),null==S?void 0:S.token}}function ti(T){return(0,N.m9)(T)}class ts{constructor(T){this.auth=T,this.observer=null,this.addObserver=(0,N.ne)(T=>this.observer=T)}get next(){return en(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ta="recaptcha-enterprise",tl="NO_RECAPTCHA";class tu{constructor(T){this.type=ta,this.auth=ti(T)}async verify(T="verify",S=!1){async function R(T){if(!S){if(null==T.tenantId&&null!=T._agentRecaptchaConfig)return T._agentRecaptchaConfig.siteKey;if(null!=T.tenantId&&void 0!==T._tenantRecaptchaConfigs[T.tenantId])return T._tenantRecaptchaConfigs[T.tenantId].siteKey}return new Promise(async(S,R)=>{eI(T,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(O=>{if(void 0===O.recaptchaKey)R(Error("recaptcha Enterprise site key undefined"));else{let R=new eC(O);return null==T.tenantId?T._agentRecaptchaConfig=R:T._tenantRecaptchaConfigs[T.tenantId]=R,S(R.siteKey)}}).catch(T=>{R(T)})})}function O(S,R,O){let N=window.grecaptcha;ew(N)?N.enterprise.ready(()=>{N.enterprise.execute(S,{action:T}).then(T=>{R(T)}).catch(()=>{R(tl)})}):O(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((T,N)=>{R(this.auth).then(R=>{if(!S&&ew(window.grecaptcha))O(R,T,N);else{N(Error("RecaptchaVerifier is only supported in browser"));return}}).catch(T=>{N(T)})})}}async function tc(T,S,R,O=!1){let N;let P=new tu(T);try{N=await P.verify(R)}catch(T){N=await P.verify(R,!0)}let M=Object.assign({},S);return O?Object.assign(M,{captchaResp:N}):Object.assign(M,{captchaResponse:N}),Object.assign(M,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(M,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),M}async function td(T,S,R,O){var N;if(null===(N=T._getRecaptchaConfig())||void 0===N||!N.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return O(T,S).catch(async N=>{if("auth/missing-recaptcha-token"!==N.code)return Promise.reject(N);{console.log(`${R} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let N=await tc(T,S,R,"getOobCode"===R);return O(T,N)}});{let N=await tc(T,S,R,"getOobCode"===R);return O(T,N)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(T,S){let R=(0,O.qX)(T,"auth");if(R.isInitialized()){let T=R.getImmediate(),O=R.getOptions();if((0,N.vZ)(O,null!=S?S:{}))return T;X(T,"already-initialized")}return R.initialize({options:S})}function tf(T,S){let R=(null==S?void 0:S.persistence)||[],O=(Array.isArray(R)?R:[R]).map(eW);(null==S?void 0:S.errorMap)&&T._updateErrorMap(S.errorMap),T._initializeWithPersistence(O,null==S?void 0:S.popupRedirectResolver)}function tp(T,S,R){let O=ti(T);en(O._canInitEmulator,O,"emulator-config-failed"),en(/^https?:\/\//.test(S),O,"invalid-emulator-scheme");let N=!!(null==R?void 0:R.disableWarnings),P=tg(S),{host:M,port:L}=tm(S),U=null===L?"":`:${L}`;O.config.emulator={url:`${P}//${M}${U}/`},O.settings.appVerificationDisabledForTesting=!0,O.emulatorConfig=Object.freeze({host:M,port:L,protocol:P.replace(":",""),options:Object.freeze({disableWarnings:N})}),N||tv()}function tg(T){let S=T.indexOf(":");return S<0?"":T.substr(0,S+1)}function tm(T){let S=tg(T),R=/(\/\/)?([^?#/]+)/.exec(T.substr(S.length));if(!R)return{host:"",port:null};let O=R[2].split("@").pop()||"",N=/^(\[[^\]]+\])(:|$)/.exec(O);if(N){let T=N[1];return{host:T,port:ty(O.substr(T.length+1))}}{let[T,S]=O.split(":");return{host:T,port:ty(S)}}}function ty(T){if(!T)return null;let S=Number(T);return isNaN(S)?null:S}function tv(){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(T,S){this.providerId=T,this.signInMethod=S}toJSON(){return ei("not implemented")}_getIdTokenResponse(T){return ei("not implemented")}_linkToIdToken(T,S){return ei("not implemented")}_getReauthenticationResolver(T){return ei("not implemented")}}async function tT(T,S){return ey(T,"POST","/v1/accounts:update",S)}async function tS(T,S){return ey(T,"POST","/v1/accounts:signUp",S)}async function t_(T,S){return ey(T,"POST","/v1/accounts:update",em(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tE(T,S){return eb(T,"POST","/v1/accounts:signInWithPassword",em(T,S))}async function tw(T,S){return ey(T,"POST","/v1/accounts:sendOobCode",em(T,S))}async function tC(T,S){return tw(T,S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tI(T,S){return eb(T,"POST","/v1/accounts:signInWithEmailLink",em(T,S))}async function tR(T,S){return eb(T,"POST","/v1/accounts:signInWithEmailLink",em(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO extends tb{constructor(T,S,R,O=null){super("password",R),this._email=T,this._password=S,this._tenantId=O}static _fromEmailAndPassword(T,S){return new tO(T,S,"password")}static _fromEmailAndCode(T,S,R=null){return new tO(T,S,"emailLink",R)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T;if((null==S?void 0:S.email)&&(null==S?void 0:S.password)){if("password"===S.signInMethod)return this._fromEmailAndPassword(S.email,S.password);if("emailLink"===S.signInMethod)return this._fromEmailAndCode(S.email,S.password,S.tenantId)}return null}async _getIdTokenResponse(T){switch(this.signInMethod){case"password":return td(T,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",tE);case"emailLink":return tI(T,{email:this._email,oobCode:this._password});default:X(T,"internal-error")}}async _linkToIdToken(T,S){switch(this.signInMethod){case"password":return td(T,{idToken:S,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tS);case"emailLink":return tR(T,{idToken:S,email:this._email,oobCode:this._password});default:X(T,"internal-error")}}_getReauthenticationResolver(T){return this._getIdTokenResponse(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tA(T,S){return eb(T,"POST","/v1/accounts:signInWithIdp",em(T,S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tk="http://localhost";class tN extends tb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(T){let S=new tN(T.providerId,T.signInMethod);return T.idToken||T.accessToken?(T.idToken&&(S.idToken=T.idToken),T.accessToken&&(S.accessToken=T.accessToken),T.nonce&&!T.pendingToken&&(S.nonce=T.nonce),T.pendingToken&&(S.pendingToken=T.pendingToken)):T.oauthToken&&T.oauthTokenSecret?(S.accessToken=T.oauthToken,S.secret=T.oauthTokenSecret):X("argument-error"),S}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(T){let S="string"==typeof T?JSON.parse(T):T,{providerId:R,signInMethod:O}=S,N=P(S,["providerId","signInMethod"]);if(!R||!O)return null;let M=new tN(R,O);return M.idToken=N.idToken||void 0,M.accessToken=N.accessToken||void 0,M.secret=N.secret,M.nonce=N.nonce,M.pendingToken=N.pendingToken||null,M}_getIdTokenResponse(T){return tA(T,this.buildRequest())}_linkToIdToken(T,S){let R=this.buildRequest();return R.idToken=S,tA(T,R)}_getReauthenticationResolver(T){let S=this.buildRequest();return S.autoCreate=!1,tA(T,S)}buildRequest(){let T={requestUri:tk,returnSecureToken:!0};if(this.pendingToken)T.pendingToken=this.pendingToken;else{let S={};this.idToken&&(S.id_token=this.idToken),this.accessToken&&(S.access_token=this.accessToken),this.secret&&(S.oauth_token_secret=this.secret),S.providerId=this.providerId,this.nonce&&!this.pendingToken&&(S.nonce=this.nonce),T.postBody=(0,N.xO)(S)}return T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(T){switch(T){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function tP(T){let S=(0,N.zd)((0,N.pd)(T)).link,R=S?(0,N.zd)((0,N.pd)(S)).deep_link_id:null,O=(0,N.zd)((0,N.pd)(T)).deep_link_id;return(O?(0,N.zd)((0,N.pd)(O)).link:null)||O||R||S||T}class tM{constructor(T){var S,R,O,P,M,L;let U=(0,N.zd)((0,N.pd)(T)),V=null!==(S=U.apiKey)&&void 0!==S?S:null,$=null!==(R=U.oobCode)&&void 0!==R?R:null,K=tD(null!==(O=U.mode)&&void 0!==O?O:null);en(V&&$&&K,"argument-error"),this.apiKey=V,this.operation=K,this.code=$,this.continueUrl=null!==(P=U.continueUrl)&&void 0!==P?P:null,this.languageCode=null!==(M=U.languageCode)&&void 0!==M?M:null,this.tenantId=null!==(L=U.tenantId)&&void 0!==L?L:null}static parseLink(T){let S=tP(T);try{return new tM(S)}catch(T){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(){this.providerId=tL.PROVIDER_ID}static credential(T,S){return tO._fromEmailAndPassword(T,S)}static credentialWithLink(T,S){let R=tM.parseLink(S);return en(R,"argument-error"),tO._fromEmailAndCode(T,R.code,R.tenantId)}}tL.PROVIDER_ID="password",tL.EMAIL_PASSWORD_SIGN_IN_METHOD="password",tL.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(T){this.providerId=T,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(T){this.defaultLanguageCode=T}setCustomParameters(T){return this.customParameters=T,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj extends tF{constructor(){super(...arguments),this.scopes=[]}addScope(T){return this.scopes.includes(T)||this.scopes.push(T),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU extends tj{constructor(){super("facebook.com")}static credential(T){return tN._fromParams({providerId:tU.PROVIDER_ID,signInMethod:tU.FACEBOOK_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return tU.credentialFromTaggedObject(T)}static credentialFromError(T){return tU.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return tU.credential(T.oauthAccessToken)}catch(T){return null}}}tU.FACEBOOK_SIGN_IN_METHOD="facebook.com",tU.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB extends tj{constructor(){super("google.com"),this.addScope("profile")}static credential(T,S){return tN._fromParams({providerId:tB.PROVIDER_ID,signInMethod:tB.GOOGLE_SIGN_IN_METHOD,idToken:T,accessToken:S})}static credentialFromResult(T){return tB.credentialFromTaggedObject(T)}static credentialFromError(T){return tB.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthIdToken:S,oauthAccessToken:R}=T;if(!S&&!R)return null;try{return tB.credential(S,R)}catch(T){return null}}}tB.GOOGLE_SIGN_IN_METHOD="google.com",tB.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV extends tj{constructor(){super("github.com")}static credential(T){return tN._fromParams({providerId:tV.PROVIDER_ID,signInMethod:tV.GITHUB_SIGN_IN_METHOD,accessToken:T})}static credentialFromResult(T){return tV.credentialFromTaggedObject(T)}static credentialFromError(T){return tV.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T||!("oauthAccessToken"in T)||!T.oauthAccessToken)return null;try{return tV.credential(T.oauthAccessToken)}catch(T){return null}}}tV.GITHUB_SIGN_IN_METHOD="github.com",tV.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz extends tj{constructor(){super("twitter.com")}static credential(T,S){return tN._fromParams({providerId:tz.PROVIDER_ID,signInMethod:tz.TWITTER_SIGN_IN_METHOD,oauthToken:T,oauthTokenSecret:S})}static credentialFromResult(T){return tz.credentialFromTaggedObject(T)}static credentialFromError(T){return tz.credentialFromTaggedObject(T.customData||{})}static credentialFromTaggedObject({_tokenResponse:T}){if(!T)return null;let{oauthAccessToken:S,oauthTokenSecret:R}=T;if(!S||!R)return null;try{return tz.credential(S,R)}catch(T){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tq(T,S){return eb(T,"POST","/v1/accounts:signUp",em(T,S))}tz.TWITTER_SIGN_IN_METHOD="twitter.com",tz.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tG{constructor(T){this.user=T.user,this.providerId=T.providerId,this._tokenResponse=T._tokenResponse,this.operationType=T.operationType}static async _fromIdTokenResponse(T,S,R,O=!1){return new tG({user:await e$._fromIdTokenResponse(T,R,O),providerId:tH(R),_tokenResponse:R,operationType:S})}static async _forOperation(T,S,R){return await T._updateTokensIfNecessary(R,!0),new tG({user:T,providerId:tH(R),_tokenResponse:R,operationType:S})}}function tH(T){return T.providerId?T.providerId:"phoneNumber"in T?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t$ extends N.ZR{constructor(T,S,R,O){var N;super(S.code,S.message),this.operationType=R,this.user=O,Object.setPrototypeOf(this,t$.prototype),this.customData={appName:T.name,tenantId:null!==(N=T.tenantId)&&void 0!==N?N:void 0,_serverResponse:S.customData._serverResponse,operationType:R}}static _fromErrorAndOperation(T,S,R,O){return new t$(T,S,R,O)}}function tK(T,S,R,O){return("reauthenticate"===S?R._getReauthenticationResolver(T):R._getIdTokenResponse(T)).catch(R=>{if("auth/multi-factor-auth-required"===R.code)throw t$._fromErrorAndOperation(T,R,S,O);throw R})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tW(T,S,R=!1){let{auth:N}=T;if((0,O.rh)(N.app))return Promise.reject(et(N));let P="reauthenticate";try{let O=await ex(T,tK(N,P,S,T),R);en(O.idToken,N,"internal-error");let M=eD(O.idToken);en(M,N,"internal-error");let{sub:L}=M;return en(T.uid===L,N,"user-mismatch"),tG._forOperation(T,P,O)}catch(T){throw(null==T?void 0:T.code)==="auth/user-not-found"&&X(N,"user-mismatch"),T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tQ(T,S,R=!1){if((0,O.rh)(T.app))return Promise.reject(et(T));let N="signIn",P=await tK(T,N,S),M=await tG._fromIdTokenResponse(T,N,P);return R||await T._updateCurrentUser(M.user),M}async function tY(T,S){return tQ(ti(T),S)}async function tJ(T,S){return tW((0,N.m9)(T),S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tX{constructor(T,S){this.factorId=T,this.uid=S.mfaEnrollmentId,this.enrollmentTime=new Date(S.enrolledAt).toUTCString(),this.displayName=S.displayName}static _fromServerResponse(T,S){return"phoneInfo"in S?tZ._fromServerResponse(T,S):"totpInfo"in S?t0._fromServerResponse(T,S):X(T,"internal-error")}}class tZ extends null{constructor(T){super("phone",T),this.phoneNumber=T.phoneInfo}static _fromServerResponse(T,S){return new tZ(S)}}class t0 extends null{constructor(T){super("totp",T)}static _fromServerResponse(T,S){return new t0(S)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(T,S,R){var O;en((null===(O=R.url)||void 0===O?void 0:O.length)>0,T,"invalid-continue-uri"),en(void 0===R.dynamicLinkDomain||R.dynamicLinkDomain.length>0,T,"invalid-dynamic-link-domain"),S.continueUrl=R.url,S.dynamicLinkDomain=R.dynamicLinkDomain,S.canHandleCodeInApp=R.handleCodeInApp,R.iOS&&(en(R.iOS.bundleId.length>0,T,"missing-ios-bundle-id"),S.iOSBundleId=R.iOS.bundleId),R.android&&(en(R.android.packageName.length>0,T,"missing-android-pkg-name"),S.androidInstallApp=R.android.installApp,S.androidMinimumVersionCode=R.android.minimumVersion,S.androidPackageName=R.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t2(T){let S=ti(T);S._getPasswordPolicyInternal()&&await S._updatePasswordPolicy()}async function t3(T,S){await t_((0,N.m9)(T),{oobCode:S})}async function t4(T,S,R){if((0,O.rh)(T.app))return Promise.reject(et(T));let N=ti(T),P=td(N,{returnSecureToken:!0,email:S,password:R,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tq),M=await P.catch(S=>{throw"auth/password-does-not-meet-requirements"===S.code&&t2(T),S}),L=await tG._fromIdTokenResponse(N,"signIn",M);return await N._updateCurrentUser(L.user),L}function t6(T,S,R){return(0,O.rh)(T.app)?Promise.reject(et(T)):tY((0,N.m9)(T),tL.credential(S,R)).catch(async S=>{throw"auth/password-does-not-meet-requirements"===S.code&&t2(T),S})}async function t9(T,S){let R=(0,N.m9)(T),O={requestType:"VERIFY_EMAIL",idToken:await T.getIdToken()};S&&t1(R.auth,O,S);let{email:P}=await tC(R.auth,O);P!==T.email&&await T.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t5(T,S){return ey(T,"POST","/v1/accounts:update",S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t8(T,{displayName:S,photoURL:R}){if(void 0===S&&void 0===R)return;let O=(0,N.m9)(T),P={idToken:await O.getIdToken(),displayName:S,photoUrl:R,returnSecureToken:!0},M=await ex(O,t5(O.auth,P));O.displayName=M.displayName||null,O.photoURL=M.photoUrl||null;let L=O.providerData.find(({providerId:T})=>"password"===T);L&&(L.displayName=O.displayName,L.photoURL=O.photoURL),await O._updateTokensIfNecessary(M)}function t7(T,S){return rt((0,N.m9)(T),null,S)}async function rt(T,S,R){let{auth:O}=T,N={idToken:await T.getIdToken(),returnSecureToken:!0};S&&(N.email=S),R&&(N.password=R);let P=await ex(T,tT(O,N));await T._updateTokensIfNecessary(P,!0)}function rr(T,S,R,O){return(0,N.m9)(T).onAuthStateChanged(S,R,O)}function rn(T){return(0,N.m9)(T).signOut()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(T,S,R){this.type=T,this.credential=S,this.user=R}static _fromIdtoken(T,S){return new ri("enroll",T,S)}static _fromMfaPendingCredential(T){return new ri("signin",T)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(T){var S,R;if(null==T?void 0:T.multiFactorSession){if(null===(S=T.multiFactorSession)||void 0===S?void 0:S.pendingCredential)return ri._fromMfaPendingCredential(T.multiFactorSession.pendingCredential);if(null===(R=T.multiFactorSession)||void 0===R?void 0:R.idToken)return ri._fromIdtoken(T.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(T,S,R){this.session=T,this.hints=S,this.signInResolver=R}static _fromError(T,S){let R=ti(T),O=S.customData._serverResponse,N=(O.mfaInfo||[]).map(T=>tX._fromServerResponse(R,T));en(O.mfaPendingCredential,R,"internal-error");let P=ri._fromMfaPendingCredential(O.mfaPendingCredential);return new rs(P,N,async T=>{let N=await T._process(R,P);delete O.mfaInfo,delete O.mfaPendingCredential;let M=Object.assign(Object.assign({},O),{idToken:N.idToken,refreshToken:N.refreshToken});switch(S.operationType){case"signIn":let L=await tG._fromIdTokenResponse(R,S.operationType,M);return await R._updateCurrentUser(L.user),L;case"reauthenticate":return en(S.user,R,"internal-error"),tG._forOperation(S.user,S.operationType,M);default:X(R,"internal-error")}})}async resolveSignIn(T){let S=T;return this.signInResolver(S)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(T,S){return ey(T,"POST","/v2/accounts/mfaEnrollment:start",em(T,S))}function ro(T,S){return ey(T,"POST","/v2/accounts/mfaEnrollment:finalize",em(T,S))}function rl(T,S){return ey(T,"POST","/v2/accounts/mfaEnrollment:withdraw",em(T,S))}class ru{constructor(T){this.user=T,this.enrolledFactors=[],T._onReload(S=>{S.mfaInfo&&(this.enrolledFactors=S.mfaInfo.map(S=>tX._fromServerResponse(T.auth,S)))})}static _fromUser(T){return new ru(T)}async getSession(){return ri._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(T,S){let R=T,O=await this.getSession(),N=await ex(this.user,R._process(this.user.auth,O,S));return await this.user._updateTokensIfNecessary(N),this.user.reload()}async unenroll(T){let S="string"==typeof T?T:T.uid,R=await this.user.getIdToken();try{let T=await ex(this.user,rl(this.user.auth,{idToken:R,mfaEnrollmentId:S}));this.enrolledFactors=this.enrolledFactors.filter(({uid:T})=>T!==S),await this.user._updateTokensIfNecessary(T),await this.user.reload()}catch(T){throw T}}}new WeakMap;var rc="@firebase/auth",rd="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(T){this.auth=T,this.internalListeners=new Map}getUid(){var T;return this.assertAuthConfigured(),(null===(T=this.auth.currentUser)||void 0===T?void 0:T.uid)||null}async getToken(T){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(T)}:null}addAuthTokenListener(T){if(this.assertAuthConfigured(),this.internalListeners.has(T))return;let S=this.auth.onIdTokenChanged(S=>{T((null==S?void 0:S.stsTokenManager.accessToken)||null)});this.internalListeners.set(T,S),this.updateProactiveRefresh()}removeAuthTokenListener(T){this.assertAuthConfigured();let S=this.internalListeners.get(T);S&&(this.internalListeners.delete(T),S(),this.updateProactiveRefresh())}assertAuthConfigured(){en(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(T){switch(T){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rp(T){(0,O.Xd)(new M.wA("auth",(S,{options:R})=>{let O=S.getProvider("app").getImmediate(),N=S.getProvider("heartbeat"),P=S.getProvider("app-check-internal"),{apiKey:M,authDomain:L}=O.options;en(M&&!M.includes(":"),"invalid-api-key",{appName:O.name});let U=new tr(O,N,P,{apiKey:M,authDomain:L,clientPlatform:T,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:e5(T)});return tf(U,R),U},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((T,S,R)=>{T.getProvider("auth-internal").initialize()})),(0,O.Xd)(new M.wA("auth-internal",T=>new rh(ti(T.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,O.KN)(rc,rd,rf(T)),(0,O.KN)(rc,rd,"esm2017")}function rg(T=(0,O.Mq)()){let S=(0,O.qX)(T,"auth");if(S.isInitialized())return S.getImmediate();let R=th(T),P=(0,N.q4)("auth");return P&&tp(R,`http://${P}`),R}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ef.initialize(L.fetch,L.Headers,L.Response),rp("Node");let rm=Z("operation-not-supported-in-this-environment");async function ry(){throw rm}class rv{constructor(){throw rm}}let rb=ry,rT=ry,rS=rv;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(T,S){return ey(T,"POST","/v2/accounts/mfaSignIn:finalize",em(T,S))}tr.prototype.setPersistence=async()=>{};class rE{constructor(T){this.factorId=T}_process(T,S,R){switch(S.type){case"enroll":return this._finalizeEnroll(T,S.credential,R);case"signin":return this._finalizeSignIn(T,S.credential);default:return ei("unexpected MultiFactorSessionType")}}}class rw{static assertionForEnrollment(T,S){return rC._fromSecret(T,S)}static assertionForSignIn(T,S){return rC._fromEnrollmentId(T,S)}static async generateSecret(T){var S;let R=T;en(void 0!==(null===(S=R.user)||void 0===S?void 0:S.auth),"internal-error");let O=await ra(R.user.auth,{idToken:R.credential,totpEnrollmentInfo:{}});return rI._fromStartTotpMfaEnrollmentResponse(O,R.user.auth)}}rw.FACTOR_ID="totp";class rC extends rE{constructor(T,S,R){super("totp"),this.otp=T,this.enrollmentId=S,this.secret=R}static _fromSecret(T,S){return new rC(S,void 0,T)}static _fromEnrollmentId(T,S){return new rC(S,T)}async _finalizeEnroll(T,S,R){return en(void 0!==this.secret,T,"argument-error"),ro(T,{idToken:S,displayName:R,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(T,S){en(void 0!==this.enrollmentId&&void 0!==this.otp,T,"argument-error");let R={verificationCode:this.otp};return r_(T,{mfaPendingCredential:S,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:R})}}class rI{constructor(T,S,R,O,N,P,M){this.sessionInfo=P,this.auth=M,this.secretKey=T,this.hashingAlgorithm=S,this.codeLength=R,this.codeIntervalSeconds=O,this.enrollmentCompletionDeadline=N}static _fromStartTotpMfaEnrollmentResponse(T,S){return new rI(T.totpSessionInfo.sharedSecretKey,T.totpSessionInfo.hashingAlgorithm,T.totpSessionInfo.verificationCodeLength,T.totpSessionInfo.periodSec,new Date(T.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),T.totpSessionInfo.sessionInfo,S)}_makeTotpVerificationInfo(T){return{sessionInfo:this.sessionInfo,verificationCode:T}}generateQrCodeUrl(T,S){var R;let O=!1;return(rR(T)||rR(S))&&(O=!0),O&&(rR(T)&&(T=(null===(R=this.auth.currentUser)||void 0===R?void 0:R.email)||"unknownuser"),rR(S)&&(S=this.auth.name)),`otpauth://totp/${S}:${T}?secret=${this.secretKey}&issuer=${S}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function rR(T){return void 0===T||(null==T?void 0:T.length)===0}},31489:(T,S,R)=>{"use strict";R.d(S,{Timestamp:()=>eM,addDoc:()=>m1,collection:()=>g_,deleteDoc:()=>m0,doc:()=>gE,getCountFromServer:()=>m6,getDoc:()=>mQ,getDocs:()=>mJ,getFirestore:()=>gO,nP:()=>ye,b9:()=>m_,cf:()=>m2,orderBy:()=>mT,query:()=>mg,serverTimestamp:()=>m7,setDoc:()=>mX,TQ:()=>mw,updateDoc:()=>mZ,where:()=>my});var O,N,P,M,L=R(20662),U=R(84803),V=R(61062),$=R(73837),K=R(62646),W=R(6113),Q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Y={};(function(){function T(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function S(T,S,R){R||(R=0);var O=Array(16);if("string"==typeof S)for(var N=0;16>N;++N)O[N]=S.charCodeAt(R++)|S.charCodeAt(R++)<<8|S.charCodeAt(R++)<<16|S.charCodeAt(R++)<<24;else for(N=0;16>N;++N)O[N]=S[R++]|S[R++]<<8|S[R++]<<16|S[R++]<<24;S=T.g[0],R=T.g[1],N=T.g[2];var P=T.g[3],M=S+(P^R&(N^P))+O[0]+3614090360&4294967295;M=P+(N^(S=R+(M<<7&4294967295|M>>>25))&(R^N))+O[1]+3905402710&4294967295,M=N+(R^(P=S+(M<<12&4294967295|M>>>20))&(S^R))+O[2]+606105819&4294967295,M=R+(S^(N=P+(M<<17&4294967295|M>>>15))&(P^S))+O[3]+3250441966&4294967295,M=S+(P^(R=N+(M<<22&4294967295|M>>>10))&(N^P))+O[4]+4118548399&4294967295,M=P+(N^(S=R+(M<<7&4294967295|M>>>25))&(R^N))+O[5]+1200080426&4294967295,M=N+(R^(P=S+(M<<12&4294967295|M>>>20))&(S^R))+O[6]+2821735955&4294967295,M=R+(S^(N=P+(M<<17&4294967295|M>>>15))&(P^S))+O[7]+4249261313&4294967295,M=S+(P^(R=N+(M<<22&4294967295|M>>>10))&(N^P))+O[8]+1770035416&4294967295,M=P+(N^(S=R+(M<<7&4294967295|M>>>25))&(R^N))+O[9]+2336552879&4294967295,M=N+(R^(P=S+(M<<12&4294967295|M>>>20))&(S^R))+O[10]+4294925233&4294967295,M=R+(S^(N=P+(M<<17&4294967295|M>>>15))&(P^S))+O[11]+2304563134&4294967295,M=S+(P^(R=N+(M<<22&4294967295|M>>>10))&(N^P))+O[12]+1804603682&4294967295,M=P+(N^(S=R+(M<<7&4294967295|M>>>25))&(R^N))+O[13]+4254626195&4294967295,M=N+(R^(P=S+(M<<12&4294967295|M>>>20))&(S^R))+O[14]+2792965006&4294967295,M=R+(S^(N=P+(M<<17&4294967295|M>>>15))&(P^S))+O[15]+1236535329&4294967295,R=N+(M<<22&4294967295|M>>>10),M=S+(N^P&(R^N))+O[1]+4129170786&4294967295,S=R+(M<<5&4294967295|M>>>27),M=P+(R^N&(S^R))+O[6]+3225465664&4294967295,P=S+(M<<9&4294967295|M>>>23),M=N+(S^R&(P^S))+O[11]+643717713&4294967295,N=P+(M<<14&4294967295|M>>>18),M=R+(P^S&(N^P))+O[0]+3921069994&4294967295,R=N+(M<<20&4294967295|M>>>12),M=S+(N^P&(R^N))+O[5]+3593408605&4294967295,S=R+(M<<5&4294967295|M>>>27),M=P+(R^N&(S^R))+O[10]+38016083&4294967295,P=S+(M<<9&4294967295|M>>>23),M=N+(S^R&(P^S))+O[15]+3634488961&4294967295,N=P+(M<<14&4294967295|M>>>18),M=R+(P^S&(N^P))+O[4]+3889429448&4294967295,R=N+(M<<20&4294967295|M>>>12),M=S+(N^P&(R^N))+O[9]+568446438&4294967295,S=R+(M<<5&4294967295|M>>>27),M=P+(R^N&(S^R))+O[14]+3275163606&4294967295,P=S+(M<<9&4294967295|M>>>23),M=N+(S^R&(P^S))+O[3]+4107603335&4294967295,N=P+(M<<14&4294967295|M>>>18),M=R+(P^S&(N^P))+O[8]+1163531501&4294967295,R=N+(M<<20&4294967295|M>>>12),M=S+(N^P&(R^N))+O[13]+2850285829&4294967295,S=R+(M<<5&4294967295|M>>>27),M=P+(R^N&(S^R))+O[2]+4243563512&4294967295,P=S+(M<<9&4294967295|M>>>23),M=N+(S^R&(P^S))+O[7]+1735328473&4294967295,N=P+(M<<14&4294967295|M>>>18),M=R+(P^S&(N^P))+O[12]+2368359562&4294967295,M=S+((R=N+(M<<20&4294967295|M>>>12))^N^P)+O[5]+4294588738&4294967295,M=P+((S=R+(M<<4&4294967295|M>>>28))^R^N)+O[8]+2272392833&4294967295,M=N+((P=S+(M<<11&4294967295|M>>>21))^S^R)+O[11]+1839030562&4294967295,M=R+((N=P+(M<<16&4294967295|M>>>16))^P^S)+O[14]+4259657740&4294967295,M=S+((R=N+(M<<23&4294967295|M>>>9))^N^P)+O[1]+2763975236&4294967295,M=P+((S=R+(M<<4&4294967295|M>>>28))^R^N)+O[4]+1272893353&4294967295,M=N+((P=S+(M<<11&4294967295|M>>>21))^S^R)+O[7]+4139469664&4294967295,M=R+((N=P+(M<<16&4294967295|M>>>16))^P^S)+O[10]+3200236656&4294967295,M=S+((R=N+(M<<23&4294967295|M>>>9))^N^P)+O[13]+681279174&4294967295,M=P+((S=R+(M<<4&4294967295|M>>>28))^R^N)+O[0]+3936430074&4294967295,M=N+((P=S+(M<<11&4294967295|M>>>21))^S^R)+O[3]+3572445317&4294967295,M=R+((N=P+(M<<16&4294967295|M>>>16))^P^S)+O[6]+76029189&4294967295,M=S+((R=N+(M<<23&4294967295|M>>>9))^N^P)+O[9]+3654602809&4294967295,M=P+((S=R+(M<<4&4294967295|M>>>28))^R^N)+O[12]+3873151461&4294967295,M=N+((P=S+(M<<11&4294967295|M>>>21))^S^R)+O[15]+530742520&4294967295,M=R+((N=P+(M<<16&4294967295|M>>>16))^P^S)+O[2]+3299628645&4294967295,R=N+(M<<23&4294967295|M>>>9),M=S+(N^(R|~P))+O[0]+4096336452&4294967295,S=R+(M<<6&4294967295|M>>>26),M=P+(R^(S|~N))+O[7]+1126891415&4294967295,P=S+(M<<10&4294967295|M>>>22),M=N+(S^(P|~R))+O[14]+2878612391&4294967295,N=P+(M<<15&4294967295|M>>>17),M=R+(P^(N|~S))+O[5]+4237533241&4294967295,R=N+(M<<21&4294967295|M>>>11),M=S+(N^(R|~P))+O[12]+1700485571&4294967295,S=R+(M<<6&4294967295|M>>>26),M=P+(R^(S|~N))+O[3]+2399980690&4294967295,P=S+(M<<10&4294967295|M>>>22),M=N+(S^(P|~R))+O[10]+4293915773&4294967295,N=P+(M<<15&4294967295|M>>>17),M=R+(P^(N|~S))+O[1]+2240044497&4294967295,R=N+(M<<21&4294967295|M>>>11),M=S+(N^(R|~P))+O[8]+1873313359&4294967295,S=R+(M<<6&4294967295|M>>>26),M=P+(R^(S|~N))+O[15]+4264355552&4294967295,P=S+(M<<10&4294967295|M>>>22),M=N+(S^(P|~R))+O[6]+2734768916&4294967295,N=P+(M<<15&4294967295|M>>>17),M=R+(P^(N|~S))+O[13]+1309151649&4294967295,R=N+(M<<21&4294967295|M>>>11),M=S+(N^(R|~P))+O[4]+4149444226&4294967295,S=R+(M<<6&4294967295|M>>>26),M=P+(R^(S|~N))+O[11]+3174756917&4294967295,P=S+(M<<10&4294967295|M>>>22),M=N+(S^(P|~R))+O[2]+718787259&4294967295,N=P+(M<<15&4294967295|M>>>17),M=R+(P^(N|~S))+O[9]+3951481745&4294967295,T.g[0]=T.g[0]+S&4294967295,T.g[1]=T.g[1]+(N+(M<<21&4294967295|M>>>11))&4294967295,T.g[2]=T.g[2]+N&4294967295,T.g[3]=T.g[3]+P&4294967295}function R(T,S){var R=L;return Object.prototype.hasOwnProperty.call(R,T)?R[T]:R[T]=S(T)}function P(T,S){this.h=S;for(var R=[],O=!0,N=T.length-1;0<=N;N--){var P=0|T[N];O&&P==S||(R[N]=P,O=!1)}this.g=R}(function(T,S){function R(){}R.prototype=S.prototype,T.D=S.prototype,T.prototype=new R,T.prototype.constructor=T,T.C=function(T,R,O){for(var N=Array(arguments.length-2),P=2;P<arguments.length;P++)N[P-2]=arguments[P];return S.prototype[R].apply(T,N)}})(T,function(){this.blockSize=-1}),T.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},T.prototype.u=function(T,R){void 0===R&&(R=T.length);for(var O=R-this.blockSize,N=this.B,P=this.h,M=0;M<R;){if(0==P)for(;M<=O;)S(this,T,M),M+=this.blockSize;if("string"==typeof T){for(;M<R;)if(N[P++]=T.charCodeAt(M++),P==this.blockSize){S(this,N),P=0;break}}else for(;M<R;)if(N[P++]=T[M++],P==this.blockSize){S(this,N),P=0;break}}this.h=P,this.o+=R},T.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var S=1;S<T.length-8;++S)T[S]=0;var R=8*this.o;for(S=T.length-8;S<T.length;++S)T[S]=255&R,R/=256;for(this.u(T),T=Array(16),S=R=0;4>S;++S)for(var O=0;32>O;O+=8)T[R++]=this.g[S]>>>O&255;return T};var M,L={};function U(T){return -128<=T&&128>T?R(T,function(T){return new P([0|T],0>T?-1:0)}):new P([0|T],0>T?-1:0)}function V(T){if(isNaN(T)||!isFinite(T))return K;if(0>T)return ee(V(-T));for(var S=[],R=1,O=0;T>=R;O++)S[O]=T/R|0,R*=4294967296;return new P(S,0)}function $(T,S){if(0==T.length)throw Error("number format error: empty string");if(2>(S=S||10)||36<S)throw Error("radix out of range: "+S);if("-"==T.charAt(0))return ee($(T.substring(1),S));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=V(Math.pow(S,8)),O=K,N=0;N<T.length;N+=8){var P=Math.min(8,T.length-N),M=parseInt(T.substring(N,N+P),S);8>P?(P=V(Math.pow(S,P)),O=O.j(P).add(V(M))):O=(O=O.j(R)).add(V(M))}return O}var K=U(0),W=U(1),Q=U(16777216);function X(T){if(0!=T.h)return!1;for(var S=0;S<T.g.length;S++)if(0!=T.g[S])return!1;return!0}function Z(T){return -1==T.h}function ee(T){for(var S=T.g.length,R=[],O=0;O<S;O++)R[O]=~T.g[O];return new P(R,~T.h).add(W)}function et(T,S){return T.add(ee(S))}function er(T,S){for(;(65535&T[S])!=T[S];)T[S+1]+=T[S]>>>16,T[S]&=65535,S++}function en(T,S){this.g=T,this.h=S}function ei(T,S){if(X(S))throw Error("division by zero");if(X(T))return new en(K,K);if(Z(T))return S=ei(ee(T),S),new en(ee(S.g),ee(S.h));if(Z(S))return S=ei(T,ee(S)),new en(ee(S.g),S.h);if(30<T.g.length){if(Z(T)||Z(S))throw Error("slowDivide_ only works with positive integers.");for(var R=W,O=S;0>=O.l(T);)R=es(R),O=es(O);var N=ea(R,1),P=ea(O,1);for(O=ea(O,2),R=ea(R,2);!X(O);){var M=P.add(O);0>=M.l(T)&&(N=N.add(R),P=M),O=ea(O,1),R=ea(R,1)}return S=et(T,N.j(S)),new en(N,S)}for(N=K;0<=T.l(S);){for(O=48>=(O=Math.ceil(Math.log(R=Math.max(1,Math.floor(T.m()/S.m())))/Math.LN2))?1:Math.pow(2,O-48),M=(P=V(R)).j(S);Z(M)||0<M.l(T);)R-=O,M=(P=V(R)).j(S);X(P)&&(P=W),N=N.add(P),T=et(T,M)}return new en(N,T)}function es(T){for(var S=T.g.length+1,R=[],O=0;O<S;O++)R[O]=T.i(O)<<1|T.i(O-1)>>>31;return new P(R,T.h)}function ea(T,S){var R=S>>5;S%=32;for(var O=T.g.length-R,N=[],M=0;M<O;M++)N[M]=0<S?T.i(M+R)>>>S|T.i(M+R+1)<<32-S:T.i(M+R);return new P(N,T.h)}(M=P.prototype).m=function(){if(Z(this))return-ee(this).m();for(var T=0,S=1,R=0;R<this.g.length;R++){var O=this.i(R);T+=(0<=O?O:4294967296+O)*S,S*=4294967296}return T},M.toString=function(T){if(2>(T=T||10)||36<T)throw Error("radix out of range: "+T);if(X(this))return"0";if(Z(this))return"-"+ee(this).toString(T);for(var S=V(Math.pow(T,6)),R=this,O="";;){var N=ei(R,S).g,P=((0<(R=et(R,N.j(S))).g.length?R.g[0]:R.h)>>>0).toString(T);if(X(R=N))return P+O;for(;6>P.length;)P="0"+P;O=P+O}},M.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h},M.l=function(T){return Z(T=et(this,T))?-1:X(T)?0:1},M.abs=function(){return Z(this)?ee(this):this},M.add=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0,N=0;N<=S;N++){var M=O+(65535&this.i(N))+(65535&T.i(N)),L=(M>>>16)+(this.i(N)>>>16)+(T.i(N)>>>16);O=L>>>16,M&=65535,L&=65535,R[N]=L<<16|M}return new P(R,-2147483648&R[R.length-1]?-1:0)},M.j=function(T){if(X(this)||X(T))return K;if(Z(this))return Z(T)?ee(this).j(ee(T)):ee(ee(this).j(T));if(Z(T))return ee(this.j(ee(T)));if(0>this.l(Q)&&0>T.l(Q))return V(this.m()*T.m());for(var S=this.g.length+T.g.length,R=[],O=0;O<2*S;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(var N=0;N<T.g.length;N++){var M=this.i(O)>>>16,L=65535&this.i(O),U=T.i(N)>>>16,$=65535&T.i(N);R[2*O+2*N]+=L*$,er(R,2*O+2*N),R[2*O+2*N+1]+=M*$,er(R,2*O+2*N+1),R[2*O+2*N+1]+=L*U,er(R,2*O+2*N+1),R[2*O+2*N+2]+=M*U,er(R,2*O+2*N+2)}for(O=0;O<S;O++)R[O]=R[2*O+1]<<16|R[2*O];for(O=S;O<2*S;O++)R[O]=0;return new P(R,0)},M.A=function(T){return ei(this,T).h},M.and=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0;O<S;O++)R[O]=this.i(O)&T.i(O);return new P(R,this.h&T.h)},M.or=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0;O<S;O++)R[O]=this.i(O)|T.i(O);return new P(R,this.h|T.h)},M.xor=function(T){for(var S=Math.max(this.g.length,T.g.length),R=[],O=0;O<S;O++)R[O]=this.i(O)^T.i(O);return new P(R,this.h^T.h)},T.prototype.digest=T.prototype.v,T.prototype.reset=T.prototype.s,T.prototype.update=T.prototype.u,N=Y.Md5=T,P.prototype.add=P.prototype.add,P.prototype.multiply=P.prototype.j,P.prototype.modulo=P.prototype.A,P.prototype.compare=P.prototype.l,P.prototype.toNumber=P.prototype.m,P.prototype.toString=P.prototype.toString,P.prototype.getBits=P.prototype.i,P.fromNumber=V,P.fromString=$,O=Y.Integer=P}).apply(void 0!==Q?Q:"undefined"!=typeof self?self:{});var X=R(13985),Z=R(37486);let ee="@firebase/firestore",et="4.7.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(T){this.uid=T}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(T){return T.uid===this.uid}}er.UNAUTHENTICATED=new er(null),er.GOOGLE_CREDENTIALS=new er("google-credentials-uid"),er.FIRST_PARTY=new er("first-party-uid"),er.MOCK_USER=new er("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let en="10.14.0";function ei(T){en=T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(T){return(0,$.inspect)(T,{depth:100})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea=new V.Yd("@firebase/firestore");function eo(){return ea.logLevel}function eu(T,...S){if(ea.logLevel<=V.in.DEBUG){let R=S.map(eh);ea.debug(`Firestore (${en}): ${T}`,...R)}}function ec(T,...S){if(ea.logLevel<=V.in.ERROR){let R=S.map(eh);ea.error(`Firestore (${en}): ${T}`,...R)}}function ed(T,...S){if(ea.logLevel<=V.in.WARN){let R=S.map(eh);ea.warn(`Firestore (${en}): ${T}`,...R)}}function eh(T){if("string"==typeof T)return T;try{return es(T)}catch(S){return T}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(T="Unexpected state"){let S=`FIRESTORE (${en}) INTERNAL ASSERTION FAILED: `+T;throw ec(S),Error(S)}function ep(T,S){T||ef()}function eg(T,S){return T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let em={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ey extends K.ZR{constructor(T,S){super(T,S),this.code=T,this.message=S,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(){this.promise=new Promise((T,S)=>{this.resolve=T,this.reject=S})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(T,S){this.user=S,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${T}`)}}class eT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(T,S){T.enqueueRetryable(()=>S(er.UNAUTHENTICATED))}shutdown(){}}class eS{constructor(T){this.token=T,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(T,S){this.changeListener=S,T.enqueueRetryable(()=>S(this.token.user))}shutdown(){this.changeListener=null}}class e_{constructor(T){this.authProvider=T,this.currentUser=er.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(T,S){ep(void 0===this.tokenListener);let R=this.tokenCounter,O=T=>this.tokenCounter!==R?(R=this.tokenCounter,S(T)):Promise.resolve(),N=new ev;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),N.resolve(),N=new ev,T.enqueueRetryable(()=>O(this.currentUser))};let P=()=>{let S=N;T.enqueueRetryable(async()=>{await S.promise,await O(this.currentUser)})},M=T=>{eu("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=T,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),P())};this.authProvider.onInit(T=>M(T)),setTimeout(()=>{if(!this.auth){let T=this.authProvider.getImmediate({optional:!0});T?M(T):(eu("FirebaseAuthCredentialsProvider","Auth not yet detected"),N.resolve(),N=new ev)}},0),P()}getToken(){let T=this.tokenCounter,S=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(S).then(S=>this.tokenCounter!==T?(eu("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):S?(ep("string"==typeof S.accessToken),new eb(S.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let T=this.auth&&this.auth.getUid();return ep(null===T||"string"==typeof T),new er(T)}}class eE{constructor(T,S,R){this.sessionIndex=T,this.iamToken=S,this.authTokenFactory=R,this.type="FirstParty",this.user=er.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let T=this.getAuthToken();return T&&this._headers.set("Authorization",T),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class ew{constructor(T,S,R){this.sessionIndex=T,this.iamToken=S,this.authTokenFactory=R}getToken(){return Promise.resolve(new eE(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(T,S){T.enqueueRetryable(()=>S(er.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eC{constructor(T){this.value=T,this.type="AppCheck",this.headers=new Map,T&&T.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eI{constructor(T){this.appCheckProvider=T,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(T,S){ep(void 0===this.tokenListener);let R=T=>{null!=T.error&&eu("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${T.error.message}`);let R=T.token!==this.latestAppCheckToken;return this.latestAppCheckToken=T.token,eu("FirebaseAppCheckTokenProvider",`Received ${R?"new":"existing"} token.`),R?S(T.token):Promise.resolve()};this.tokenListener=S=>{T.enqueueRetryable(()=>R(S))};let O=T=>{eu("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=T,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(T=>O(T)),setTimeout(()=>{if(!this.appCheck){let T=this.appCheckProvider.getImmediate({optional:!0});T?O(T):eu("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let T=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(T).then(T=>T?(ep("string"==typeof T.token),this.latestAppCheckToken=T.token,new eC(T.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function eR(T){if(!T)return new eT;switch(T.type){case"firstParty":return new ew(T.sessionIndex||"0",T.iamToken||null,T.authTokenFactory||null);case"provider":return T.client;default:throw new ey(em.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eO(T){return(0,W.randomBytes)(T)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{static newId(){let T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",S=Math.floor(256/T.length)*T.length,R="",O=20;for(;R.length<O;){let N=eO(40);for(let P=0;P<N.length;++P)R.length<O&&N[P]<S&&(R+=T.charAt(N[P]%T.length))}return R}}function ek(T,S){return T<S?-1:T>S?1:0}function eN(T,S,R){return T.length===S.length&&T.every((T,O)=>R(T,S[O]))}function eD(T){return T+"\x00"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eP=-62135596800,ex=1e6;class eM{constructor(T,S){if(this.seconds=T,this.nanoseconds=S,S<0||S>=1e9)throw new ey(em.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+S);if(T<eP||T>=253402300800)throw new ey(em.INVALID_ARGUMENT,"Timestamp seconds out of range: "+T)}static now(){return eM.fromMillis(Date.now())}static fromDate(T){return eM.fromMillis(T.getTime())}static fromMillis(T){let S=Math.floor(T/1e3),R=Math.floor((T-1e3*S)*ex);return new eM(S,R)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ex}_compareTo(T){return this.seconds===T.seconds?ek(this.nanoseconds,T.nanoseconds):ek(this.seconds,T.seconds)}isEqual(T){return T.seconds===this.seconds&&T.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds-eP).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(T){this.timestamp=T}static fromTimestamp(T){return new eL(T)}static min(){return new eL(new eM(0,0))}static max(){return new eL(new eM(253402300799,1e9-1))}compareTo(T){return this.timestamp._compareTo(T.timestamp)}isEqual(T){return this.timestamp.isEqual(T.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eF="__name__";class ej{constructor(T,S,R){void 0===S?S=0:S>T.length&&ef(),void 0===R?R=T.length-S:R>T.length-S&&ef(),this.segments=T,this.offset=S,this.len=R}get length(){return this.len}isEqual(T){return 0===ej.comparator(this,T)}child(T){let S=this.segments.slice(this.offset,this.limit());return T instanceof ej?T.forEach(T=>{S.push(T)}):S.push(T),this.construct(S)}limit(){return this.offset+this.length}popFirst(T){return T=void 0===T?1:T,this.construct(this.segments,this.offset+T,this.length-T)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(T){return this.segments[this.offset+T]}isEmpty(){return 0===this.length}isPrefixOf(T){if(T.length<this.length)return!1;for(let S=0;S<this.length;S++)if(this.get(S)!==T.get(S))return!1;return!0}isImmediateParentOf(T){if(this.length+1!==T.length)return!1;for(let S=0;S<this.length;S++)if(this.get(S)!==T.get(S))return!1;return!0}forEach(T){for(let S=this.offset,R=this.limit();S<R;S++)T(this.segments[S])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(T,S){let R=Math.min(T.length,S.length);for(let O=0;O<R;O++){let R=T.get(O),N=S.get(O);if(R<N)return -1;if(R>N)return 1}return T.length<S.length?-1:T.length>S.length?1:0}}class eU extends ej{construct(T,S,R){return new eU(T,S,R)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...T){let S=[];for(let R of T){if(R.indexOf("//")>=0)throw new ey(em.INVALID_ARGUMENT,`Invalid segment (${R}). Paths must not contain // in them.`);S.push(...R.split("/").filter(T=>T.length>0))}return new eU(S)}static emptyPath(){return new eU([])}}let eB=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class eV extends ej{construct(T,S,R){return new eV(T,S,R)}static isValidIdentifier(T){return eB.test(T)}canonicalString(){return this.toArray().map(T=>(T=T.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),eV.isValidIdentifier(T)||(T="`"+T+"`"),T)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===eF}static keyField(){return new eV([eF])}static fromServerFormat(T){let S=[],R="",O=0,N=()=>{if(0===R.length)throw new ey(em.INVALID_ARGUMENT,`Invalid field path (${T}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);S.push(R),R=""},P=!1;for(;O<T.length;){let S=T[O];if("\\"===S){if(O+1===T.length)throw new ey(em.INVALID_ARGUMENT,"Path has trailing escape character: "+T);let S=T[O+1];if(!("\\"===S||"."===S||"`"===S))throw new ey(em.INVALID_ARGUMENT,"Path has invalid escape sequence: "+T);R+=S,O+=2}else"`"===S?P=!P:"."!==S||P?R+=S:N(),O++}if(N(),P)throw new ey(em.INVALID_ARGUMENT,"Unterminated ` in path: "+T);return new eV(S)}static emptyPath(){return new eV([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ez{constructor(T){this.path=T}static fromPath(T){return new ez(eU.fromString(T))}static fromName(T){return new ez(eU.fromString(T).popFirst(5))}static empty(){return new ez(eU.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(T){return this.path.length>=2&&this.path.get(this.path.length-2)===T}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(T){return null!==T&&0===eU.comparator(this.path,T.path)}toString(){return this.path.toString()}static comparator(T,S){return eU.comparator(T.path,S.path)}static isDocumentKey(T){return T.length%2==0}static fromSegments(T){return new ez(new eU(T.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eq=-1,eG=0;class eH{constructor(T,S,R,O){this.indexId=T,this.collectionGroup=S,this.fields=R,this.indexState=O}}function e$(T){return T.fields.find(T=>2===T.kind)}function eK(T){return T.fields.filter(T=>2!==T.kind)}function eW(T){let S=eK(T);return 0===S.length?0:S[S.length-1].kind}function eQ(T,S){let R=ek(T.collectionGroup,S.collectionGroup);if(0!==R)return R;for(let O=0;O<Math.min(T.fields.length,S.fields.length);++O)if(0!==(R=eX(T.fields[O],S.fields[O])))return R;return ek(T.fields.length,S.fields.length)}function eY(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}eH.UNKNOWN_ID=-1;class eJ{constructor(T,S){this.fieldPath=T,this.kind=S}}function eX(T,S){let R=eV.comparator(T.fieldPath,S.fieldPath);return 0!==R?R:ek(T.kind,S.kind)}class eZ{constructor(T,S){this.sequenceNumber=T,this.offset=S}static empty(){return new eZ(eG,e2.min())}}function e0(T,S){let R=T.toTimestamp().seconds,O=T.toTimestamp().nanoseconds+1;return new e2(eL.fromTimestamp(1e9===O?new eM(R+1,0):new eM(R,O)),ez.empty(),S)}function e1(T){return new e2(T.readTime,T.key,eq)}class e2{constructor(T,S,R){this.readTime=T,this.documentKey=S,this.largestBatchId=R}static min(){return new e2(eL.min(),ez.empty(),eq)}static max(){return new e2(eL.max(),ez.empty(),eq)}}function e3(T,S){let R=T.readTime.compareTo(S.readTime);return 0!==R||0!==(R=ez.comparator(T.documentKey,S.documentKey))?R:ek(T.largestBatchId,S.largestBatchId)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class e6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(T){this.onCommittedListeners.push(T)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(T=>T())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e9(T){if(T.code===em.FAILED_PRECONDITION&&T.message===e4)eu("LocalStore","Unexpectedly lost primary lease");else throw T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(T){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,T(T=>{this.isDone=!0,this.result=T,this.nextCallback&&this.nextCallback(T)},T=>{this.isDone=!0,this.error=T,this.catchCallback&&this.catchCallback(T)})}catch(T){return this.next(void 0,T)}next(T,S){return(this.callbackAttached&&ef(),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(S,this.error):this.wrapSuccess(T,this.result):new e5((R,O)=>{this.nextCallback=S=>{this.wrapSuccess(T,S).next(R,O)},this.catchCallback=T=>{this.wrapFailure(S,T).next(R,O)}})}toPromise(){return new Promise((T,S)=>{this.next(T,S)})}wrapUserFunction(T){try{let S=T();if(S instanceof e5)return S;return e5.resolve(S)}catch(T){return e5.reject(T)}}wrapSuccess(T,S){return T?this.wrapUserFunction(()=>T(S)):e5.resolve(S)}wrapFailure(T,S){return T?this.wrapUserFunction(()=>T(S)):e5.reject(S)}static resolve(T){return new e5((S,R)=>{S(T)})}static reject(T){return new e5((S,R)=>{R(T)})}static waitFor(T){return new e5((S,R)=>{let O=0,N=0,P=!1;T.forEach(T=>{++O,T.next(()=>{++N,P&&N===O&&S()},T=>R(T))}),P=!0,N===O&&S()})}static or(T){let S=e5.resolve(!1);for(let R of T)S=S.next(T=>T?e5.resolve(T):R());return S}static forEach(T,S){let R=[];return T.forEach((T,O)=>{R.push(S.call(this,T,O))}),this.waitFor(R)}static mapArray(T,S){return new e5((R,O)=>{let N=T.length,P=Array(N),M=0;for(let L=0;L<N;L++){let U=L;S(T[U]).next(T=>{P[U]=T,++M===N&&R(P)},T=>O(T))}})}static doWhile(T,S){return new e5((R,O)=>{let N=()=>{!0===T()?S().next(()=>{N()},O):R()};N()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e8="SimpleDb",e7=3;class te{constructor(T,S){this.action=T,this.transaction=S,this.aborted=!1,this.completionDeferred=new ev,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{S.error?this.completionDeferred.reject(new ts(T,S.error)):this.completionDeferred.resolve()},this.transaction.onerror=S=>{let R=td(S.target.error);this.completionDeferred.reject(new ts(T,R))}}static open(T,S,R,O){try{return new te(S,T.transaction(O,R))}catch(T){throw new ts(S,T)}}get completionPromise(){return this.completionDeferred.promise}abort(T){T&&this.completionDeferred.reject(T),this.aborted||(eu(e8,"Aborting transaction:",T?T.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let T=this.transaction;this.aborted||"function"!=typeof T.commit||T.commit()}store(T){return new tl(this.transaction.objectStore(T))}}class tt{constructor(T,S,R){this.name=T,this.version=S,this.schemaConverter=R,12.2===tt.getIOSVersion(getUA())&&ec("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(T){return eu(e8,"Removing database:",T),tu(window.indexedDB.deleteDatabase(T)).toPromise()}static isAvailable(){if(!isIndexedDBAvailable())return!1;if(tt.isMockPersistence())return!0;let T=getUA(),S=tt.getIOSVersion(T),R=0<S&&S<10,O=tr(T),N=0<O&&O<4.5;return!(T.indexOf("MSIE ")>0||T.indexOf("Trident/")>0||T.indexOf("Edge/")>0)&&!R&&!N}static isMockPersistence(){var T;return"undefined"!=typeof process&&(null===(T=process.env)||void 0===T?void 0:T.USE_MOCK_PERSISTENCE)==="YES"}static getStore(T,S){return T.store(S)}static getIOSVersion(T){let S=T.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(S?S[1].split("_").slice(0,2).join("."):"-1")}async ensureDb(T){return this.db||(eu(e8,"Opening database:",this.name),this.db=await new Promise((S,R)=>{let O=indexedDB.open(this.name,this.version);O.onsuccess=T=>{S(T.target.result)},O.onblocked=()=>{R(new ts(T,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},O.onerror=S=>{let O=S.target.error;"VersionError"===O.name?R(new ey(em.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===O.name?R(new ey(em.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+O)):R(new ts(T,O))},O.onupgradeneeded=T=>{eu(e8,'Database "'+this.name+'" requires upgrade from version:',T.oldVersion);let S=T.target.result;this.schemaConverter.createOrUpgrade(S,O.transaction,T.oldVersion,this.version).next(()=>{eu(e8,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=T=>this.versionchangelistener(T)),this.db}setVersionChangeListener(T){this.versionchangelistener=T,this.db&&(this.db.onversionchange=S=>T(S))}async runTransaction(T,S,R,O){let N="readonly"===S,P=0;for(;;){++P;try{this.db=await this.ensureDb(T);let S=te.open(this.db,T,N?"readonly":"readwrite",R),P=O(S).next(T=>(S.maybeCommit(),T)).catch(T=>(S.abort(T),e5.reject(T))).toPromise();return P.catch(()=>{}),await S.completionPromise,P}catch(R){let T=R,S="FirebaseError"!==T.name&&P<e7;if(eu(e8,"Transaction failed with error:",T.message,"Retrying:",S),this.close(),!S)return Promise.reject(T)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tr(T){let S=T.match(/Android ([\d.]+)/i);return Number(S?S[1].split(".").slice(0,2).join("."):"-1")}class ti{constructor(T){this.dbCursor=T,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(T){this.dbCursor=T}done(){this.shouldStop=!0}skip(T){this.nextKey=T}delete(){return tu(this.dbCursor.delete())}}class ts extends null{constructor(T,S){super(em.UNAVAILABLE,`IndexedDB transaction '${T}' failed: ${S}`),this.name="IndexedDbTransactionError"}}function ta(T){return"IndexedDbTransactionError"===T.name}class tl{constructor(T){this.store=T}put(T,S){let R;return void 0!==S?(eu(e8,"PUT",this.store.name,T,S),R=this.store.put(S,T)):(eu(e8,"PUT",this.store.name,"<auto-key>",T),R=this.store.put(T)),tu(R)}add(T){return eu(e8,"ADD",this.store.name,T,T),tu(this.store.add(T))}get(T){return tu(this.store.get(T)).next(S=>(void 0===S&&(S=null),eu(e8,"GET",this.store.name,T,S),S))}delete(T){return eu(e8,"DELETE",this.store.name,T),tu(this.store.delete(T))}count(){return eu(e8,"COUNT",this.store.name),tu(this.store.count())}loadAll(T,S){let R=this.options(T,S),O=R.index?this.store.index(R.index):this.store;if("function"==typeof O.getAll){let T=O.getAll(R.range);return new e5((S,R)=>{T.onerror=T=>{R(T.target.error)},T.onsuccess=T=>{S(T.target.result)}})}{let T=this.cursor(R),S=[];return this.iterateCursor(T,(T,R)=>{S.push(R)}).next(()=>S)}}loadFirst(T,S){let R=this.store.getAll(T,null===S?void 0:S);return new e5((T,S)=>{R.onerror=T=>{S(T.target.error)},R.onsuccess=S=>{T(S.target.result)}})}deleteAll(T,S){eu(e8,"DELETE ALL",this.store.name);let R=this.options(T,S);R.keysOnly=!1;let O=this.cursor(R);return this.iterateCursor(O,(T,S,R)=>R.delete())}iterate(T,S){let R;S?R=T:(R={},S=T);let O=this.cursor(R);return this.iterateCursor(O,S)}iterateSerial(T){let S=this.cursor({});return new e5((R,O)=>{S.onerror=T=>{O(td(T.target.error))},S.onsuccess=S=>{let O=S.target.result;if(!O){R();return}T(O.primaryKey,O.value).next(T=>{T?O.continue():R()})}})}iterateCursor(T,S){let R=[];return new e5((O,N)=>{T.onerror=T=>{N(T.target.error)},T.onsuccess=T=>{let N=T.target.result;if(!N){O();return}let P=new ti(N),M=S(N.primaryKey,N.value,P);if(M instanceof e5){let T=M.catch(T=>(P.done(),e5.reject(T)));R.push(T)}P.isDone?O():null===P.skipToKey?N.continue():N.continue(P.skipToKey)}}).next(()=>e5.waitFor(R))}options(T,S){let R;return void 0!==T&&("string"==typeof T?R=T:S=T),{index:R,range:S}}cursor(T){let S="next";if(T.reverse&&(S="prev"),!T.index)return this.store.openCursor(T.range,S);{let R=this.store.index(T.index);return T.keysOnly?R.openKeyCursor(T.range,S):R.openCursor(T.range,S)}}}function tu(T){return new e5((S,R)=>{T.onsuccess=T=>{S(T.target.result)},T.onerror=T=>{R(td(T.target.error))}})}let tc=!1;function td(T){let S=tt.getIOSVersion(getUA());if(S>=12.2&&S<13){let S="An internal error was encountered in the Indexed Database server";if(T.message.indexOf(S)>=0){let T=new ey("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${S}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return tc||(tc=!0,setTimeout(()=>{throw T},0)),T}}return T}let th="IndexBackfiller",tf=null,tp=null,tg=50;class tm{constructor(T,S){this.asyncQueue=T,this.backfiller=S,this.task=null}start(){this.schedule(tf)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(T){eu(th,`Scheduled in ${T}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",T,async()=>{this.task=null;try{let T=await this.backfiller.backfill();eu(th,`Documents written: ${T}`)}catch(T){ta(T)?eu(th,"Ignoring IndexedDB error during index backfill: ",T):await e9(T)}await this.schedule(tp)})}}class ty{constructor(T,S){this.localStore=T,this.persistence=S}async backfill(T=tg){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",S=>this.writeIndexEntries(S,T))}writeIndexEntries(T,S){let R=new Set,O=S,N=!0;return e5.doWhile(()=>!0===N&&O>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(T).next(S=>{if(!(null===S||R.has(S)))return eu(th,`Processing collection: ${S}`),this.writeEntriesForCollectionGroup(T,S,O).next(T=>{O-=T,R.add(S)});N=!1})).next(()=>S-O)}writeEntriesForCollectionGroup(T,S,R){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(T,S).next(O=>this.localStore.localDocuments.getNextDocuments(T,S,O,R).next(R=>{let N=R.changes;return this.localStore.indexManager.updateIndexEntries(T,N).next(()=>this.getNewOffset(O,R)).next(R=>(eu(th,`Updating offset: ${R}`),this.localStore.indexManager.updateCollectionGroup(T,S,R))).next(()=>N.size)}))}getNewOffset(T,S){let R=T;return S.changes.forEach((T,S)=>{let O=e1(S);e3(O,R)>0&&(R=O)}),new e2(R.readTime,R.documentKey,Math.max(S.batchId,T.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(T,S){this.previousValue=T,S&&(S.sequenceNumberHandler=T=>this.setPreviousValue(T),this.writeNewSequenceNumber=T=>S.writeSequenceNumber(T))}setPreviousValue(T){return this.previousValue=Math.max(T,this.previousValue),this.previousValue}next(){let T=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(T),T}}tv.INVALID=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tb="\x01",tT="\x01",tS="\x10",t_="\x11";function tE(T){let S="";for(let R=0;R<T.length;R++)S.length>0&&(S=tC(S)),S=tw(T.get(R),S);return tC(S)}function tw(T,S){let R=S,O=T.length;for(let S=0;S<O;S++){let O=T.charAt(S);switch(O){case"\x00":R+=tb+tS;break;case tb:R+=tb+t_;break;default:R+=O}}return R}function tC(T){return T+tb+tT}function tI(T){let S=T.length;if(ep(S>=2),2===S)return ep(T.charAt(0)===tb&&T.charAt(1)===tT),eU.emptyPath();let R=S-2,O=[],N="";for(let P=0;P<S;){let S=T.indexOf(tb,P);switch((S<0||S>R)&&ef(),T.charAt(S+1)){case tT:let M;let L=T.substring(P,S);0===N.length?M=L:(N+=L,M=N,N=""),O.push(M);break;case tS:N+=T.substring(P,S)+"\x00";break;case t_:N+=T.substring(P,S+1);break;default:ef()}P=S+2}return new eU(O)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tR="remoteDocuments",tO="owner",tA="owner",tk="mutationQueues",tN="userId",tD="mutations",tP="batchId",tM="userMutationsIndex",tL=null;function tF(T){return[T]}function tj(T,S){return[T,tE(S)]}function tU(T,S,R){return[T,tE(S),R]}let tB={},tV="documentMutations",tz="remoteDocumentsV14",tq=null,tG="documentKeyIndex",tH=null,t$="collectionGroupIndex",tK=null,tW="remoteDocumentGlobal",tQ="remoteDocumentGlobalKey",tY="targets",tJ="targetId",tX="queryTargetsIndex",tZ=null,t0="targetDocuments",t1=null,t2="documentTargetsIndex",t3=null,t4="targetGlobalKey",t6="targetGlobal",t9="collectionParents",t5=null,t8="clientMetadata",t7="clientId",rt="bundles",rr="bundleId",rn="namedQueries",ri="name",rs="indexConfiguration",ra="indexId",ro="collectionGroupIndex",rl="collectionGroup",ru="indexState",rc=null,rd="sequenceNumberIndex",rh=null,rf="indexEntries",rp=null,rg="documentKeyIndex",rm=null,ry="documentOverlays",rv=null,rb="collectionPathOverlayIndex",rT=null,rS="collectionGroupOverlayIndex",r_=null,rE="globals",rw="name",rC=[tk,tD,tV,tR,tY,tO,t6,t0,t8,tW,t9,rt,rn],rI=[...rC,ry],rR=[tk,tD,tV,tz,tY,tO,t6,t0,t8,tW,t9,rt,rn,ry],rO=rR,rA=[...rO,rs,ru,rf],rk=null,rN=[...rA,rE];function rD(T){return 17===T?rN:16===T?rk:15===T?rA:14===T?rO:13===T?rR:12===T?rI:11===T?rC:void ef()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP extends null{constructor(T,S){super(),this.simpleDbTransaction=T,this.currentSequenceNumber=S}}function rx(T,S){let R=eg(T);return tt.getStore(R.simpleDbTransaction,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rM(T){let S=0;for(let R in T)Object.prototype.hasOwnProperty.call(T,R)&&S++;return S}function rL(T,S){for(let R in T)Object.prototype.hasOwnProperty.call(T,R)&&S(R,T[R])}function rF(T,S){let R=[];for(let O in T)Object.prototype.hasOwnProperty.call(T,O)&&R.push(S(T[O],O,T));return R}function rj(T){for(let S in T)if(Object.prototype.hasOwnProperty.call(T,S))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(T,S){this.comparator=T,this.root=S||rV.EMPTY}insert(T,S){return new rU(this.comparator,this.root.insert(T,S,this.comparator).copy(null,null,rV.BLACK,null,null))}remove(T){return new rU(this.comparator,this.root.remove(T,this.comparator).copy(null,null,rV.BLACK,null,null))}get(T){let S=this.root;for(;!S.isEmpty();){let R=this.comparator(T,S.key);if(0===R)return S.value;R<0?S=S.left:R>0&&(S=S.right)}return null}indexOf(T){let S=0,R=this.root;for(;!R.isEmpty();){let O=this.comparator(T,R.key);if(0===O)return S+R.left.size;O<0?R=R.left:(S+=R.left.size+1,R=R.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(T){return this.root.inorderTraversal(T)}forEach(T){this.inorderTraversal((S,R)=>(T(S,R),!1))}toString(){let T=[];return this.inorderTraversal((S,R)=>(T.push(`${S}:${R}`),!1)),`{${T.join(", ")}}`}reverseTraversal(T){return this.root.reverseTraversal(T)}getIterator(){return new rB(this.root,null,this.comparator,!1)}getIteratorFrom(T){return new rB(this.root,T,this.comparator,!1)}getReverseIterator(){return new rB(this.root,null,this.comparator,!0)}getReverseIteratorFrom(T){return new rB(this.root,T,this.comparator,!0)}}class rB{constructor(T,S,R,O){this.isReverse=O,this.nodeStack=[];let N=1;for(;!T.isEmpty();)if(N=S?R(T.key,S):1,S&&O&&(N*=-1),N<0)T=this.isReverse?T.left:T.right;else if(0===N){this.nodeStack.push(T);break}else this.nodeStack.push(T),T=this.isReverse?T.right:T.left}getNext(){let T=this.nodeStack.pop(),S={key:T.key,value:T.value};if(this.isReverse)for(T=T.left;!T.isEmpty();)this.nodeStack.push(T),T=T.right;else for(T=T.right;!T.isEmpty();)this.nodeStack.push(T),T=T.left;return S}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let T=this.nodeStack[this.nodeStack.length-1];return{key:T.key,value:T.value}}}class rV{constructor(T,S,R,O,N){this.key=T,this.value=S,this.color=null!=R?R:rV.RED,this.left=null!=O?O:rV.EMPTY,this.right=null!=N?N:rV.EMPTY,this.size=this.left.size+1+this.right.size}copy(T,S,R,O,N){return new rV(null!=T?T:this.key,null!=S?S:this.value,null!=R?R:this.color,null!=O?O:this.left,null!=N?N:this.right)}isEmpty(){return!1}inorderTraversal(T){return this.left.inorderTraversal(T)||T(this.key,this.value)||this.right.inorderTraversal(T)}reverseTraversal(T){return this.right.reverseTraversal(T)||T(this.key,this.value)||this.left.reverseTraversal(T)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(T,S,R){let O=this,N=R(T,O.key);return(O=N<0?O.copy(null,null,null,O.left.insert(T,S,R),null):0===N?O.copy(null,S,null,null,null):O.copy(null,null,null,null,O.right.insert(T,S,R))).fixUp()}removeMin(){if(this.left.isEmpty())return rV.EMPTY;let T=this;return T.left.isRed()||T.left.left.isRed()||(T=T.moveRedLeft()),(T=T.copy(null,null,null,T.left.removeMin(),null)).fixUp()}remove(T,S){let R;let O=this;if(0>S(T,O.key))O.left.isEmpty()||O.left.isRed()||O.left.left.isRed()||(O=O.moveRedLeft()),O=O.copy(null,null,null,O.left.remove(T,S),null);else{if(O.left.isRed()&&(O=O.rotateRight()),O.right.isEmpty()||O.right.isRed()||O.right.left.isRed()||(O=O.moveRedRight()),0===S(T,O.key)){if(O.right.isEmpty())return rV.EMPTY;R=O.right.min(),O=O.copy(R.key,R.value,null,null,O.right.removeMin())}O=O.copy(null,null,null,null,O.right.remove(T,S))}return O.fixUp()}isRed(){return this.color}fixUp(){let T=this;return T.right.isRed()&&!T.left.isRed()&&(T=T.rotateLeft()),T.left.isRed()&&T.left.left.isRed()&&(T=T.rotateRight()),T.left.isRed()&&T.right.isRed()&&(T=T.colorFlip()),T}moveRedLeft(){let T=this.colorFlip();return T.right.left.isRed()&&(T=(T=(T=T.copy(null,null,null,null,T.right.rotateRight())).rotateLeft()).colorFlip()),T}moveRedRight(){let T=this.colorFlip();return T.left.left.isRed()&&(T=(T=T.rotateRight()).colorFlip()),T}rotateLeft(){let T=this.copy(null,null,rV.RED,null,this.right.left);return this.right.copy(null,null,this.color,T,null)}rotateRight(){let T=this.copy(null,null,rV.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,T)}colorFlip(){let T=this.left.copy(null,null,!this.left.color,null,null),S=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,T,S)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ef();let T=this.left.check();if(T===this.right.check())return T+(this.isRed()?0:1);throw ef()}}rV.EMPTY=null,rV.RED=!0,rV.BLACK=!1;class rz{constructor(){this.size=0}get key(){throw ef()}get value(){throw ef()}get color(){throw ef()}get left(){throw ef()}get right(){throw ef()}copy(T,S,R,O,N){return this}insert(T,S,R){return new rV(T,S)}remove(T,S){return this}isEmpty(){return!0}inorderTraversal(T){return!1}reverseTraversal(T){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}rV.EMPTY=new rz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rq{constructor(T){this.comparator=T,this.data=new rU(this.comparator)}has(T){return null!==this.data.get(T)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(T){return this.data.indexOf(T)}forEach(T){this.data.inorderTraversal((S,R)=>(T(S),!1))}forEachInRange(T,S){let R=this.data.getIteratorFrom(T[0]);for(;R.hasNext();){let O=R.getNext();if(this.comparator(O.key,T[1])>=0)return;S(O.key)}}forEachWhile(T,S){let R;for(R=void 0!==S?this.data.getIteratorFrom(S):this.data.getIterator();R.hasNext();)if(!T(R.getNext().key))return}firstAfterOrEqual(T){let S=this.data.getIteratorFrom(T);return S.hasNext()?S.getNext().key:null}getIterator(){return new rG(this.data.getIterator())}getIteratorFrom(T){return new rG(this.data.getIteratorFrom(T))}add(T){return this.copy(this.data.remove(T).insert(T,!0))}delete(T){return this.has(T)?this.copy(this.data.remove(T)):this}isEmpty(){return this.data.isEmpty()}unionWith(T){let S=this;return S.size<T.size&&(S=T,T=this),T.forEach(T=>{S=S.add(T)}),S}isEqual(T){if(!(T instanceof rq)||this.size!==T.size)return!1;let S=this.data.getIterator(),R=T.data.getIterator();for(;S.hasNext();){let T=S.getNext().key,O=R.getNext().key;if(0!==this.comparator(T,O))return!1}return!0}toArray(){let T=[];return this.forEach(S=>{T.push(S)}),T}toString(){let T=[];return this.forEach(S=>T.push(S)),"SortedSet("+T.toString()+")"}copy(T){let S=new rq(this.comparator);return S.data=T,S}}class rG{constructor(T){this.iter=T}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function rH(T,S,R,O,N){let P=T.getIterator(),M=S.getIterator(),L=r$(P),U=r$(M);for(;L||U;){let T=!1,S=!1;if(L&&U){let O=R(L,U);O<0?S=!0:O>0&&(T=!0)}else null!=L?S=!0:T=!0;T?(O(U),U=r$(M)):S?(N(L),L=r$(P)):(L=r$(P),U=r$(M))}}function r$(T){return T.hasNext()?T.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rK{constructor(T){this.fields=T,T.sort(eV.comparator)}static empty(){return new rK([])}unionWith(T){let S=new rq(eV.comparator);for(let T of this.fields)S=S.add(T);for(let R of T)S=S.add(R);return new rK(S.toArray())}covers(T){for(let S of this.fields)if(S.isPrefixOf(T))return!0;return!1}isEqual(T){return eN(this.fields,T.fields,(T,S)=>T.isEqual(S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rW(T){return Buffer.from(T,"base64").toString("binary")}function rQ(T){return Buffer.from(T,"binary").toString("base64")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rY{constructor(T){this.binaryString=T}static fromBase64String(T){return new rY(rW(T))}static fromUint8Array(T){return new rY(rJ(T))}[Symbol.iterator](){let T=0;return{next:()=>T<this.binaryString.length?{value:this.binaryString.charCodeAt(T++),done:!1}:{value:void 0,done:!0}}}toBase64(){return rQ(this.binaryString)}toUint8Array(){return rX(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(T){return ek(this.binaryString,T.binaryString)}isEqual(T){return this.binaryString===T.binaryString}}function rJ(T){let S="";for(let R=0;R<T.length;++R)S+=String.fromCharCode(T[R]);return S}function rX(T){let S=new Uint8Array(T.length);for(let R=0;R<T.length;R++)S[R]=T.charCodeAt(R);return S}rY.EMPTY_BYTE_STRING=new rY("");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function r0(T){if(ep(!!T),"string"==typeof T){let S=0,R=rZ.exec(T);if(ep(!!R),R[1]){let T=R[1];S=Number(T=(T+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(T).getTime()/1e3),nanos:S}}return{seconds:r1(T.seconds),nanos:r1(T.nanos)}}function r1(T){return"number"==typeof T?T:"string"==typeof T?Number(T):0}function r2(T){return"string"==typeof T?rY.fromBase64String(T):rY.fromUint8Array(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r3="server_timestamp",r4="__type__",r6="__previous_value__",r9="__local_write_time__";function r5(T){var S,R;return(null===(R=((null===(S=null==T?void 0:T.mapValue)||void 0===S?void 0:S.fields)||{})[r4])||void 0===R?void 0:R.stringValue)===r3}function r8(T,S){let R={fields:{[r4]:{stringValue:r3},[r9]:{timestampValue:{seconds:T.seconds,nanos:T.nanoseconds}}}};return S&&r5(S)&&(S=r7(S)),S&&(R.fields[r6]=S),{mapValue:R}}function r7(T){let S=T.mapValue.fields[r6];return r5(S)?r7(S):S}function ne(T){let S=r0(T.mapValue.fields[r9].timestampValue);return new eM(S.seconds,S.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(T,S,R,O,N,P,M,L,U){this.databaseId=T,this.appId=S,this.persistenceKey=R,this.host=O,this.ssl=N,this.forceLongPolling=P,this.autoDetectLongPolling=M,this.longPollingOptions=L,this.useFetchStreams=U}}let nn="(default)";class ni{constructor(T,S){this.projectId=T,this.database=S||nn}static empty(){return new ni("","")}get isDefaultDatabase(){return this.database===nn}isEqual(T){return T instanceof ni&&T.projectId===this.projectId&&T.database===this.database}}function na(T,S){if(!Object.prototype.hasOwnProperty.apply(T.options,["projectId"]))throw new ey(em.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ni(T.options.projectId,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let no=-1;function nu(T){return null==T}function nc(T){return 0===T&&1/T==-1/0}function nd(T){return"number"==typeof T&&Number.isInteger(T)&&!nc(T)&&T<=Number.MAX_SAFE_INTEGER&&T>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nh="__type__",nf="__max__",np={mapValue:{fields:{__type__:{stringValue:nf}}}},ng="__vector__",nm="value",ny={nullValue:"NULL_VALUE"};function nv(T){return"nullValue"in T?0:"booleanValue"in T?1:"integerValue"in T||"doubleValue"in T?2:"timestampValue"in T?3:"stringValue"in T?5:"bytesValue"in T?6:"referenceValue"in T?7:"geoPointValue"in T?8:"arrayValue"in T?9:"mapValue"in T?r5(T)?4:n4(T)?9007199254740991:n0(T)?10:11:ef()}function nb(T,S){if(T===S)return!0;let R=nv(T);if(R!==nv(S))return!1;switch(R){case 0:case 9007199254740991:return!0;case 1:return T.booleanValue===S.booleanValue;case 4:return ne(T).isEqual(ne(S));case 3:return nT(T,S);case 5:return T.stringValue===S.stringValue;case 6:return n_(T,S);case 7:return T.referenceValue===S.referenceValue;case 8:return nS(T,S);case 2:return nE(T,S);case 9:return eN(T.arrayValue.values||[],S.arrayValue.values||[],nb);case 10:case 11:return nw(T,S);default:return ef()}}function nT(T,S){if("string"==typeof T.timestampValue&&"string"==typeof S.timestampValue&&T.timestampValue.length===S.timestampValue.length)return T.timestampValue===S.timestampValue;let R=r0(T.timestampValue),O=r0(S.timestampValue);return R.seconds===O.seconds&&R.nanos===O.nanos}function nS(T,S){return r1(T.geoPointValue.latitude)===r1(S.geoPointValue.latitude)&&r1(T.geoPointValue.longitude)===r1(S.geoPointValue.longitude)}function n_(T,S){return r2(T.bytesValue).isEqual(r2(S.bytesValue))}function nE(T,S){if("integerValue"in T&&"integerValue"in S)return r1(T.integerValue)===r1(S.integerValue);if("doubleValue"in T&&"doubleValue"in S){let R=r1(T.doubleValue),O=r1(S.doubleValue);return R===O?nc(R)===nc(O):isNaN(R)&&isNaN(O)}return!1}function nw(T,S){let R=T.mapValue.fields||{},O=S.mapValue.fields||{};if(rM(R)!==rM(O))return!1;for(let T in R)if(R.hasOwnProperty(T)&&(void 0===O[T]||!nb(R[T],O[T])))return!1;return!0}function nC(T,S){return void 0!==(T.values||[]).find(T=>nb(T,S))}function nI(T,S){if(T===S)return 0;let R=nv(T),O=nv(S);if(R!==O)return ek(R,O);switch(R){case 0:case 9007199254740991:return 0;case 1:return ek(T.booleanValue,S.booleanValue);case 2:return nR(T,S);case 3:return nO(T.timestampValue,S.timestampValue);case 4:return nO(ne(T),ne(S));case 5:return ek(T.stringValue,S.stringValue);case 6:return nN(T.bytesValue,S.bytesValue);case 7:return nA(T.referenceValue,S.referenceValue);case 8:return nk(T.geoPointValue,S.geoPointValue);case 9:return nD(T.arrayValue,S.arrayValue);case 10:return nP(T.mapValue,S.mapValue);case 11:return nx(T.mapValue,S.mapValue);default:throw ef()}}function nR(T,S){let R=r1(T.integerValue||T.doubleValue),O=r1(S.integerValue||S.doubleValue);return R<O?-1:R>O?1:R===O?0:isNaN(R)?isNaN(O)?0:-1:1}function nO(T,S){if("string"==typeof T&&"string"==typeof S&&T.length===S.length)return ek(T,S);let R=r0(T),O=r0(S),N=ek(R.seconds,O.seconds);return 0!==N?N:ek(R.nanos,O.nanos)}function nA(T,S){let R=T.split("/"),O=S.split("/");for(let T=0;T<R.length&&T<O.length;T++){let S=ek(R[T],O[T]);if(0!==S)return S}return ek(R.length,O.length)}function nk(T,S){let R=ek(r1(T.latitude),r1(S.latitude));return 0!==R?R:ek(r1(T.longitude),r1(S.longitude))}function nN(T,S){let R=r2(T),O=r2(S);return R.compareTo(O)}function nD(T,S){let R=T.values||[],O=S.values||[];for(let T=0;T<R.length&&T<O.length;++T){let S=nI(R[T],O[T]);if(S)return S}return ek(R.length,O.length)}function nP(T,S){var R,O,N,P;let M=T.fields||{},L=S.fields||{},U=null===(R=M[nm])||void 0===R?void 0:R.arrayValue,V=null===(O=L[nm])||void 0===O?void 0:O.arrayValue,$=ek((null===(N=null==U?void 0:U.values)||void 0===N?void 0:N.length)||0,(null===(P=null==V?void 0:V.values)||void 0===P?void 0:P.length)||0);return 0!==$?$:nD(U,V)}function nx(T,S){if(T===np.mapValue&&S===np.mapValue)return 0;if(T===np.mapValue)return 1;if(S===np.mapValue)return -1;let R=T.fields||{},O=Object.keys(R),N=S.fields||{},P=Object.keys(N);O.sort(),P.sort();for(let T=0;T<O.length&&T<P.length;++T){let S=ek(O[T],P[T]);if(0!==S)return S;let M=nI(R[O[T]],N[P[T]]);if(0!==M)return M}return ek(O.length,P.length)}function nM(T){return nL(T)}function nL(T){if("nullValue"in T)return"null";if("booleanValue"in T)return""+T.booleanValue;if("integerValue"in T)return""+T.integerValue;if("doubleValue"in T)return""+T.doubleValue;if("timestampValue"in T)return nj(T.timestampValue);if("stringValue"in T)return T.stringValue;if("bytesValue"in T)return nF(T.bytesValue);else if("referenceValue"in T)return nB(T.referenceValue);else if("geoPointValue"in T)return nU(T.geoPointValue);else if("arrayValue"in T)return nz(T.arrayValue);else if("mapValue"in T)return nV(T.mapValue);else return ef()}function nF(T){return r2(T).toBase64()}function nj(T){let S=r0(T);return`time(${S.seconds},${S.nanos})`}function nU(T){return`geo(${T.latitude},${T.longitude})`}function nB(T){return ez.fromName(T).toString()}function nV(T){let S=Object.keys(T.fields||{}).sort(),R="{",O=!0;for(let N of S)O?O=!1:R+=",",R+=`${N}:${nL(T.fields[N])}`;return R+"}"}function nz(T){let S="[",R=!0;for(let O of T.values||[])R?R=!1:S+=",",S+=nL(O);return S+"]"}function nq(T){switch(nv(T)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let S=r7(T);return S?16+nq(S):16;case 5:return 2*T.stringValue.length;case 6:return r2(T.bytesValue).approximateByteSize();case 7:return T.referenceValue.length;case 9:return nH(T.arrayValue);case 10:case 11:return nG(T.mapValue);default:throw ef()}}function nG(T){let S=0;return rL(T.fields,(T,R)=>{S+=T.length+nq(R)}),S}function nH(T){return(T.values||[]).reduce((T,S)=>T+nq(S),0)}function n$(T,S){return{referenceValue:`projects/${T.projectId}/databases/${T.database}/documents/${S.path.canonicalString()}`}}function nK(T){return!!T&&"integerValue"in T}function nW(T){return!!T&&"doubleValue"in T}function nQ(T){return nK(T)||nW(T)}function nY(T){return!!T&&"arrayValue"in T}function nJ(T){return!!T&&"nullValue"in T}function nX(T){return!!T&&"doubleValue"in T&&isNaN(Number(T.doubleValue))}function nZ(T){return!!T&&"mapValue"in T}function n0(T){var S,R;return(null===(R=((null===(S=null==T?void 0:T.mapValue)||void 0===S?void 0:S.fields)||{})[nh])||void 0===R?void 0:R.stringValue)===ng}function n3(T){if(T.geoPointValue)return{geoPointValue:Object.assign({},T.geoPointValue)};if(T.timestampValue&&"object"==typeof T.timestampValue)return{timestampValue:Object.assign({},T.timestampValue)};if(T.mapValue){let S={mapValue:{fields:{}}};return rL(T.mapValue.fields,(T,R)=>S.mapValue.fields[T]=n3(R)),S}{if(!T.arrayValue)return Object.assign({},T);let S={arrayValue:{values:[]}};for(let R=0;R<(T.arrayValue.values||[]).length;++R)S.arrayValue.values[R]=n3(T.arrayValue.values[R]);return S}}function n4(T){return(((T.mapValue||{}).fields||{}).__type__||{}).stringValue===nf}let n6={mapValue:{fields:{[nh]:{stringValue:ng},[nm]:{arrayValue:{}}}}};function n9(T){if("nullValue"in T)return ny;if("booleanValue"in T)return{booleanValue:!1};if("integerValue"in T||"doubleValue"in T)return{doubleValue:NaN};if("timestampValue"in T)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in T)return{stringValue:""};if("bytesValue"in T)return{bytesValue:""};if("referenceValue"in T)return n$(ni.empty(),ez.empty());else if("geoPointValue"in T)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in T)return{arrayValue:{}};else if(!("mapValue"in T))return ef();else return n0(T)?n6:{mapValue:{}}}function n5(T){if("nullValue"in T)return{booleanValue:!1};if("booleanValue"in T)return{doubleValue:NaN};if("integerValue"in T||"doubleValue"in T)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in T)return{stringValue:""};if("stringValue"in T)return{bytesValue:""};if("bytesValue"in T)return n$(ni.empty(),ez.empty());if("referenceValue"in T)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in T)return{arrayValue:{}};else if("arrayValue"in T)return n6;else if(!("mapValue"in T))return ef();else return n0(T)?{mapValue:{}}:np}function n8(T,S){let R=nI(T.value,S.value);return 0!==R?R:T.inclusive&&!S.inclusive?-1:!T.inclusive&&S.inclusive?1:0}function n7(T,S){let R=nI(T.value,S.value);return 0!==R?R:T.inclusive&&!S.inclusive?1:!T.inclusive&&S.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(T){this.value=T}static empty(){return new ie({mapValue:{}})}field(T){if(T.isEmpty())return this.value;{let S=this.value;for(let R=0;R<T.length-1;++R)if(!nZ(S=(S.mapValue.fields||{})[T.get(R)]))return null;return(S=(S.mapValue.fields||{})[T.lastSegment()])||null}}set(T,S){this.getFieldsMap(T.popLast())[T.lastSegment()]=n3(S)}setAll(T){let S=eV.emptyPath(),R={},O=[];T.forEach((T,N)=>{if(!S.isImmediateParentOf(N)){let T=this.getFieldsMap(S);this.applyChanges(T,R,O),R={},O=[],S=N.popLast()}T?R[N.lastSegment()]=n3(T):O.push(N.lastSegment())});let N=this.getFieldsMap(S);this.applyChanges(N,R,O)}delete(T){let S=this.field(T.popLast());nZ(S)&&S.mapValue.fields&&delete S.mapValue.fields[T.lastSegment()]}isEqual(T){return nb(this.value,T.value)}getFieldsMap(T){let S=this.value;S.mapValue.fields||(S.mapValue={fields:{}});for(let R=0;R<T.length;++R){let O=S.mapValue.fields[T.get(R)];nZ(O)&&O.mapValue.fields||(O={mapValue:{fields:{}}},S.mapValue.fields[T.get(R)]=O),S=O}return S.mapValue.fields}applyChanges(T,S,R){for(let O of(rL(S,(S,R)=>T[S]=R),R))delete T[O]}clone(){return new ie(n3(this.value))}}function ir(T){let S=[];return rL(T.fields,(T,R)=>{let O=new eV([T]);if(nZ(R)){let T=ir(R.mapValue).fields;if(0===T.length)S.push(O);else for(let R of T)S.push(O.child(R))}else S.push(O)}),new rK(S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(T,S,R,O,N,P,M){this.key=T,this.documentType=S,this.version=R,this.readTime=O,this.createTime=N,this.data=P,this.documentState=M}static newInvalidDocument(T){return new ii(T,0,eL.min(),eL.min(),eL.min(),ie.empty(),0)}static newFoundDocument(T,S,R,O){return new ii(T,1,S,eL.min(),R,O,0)}static newNoDocument(T,S){return new ii(T,2,S,eL.min(),eL.min(),ie.empty(),0)}static newUnknownDocument(T,S){return new ii(T,3,S,eL.min(),eL.min(),ie.empty(),2)}convertToFoundDocument(T,S){return this.createTime.isEqual(eL.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=T),this.version=T,this.documentType=1,this.data=S,this.documentState=0,this}convertToNoDocument(T){return this.version=T,this.documentType=2,this.data=ie.empty(),this.documentState=0,this}convertToUnknownDocument(T){return this.version=T,this.documentType=3,this.data=ie.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=eL.min(),this}setReadTime(T){return this.readTime=T,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(T){return T instanceof ii&&this.key.isEqual(T.key)&&this.version.isEqual(T.version)&&this.documentType===T.documentType&&this.documentState===T.documentState&&this.data.isEqual(T.data)}mutableCopy(){return new ii(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function is(T,S,R){let O=S.data.field(T),N=R.data.field(T);return null!==O&&null!==N?nI(O,N):ef()}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(T,S){this.position=T,this.inclusive=S}}function io(T,S,R){let O=0;for(let N=0;N<T.position.length;N++){let P=S[N],M=T.position[N];if(O=P.field.isKeyField()?ez.comparator(ez.fromName(M.referenceValue),R.key):nI(M,R.data.field(P.field)),"desc"===P.dir&&(O*=-1),0!==O)break}return O}function il(T,S,R){let O=io(T,S,R);return T.inclusive?O>=0:O>0}function iu(T,S,R){let O=io(T,S,R);return T.inclusive?O<=0:O<0}function ic(T,S){if(null===T)return null===S;if(null===S||T.inclusive!==S.inclusive||T.position.length!==S.position.length)return!1;for(let R=0;R<T.position.length;R++)if(!nb(T.position[R],S.position[R]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(T,S="asc"){this.field=T,this.dir=S}}function ip(T){return T.field.canonicalString()+T.dir}function ig(T){return`${T.field.canonicalString()} (${T.dir})`}function im(T,S){return T.dir===S.dir&&T.field.isEqual(S.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{}class iv extends iy{constructor(T,S,R){super(),this.field=T,this.op=S,this.value=R}static create(T,S,R){return T.isKeyField()?"in"===S||"not-in"===S?this.createKeyFieldInFilter(T,S,R):new iD(T,S,R):"array-contains"===S?new iL(T,R):"in"===S?new iF(T,R):"not-in"===S?new ij(T,R):"array-contains-any"===S?new iU(T,R):new iv(T,S,R)}static createKeyFieldInFilter(T,S,R){return"in"===S?new iP(T,R):new ix(T,R)}matches(T){let S=T.data.field(this.field);return"!="===this.op?null!==S&&this.matchesComparison(nI(S,this.value)):null!==S&&nv(this.value)===nv(S)&&this.matchesComparison(nI(S,this.value))}matchesComparison(T){switch(this.op){case"<":return T<0;case"<=":return T<=0;case"==":return 0===T;case"!=":return 0!==T;case">":return T>0;case">=":return T>=0;default:return ef()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ib extends iy{constructor(T,S){super(),this.filters=T,this.op=S,this.memoizedFlattenedFilters=null}static create(T,S){return new ib(T,S)}matches(T){return iT(this)?void 0===this.filters.find(S=>!S.matches(T)):void 0!==this.filters.find(S=>S.matches(T))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((T,S)=>T.concat(S.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function iT(T){return"and"===T.op}function iS(T){return"or"===T.op}function i_(T){return iE(T)&&iT(T)}function iE(T){for(let S of T.filters)if(S instanceof ib)return!1;return!0}function iw(T){if(T instanceof iv)return T.field.canonicalString()+T.op.toString()+nM(T.value);if(i_(T))return T.filters.map(T=>iw(T)).join(",");{let S=T.filters.map(T=>iw(T)).join(",");return`${T.op}(${S})`}}function iC(T,S){return T instanceof iv?iI(T,S):T instanceof ib?iR(T,S):void ef()}function iI(T,S){return S instanceof iv&&T.op===S.op&&T.field.isEqual(S.field)&&nb(T.value,S.value)}function iR(T,S){return S instanceof ib&&T.op===S.op&&T.filters.length===S.filters.length&&T.filters.reduce((T,R,O)=>T&&iC(R,S.filters[O]),!0)}function iO(T,S){let R=T.filters.concat(S);return ib.create(R,T.op)}function iA(T){return T instanceof iv?iN(T):T instanceof ib?ik(T):"Filter"}function ik(T){return T.op.toString()+" {"+T.getFilters().map(iA).join(" ,")+"}"}function iN(T){return`${T.field.canonicalString()} ${T.op} ${nM(T.value)}`}class iD extends iv{constructor(T,S,R){super(T,S,R),this.key=ez.fromName(R.referenceValue)}matches(T){let S=ez.comparator(T.key,this.key);return this.matchesComparison(S)}}class iP extends iv{constructor(T,S){super(T,"in",S),this.keys=iM("in",S)}matches(T){return this.keys.some(S=>S.isEqual(T.key))}}class ix extends iv{constructor(T,S){super(T,"not-in",S),this.keys=iM("not-in",S)}matches(T){return!this.keys.some(S=>S.isEqual(T.key))}}function iM(T,S){var R;return((null===(R=S.arrayValue)||void 0===R?void 0:R.values)||[]).map(T=>ez.fromName(T.referenceValue))}class iL extends iv{constructor(T,S){super(T,"array-contains",S)}matches(T){let S=T.data.field(this.field);return nY(S)&&nC(S.arrayValue,this.value)}}class iF extends iv{constructor(T,S){super(T,"in",S)}matches(T){let S=T.data.field(this.field);return null!==S&&nC(this.value.arrayValue,S)}}class ij extends iv{constructor(T,S){super(T,"not-in",S)}matches(T){if(nC(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let S=T.data.field(this.field);return null!==S&&!nC(this.value.arrayValue,S)}}class iU extends iv{constructor(T,S){super(T,"array-contains-any",S)}matches(T){let S=T.data.field(this.field);return!!nY(S)&&!!S.arrayValue.values&&S.arrayValue.values.some(T=>nC(this.value.arrayValue,T))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(T,S=null,R=[],O=[],N=null,P=null,M=null){this.path=T,this.collectionGroup=S,this.orderBy=R,this.filters=O,this.limit=N,this.startAt=P,this.endAt=M,this.memoizedCanonicalId=null}}function iV(T,S=null,R=[],O=[],N=null,P=null,M=null){return new iB(T,S,R,O,N,P,M)}function iz(T){let S=eg(T);if(null===S.memoizedCanonicalId){let T=S.path.canonicalString();null!==S.collectionGroup&&(T+="|cg:"+S.collectionGroup),T+="|f:"+S.filters.map(T=>iw(T)).join(",")+"|ob:"+S.orderBy.map(T=>ip(T)).join(","),nu(S.limit)||(T+="|l:"+S.limit),S.startAt&&(T+="|lb:"+(S.startAt.inclusive?"b:":"a:")+S.startAt.position.map(T=>nM(T)).join(",")),S.endAt&&(T+="|ub:"+(S.endAt.inclusive?"a:":"b:")+S.endAt.position.map(T=>nM(T)).join(",")),S.memoizedCanonicalId=T}return S.memoizedCanonicalId}function iq(T){let S=T.path.canonicalString();return null!==T.collectionGroup&&(S+=" collectionGroup="+T.collectionGroup),T.filters.length>0&&(S+=`, filters: [${T.filters.map(T=>iA(T)).join(", ")}]`),nu(T.limit)||(S+=", limit: "+T.limit),T.orderBy.length>0&&(S+=`, orderBy: [${T.orderBy.map(T=>ig(T)).join(", ")}]`),T.startAt&&(S+=", startAt: "+(T.startAt.inclusive?"b:":"a:")+T.startAt.position.map(T=>nM(T)).join(",")),T.endAt&&(S+=", endAt: "+(T.endAt.inclusive?"a:":"b:")+T.endAt.position.map(T=>nM(T)).join(",")),`Target(${S})`}function iG(T,S){if(T.limit!==S.limit||T.orderBy.length!==S.orderBy.length)return!1;for(let R=0;R<T.orderBy.length;R++)if(!im(T.orderBy[R],S.orderBy[R]))return!1;if(T.filters.length!==S.filters.length)return!1;for(let R=0;R<T.filters.length;R++)if(!iC(T.filters[R],S.filters[R]))return!1;return!!(T.collectionGroup===S.collectionGroup&&T.path.isEqual(S.path)&&ic(T.startAt,S.startAt))&&ic(T.endAt,S.endAt)}function iH(T){return ez.isDocumentKey(T.path)&&null===T.collectionGroup&&0===T.filters.length}function i$(T,S){return T.filters.filter(T=>T instanceof iv&&T.field.isEqual(S))}function iK(T,S){let R=e$(S);if(void 0===R)return null;for(let S of i$(T,R.fieldPath))switch(S.op){case"array-contains-any":return S.value.arrayValue.values||[];case"array-contains":return[S.value]}return null}function iW(T,S){let R=new Map;for(let O of eK(S))for(let S of i$(T,O.fieldPath))switch(S.op){case"==":case"in":R.set(O.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return R.set(O.fieldPath.canonicalString(),S.value),Array.from(R.values())}return null}function iQ(T,S){let R=[],O=!0;for(let N of eK(S)){let S=0===N.kind?iJ(T,N.fieldPath,T.startAt):iX(T,N.fieldPath,T.startAt);R.push(S.value),O&&(O=S.inclusive)}return new ia(R,O)}function iY(T,S){let R=[],O=!0;for(let N of eK(S)){let S=0===N.kind?iX(T,N.fieldPath,T.endAt):iJ(T,N.fieldPath,T.endAt);R.push(S.value),O&&(O=S.inclusive)}return new ia(R,O)}function iJ(T,S,R){let O=ny,N=!0;for(let R of i$(T,S)){let T=ny,S=!0;switch(R.op){case"<":case"<=":T=n9(R.value);break;case"==":case"in":case">=":T=R.value;break;case">":T=R.value,S=!1;break;case"!=":case"not-in":T=ny}0>n8({value:O,inclusive:N},{value:T,inclusive:S})&&(O=T,N=S)}if(null!==R){for(let P=0;P<T.orderBy.length;++P)if(T.orderBy[P].field.isEqual(S)){let T=R.position[P];0>n8({value:O,inclusive:N},{value:T,inclusive:R.inclusive})&&(O=T,N=R.inclusive);break}}return{value:O,inclusive:N}}function iX(T,S,R){let O=np,N=!0;for(let R of i$(T,S)){let T=np,S=!0;switch(R.op){case">=":case">":T=n5(R.value),S=!1;break;case"==":case"in":case"<=":T=R.value;break;case"<":T=R.value,S=!1;break;case"!=":case"not-in":T=np}n7({value:O,inclusive:N},{value:T,inclusive:S})>0&&(O=T,N=S)}if(null!==R){for(let P=0;P<T.orderBy.length;++P)if(T.orderBy[P].field.isEqual(S)){let T=R.position[P];n7({value:O,inclusive:N},{value:T,inclusive:R.inclusive})>0&&(O=T,N=R.inclusive);break}}return{value:O,inclusive:N}}function iZ(T){let S=new rq(eV.comparator),R=!1;for(let O of T.filters)for(let T of O.getFlattenedFilters())T.field.isKeyField()||("array-contains"===T.op||"array-contains-any"===T.op?R=!0:S=S.add(T.field));for(let R of T.orderBy)R.field.isKeyField()||(S=S.add(R.field));return S.size+(R?1:0)}function i0(T){return null!==T.limit}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(T,S=null,R=[],O=[],N=null,P="F",M=null,L=null){this.path=T,this.collectionGroup=S,this.explicitOrderBy=R,this.filters=O,this.limit=N,this.limitType=P,this.startAt=M,this.endAt=L,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function i2(T,S,R,O,N,P,M,L){return new i1(T,S,R,O,N,P,M,L)}function i3(T){return new i1(T)}function i4(T,S){return new i1(S,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}function i6(T){return 0===T.filters.length&&null===T.limit&&null==T.startAt&&null==T.endAt&&(0===T.explicitOrderBy.length||1===T.explicitOrderBy.length&&T.explicitOrderBy[0].field.isKeyField())}function i9(T){let S=new rq(eV.comparator);return T.filters.forEach(T=>{T.getFlattenedFilters().forEach(T=>{T.isInequality()&&(S=S.add(T.field))})}),S}function i5(T){return ez.isDocumentKey(T.path)&&null===T.collectionGroup&&0===T.filters.length}function i8(T){return null!==T.collectionGroup}function i7(T){let S=eg(T);if(null===S.memoizedNormalizedOrderBy){S.memoizedNormalizedOrderBy=[];let T=new Set;for(let R of S.explicitOrderBy)S.memoizedNormalizedOrderBy.push(R),T.add(R.field.canonicalString());let R=S.explicitOrderBy.length>0?S.explicitOrderBy[S.explicitOrderBy.length-1].dir:"asc";i9(S).forEach(O=>{T.has(O.canonicalString())||O.isKeyField()||S.memoizedNormalizedOrderBy.push(new ih(O,R))}),T.has(eV.keyField().canonicalString())||S.memoizedNormalizedOrderBy.push(new ih(eV.keyField(),R))}return S.memoizedNormalizedOrderBy}function se(T){let S=eg(T);return S.memoizedTarget||(S.memoizedTarget=sr(S,i7(T))),S.memoizedTarget}function st(T){let S=eg(T);return S.memoizedAggregateTarget||(S.memoizedAggregateTarget=sr(S,T.explicitOrderBy)),S.memoizedAggregateTarget}function sr(T,S){if("F"===T.limitType)return iV(T.path,T.collectionGroup,S,T.filters,T.limit,T.startAt,T.endAt);{S=S.map(T=>{let S="desc"===T.dir?"asc":"desc";return new ih(T.field,S)});let R=T.endAt?new ia(T.endAt.position,T.endAt.inclusive):null,O=T.startAt?new ia(T.startAt.position,T.startAt.inclusive):null;return iV(T.path,T.collectionGroup,S,T.filters,T.limit,R,O)}}function sn(T,S){let R=T.filters.concat([S]);return new i1(T.path,T.collectionGroup,T.explicitOrderBy.slice(),R,T.limit,T.limitType,T.startAt,T.endAt)}function si(T,S){let R=T.explicitOrderBy.concat([S]);return new i1(T.path,T.collectionGroup,R,T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}function ss(T,S,R){return new i1(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),S,R,T.startAt,T.endAt)}function sa(T,S){return new i1(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,S,T.endAt)}function so(T,S){return new i1(T.path,T.collectionGroup,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,S)}function sl(T,S){return iG(se(T),se(S))&&T.limitType===S.limitType}function su(T){return`${iz(se(T))}|lt:${T.limitType}`}function sc(T){return`Query(target=${iq(se(T))}; limitType=${T.limitType})`}function sd(T,S){return S.isFoundDocument()&&sh(T,S)&&sf(T,S)&&sp(T,S)&&sg(T,S)}function sh(T,S){let R=S.key.path;return null!==T.collectionGroup?S.key.hasCollectionId(T.collectionGroup)&&T.path.isPrefixOf(R):ez.isDocumentKey(T.path)?T.path.isEqual(R):T.path.isImmediateParentOf(R)}function sf(T,S){for(let R of i7(T))if(!R.field.isKeyField()&&null===S.data.field(R.field))return!1;return!0}function sp(T,S){for(let R of T.filters)if(!R.matches(S))return!1;return!0}function sg(T,S){return(!T.startAt||!!iu(T.startAt,i7(T),S))&&(!T.endAt||!!il(T.endAt,i7(T),S))}function sm(T){return T.collectionGroup||(T.path.length%2==1?T.path.lastSegment():T.path.get(T.path.length-2))}function sy(T){return(S,R)=>{let O=!1;for(let N of i7(T)){let T=sv(N,S,R);if(0!==T)return T;O=O||N.field.isKeyField()}return 0}}function sv(T,S,R){let O=T.field.isKeyField()?ez.comparator(S.key,R.key):is(T.field,S,R);switch(T.dir){case"asc":return O;case"desc":return -1*O;default:return ef()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(T,S){this.mapKeyFn=T,this.equalsFn=S,this.inner={},this.innerSize=0}get(T){let S=this.mapKeyFn(T),R=this.inner[S];if(void 0!==R){for(let[S,O]of R)if(this.equalsFn(S,T))return O}}has(T){return void 0!==this.get(T)}set(T,S){let R=this.mapKeyFn(T),O=this.inner[R];if(void 0===O){this.inner[R]=[[T,S]],this.innerSize++;return}for(let R=0;R<O.length;R++)if(this.equalsFn(O[R][0],T)){O[R]=[T,S];return}O.push([T,S]),this.innerSize++}delete(T){let S=this.mapKeyFn(T),R=this.inner[S];if(void 0===R)return!1;for(let O=0;O<R.length;O++)if(this.equalsFn(R[O][0],T))return 1===R.length?delete this.inner[S]:R.splice(O,1),this.innerSize--,!0;return!1}forEach(T){rL(this.inner,(S,R)=>{for(let[S,O]of R)T(S,O)})}isEmpty(){return rj(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sT=new rU(ez.comparator);function sS(){return sT}let s_=new rU(ez.comparator);function sE(...T){let S=s_;for(let R of T)S=S.insert(R.key,R);return S}function sw(){return sO()}function sC(T){let S=s_;return T.forEach((T,R)=>S=S.insert(T,R.overlayedDocument)),S}function sI(){return sO()}function sR(){return sO()}function sO(){return new sb(T=>T.toString(),(T,S)=>T.isEqual(S))}let sA=new rU(ez.comparator);function sk(){return sA}let sN=new rq(ez.comparator);function sD(...T){let S=sN;for(let R of T)S=S.add(R);return S}let sP=new rq(ek);function sx(){return sP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sM(T,S){if(T.useProto3Json){if(isNaN(S))return{doubleValue:"NaN"};if(S===1/0)return{doubleValue:"Infinity"};if(S===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nc(S)?"-0":S}}function sL(T){return{integerValue:""+T}}function sF(T,S){return nd(S)?sL(S):sM(T,S)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(){this._=void 0}}function sU(T,S,R){return T instanceof sq?r8(R,S):T instanceof sG?sH(T,S):T instanceof s$?sK(T,S):sQ(T,S)}function sB(T,S,R){return T instanceof sG?sH(T,S):T instanceof s$?sK(T,S):R}function sV(T,S){return T instanceof sW?nQ(S)?S:{integerValue:0}:null}function sz(T,S){return T instanceof sG&&S instanceof sG||T instanceof s$&&S instanceof s$?eN(T.elements,S.elements,nb):T instanceof sW&&S instanceof sW?nb(T.operand,S.operand):T instanceof sq&&S instanceof sq}class sq extends sj{}class sG extends sj{constructor(T){super(),this.elements=T}}function sH(T,S){let R=sJ(S);for(let S of T.elements)R.some(T=>nb(T,S))||R.push(S);return{arrayValue:{values:R}}}class s$ extends sj{constructor(T){super(),this.elements=T}}function sK(T,S){let R=sJ(S);for(let S of T.elements)R=R.filter(T=>!nb(T,S));return{arrayValue:{values:R}}}class sW extends sj{constructor(T,S){super(),this.serializer=T,this.operand=S}}function sQ(T,S){let R=sV(T,S),O=sY(R)+sY(T.operand);return nK(R)&&nK(T.operand)?sL(O):sM(T.serializer,O)}function sY(T){return r1(T.integerValue||T.doubleValue)}function sJ(T){return nY(T)&&T.arrayValue.values?T.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sX{constructor(T,S){this.field=T,this.transform=S}}function sZ(T,S){return T.field.isEqual(S.field)&&sz(T.transform,S.transform)}function s0(T,S){return void 0===T&&void 0===S||!!T&&!!S&&eN(T,S,(T,S)=>sZ(T,S))}class s3{constructor(T,S){this.version=T,this.transformResults=S}}class s4{constructor(T,S){this.updateTime=T,this.exists=S}static none(){return new s4}static exists(T){return new s4(void 0,T)}static updateTime(T){return new s4(T)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(T){return this.exists===T.exists&&(this.updateTime?!!T.updateTime&&this.updateTime.isEqual(T.updateTime):!T.updateTime)}}function s6(T,S){return void 0!==T.updateTime?S.isFoundDocument()&&S.version.isEqual(T.updateTime):void 0===T.exists||T.exists===S.isFoundDocument()}class s9{}function s5(T,S){if(!T.hasLocalMutations||S&&0===S.fields.length)return null;if(null===S)return T.isNoDocument()?new ad(T.key,s4.none()):new ar(T.key,T.data,s4.none());{let R=T.data,O=ie.empty(),N=new rq(eV.comparator);for(let T of S.fields)if(!N.has(T)){let S=R.field(T);null===S&&T.length>1&&(T=T.popLast(),S=R.field(T)),null===S?O.delete(T):O.set(T,S),N=N.add(T)}return new as(T.key,O,new rK(N.toArray()),s4.none())}}function s8(T,S,R){T instanceof ar?an(T,S,R):T instanceof as?aa(T,S,R):ah(T,S,R)}function s7(T,S,R,O){return T instanceof ar?ai(T,S,R,O):T instanceof as?ao(T,S,R,O):af(T,S,R)}function ae(T,S){let R=null;for(let O of T.fieldTransforms){let T=S.data.field(O.field),N=sV(O.transform,T||null);null!=N&&(null===R&&(R=ie.empty()),R.set(O.field,N))}return R||null}function at(T,S){return!!(T.type===S.type&&T.key.isEqual(S.key)&&T.precondition.isEqual(S.precondition)&&s0(T.fieldTransforms,S.fieldTransforms))&&(0===T.type?T.value.isEqual(S.value):1!==T.type||T.data.isEqual(S.data)&&T.fieldMask.isEqual(S.fieldMask))}class ar extends s9{constructor(T,S,R,O=[]){super(),this.key=T,this.value=S,this.precondition=R,this.fieldTransforms=O,this.type=0}getFieldMask(){return null}}function an(T,S,R){let O=T.value.clone(),N=au(T.fieldTransforms,S,R.transformResults);O.setAll(N),S.convertToFoundDocument(R.version,O).setHasCommittedMutations()}function ai(T,S,R,O){if(!s6(T.precondition,S))return R;let N=T.value.clone(),P=ac(T.fieldTransforms,O,S);return N.setAll(P),S.convertToFoundDocument(S.version,N).setHasLocalMutations(),null}class as extends s9{constructor(T,S,R,O,N=[]){super(),this.key=T,this.data=S,this.fieldMask=R,this.precondition=O,this.fieldTransforms=N,this.type=1}getFieldMask(){return this.fieldMask}}function aa(T,S,R){if(!s6(T.precondition,S)){S.convertToUnknownDocument(R.version);return}let O=au(T.fieldTransforms,S,R.transformResults),N=S.data;N.setAll(al(T)),N.setAll(O),S.convertToFoundDocument(R.version,N).setHasCommittedMutations()}function ao(T,S,R,O){if(!s6(T.precondition,S))return R;let N=ac(T.fieldTransforms,O,S),P=S.data;return(P.setAll(al(T)),P.setAll(N),S.convertToFoundDocument(S.version,P).setHasLocalMutations(),null===R)?null:R.unionWith(T.fieldMask.fields).unionWith(T.fieldTransforms.map(T=>T.field))}function al(T){let S=new Map;return T.fieldMask.fields.forEach(R=>{if(!R.isEmpty()){let O=T.data.field(R);S.set(R,O)}}),S}function au(T,S,R){let O=new Map;ep(T.length===R.length);for(let N=0;N<R.length;N++){let P=T[N],M=P.transform,L=S.data.field(P.field);O.set(P.field,sB(M,L,R[N]))}return O}function ac(T,S,R){let O=new Map;for(let N of T){let T=N.transform,P=R.data.field(N.field);O.set(N.field,sU(T,P,S))}return O}class ad extends s9{constructor(T,S){super(),this.key=T,this.precondition=S,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function ah(T,S,R){S.convertToNoDocument(R.version).setHasCommittedMutations()}function af(T,S,R){return s6(T.precondition,S)?(S.convertToNoDocument(S.version).setHasLocalMutations(),null):R}class ap extends s9{constructor(T,S){super(),this.key=T,this.precondition=S,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(T,S,R,O){this.batchId=T,this.localWriteTime=S,this.baseMutations=R,this.mutations=O}applyToRemoteDocument(T,S){let R=S.mutationResults;for(let S=0;S<this.mutations.length;S++){let O=this.mutations[S];O.key.isEqual(T.key)&&s8(O,T,R[S])}}applyToLocalView(T,S){for(let R of this.baseMutations)R.key.isEqual(T.key)&&(S=s7(R,T,S,this.localWriteTime));for(let R of this.mutations)R.key.isEqual(T.key)&&(S=s7(R,T,S,this.localWriteTime));return S}applyToLocalDocumentSet(T,S){let R=sR();return this.mutations.forEach(O=>{let N=T.get(O.key),P=N.overlayedDocument,M=this.applyToLocalView(P,N.mutatedFields),L=s5(P,M=S.has(O.key)?null:M);null!==L&&R.set(O.key,L),P.isValidDocument()||P.convertToNoDocument(eL.min())}),R}keys(){return this.mutations.reduce((T,S)=>T.add(S.key),sD())}isEqual(T){return this.batchId===T.batchId&&eN(this.mutations,T.mutations,(T,S)=>at(T,S))&&eN(this.baseMutations,T.baseMutations,(T,S)=>at(T,S))}}class am{constructor(T,S,R,O){this.batch=T,this.commitVersion=S,this.mutationResults=R,this.docVersions=O}static from(T,S,R){ep(T.mutations.length===R.length);let O=sk(),N=T.mutations;for(let T=0;T<N.length;T++)O=O.insert(N[T].key,R[T].version);return new am(T,S,R,O)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(T,S){this.largestBatchId=T,this.mutation=S}getKey(){return this.mutation.key}isEqual(T){return null!==T&&this.mutation===T.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(T,S){this.count=T,this.unchangedNames=S}}function ab(T){switch(T){case em.OK:return ef();case em.CANCELLED:case em.UNKNOWN:case em.DEADLINE_EXCEEDED:case em.RESOURCE_EXHAUSTED:case em.INTERNAL:case em.UNAVAILABLE:case em.UNAUTHENTICATED:return!1;case em.INVALID_ARGUMENT:case em.NOT_FOUND:case em.ALREADY_EXISTS:case em.PERMISSION_DENIED:case em.FAILED_PRECONDITION:case em.ABORTED:case em.OUT_OF_RANGE:case em.UNIMPLEMENTED:case em.DATA_LOSS:return!0;default:return ef()}}function aT(T){return ab(T)&&T!==em.ABORTED}function aS(T){if(void 0===T)return ec("GRPC error has no .code"),em.UNKNOWN;switch(T){case P.OK:return em.OK;case P.CANCELLED:return em.CANCELLED;case P.UNKNOWN:return em.UNKNOWN;case P.DEADLINE_EXCEEDED:return em.DEADLINE_EXCEEDED;case P.RESOURCE_EXHAUSTED:return em.RESOURCE_EXHAUSTED;case P.INTERNAL:return em.INTERNAL;case P.UNAVAILABLE:return em.UNAVAILABLE;case P.UNAUTHENTICATED:return em.UNAUTHENTICATED;case P.INVALID_ARGUMENT:return em.INVALID_ARGUMENT;case P.NOT_FOUND:return em.NOT_FOUND;case P.ALREADY_EXISTS:return em.ALREADY_EXISTS;case P.PERMISSION_DENIED:return em.PERMISSION_DENIED;case P.FAILED_PRECONDITION:return em.FAILED_PRECONDITION;case P.ABORTED:return em.ABORTED;case P.OUT_OF_RANGE:return em.OUT_OF_RANGE;case P.UNIMPLEMENTED:return em.UNIMPLEMENTED;case P.DATA_LOSS:return em.DATA_LOSS;default:return ef()}}!function(T){T[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS"}(P||(P={}));/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aE=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(){return new $.TextEncoder}function aC(){return new TextDecoder("utf-8")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aI=new O([4294967295,4294967295],0);function aR(T){let S=aw().encode(T),R=new N;return R.update(S),new Uint8Array(R.digest())}function aO(T){let S=new DataView(T.buffer),R=S.getUint32(0,!0),N=S.getUint32(4,!0),P=S.getUint32(8,!0),M=S.getUint32(12,!0);return[new O([R,N],0),new O([P,M],0)]}class aA{constructor(T,S,R){if(this.bitmap=T,this.padding=S,this.hashCount=R,S<0||S>=8)throw new ak(`Invalid padding: ${S}`);if(R<0||T.length>0&&0===this.hashCount)throw new ak(`Invalid hash count: ${R}`);if(0===T.length&&0!==S)throw new ak(`Invalid padding when bitmap length is 0: ${S}`);this.bitCount=8*T.length-S,this.bitCountInInteger=O.fromNumber(this.bitCount)}getBitIndex(T,S,R){let N=T.add(S.multiply(O.fromNumber(R)));return 1===N.compare(aI)&&(N=new O([N.getBits(0),N.getBits(1)],0)),N.modulo(this.bitCountInInteger).toNumber()}isBitSet(T){return(this.bitmap[Math.floor(T/8)]&1<<T%8)!=0}mightContain(T){if(0===this.bitCount)return!1;let[S,R]=aO(aR(T));for(let T=0;T<this.hashCount;T++){let O=this.getBitIndex(S,R,T);if(!this.isBitSet(O))return!1}return!0}static create(T,S,R){let O=T%8==0?0:8-T%8,N=new aA(new Uint8Array(Math.ceil(T/8)),O,S);return R.forEach(T=>N.insert(T)),N}insert(T){if(0===this.bitCount)return;let[S,R]=aO(aR(T));for(let T=0;T<this.hashCount;T++){let O=this.getBitIndex(S,R,T);this.setBit(O)}}setBit(T){let S=Math.floor(T/8),R=T%8;this.bitmap[S]|=1<<R}}class ak extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(T,S,R,O,N){this.snapshotVersion=T,this.targetChanges=S,this.targetMismatches=R,this.documentUpdates=O,this.resolvedLimboDocuments=N}static createSynthesizedRemoteEventForCurrentChange(T,S,R){let O=new Map;return O.set(T,aD.createSynthesizedTargetChangeForCurrentChange(T,S,R)),new aN(eL.min(),O,new rU(ek),sS(),sD())}}class aD{constructor(T,S,R,O,N){this.resumeToken=T,this.current=S,this.addedDocuments=R,this.modifiedDocuments=O,this.removedDocuments=N}static createSynthesizedTargetChangeForCurrentChange(T,S,R){return new aD(R,S,sD(),sD(),sD())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(T,S,R,O){this.updatedTargetIds=T,this.removedTargetIds=S,this.key=R,this.newDoc=O}}class ax{constructor(T,S){this.targetId=T,this.existenceFilter=S}}class aM{constructor(T,S,R=rY.EMPTY_BYTE_STRING,O=null){this.state=T,this.targetIds=S,this.resumeToken=R,this.cause=O}}class aL{constructor(){this.pendingResponses=0,this.documentChanges=aB(),this._resumeToken=rY.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(T){T.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=T)}toTargetChange(){let T=sD(),S=sD(),R=sD();return this.documentChanges.forEach((O,N)=>{switch(N){case 0:T=T.add(O);break;case 2:S=S.add(O);break;case 1:R=R.add(O);break;default:ef()}}),new aD(this._resumeToken,this._current,T,S,R)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=aB()}addDocumentChange(T,S){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(T,S)}removeDocumentChange(T){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(T)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,ep(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let aF="WatchChangeAggregator";class aj{constructor(T){this.metadataProvider=T,this.targetStates=new Map,this.pendingDocumentUpdates=sS(),this.pendingDocumentTargetMapping=aU(),this.pendingTargetResets=new rU(ek)}handleDocumentChange(T){for(let S of T.updatedTargetIds)T.newDoc&&T.newDoc.isFoundDocument()?this.addDocumentToTarget(S,T.newDoc):this.removeDocumentFromTarget(S,T.key,T.newDoc);for(let S of T.removedTargetIds)this.removeDocumentFromTarget(S,T.key,T.newDoc)}handleTargetChange(T){this.forEachTarget(T,S=>{let R=this.ensureTargetState(S);switch(T.state){case 0:this.isActiveTarget(S)&&R.updateResumeToken(T.resumeToken);break;case 1:R.recordTargetResponse(),R.isPending||R.clearPendingChanges(),R.updateResumeToken(T.resumeToken);break;case 2:R.recordTargetResponse(),R.isPending||this.removeTarget(S);break;case 3:this.isActiveTarget(S)&&(R.markCurrent(),R.updateResumeToken(T.resumeToken));break;case 4:this.isActiveTarget(S)&&(this.resetTarget(S),R.updateResumeToken(T.resumeToken));break;default:ef()}})}forEachTarget(T,S){T.targetIds.length>0?T.targetIds.forEach(S):this.targetStates.forEach((T,R)=>{this.isActiveTarget(R)&&S(R)})}handleExistenceFilter(T){let S=T.targetId,R=T.existenceFilter.count,O=this.targetDataForActiveTarget(S);if(O){let N=O.target;if(iH(N)){if(0===R){let T=new ez(N.path);this.removeDocumentFromTarget(S,T,ii.newNoDocument(T,eL.min()))}else ep(1===R)}else{let O=this.getCurrentDocumentCountForTarget(S);if(O!==R){let R=this.parseBloomFilter(T),N=R?this.applyBloomFilter(R,T,O):1;if(0!==N){this.resetTarget(S);let T=2===N?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(S,T)}null==aE||aE.notifyOnExistenceFilterMismatch(aV(O,T.existenceFilter,this.metadataProvider.getDatabaseId(),R,N))}}}}parseBloomFilter(T){let S,R;let O=T.existenceFilter.unchangedNames;if(!O||!O.bits)return null;let{bits:{bitmap:N="",padding:P=0},hashCount:M=0}=O;try{S=r2(N).toUint8Array()}catch(T){if(T instanceof a_)return ed("Decoding the base64 bloom filter in existence filter failed ("+T.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw T}try{R=new aA(S,P,M)}catch(T){return T instanceof ak?ed("BloomFilter error: ",T):ed("Applying bloom filter failed: ",T),null}return 0===R.bitCount?null:R}applyBloomFilter(T,S,R){return S.existenceFilter.count===R-this.filterRemovedDocuments(T,S.targetId)?0:2}filterRemovedDocuments(T,S){let R=this.metadataProvider.getRemoteKeysForTarget(S),O=0;return R.forEach(R=>{let N=this.metadataProvider.getDatabaseId(),P=`projects/${N.projectId}/databases/${N.database}/documents/${R.path.canonicalString()}`;!T.mightContain(P)&&(this.removeDocumentFromTarget(S,R,null),O++)}),O}createRemoteEvent(T){let S=new Map;this.targetStates.forEach((R,O)=>{let N=this.targetDataForActiveTarget(O);if(N){if(R.current&&iH(N.target)){let S=new ez(N.target.path);null!==this.pendingDocumentUpdates.get(S)||this.targetContainsDocument(O,S)||this.removeDocumentFromTarget(O,S,ii.newNoDocument(S,T))}R.hasPendingChanges&&(S.set(O,R.toTargetChange()),R.clearPendingChanges())}});let R=sD();this.pendingDocumentTargetMapping.forEach((T,S)=>{let O=!0;S.forEachWhile(T=>{let S=this.targetDataForActiveTarget(T);return!S||"TargetPurposeLimboResolution"===S.purpose||(O=!1,!1)}),O&&(R=R.add(T))}),this.pendingDocumentUpdates.forEach((S,R)=>R.setReadTime(T));let O=new aN(T,S,this.pendingTargetResets,this.pendingDocumentUpdates,R);return this.pendingDocumentUpdates=sS(),this.pendingDocumentTargetMapping=aU(),this.pendingTargetResets=new rU(ek),O}addDocumentToTarget(T,S){if(!this.isActiveTarget(T))return;let R=this.targetContainsDocument(T,S.key)?2:0;this.ensureTargetState(T).addDocumentChange(S.key,R),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(S.key,S),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(S.key,this.ensureDocumentTargetMapping(S.key).add(T))}removeDocumentFromTarget(T,S,R){if(!this.isActiveTarget(T))return;let O=this.ensureTargetState(T);this.targetContainsDocument(T,S)?O.addDocumentChange(S,1):O.removeDocumentChange(S),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(S,this.ensureDocumentTargetMapping(S).delete(T)),R&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(S,R))}removeTarget(T){this.targetStates.delete(T)}getCurrentDocumentCountForTarget(T){let S=this.ensureTargetState(T).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(T).size+S.addedDocuments.size-S.removedDocuments.size}recordPendingTargetRequest(T){this.ensureTargetState(T).recordPendingTargetRequest()}ensureTargetState(T){let S=this.targetStates.get(T);return S||(S=new aL,this.targetStates.set(T,S)),S}ensureDocumentTargetMapping(T){let S=this.pendingDocumentTargetMapping.get(T);return S||(S=new rq(ek),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(T,S)),S}isActiveTarget(T){let S=null!==this.targetDataForActiveTarget(T);return S||eu(aF,"Detected inactive target",T),S}targetDataForActiveTarget(T){let S=this.targetStates.get(T);return S&&S.isPending?null:this.metadataProvider.getTargetDataForTarget(T)}resetTarget(T){this.targetStates.set(T,new aL),this.metadataProvider.getRemoteKeysForTarget(T).forEach(S=>{this.removeDocumentFromTarget(T,S,null)})}targetContainsDocument(T,S){return this.metadataProvider.getRemoteKeysForTarget(T).has(S)}}function aU(){return new rU(ez.comparator)}function aB(){return new rU(ez.comparator)}function aV(T,S,R,O,N){var P,M,L,U,V,$;let K={localCacheCount:T,existenceFilterCount:S.count,databaseId:R.database,projectId:R.projectId},W=S.unchangedNames;return W&&(K.bloomFilter={applied:0===N,hashCount:null!==(P=null==W?void 0:W.hashCount)&&void 0!==P?P:0,bitmapLength:null!==(U=null===(L=null===(M=null==W?void 0:W.bits)||void 0===M?void 0:M.bitmap)||void 0===L?void 0:L.length)&&void 0!==U?U:0,padding:null!==($=null===(V=null==W?void 0:W.bits)||void 0===V?void 0:V.padding)&&void 0!==$?$:0,mightContain:T=>{var S;return null!==(S=null==O?void 0:O.mightContain(T))&&void 0!==S&&S}}),K}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let az=(()=>{let T={};return T.asc="ASCENDING",T.desc="DESCENDING",T})(),aq=(()=>{let T={};return T["<"]="LESS_THAN",T["<="]="LESS_THAN_OR_EQUAL",T[">"]="GREATER_THAN",T[">="]="GREATER_THAN_OR_EQUAL",T["=="]="EQUAL",T["!="]="NOT_EQUAL",T["array-contains"]="ARRAY_CONTAINS",T.in="IN",T["not-in"]="NOT_IN",T["array-contains-any"]="ARRAY_CONTAINS_ANY",T})(),aG=(()=>{let T={};return T.and="AND",T.or="OR",T})();class aH{constructor(T,S){this.databaseId=T,this.useProto3Json=S}}function a$(T){return new ey(void 0===T.code?em.UNKNOWN:aS(T.code),T.message||"")}function aK(T,S){return T.useProto3Json||nu(S)?S:{value:S}}function aW(T){let S;return nu(S="object"==typeof T?T.value:T)?null:S}function aQ(T,S){if(!T.useProto3Json)return{seconds:""+S.seconds,nanos:S.nanoseconds};{let T=new Date(1e3*S.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),R=("000000000"+S.nanoseconds).slice(-9);return`${T}.${R}Z`}}function aY(T){let S=r0(T);return new eM(S.seconds,S.nanos)}function aJ(T,S){return T.useProto3Json?S.toBase64():S.toUint8Array()}function aX(T,S){return T.useProto3Json?(ep(void 0===S||"string"==typeof S),rY.fromBase64String(S||"")):(ep(void 0===S||S instanceof Buffer||S instanceof Uint8Array),rY.fromUint8Array(S||new Uint8Array))}function aZ(T,S){return aQ(T,S.toTimestamp())}function a0(T){return ep(!!T),eL.fromTimestamp(aY(T))}function a1(T,S){return a2(T,S).canonicalString()}function a2(T,S){let R=a7(T).child("documents");return void 0===S?R:R.child(S)}function a3(T){let S=eU.fromString(T);return ep(o2(S)),S}function a4(T,S){return a1(T.databaseId,S.path)}function a6(T,S){let R=a3(S);if(R.get(1)!==T.databaseId.projectId)throw new ey(em.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+R.get(1)+" vs "+T.databaseId.projectId);if(R.get(3)!==T.databaseId.database)throw new ey(em.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+R.get(3)+" vs "+T.databaseId.database);return new ez(oe(R))}function a9(T,S){return a1(T.databaseId,S)}function a5(T){let S=a3(T);return 4===S.length?eU.emptyPath():oe(S)}function a8(T){return new eU(["projects",T.databaseId.projectId,"databases",T.databaseId.database]).canonicalString()}function a7(T){return new eU(["projects",T.projectId,"databases",T.database])}function oe(T){return ep(T.length>4&&"documents"===T.get(4)),T.popFirst(5)}function ot(T,S,R){return{name:a4(T,S),fields:R.value.mapValue.fields}}function or(T,S){return{name:a4(T,S.key),fields:S.data.value.mapValue.fields,updateTime:aQ(T,S.version.toTimestamp()),createTime:aQ(T,S.createTime.toTimestamp())}}function on(T,S,R){let O=a6(T,S.name),N=a0(S.updateTime),P=S.createTime?a0(S.createTime):eL.min(),M=new ie({mapValue:{fields:S.fields}}),L=ii.newFoundDocument(O,N,P,M);return R&&L.setHasCommittedMutations(),R?L.setHasCommittedMutations():L}function oi(T,S){ep(!!S.found),S.found.name,S.found.updateTime;let R=a6(T,S.found.name),O=a0(S.found.updateTime),N=S.found.createTime?a0(S.found.createTime):eL.min(),P=new ie({mapValue:{fields:S.found.fields}});return ii.newFoundDocument(R,O,N,P)}function oa(T,S){ep(!!S.missing),ep(!!S.readTime);let R=a6(T,S.missing),O=a0(S.readTime);return ii.newNoDocument(R,O)}function oo(T,S){return"found"in S?oi(T,S):"missing"in S?oa(T,S):ef()}function ol(T,S){let R;if("targetChange"in S){S.targetChange;let O=ou(S.targetChange.targetChangeType||"NO_CHANGE"),N=S.targetChange.targetIds||[],P=aX(T,S.targetChange.resumeToken),M=S.targetChange.cause;R=new aM(O,N,P,M&&a$(M)||null)}else if("documentChange"in S){S.documentChange;let O=S.documentChange;O.document,O.document.name,O.document.updateTime;let N=a6(T,O.document.name),P=a0(O.document.updateTime),M=O.document.createTime?a0(O.document.createTime):eL.min(),L=new ie({mapValue:{fields:O.document.fields}}),U=ii.newFoundDocument(N,P,M,L);R=new aP(O.targetIds||[],O.removedTargetIds||[],U.key,U)}else if("documentDelete"in S){S.documentDelete;let O=S.documentDelete;O.document;let N=a6(T,O.document),P=O.readTime?a0(O.readTime):eL.min(),M=ii.newNoDocument(N,P);R=new aP([],O.removedTargetIds||[],M.key,M)}else if("documentRemove"in S){S.documentRemove;let O=S.documentRemove;O.document;let N=a6(T,O.document);R=new aP([],O.removedTargetIds||[],N,null)}else{if(!("filter"in S))return ef();S.filter;let T=S.filter;T.targetId;let{count:O=0,unchangedNames:N}=T,P=new av(O,N);R=new ax(T.targetId,P)}return R}function ou(T){return"NO_CHANGE"===T?0:"ADD"===T?1:"REMOVE"===T?2:"CURRENT"===T?3:"RESET"===T?4:ef()}function oc(T){if(!("targetChange"in T))return eL.min();let S=T.targetChange;return S.targetIds&&S.targetIds.length||!S.readTime?eL.min():a0(S.readTime)}function od(T,S){let R;if(S instanceof ar)R={update:ot(T,S.key,S.value)};else if(S instanceof ad)R={delete:a4(T,S.key)};else if(S instanceof as)R={update:ot(T,S.key,S.data),updateMask:o0(S.fieldMask)};else{if(!(S instanceof ap))return ef();R={verify:a4(T,S.key)}}return S.fieldTransforms.length>0&&(R.updateTransforms=S.fieldTransforms.map(S=>ov(T,S))),S.precondition.isNone||(R.currentDocument=of(T,S.precondition)),R}function oh(T,S){let R=S.currentDocument?og(S.currentDocument):s4.none(),O=S.updateTransforms?S.updateTransforms.map(S=>ob(T,S)):[];if(S.update){S.update.name;let N=a6(T,S.update.name),P=new ie({mapValue:{fields:S.update.fields}});return S.updateMask?new as(N,P,o1(S.updateMask),R,O):new ar(N,P,R,O)}return S.delete?new ad(a6(T,S.delete),R):S.verify?new ap(a6(T,S.verify),R):ef()}function of(T,S){return void 0!==S.updateTime?{updateTime:aZ(T,S.updateTime)}:void 0!==S.exists?{exists:S.exists}:ef()}function og(T){return void 0!==T.updateTime?s4.updateTime(a0(T.updateTime)):void 0!==T.exists?s4.exists(T.exists):s4.none()}function om(T,S){let R=T.updateTime?a0(T.updateTime):a0(S);return R.isEqual(eL.min())&&(R=a0(S)),new s3(R,T.transformResults||[])}function oy(T,S){return T&&T.length>0?(ep(void 0!==S),T.map(T=>om(T,S))):[]}function ov(T,S){let R=S.transform;if(R instanceof sq)return{fieldPath:S.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(R instanceof sG)return{fieldPath:S.field.canonicalString(),appendMissingElements:{values:R.elements}};if(R instanceof s$)return{fieldPath:S.field.canonicalString(),removeAllFromArray:{values:R.elements}};if(R instanceof sW)return{fieldPath:S.field.canonicalString(),increment:R.operand};throw ef()}function ob(T,S){let R=null;return"setToServerValue"in S?(ep("REQUEST_TIME"===S.setToServerValue),R=new sq):"appendMissingElements"in S?R=new sG(S.appendMissingElements.values||[]):"removeAllFromArray"in S?R=new s$(S.removeAllFromArray.values||[]):"increment"in S?R=new sW(T,S.increment):ef(),new sX(eV.fromServerFormat(S.fieldPath),R)}function oT(T,S){return{documents:[a9(T,S.path)]}}function oS(T){return ep(1===T.documents.length),se(i3(a5(T.documents[0])))}function o_(T,S){let R;let O={structuredQuery:{}},N=S.path;null!==S.collectionGroup?(R=N,O.structuredQuery.from=[{collectionId:S.collectionGroup,allDescendants:!0}]):(R=N.popLast(),O.structuredQuery.from=[{collectionId:N.lastSegment()}]),O.parent=a9(T,R);let P=oA(S.filters);P&&(O.structuredQuery.where=P);let M=oD(S.orderBy);M&&(O.structuredQuery.orderBy=M);let L=aK(T,S.limit);return null!==L&&(O.structuredQuery.limit=L),S.startAt&&(O.structuredQuery.startAt=ox(S.startAt)),S.endAt&&(O.structuredQuery.endAt=oM(S.endAt)),{queryTarget:O,parent:R}}function oE(T,S,R,O){let{queryTarget:N,parent:P}=o_(T,S),M={},L=[],U=0;return R.forEach(T=>{let S=O?T.alias:`aggregate_${U++}`;M[S]=T.alias,"count"===T.aggregateType?L.push({alias:S,count:{}}):"avg"===T.aggregateType?L.push({alias:S,avg:{field:oG(T.fieldPath)}}):"sum"===T.aggregateType&&L.push({alias:S,sum:{field:oG(T.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:L,structuredQuery:N.structuredQuery},parent:N.parent},aliasMap:M,parent:P}}function ow(T){let S=a5(T.parent),R=T.structuredQuery,O=R.from?R.from.length:0,N=null;if(O>0){ep(1===O);let T=R.from[0];T.allDescendants?N=T.collectionId:S=S.child(T.collectionId)}let P=[];R.where&&(P=ok(R.where));let M=[];R.orderBy&&(M=oP(R.orderBy));let L=null;R.limit&&(L=aW(R.limit));let U=null;R.startAt&&(U=oL(R.startAt));let V=null;return R.endAt&&(V=oF(R.endAt)),i2(S,N,M,P,L,"F",U,V)}function oC(T){return se(ow(T))}function oI(T,S){let R=oR(S.purpose);return null==R?null:{"goog-listen-tags":R}}function oR(T){switch(T){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ef()}}function oO(T,S){let R;let O=S.target;if((R=iH(O)?{documents:oT(T,O)}:{query:o_(T,O).queryTarget}).targetId=S.targetId,S.resumeToken.approximateByteSize()>0){R.resumeToken=aJ(T,S.resumeToken);let O=aK(T,S.expectedCount);null!==O&&(R.expectedCount=O)}else if(S.snapshotVersion.compareTo(eL.min())>0){R.readTime=aQ(T,S.snapshotVersion.toTimestamp());let O=aK(T,S.expectedCount);null!==O&&(R.expectedCount=O)}return R}function oA(T){if(0!==T.length)return oW(ib.create(T,"and"))}function ok(T){let S=oN(T);return S instanceof ib&&i_(S)?S.getFilters():[S]}function oN(T){return void 0!==T.unaryFilter?oJ(T):void 0!==T.fieldFilter?oX(T):void 0!==T.compositeFilter?oZ(T):ef()}function oD(T){if(0!==T.length)return T.map(T=>o$(T))}function oP(T){return T.map(T=>oK(T))}function ox(T){return{before:T.inclusive,values:T.position}}function oM(T){return{before:!T.inclusive,values:T.position}}function oL(T){let S=!!T.before;return new ia(T.values||[],S)}function oF(T){let S=!T.before;return new ia(T.values||[],S)}function oj(T){return az[T]}function oU(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function oB(T){return aq[T]}function oV(T){return aG[T]}function oz(T){switch(T){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ef()}}function oq(T){switch(T){case"AND":return"and";case"OR":return"or";default:return ef()}}function oG(T){return{fieldPath:T.canonicalString()}}function oH(T){return eV.fromServerFormat(T.fieldPath)}function o$(T){return{field:oG(T.field),direction:oj(T.dir)}}function oK(T){return new ih(oH(T.field),oU(T.direction))}function oW(T){return T instanceof iv?oY(T):T instanceof ib?oQ(T):ef()}function oQ(T){let S=T.getFilters().map(T=>oW(T));return 1===S.length?S[0]:{compositeFilter:{op:oV(T.op),filters:S}}}function oY(T){if("=="===T.op){if(nX(T.value))return{unaryFilter:{field:oG(T.field),op:"IS_NAN"}};if(nJ(T.value))return{unaryFilter:{field:oG(T.field),op:"IS_NULL"}}}else if("!="===T.op){if(nX(T.value))return{unaryFilter:{field:oG(T.field),op:"IS_NOT_NAN"}};if(nJ(T.value))return{unaryFilter:{field:oG(T.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oG(T.field),op:oB(T.op),value:T.value}}}function oJ(T){switch(T.unaryFilter.op){case"IS_NAN":let S=oH(T.unaryFilter.field);return iv.create(S,"==",{doubleValue:NaN});case"IS_NULL":let R=oH(T.unaryFilter.field);return iv.create(R,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let O=oH(T.unaryFilter.field);return iv.create(O,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let N=oH(T.unaryFilter.field);return iv.create(N,"!=",{nullValue:"NULL_VALUE"});default:return ef()}}function oX(T){return iv.create(oH(T.fieldFilter.field),oz(T.fieldFilter.op),T.fieldFilter.value)}function oZ(T){return ib.create(T.compositeFilter.filters.map(T=>oN(T)),oq(T.compositeFilter.op))}function o0(T){let S=[];return T.fields.forEach(T=>S.push(T.canonicalString())),{fieldPaths:S}}function o1(T){return new rK((T.fieldPaths||[]).map(T=>eV.fromServerFormat(T)))}function o2(T){return T.length>=4&&"projects"===T.get(0)&&"databases"===T.get(2)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{constructor(T,S,R,O,N=eL.min(),P=eL.min(),M=rY.EMPTY_BYTE_STRING,L=null){this.target=T,this.targetId=S,this.purpose=R,this.sequenceNumber=O,this.snapshotVersion=N,this.lastLimboFreeSnapshotVersion=P,this.resumeToken=M,this.expectedCount=L}withSequenceNumber(T){return new o3(this.target,this.targetId,this.purpose,T,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(T,S){return new o3(this.target,this.targetId,this.purpose,this.sequenceNumber,S,this.lastLimboFreeSnapshotVersion,T,null)}withExpectedCount(T){return new o3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,T)}withLastLimboFreeSnapshotVersion(T){return new o3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,T,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(T){this.remoteSerializer=T}}function o6(T,S){let R;if(S.document)R=on(T.remoteSerializer,S.document,!!S.hasCommittedMutations);else if(S.noDocument){let T=ez.fromSegments(S.noDocument.path),O=lt(S.noDocument.readTime);R=ii.newNoDocument(T,O),S.hasCommittedMutations&&R.setHasCommittedMutations()}else{if(!S.unknownDocument)return ef();let T=ez.fromSegments(S.unknownDocument.path),O=lt(S.unknownDocument.version);R=ii.newUnknownDocument(T,O)}return S.readTime&&R.setReadTime(o8(S.readTime)),R}function o9(T,S){let R=S.key,O={prefixPath:R.getCollectionPath().popLast().toArray(),collectionGroup:R.collectionGroup,documentId:R.path.lastSegment(),readTime:o5(S.readTime),hasCommittedMutations:S.hasCommittedMutations};if(S.isFoundDocument())O.document=or(T.remoteSerializer,S);else if(S.isNoDocument())O.noDocument={path:R.path.toArray(),readTime:o7(S.version)};else{if(!S.isUnknownDocument())return ef();O.unknownDocument={path:R.path.toArray(),version:o7(S.version)}}return O}function o5(T){let S=T.toTimestamp();return[S.seconds,S.nanoseconds]}function o8(T){let S=new eM(T[0],T[1]);return eL.fromTimestamp(S)}function o7(T){let S=T.toTimestamp();return{seconds:S.seconds,nanoseconds:S.nanoseconds}}function lt(T){let S=new eM(T.seconds,T.nanoseconds);return eL.fromTimestamp(S)}function lr(T,S,R){let O=R.baseMutations.map(S=>od(T.remoteSerializer,S)),N=R.mutations.map(S=>od(T.remoteSerializer,S));return{userId:S,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:O,mutations:N}}function ln(T,S){let R=(S.baseMutations||[]).map(S=>oh(T.remoteSerializer,S));for(let T=0;T<S.mutations.length-1;++T){let R=S.mutations[T];if(T+1<S.mutations.length&&void 0!==S.mutations[T+1].transform){let O=S.mutations[T+1];R.updateTransforms=O.transform.fieldTransforms,S.mutations.splice(T+1,1),++T}}let O=S.mutations.map(S=>oh(T.remoteSerializer,S)),N=eM.fromMillis(S.localWriteTimeMs);return new ag(S.batchId,N,R,O)}function li(T){let S;let R=lt(T.readTime),O=void 0!==T.lastLimboFreeSnapshotVersion?lt(T.lastLimboFreeSnapshotVersion):eL.min();return new o3(S=la(T.query)?oS(T.query):oC(T.query),T.targetId,"TargetPurposeListen",T.lastListenSequenceNumber,R,O,rY.fromBase64String(T.resumeToken))}function ls(T,S){let R;let O=o7(S.snapshotVersion),N=o7(S.lastLimboFreeSnapshotVersion);R=iH(S.target)?oT(T.remoteSerializer,S.target):o_(T.remoteSerializer,S.target).queryTarget;let P=S.resumeToken.toBase64();return{targetId:S.targetId,canonicalId:iz(S.target),readTime:O,resumeToken:P,lastListenSequenceNumber:S.sequenceNumber,lastLimboFreeSnapshotVersion:N,query:R}}function la(T){return void 0!==T.documents}function ll(T){return{id:T.bundleId,createTime:lt(T.createTime),version:T.version}}function lu(T){return{bundleId:T.id,createTime:o7(a0(T.createTime)),version:T.version}}function lc(T){return{name:T.name,query:lh(T.bundledQuery),readTime:lt(T.readTime)}}function ld(T){return{name:T.name,readTime:o7(a0(T.readTime)),bundledQuery:T.bundledQuery}}function lh(T){let S=ow({parent:T.parent,structuredQuery:T.structuredQuery});return"LAST"===T.limitType?ss(S,S.limit,"L"):S}function lf(T){return{name:T.name,query:lh(T.bundledQuery),readTime:a0(T.readTime)}}function lp(T){return{id:T.id,version:T.version,createTime:a0(T.createTime)}}function lg(T,S){return new ay(S.largestBatchId,oh(T.remoteSerializer,S.overlayMutation))}function lm(T,S,R){let[O,N,P]=ly(S,R.mutation.key);return{userId:S,collectionPath:N,documentId:P,collectionGroup:R.mutation.key.getCollectionGroup(),largestBatchId:R.largestBatchId,overlayMutation:od(T.remoteSerializer,R.mutation)}}function ly(T,S){let R=S.path.lastSegment();return[T,tE(S.path.popLast()),R]}function lv(T){return{indexId:T.indexId,collectionGroup:T.collectionGroup,fields:T.fields.map(T=>[T.fieldPath.canonicalString(),T.kind])}}function lb(T,S){let R=S?new eZ(S.sequenceNumber,new e2(lt(S.readTime),new ez(tI(S.documentKey)),S.largestBatchId)):eZ.empty(),O=T.fields.map(([T,S])=>new eJ(eV.fromServerFormat(T),S));return new eH(T.indexId,T.collectionGroup,O,R)}function lT(T,S,R,O){return{indexId:T,uid:S,sequenceNumber:R,readTime:o7(O.readTime),documentKey:tE(O.documentKey.path),largestBatchId:O.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{getBundleMetadata(T,S){return l_(T).get(S).next(T=>{if(T)return ll(T)})}saveBundleMetadata(T,S){return l_(T).put(lu(S))}getNamedQuery(T,S){return lE(T).get(S).next(T=>{if(T)return lc(T)})}saveNamedQuery(T,S){return lE(T).put(ld(S))}}function l_(T){return rx(T,rt)}function lE(T){return rx(T,rn)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(T,S){this.serializer=T,this.userId=S}static forUser(T,S){return new lw(T,S.uid||"")}getOverlay(T,S){return lC(T).get(ly(this.userId,S)).next(T=>T?lg(this.serializer,T):null)}getOverlays(T,S){let R=sI();return e5.forEach(S,S=>this.getOverlay(T,S).next(T=>{null!==T&&R.set(S,T)})).next(()=>R)}saveOverlays(T,S,R){let O=[];return R.forEach((R,N)=>{let P=new ay(S,N);O.push(this.saveOverlay(T,P))}),e5.waitFor(O)}removeOverlaysForBatchId(T,S,R){let O=new Set;S.forEach(T=>O.add(tE(T.getCollectionPath())));let N=[];return O.forEach(S=>{let O=IDBKeyRange.bound([this.userId,S,R],[this.userId,S,R+1],!1,!0);N.push(lC(T).deleteAll(rb,O))}),e5.waitFor(N)}getOverlaysForCollection(T,S,R){let O=sI(),N=tE(S),P=IDBKeyRange.bound([this.userId,N,R],[this.userId,N,Number.POSITIVE_INFINITY],!0);return lC(T).loadAll(rb,P).next(T=>{for(let S of T){let T=lg(this.serializer,S);O.set(T.getKey(),T)}return O})}getOverlaysForCollectionGroup(T,S,R,O){let N;let P=sI(),M=IDBKeyRange.bound([this.userId,S,R],[this.userId,S,Number.POSITIVE_INFINITY],!0);return lC(T).iterate({index:rS,range:M},(T,S,R)=>{let M=lg(this.serializer,S);P.size()<O||M.largestBatchId===N?(P.set(M.getKey(),M),N=M.largestBatchId):R.done()}).next(()=>P)}saveOverlay(T,S){return lC(T).put(lm(this.serializer,this.userId,S))}}function lC(T){return rx(T,ry)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{globalsStore(T){return rx(T,rE)}getSessionToken(T){return this.globalsStore(T).get("sessionToken").next(T=>{let S=null==T?void 0:T.value;return S?rY.fromUint8Array(S):rY.EMPTY_BYTE_STRING})}setSessionToken(T,S){return this.globalsStore(T).put({name:"sessionToken",value:S.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lR=5,lO=10,lA=13,lk=15,lN=20,lD=25,lP=30,lx=37,lM=45,lL=50,lF=53,lj=55,lU=60,lB=2;class lV{constructor(){}writeIndexValue(T,S){this.writeIndexValueAux(T,S),S.writeInfinity()}writeIndexValueAux(T,S){if("nullValue"in T)this.writeValueTypeLabel(S,lR);else if("booleanValue"in T)this.writeValueTypeLabel(S,lO),S.writeNumber(T.booleanValue?1:0);else if("integerValue"in T)this.writeValueTypeLabel(S,lk),S.writeNumber(r1(T.integerValue));else if("doubleValue"in T){let R=r1(T.doubleValue);isNaN(R)?this.writeValueTypeLabel(S,lA):(this.writeValueTypeLabel(S,lk),nc(R)?S.writeNumber(0):S.writeNumber(R))}else if("timestampValue"in T){let R=T.timestampValue;this.writeValueTypeLabel(S,lN),"string"==typeof R&&(R=r0(R)),S.writeString(`${R.seconds||""}`),S.writeNumber(R.nanos||0)}else if("stringValue"in T)this.writeIndexString(T.stringValue,S),this.writeTruncationMarker(S);else if("bytesValue"in T)this.writeValueTypeLabel(S,lP),S.writeBytes(r2(T.bytesValue)),this.writeTruncationMarker(S);else if("referenceValue"in T)this.writeIndexEntityRef(T.referenceValue,S);else if("geoPointValue"in T){let R=T.geoPointValue;this.writeValueTypeLabel(S,lM),S.writeNumber(R.latitude||0),S.writeNumber(R.longitude||0)}else"mapValue"in T?n4(T)?this.writeValueTypeLabel(S,Number.MAX_SAFE_INTEGER):n0(T)?this.writeIndexVector(T.mapValue,S):(this.writeIndexMap(T.mapValue,S),this.writeTruncationMarker(S)):"arrayValue"in T?(this.writeIndexArray(T.arrayValue,S),this.writeTruncationMarker(S)):ef()}writeIndexString(T,S){this.writeValueTypeLabel(S,lD),this.writeUnlabeledIndexString(T,S)}writeUnlabeledIndexString(T,S){S.writeString(T)}writeIndexMap(T,S){let R=T.fields||{};for(let T of(this.writeValueTypeLabel(S,lj),Object.keys(R)))this.writeIndexString(T,S),this.writeIndexValueAux(R[T],S)}writeIndexVector(T,S){var R,O;let N=T.fields||{};this.writeValueTypeLabel(S,lF);let P=nm,M=(null===(O=null===(R=N[P].arrayValue)||void 0===R?void 0:R.values)||void 0===O?void 0:O.length)||0;this.writeValueTypeLabel(S,lk),S.writeNumber(r1(M)),this.writeIndexString(P,S),this.writeIndexValueAux(N[P],S)}writeIndexArray(T,S){let R=T.values||[];for(let T of(this.writeValueTypeLabel(S,lL),R))this.writeIndexValueAux(T,S)}writeIndexEntityRef(T,S){this.writeValueTypeLabel(S,lx),ez.fromName(T).path.forEach(T=>{this.writeValueTypeLabel(S,lU),this.writeUnlabeledIndexString(T,S)})}writeValueTypeLabel(T,S){T.writeNumber(S)}writeTruncationMarker(T){T.writeNumber(lB)}}lV.INSTANCE=new lV;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lz="\uD800",lq="\uDBFF",lG=0,lH=255,l$=1,lK=255,lW=255,lQ=0,lY=64,lJ=8,lX=1024;function lZ(T){let S=new DataView(new ArrayBuffer(8));return S.setFloat64(0,T,!1),new Uint8Array(S.buffer)}function l0(T){if(0===T)return 8;let S=0;return T>>4==0&&(S+=4,T<<=4),T>>6==0&&(S+=2,T<<=2),T>>7==0&&(S+=1),S}function l1(T){let S=0;for(let R=0;R<8;++R){let O=l0(255&T[R]);if(S+=O,8!==O)break}return S}function l2(T){return Math.ceil((lY-l1(T))/lJ)}class l3{constructor(){this.buffer=new Uint8Array(lX),this.position=0}writeBytesAscending(T){let S=T[Symbol.iterator](),R=S.next();for(;!R.done;)this.writeByteAscending(R.value),R=S.next();this.writeSeparatorAscending()}writeBytesDescending(T){let S=T[Symbol.iterator](),R=S.next();for(;!R.done;)this.writeByteDescending(R.value),R=S.next();this.writeSeparatorDescending()}writeUtf8Ascending(T){for(let S of T){let T=S.charCodeAt(0);if(T<128)this.writeByteAscending(T);else if(T<2048)this.writeByteAscending(960|T>>>6),this.writeByteAscending(128|63&T);else if(S<lz||lq<S)this.writeByteAscending(480|T>>>12),this.writeByteAscending(128|63&T>>>6),this.writeByteAscending(128|63&T);else{let T=S.codePointAt(0);this.writeByteAscending(240|T>>>18),this.writeByteAscending(128|63&T>>>12),this.writeByteAscending(128|63&T>>>6),this.writeByteAscending(128|63&T)}}this.writeSeparatorAscending()}writeUtf8Descending(T){for(let S of T){let T=S.charCodeAt(0);if(T<128)this.writeByteDescending(T);else if(T<2048)this.writeByteDescending(960|T>>>6),this.writeByteDescending(128|63&T);else if(S<lz||lq<S)this.writeByteDescending(480|T>>>12),this.writeByteDescending(128|63&T>>>6),this.writeByteDescending(128|63&T);else{let T=S.codePointAt(0);this.writeByteDescending(240|T>>>18),this.writeByteDescending(128|63&T>>>12),this.writeByteDescending(128|63&T>>>6),this.writeByteDescending(128|63&T)}}this.writeSeparatorDescending()}writeNumberAscending(T){let S=this.toOrderedBits(T),R=l2(S);this.ensureAvailable(1+R),this.buffer[this.position++]=255&R;for(let T=S.length-R;T<S.length;++T)this.buffer[this.position++]=255&S[T]}writeNumberDescending(T){let S=this.toOrderedBits(T),R=l2(S);this.ensureAvailable(1+R),this.buffer[this.position++]=~(255&R);for(let T=S.length-R;T<S.length;++T)this.buffer[this.position++]=~(255&S[T])}writeInfinityAscending(){this.writeEscapedByteAscending(lK),this.writeEscapedByteAscending(lW)}writeInfinityDescending(){this.writeEscapedByteDescending(lK),this.writeEscapedByteDescending(lW)}reset(){this.position=0}seed(T){this.ensureAvailable(T.length),this.buffer.set(T,this.position),this.position+=T.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(T){let S=lZ(T),R=(128&S[0])!=0;S[0]^=R?255:128;for(let T=1;T<S.length;++T)S[T]^=R?255:0;return S}writeByteAscending(T){let S=255&T;S===lG?(this.writeEscapedByteAscending(lG),this.writeEscapedByteAscending(lH)):S===lK?(this.writeEscapedByteAscending(lK),this.writeEscapedByteAscending(lQ)):this.writeEscapedByteAscending(S)}writeByteDescending(T){let S=255&T;S===lG?(this.writeEscapedByteDescending(lG),this.writeEscapedByteDescending(lH)):S===lK?(this.writeEscapedByteDescending(lK),this.writeEscapedByteDescending(lQ)):this.writeEscapedByteDescending(T)}writeSeparatorAscending(){this.writeEscapedByteAscending(lG),this.writeEscapedByteAscending(l$)}writeSeparatorDescending(){this.writeEscapedByteDescending(lG),this.writeEscapedByteDescending(l$)}writeEscapedByteAscending(T){this.ensureAvailable(1),this.buffer[this.position++]=T}writeEscapedByteDescending(T){this.ensureAvailable(1),this.buffer[this.position++]=~T}ensureAvailable(T){let S=T+this.position;if(S<=this.buffer.length)return;let R=2*this.buffer.length;R<S&&(R=S);let O=new Uint8Array(R);O.set(this.buffer),this.buffer=O}}class l4{constructor(T){this.orderedCode=T}writeBytes(T){this.orderedCode.writeBytesAscending(T)}writeString(T){this.orderedCode.writeUtf8Ascending(T)}writeNumber(T){this.orderedCode.writeNumberAscending(T)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class l6{constructor(T){this.orderedCode=T}writeBytes(T){this.orderedCode.writeBytesDescending(T)}writeString(T){this.orderedCode.writeUtf8Descending(T)}writeNumber(T){this.orderedCode.writeNumberDescending(T)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class l9{constructor(){this.orderedCode=new l3,this.ascending=new l4(this.orderedCode),this.descending=new l6(this.orderedCode)}seed(T){this.orderedCode.seed(T)}forKind(T){return 0===T?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l5{constructor(T,S,R,O){this.indexId=T,this.documentKey=S,this.arrayValue=R,this.directionalValue=O}successor(){let T=this.directionalValue.length,S=0===T||255===this.directionalValue[T-1]?T+1:T,R=new Uint8Array(S);return R.set(this.directionalValue,0),S!==T?R.set([0],this.directionalValue.length):++R[R.length-1],new l5(this.indexId,this.documentKey,this.arrayValue,R)}}function l8(T,S){let R=T.indexId-S.indexId;return 0!==R||0!==(R=l7(T.arrayValue,S.arrayValue))||0!==(R=l7(T.directionalValue,S.directionalValue))?R:ez.comparator(T.documentKey,S.documentKey)}function l7(T,S){for(let R=0;R<T.length&&R<S.length;++R){let O=T[R]-S[R];if(0!==O)return O}return T.length-S.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(T){for(let S of(this.inequalityFilters=new rq((T,S)=>eV.comparator(T.field,S.field)),this.collectionId=null!=T.collectionGroup?T.collectionGroup:T.path.lastSegment(),this.orderBys=T.orderBy,this.equalityFilters=[],T.filters)){let T=S;T.isInequality()?this.inequalityFilters=this.inequalityFilters.add(T):this.equalityFilters.push(T)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(T){if(ep(T.collectionGroup===this.collectionId),this.hasMultipleInequality)return!1;let S=e$(T);if(void 0!==S&&!this.hasMatchingEqualityFilter(S))return!1;let R=eK(T),O=new Set,N=0,P=0;for(;N<R.length;++N)if(this.hasMatchingEqualityFilter(R[N]))O=O.add(R[N].fieldPath.canonicalString());else break;if(N===R.length)return!0;if(this.inequalityFilters.size>0){let T=this.inequalityFilters.getIterator().getNext();if(!O.has(T.field.canonicalString())){let S=R[N];if(!this.matchesFilter(T,S)||!this.matchesOrderBy(this.orderBys[P++],S))return!1}++N}for(;N<R.length;++N){let T=R[N];if(P>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[P++],T))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let T=new rq(eV.comparator),S=[];for(let R of this.equalityFilters)if(!R.field.isKeyField()){if("array-contains"===R.op||"array-contains-any"===R.op)S.push(new eJ(R.field,2));else{if(T.has(R.field))continue;T=T.add(R.field),S.push(new eJ(R.field,0))}}for(let R of this.orderBys)R.field.isKeyField()||T.has(R.field)||(T=T.add(R.field),S.push(new eJ(R.field,"asc"===R.dir?0:1)));return new eH(eH.UNKNOWN_ID,this.collectionId,S,eZ.empty())}hasMatchingEqualityFilter(T){for(let S of this.equalityFilters)if(this.matchesFilter(S,T))return!0;return!1}matchesFilter(T,S){if(void 0===T||!T.field.isEqual(S.fieldPath))return!1;let R="array-contains"===T.op||"array-contains-any"===T.op;return 2===S.kind===R}matchesOrderBy(T,S){return!!T.field.isEqual(S.fieldPath)&&(0===S.kind&&"asc"===T.dir||1===S.kind&&"desc"===T.dir)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(T){var S,R;if(ep(T instanceof iv||T instanceof ib),T instanceof iv){if(!(T instanceof iF))return T;{let O=(null===(R=null===(S=T.value.arrayValue)||void 0===S?void 0:S.values)||void 0===R?void 0:R.map(S=>iv.create(T.field,"==",S)))||[];return ib.create(O,"or")}}let O=T.filters.map(T=>ut(T));return ib.create(O,T.op)}function ur(T){if(0===T.getFilters().length)return[];let S=ul(ut(T));return(ep(us(S)),un(S)||ui(S))?[S]:S.getFilters()}function un(T){return T instanceof iv}function ui(T){return T instanceof ib&&i_(T)}function us(T){return un(T)||ui(T)||uo(T)}function uo(T){if(T instanceof ib&&iS(T)){for(let S of T.getFilters())if(!un(S)&&!ui(S))return!1;return!0}return!1}function ul(T){if(ep(T instanceof iv||T instanceof ib),T instanceof iv)return T;if(1===T.filters.length)return ul(T.filters[0]);let S=T.filters.map(T=>ul(T)),R=ib.create(S,T.op);return us(R=uf(R))?R:(ep(R instanceof ib),ep(iT(R)),ep(R.filters.length>1),R.filters.reduce((T,S)=>uu(T,S)))}function uu(T,S){let R;return ep(T instanceof iv||T instanceof ib),ep(S instanceof iv||S instanceof ib),uf(R=T instanceof iv?S instanceof iv?uc(T,S):uh(T,S):S instanceof iv?uh(S,T):ud(T,S))}function uc(T,S){return ib.create([T,S],"and")}function ud(T,S){if(ep(T.filters.length>0&&S.filters.length>0),iT(T)&&iT(S))return iO(T,S.getFilters());let R=iS(T)?T:S,O=iS(T)?S:T,N=R.filters.map(T=>uu(T,O));return ib.create(N,"or")}function uh(T,S){if(iT(S))return iO(S,T.getFilters());{let R=S.filters.map(S=>uu(T,S));return ib.create(R,"or")}}function uf(T){if(ep(T instanceof iv||T instanceof ib),T instanceof iv)return T;let S=T.getFilters();if(1===S.length)return uf(S[0]);if(iE(T))return T;let R=S.map(T=>uf(T)),O=[];return(R.forEach(S=>{S instanceof iv?O.push(S):S instanceof ib&&(S.op===T.op?O.push(...S.filters):O.push(S))}),1===O.length)?O[0]:ib.create(O,T.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(){this.collectionParentIndex=new ug}addToCollectionParentIndex(T,S){return this.collectionParentIndex.add(S),e5.resolve()}getCollectionParents(T,S){return e5.resolve(this.collectionParentIndex.getEntries(S))}addFieldIndex(T,S){return e5.resolve()}deleteFieldIndex(T,S){return e5.resolve()}deleteAllFieldIndexes(T){return e5.resolve()}createTargetIndexes(T,S){return e5.resolve()}getDocumentsMatchingTarget(T,S){return e5.resolve(null)}getIndexType(T,S){return e5.resolve(0)}getFieldIndexes(T,S){return e5.resolve([])}getNextCollectionGroupToUpdate(T){return e5.resolve(null)}getMinOffset(T,S){return e5.resolve(e2.min())}getMinOffsetFromCollectionGroup(T,S){return e5.resolve(e2.min())}updateCollectionGroup(T,S,R){return e5.resolve()}updateIndexEntries(T,S){return e5.resolve()}}class ug{constructor(){this.index={}}add(T){let S=T.lastSegment(),R=T.popLast(),O=this.index[S]||new rq(eU.comparator),N=!O.has(R);return this.index[S]=O.add(R),N}has(T){let S=T.lastSegment(),R=T.popLast(),O=this.index[S];return O&&O.has(R)}getEntries(T){return(this.index[T]||new rq(eU.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let um="IndexedDbIndexManager",uy=new Uint8Array(0);class uv{constructor(T,S){this.databaseId=S,this.collectionParentsCache=new ug,this.targetToDnfSubTargets=new sb(T=>iz(T),(T,S)=>iG(T,S)),this.uid=T.uid||""}addToCollectionParentIndex(T,S){if(!this.collectionParentsCache.has(S)){let R=S.lastSegment(),O=S.popLast();T.addOnCommittedListener(()=>{this.collectionParentsCache.add(S)});let N={collectionId:R,parent:tE(O)};return ub(T).put(N)}return e5.resolve()}getCollectionParents(T,S){let R=[],O=IDBKeyRange.bound([S,""],[eD(S),""],!1,!0);return ub(T).loadAll(O).next(T=>{for(let O of T){if(O.collectionId!==S)break;R.push(tI(O.parent))}return R})}addFieldIndex(T,S){let R=uS(T),O=lv(S);delete O.indexId;let N=R.add(O);if(!S.indexState)return N.next();{let R=u_(T);return N.next(T=>{R.put(lT(T,this.uid,S.indexState.sequenceNumber,S.indexState.offset))})}}deleteFieldIndex(T,S){let R=uS(T),O=u_(T),N=uT(T);return R.delete(S.indexId).next(()=>O.delete(IDBKeyRange.bound([S.indexId],[S.indexId+1],!1,!0))).next(()=>N.delete(IDBKeyRange.bound([S.indexId],[S.indexId+1],!1,!0)))}deleteAllFieldIndexes(T){let S=uS(T),R=uT(T),O=u_(T);return S.deleteAll().next(()=>R.deleteAll()).next(()=>O.deleteAll())}createTargetIndexes(T,S){return e5.forEach(this.getSubTargets(S),S=>this.getIndexType(T,S).next(R=>{if(0===R||1===R){let R=new ue(S).buildTargetIndex();if(null!=R)return this.addFieldIndex(T,R)}}))}getDocumentsMatchingTarget(T,S){let R=uT(T),O=!0,N=new Map;return e5.forEach(this.getSubTargets(S),S=>this.getFieldIndex(T,S).next(T=>{O&&(O=!!T),N.set(S,T)})).next(()=>{if(!O)return e5.resolve(null);{let T=sD(),O=[];return e5.forEach(N,(N,P)=>{eu(um,`Using index ${eY(N)} to execute ${iz(S)}`);let M=iK(P,N),L=iW(P,N),U=iQ(P,N),V=iY(P,N),$=this.encodeBound(N,P,U),K=this.encodeBound(N,P,V),W=this.encodeValues(N,P,L),Q=this.generateIndexRanges(N.indexId,M,$,U.inclusive,K,V.inclusive,W);return e5.forEach(Q,N=>R.loadFirst(N,S.limit).next(S=>{S.forEach(S=>{let R=ez.fromSegments(S.documentKey);T.has(R)||(T=T.add(R),O.push(R))})}))}).next(()=>O)}})}getSubTargets(T){let S=this.targetToDnfSubTargets.get(T);return S||(S=0===T.filters.length?[T]:ur(ib.create(T.filters,"and")).map(S=>iV(T.path,T.collectionGroup,T.orderBy,S.getFilters(),T.limit,T.startAt,T.endAt)),this.targetToDnfSubTargets.set(T,S)),S}generateIndexRanges(T,S,R,O,N,P,M){let L=(null!=S?S.length:1)*Math.max(R.length,N.length),U=L/(null!=S?S.length:1),V=[];for(let $=0;$<L;++$){let L=S?this.encodeSingleElement(S[$/U]):uy,K=this.generateLowerBound(T,L,R[$%U],O),W=this.generateUpperBound(T,L,N[$%U],P),Q=M.map(S=>this.generateLowerBound(T,L,S,!0));V.push(...this.createRange(K,W,Q))}return V}generateLowerBound(T,S,R,O){let N=new l5(T,ez.empty(),S,R);return O?N:N.successor()}generateUpperBound(T,S,R,O){let N=new l5(T,ez.empty(),S,R);return O?N.successor():N}getFieldIndex(T,S){let R=new ue(S),O=null!=S.collectionGroup?S.collectionGroup:S.path.lastSegment();return this.getFieldIndexes(T,O).next(T=>{let S=null;for(let O of T)R.servedByIndex(O)&&(!S||O.fields.length>S.fields.length)&&(S=O);return S})}getIndexType(T,S){let R=2,O=this.getSubTargets(S);return e5.forEach(O,S=>this.getFieldIndex(T,S).next(T=>{T?0!==R&&T.fields.length<iZ(S)&&(R=1):R=0})).next(()=>i0(S)&&O.length>1&&2===R?1:R)}encodeDirectionalElements(T,S){let R=new l9;for(let O of eK(T)){let T=S.data.field(O.fieldPath);if(null==T)return null;let N=R.forKind(O.kind);lV.INSTANCE.writeIndexValue(T,N)}return R.encodedBytes()}encodeSingleElement(T){let S=new l9;return lV.INSTANCE.writeIndexValue(T,S.forKind(0)),S.encodedBytes()}encodeDirectionalKey(T,S){let R=new l9;return lV.INSTANCE.writeIndexValue(n$(this.databaseId,S),R.forKind(eW(T))),R.encodedBytes()}encodeValues(T,S,R){if(null===R)return[];let O=[];O.push(new l9);let N=0;for(let P of eK(T)){let T=R[N++];for(let R of O)if(this.isInFilter(S,P.fieldPath)&&nY(T))O=this.expandIndexValues(O,P,T);else{let S=R.forKind(P.kind);lV.INSTANCE.writeIndexValue(T,S)}}return this.getEncodedBytes(O)}encodeBound(T,S,R){return this.encodeValues(T,S,R.position)}getEncodedBytes(T){let S=[];for(let R=0;R<T.length;++R)S[R]=T[R].encodedBytes();return S}expandIndexValues(T,S,R){let O=[...T],N=[];for(let T of R.arrayValue.values||[])for(let R of O){let O=new l9;O.seed(R.encodedBytes()),lV.INSTANCE.writeIndexValue(T,O.forKind(S.kind)),N.push(O)}return N}isInFilter(T,S){return!!T.filters.find(T=>T instanceof iv&&T.field.isEqual(S)&&("in"===T.op||"not-in"===T.op))}getFieldIndexes(T,S){let R=uS(T),O=u_(T);return(S?R.loadAll(ro,IDBKeyRange.bound(S,S)):R.loadAll()).next(T=>{let S=[];return e5.forEach(T,T=>O.get([T.indexId,this.uid]).next(R=>{S.push(lb(T,R))})).next(()=>S)})}getNextCollectionGroupToUpdate(T){return this.getFieldIndexes(T).next(T=>0===T.length?null:(T.sort((T,S)=>{let R=T.indexState.sequenceNumber-S.indexState.sequenceNumber;return 0!==R?R:ek(T.collectionGroup,S.collectionGroup)}),T[0].collectionGroup))}updateCollectionGroup(T,S,R){let O=uS(T),N=u_(T);return this.getNextSequenceNumber(T).next(T=>O.loadAll(ro,IDBKeyRange.bound(S,S)).next(S=>e5.forEach(S,S=>N.put(lT(S.indexId,this.uid,T,R)))))}updateIndexEntries(T,S){let R=new Map;return e5.forEach(S,(S,O)=>{let N=R.get(S.collectionGroup);return(N?e5.resolve(N):this.getFieldIndexes(T,S.collectionGroup)).next(N=>(R.set(S.collectionGroup,N),e5.forEach(N,R=>this.getExistingIndexEntries(T,S,R).next(S=>{let N=this.computeIndexEntries(O,R);return S.isEqual(N)?e5.resolve():this.updateEntries(T,O,R,S,N)}))))})}addIndexEntry(T,S,R,O){return uT(T).put({indexId:O.indexId,uid:this.uid,arrayValue:O.arrayValue,directionalValue:O.directionalValue,orderedDocumentKey:this.encodeDirectionalKey(R,S.key),documentKey:S.key.path.toArray()})}deleteIndexEntry(T,S,R,O){return uT(T).delete([O.indexId,this.uid,O.arrayValue,O.directionalValue,this.encodeDirectionalKey(R,S.key),S.key.path.toArray()])}getExistingIndexEntries(T,S,R){let O=uT(T),N=new rq(l8);return O.iterate({index:rg,range:IDBKeyRange.only([R.indexId,this.uid,this.encodeDirectionalKey(R,S)])},(T,O)=>{N=N.add(new l5(R.indexId,S,O.arrayValue,O.directionalValue))}).next(()=>N)}computeIndexEntries(T,S){let R=new rq(l8),O=this.encodeDirectionalElements(S,T);if(null==O)return R;let N=e$(S);if(null!=N){let P=T.data.field(N.fieldPath);if(nY(P))for(let N of P.arrayValue.values||[])R=R.add(new l5(S.indexId,T.key,this.encodeSingleElement(N),O))}else R=R.add(new l5(S.indexId,T.key,uy,O));return R}updateEntries(T,S,R,O,N){eu(um,"Updating index entries for document '%s'",S.key);let P=[];return rH(O,N,l8,O=>{P.push(this.addIndexEntry(T,S,R,O))},O=>{P.push(this.deleteIndexEntry(T,S,R,O))}),e5.waitFor(P)}getNextSequenceNumber(T){let S=1;return u_(T).iterate({index:rd,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(T,R,O)=>{O.done(),S=R.sequenceNumber+1}).next(()=>S)}createRange(T,S,R){R=R.sort((T,S)=>l8(T,S)).filter((T,S,R)=>!S||0!==l8(T,R[S-1]));let O=[];for(let N of(O.push(T),R)){let R=l8(N,T),P=l8(N,S);if(0===R)O[0]=T.successor();else if(R>0&&P<0)O.push(N),O.push(N.successor());else if(P>0)break}O.push(S);let N=[];for(let T=0;T<O.length;T+=2){if(this.isRangeMatchable(O[T],O[T+1]))return[];let S=[O[T].indexId,this.uid,O[T].arrayValue,O[T].directionalValue,uy,[]],R=[O[T+1].indexId,this.uid,O[T+1].arrayValue,O[T+1].directionalValue,uy,[]];N.push(IDBKeyRange.bound(S,R))}return N}isRangeMatchable(T,S){return l8(T,S)>0}getMinOffsetFromCollectionGroup(T,S){return this.getFieldIndexes(T,S).next(uE)}getMinOffset(T,S){return e5.mapArray(this.getSubTargets(S),S=>this.getFieldIndex(T,S).next(T=>T||ef())).next(uE)}}function ub(T){return rx(T,t9)}function uT(T){return rx(T,rf)}function uS(T){return rx(T,rs)}function u_(T){return rx(T,ru)}function uE(T){ep(0!==T.length);let S=T[0].indexState.offset,R=S.largestBatchId;for(let O=1;O<T.length;O++){let N=T[O].indexState.offset;0>e3(N,S)&&(S=N),R<N.largestBatchId&&(R=N.largestBatchId)}return new e2(S.readTime,S.documentKey,R)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(T,S,R){let O=T.store(tD),N=T.store(tV),P=[],M=IDBKeyRange.only(R.batchId),L=0,U=O.iterate({range:M},(T,S,R)=>(L++,R.delete()));P.push(U.next(()=>{ep(1===L)}));let V=[];for(let T of R.mutations){let O=tU(S,T.key.path,R.batchId);P.push(N.delete(O)),V.push(T.key)}return e5.waitFor(P).next(()=>V)}function uC(T){let S;if(!T)return 0;if(T.document)S=T.document;else if(T.unknownDocument)S=T.unknownDocument;else if(T.noDocument)S=T.noDocument;else throw ef();return JSON.stringify(S).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(T,S,R,O){this.userId=T,this.serializer=S,this.indexManager=R,this.referenceDelegate=O,this.documentKeysByBatchId={}}static forUser(T,S,R,O){return ep(""!==T.uid),new uI(T.isAuthenticated()?T.uid:"",S,R,O)}checkEmpty(T){let S=!0,R=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return uA(T).iterate({index:tM,range:R},(T,R,O)=>{S=!1,O.done()}).next(()=>S)}addMutationBatch(T,S,R,O){let N=uk(T),P=uA(T);return P.add({}).next(M=>{ep("number"==typeof M);let L=new ag(M,S,R,O),U=lr(this.serializer,this.userId,L),V=[],$=new rq((T,S)=>ek(T.canonicalString(),S.canonicalString()));for(let T of O){let S=tU(this.userId,T.key.path,M);$=$.add(T.key.path.popLast()),V.push(P.put(U)),V.push(N.put(S,tB))}return $.forEach(S=>{V.push(this.indexManager.addToCollectionParentIndex(T,S))}),T.addOnCommittedListener(()=>{this.documentKeysByBatchId[M]=L.keys()}),e5.waitFor(V).next(()=>L)})}lookupMutationBatch(T,S){return uA(T).get(S).next(T=>T?(ep(T.userId===this.userId),ln(this.serializer,T)):null)}lookupMutationKeys(T,S){return this.documentKeysByBatchId[S]?e5.resolve(this.documentKeysByBatchId[S]):this.lookupMutationBatch(T,S).next(T=>{if(!T)return null;{let R=T.keys();return this.documentKeysByBatchId[S]=R,R}})}getNextMutationBatchAfterBatchId(T,S){let R=S+1,O=IDBKeyRange.lowerBound([this.userId,R]),N=null;return uA(T).iterate({index:tM,range:O},(T,S,O)=>{S.userId===this.userId&&(ep(S.batchId>=R),N=ln(this.serializer,S)),O.done()}).next(()=>N)}getHighestUnacknowledgedBatchId(T){let S=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),R=no;return uA(T).iterate({index:tM,range:S,reverse:!0},(T,S,O)=>{R=S.batchId,O.done()}).next(()=>R)}getAllMutationBatches(T){let S=IDBKeyRange.bound([this.userId,no],[this.userId,Number.POSITIVE_INFINITY]);return uA(T).loadAll(tM,S).next(T=>T.map(T=>ln(this.serializer,T)))}getAllMutationBatchesAffectingDocumentKey(T,S){let R=tj(this.userId,S.path),O=IDBKeyRange.lowerBound(R),N=[];return uk(T).iterate({range:O},(R,O,P)=>{let[M,L,U]=R,V=tI(L);if(M!==this.userId||!S.path.isEqual(V)){P.done();return}return uA(T).get(U).next(T=>{if(!T)throw ef();ep(T.userId===this.userId),N.push(ln(this.serializer,T))})}).next(()=>N)}getAllMutationBatchesAffectingDocumentKeys(T,S){let R=new rq(ek),O=[];return S.forEach(S=>{let N=tj(this.userId,S.path),P=IDBKeyRange.lowerBound(N),M=uk(T).iterate({range:P},(T,O,N)=>{let[P,M,L]=T,U=tI(M);if(P!==this.userId||!S.path.isEqual(U)){N.done();return}R=R.add(L)});O.push(M)}),e5.waitFor(O).next(()=>this.lookupMutationBatches(T,R))}getAllMutationBatchesAffectingQuery(T,S){let R=S.path,O=R.length+1,N=tj(this.userId,R),P=IDBKeyRange.lowerBound(N),M=new rq(ek);return uk(T).iterate({range:P},(T,S,N)=>{let[P,L,U]=T,V=tI(L);if(P!==this.userId||!R.isPrefixOf(V)){N.done();return}V.length===O&&(M=M.add(U))}).next(()=>this.lookupMutationBatches(T,M))}lookupMutationBatches(T,S){let R=[],O=[];return S.forEach(S=>{O.push(uA(T).get(S).next(T=>{if(null===T)throw ef();ep(T.userId===this.userId),R.push(ln(this.serializer,T))}))}),e5.waitFor(O).next(()=>R)}removeMutationBatch(T,S){return uw(T.simpleDbTransaction,this.userId,S).next(R=>(T.addOnCommittedListener(()=>{this.removeCachedMutationKeys(S.batchId)}),e5.forEach(R,S=>this.referenceDelegate.markPotentiallyOrphaned(T,S))))}removeCachedMutationKeys(T){delete this.documentKeysByBatchId[T]}performConsistencyCheck(T){return this.checkEmpty(T).next(S=>{if(!S)return e5.resolve();let R=IDBKeyRange.lowerBound(tF(this.userId)),O=[];return uk(T).iterate({range:R},(T,S,R)=>{if(T[0]!==this.userId){R.done();return}{let S=tI(T[1]);O.push(S)}}).next(()=>{ep(0===O.length)})})}containsKey(T,S){return uR(T,this.userId,S)}getMutationQueueMetadata(T){return uN(T).get(this.userId).next(T=>T||{userId:this.userId,lastAcknowledgedBatchId:no,lastStreamToken:""})}}function uR(T,S,R){let O=tj(S,R.path),N=O[1],P=IDBKeyRange.lowerBound(O),M=!1;return uk(T).iterate({range:P,keysOnly:!0},(T,R,O)=>{let[P,L,U]=T;P===S&&L===N&&(M=!0),O.done()}).next(()=>M)}function uO(T,S){let R=!1;return uN(T).iterateSerial(O=>uR(T,O,S).next(T=>(T&&(R=!0),e5.resolve(!T)))).next(()=>R)}function uA(T){return rx(T,tD)}function uk(T){return rx(T,tV)}function uN(T){return rx(T,tk)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uD=2;class uP{constructor(T){this.lastId=T}next(){return this.lastId+=uD,this.lastId}static forTargetCache(){return new uP(2-uD)}static forSyncEngine(){return new uP(1-uD)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(T,S){this.referenceDelegate=T,this.serializer=S}allocateTargetId(T){return this.retrieveMetadata(T).next(S=>{let R=new uP(S.highestTargetId);return S.highestTargetId=R.next(),this.saveMetadata(T,S).next(()=>S.highestTargetId)})}getLastRemoteSnapshotVersion(T){return this.retrieveMetadata(T).next(T=>eL.fromTimestamp(new eM(T.lastRemoteSnapshotVersion.seconds,T.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(T){return this.retrieveMetadata(T).next(T=>T.highestListenSequenceNumber)}setTargetsMetadata(T,S,R){return this.retrieveMetadata(T).next(O=>(O.highestListenSequenceNumber=S,R&&(O.lastRemoteSnapshotVersion=R.toTimestamp()),S>O.highestListenSequenceNumber&&(O.highestListenSequenceNumber=S),this.saveMetadata(T,O)))}addTargetData(T,S){return this.saveTargetData(T,S).next(()=>this.retrieveMetadata(T).next(R=>(R.targetCount+=1,this.updateMetadataFromTargetData(S,R),this.saveMetadata(T,R))))}updateTargetData(T,S){return this.saveTargetData(T,S)}removeTargetData(T,S){return this.removeMatchingKeysForTargetId(T,S.targetId).next(()=>uM(T).delete(S.targetId)).next(()=>this.retrieveMetadata(T)).next(S=>(ep(S.targetCount>0),S.targetCount-=1,this.saveMetadata(T,S)))}removeTargets(T,S,R){let O=0,N=[];return uM(T).iterate((P,M)=>{let L=li(M);L.sequenceNumber<=S&&null===R.get(L.targetId)&&(O++,N.push(this.removeTargetData(T,L)))}).next(()=>e5.waitFor(N)).next(()=>O)}forEachTarget(T,S){return uM(T).iterate((T,R)=>{S(li(R))})}retrieveMetadata(T){return uL(T).get(t4).next(T=>(ep(null!==T),T))}saveMetadata(T,S){return uL(T).put(t4,S)}saveTargetData(T,S){return uM(T).put(ls(this.serializer,S))}updateMetadataFromTargetData(T,S){let R=!1;return T.targetId>S.highestTargetId&&(S.highestTargetId=T.targetId,R=!0),T.sequenceNumber>S.highestListenSequenceNumber&&(S.highestListenSequenceNumber=T.sequenceNumber,R=!0),R}getTargetCount(T){return this.retrieveMetadata(T).next(T=>T.targetCount)}getTargetData(T,S){let R=iz(S),O=IDBKeyRange.bound([R,Number.NEGATIVE_INFINITY],[R,Number.POSITIVE_INFINITY]),N=null;return uM(T).iterate({range:O,index:tX},(T,R,O)=>{let P=li(R);iG(S,P.target)&&(N=P,O.done())}).next(()=>N)}addMatchingKeys(T,S,R){let O=[],N=uF(T);return S.forEach(S=>{let P=tE(S.path);O.push(N.put({targetId:R,path:P})),O.push(this.referenceDelegate.addReference(T,R,S))}),e5.waitFor(O)}removeMatchingKeys(T,S,R){let O=uF(T);return e5.forEach(S,S=>{let N=tE(S.path);return e5.waitFor([O.delete([R,N]),this.referenceDelegate.removeReference(T,R,S)])})}removeMatchingKeysForTargetId(T,S){let R=uF(T),O=IDBKeyRange.bound([S],[S+1],!1,!0);return R.delete(O)}getMatchingKeysForTargetId(T,S){let R=IDBKeyRange.bound([S],[S+1],!1,!0),O=uF(T),N=sD();return O.iterate({range:R,keysOnly:!0},(T,S,R)=>{let O=new ez(tI(T[1]));N=N.add(O)}).next(()=>N)}containsKey(T,S){let R=tE(S.path),O=IDBKeyRange.bound([R],[eD(R)],!1,!0),N=0;return uF(T).iterate({index:t2,keysOnly:!0,range:O},([T,S],R,O)=>{0!==T&&(N++,O.done())}).next(()=>N>0)}getTargetDataForTarget(T,S){return uM(T).get(S).next(T=>T?li(T):null)}}function uM(T){return rx(T,tY)}function uL(T){return rx(T,t6)}function uF(T){return rx(T,t0)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uj={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uU=-1,uB=41943040;class uV{constructor(T,S,R){this.cacheSizeCollectionThreshold=T,this.percentileToCollect=S,this.maximumSequenceNumbersToCollect=R}static withCacheSize(T){return new uV(T,uV.DEFAULT_COLLECTION_PERCENTILE,uV.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}uV.DEFAULT_COLLECTION_PERCENTILE=10,uV.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uV.DEFAULT=new uV(uB,uV.DEFAULT_COLLECTION_PERCENTILE,uV.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uV.DISABLED=new uV(uU,0,0);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uz="LruGarbageCollector",uq=1048576,uG=null,uH=null;function u$([T,S],[R,O]){let N=ek(T,R);return 0===N?ek(S,O):N}class uK{constructor(T){this.maxElements=T,this.buffer=new rq(u$),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(T){let S=[T,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(S);else{let T=this.buffer.last();0>u$(S,T)&&(this.buffer=this.buffer.delete(T).add(S))}}get maxValue(){return this.buffer.last()[0]}}class uW{constructor(T,S,R){this.garbageCollector=T,this.asyncQueue=S,this.localStore=R,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==uU&&this.scheduleGC(uG)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(T){eu(uz,`Garbage collection scheduled in ${T}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",T,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(T){ta(T)?eu(uz,"Ignoring IndexedDB error during garbage collection: ",T):await e9(T)}await this.scheduleGC(uH)})}}class uQ{constructor(T,S){this.delegate=T,this.params=S}calculateTargetCount(T,S){return this.delegate.getSequenceNumberCount(T).next(T=>Math.floor(S/100*T))}nthSequenceNumber(T,S){if(0===S)return e5.resolve(tv.INVALID);let R=new uK(S);return this.delegate.forEachTarget(T,T=>R.addElement(T.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(T,T=>R.addElement(T))).next(()=>R.maxValue)}removeTargets(T,S,R){return this.delegate.removeTargets(T,S,R)}removeOrphanedDocuments(T,S){return this.delegate.removeOrphanedDocuments(T,S)}collect(T,S){return this.params.cacheSizeCollectionThreshold===uU?(eu("LruGarbageCollector","Garbage collection skipped; disabled"),e5.resolve(uj)):this.getCacheSize(T).next(R=>R<this.params.cacheSizeCollectionThreshold?(eu("LruGarbageCollector",`Garbage collection skipped; Cache size ${R} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uj):this.runGarbageCollection(T,S))}getCacheSize(T){return this.delegate.getCacheSize(T)}runGarbageCollection(T,S){let R,O,N,P,M,L,U;let V=Date.now();return this.calculateTargetCount(T,this.params.percentileToCollect).next(S=>(S>this.params.maximumSequenceNumbersToCollect?(eu("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),O=this.params.maximumSequenceNumbersToCollect):O=S,P=Date.now(),this.nthSequenceNumber(T,O))).next(O=>(R=O,M=Date.now(),this.removeTargets(T,R,S))).next(S=>(N=S,L=Date.now(),this.removeOrphanedDocuments(T,R))).next(T=>(U=Date.now(),eo()<=LogLevel.DEBUG&&eu("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${P-V}ms
	Determined least recently used ${O} in ${M-P}ms
	Removed ${N} targets in ${L-M}ms
	Removed ${T} documents in ${U-L}ms
Total Duration: ${U-V}ms`),e5.resolve({didRun:!0,sequenceNumbersCollected:O,targetsRemoved:N,documentsRemoved:T})))}}function uY(T,S){return new uQ(T,S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uJ{constructor(T,S){this.db=T,this.garbageCollector=uY(this,S)}getSequenceNumberCount(T){let S=this.orphanedDocumentCount(T);return this.db.getTargetCache().getTargetCount(T).next(T=>S.next(S=>T+S))}orphanedDocumentCount(T){let S=0;return this.forEachOrphanedDocumentSequenceNumber(T,T=>{S++}).next(()=>S)}forEachTarget(T,S){return this.db.getTargetCache().forEachTarget(T,S)}forEachOrphanedDocumentSequenceNumber(T,S){return this.forEachOrphanedDocument(T,(T,R)=>S(R))}addReference(T,S,R){return u0(T,R)}removeReference(T,S,R){return u0(T,R)}removeTargets(T,S,R){return this.db.getTargetCache().removeTargets(T,S,R)}markPotentiallyOrphaned(T,S){return u0(T,S)}isPinned(T,S){return uO(T,S)}removeOrphanedDocuments(T,S){let R=this.db.getRemoteDocumentCache().newChangeBuffer(),O=[],N=0;return this.forEachOrphanedDocument(T,(P,M)=>{if(M<=S){let S=this.isPinned(T,P).next(S=>{if(!S)return N++,R.getEntry(T,P).next(()=>(R.removeEntry(P,eL.min()),uF(T).delete(uX(P))))});O.push(S)}}).next(()=>e5.waitFor(O)).next(()=>R.apply(T)).next(()=>N)}removeTarget(T,S){let R=S.withSequenceNumber(T.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(T,R)}updateLimboDocument(T,S){return u0(T,S)}forEachOrphanedDocument(T,S){let R;let O=uF(T),N=tv.INVALID;return O.iterate({index:t2},([T,O],{path:P,sequenceNumber:M})=>{0===T?(N!==tv.INVALID&&S(new ez(tI(R)),N),N=M,R=P):N=tv.INVALID}).next(()=>{N!==tv.INVALID&&S(new ez(tI(R)),N)})}getCacheSize(T){return this.db.getRemoteDocumentCache().getSize(T)}}function uX(T){return[0,tE(T.path)]}function uZ(T,S){return{targetId:0,path:tE(T.path),sequenceNumber:S}}function u0(T,S){return uF(T).put(uZ(S,T.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(){this.changes=new sb(T=>T.toString(),(T,S)=>T.isEqual(S)),this.changesApplied=!1}addEntry(T){this.assertNotApplied(),this.changes.set(T.key,T)}removeEntry(T,S){this.assertNotApplied(),this.changes.set(T,ii.newInvalidDocument(T).setReadTime(S))}getEntry(T,S){this.assertNotApplied();let R=this.changes.get(S);return void 0!==R?e5.resolve(R):this.getFromCache(T,S)}getEntries(T,S){return this.getAllFromCache(T,S)}apply(T){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(T)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(T){this.serializer=T}setIndexManager(T){this.indexManager=T}addEntry(T,S,R){return u9(T).put(R)}removeEntry(T,S,R){return u9(T).delete(u8(S,R))}updateMetadata(T,S){return this.getMetadata(T).next(R=>(R.byteSize+=S,this.setMetadata(T,R)))}getEntry(T,S){let R=ii.newInvalidDocument(S);return u9(T).iterate({index:tG,range:IDBKeyRange.only(u5(S))},(T,O)=>{R=this.maybeDecodeDocument(S,O)}).next(()=>R)}getSizedEntry(T,S){let R={size:0,document:ii.newInvalidDocument(S)};return u9(T).iterate({index:tG,range:IDBKeyRange.only(u5(S))},(T,O)=>{R={document:this.maybeDecodeDocument(S,O),size:uC(O)}}).next(()=>R)}getEntries(T,S){let R=sS();return this.forEachDbEntry(T,S,(T,S)=>{let O=this.maybeDecodeDocument(T,S);R=R.insert(T,O)}).next(()=>R)}getSizedEntries(T,S){let R=sS(),O=new rU(ez.comparator);return this.forEachDbEntry(T,S,(T,S)=>{let N=this.maybeDecodeDocument(T,S);R=R.insert(T,N),O=O.insert(T,uC(S))}).next(()=>({documents:R,sizeMap:O}))}forEachDbEntry(T,S,R){if(S.isEmpty())return e5.resolve();let O=new rq(ce);S.forEach(T=>O=O.add(T));let N=IDBKeyRange.bound(u5(O.first()),u5(O.last())),P=O.getIterator(),M=P.getNext();return u9(T).iterate({index:tG,range:N},(T,S,O)=>{let N=ez.fromSegments([...S.prefixPath,S.collectionGroup,S.documentId]);for(;M&&0>ce(M,N);)R(M,null),M=P.getNext();M&&M.isEqual(N)&&(R(M,S),M=P.hasNext()?P.getNext():null),M?O.skip(u5(M)):O.done()}).next(()=>{for(;M;)R(M,null),M=P.hasNext()?P.getNext():null})}getDocumentsMatchingQuery(T,S,R,O,N){let P=S.path,M=[P.popLast().toArray(),P.lastSegment(),o5(R.readTime),R.documentKey.path.isEmpty()?"":R.documentKey.path.lastSegment()],L=[P.popLast().toArray(),P.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return u9(T).loadAll(IDBKeyRange.bound(M,L,!0)).next(T=>{null==N||N.incrementDocumentReadCount(T.length);let R=sS();for(let N of T){let T=this.maybeDecodeDocument(ez.fromSegments(N.prefixPath.concat(N.collectionGroup,N.documentId)),N);T.isFoundDocument()&&(sd(S,T)||O.has(T.key))&&(R=R.insert(T.key,T))}return R})}getAllFromCollectionGroup(T,S,R,O){let N=sS(),P=u7(S,R),M=u7(S,e2.max());return u9(T).iterate({index:t$,range:IDBKeyRange.bound(P,M,!0)},(T,S,R)=>{let P=this.maybeDecodeDocument(ez.fromSegments(S.prefixPath.concat(S.collectionGroup,S.documentId)),S);(N=N.insert(P.key,P)).size===O&&R.done()}).next(()=>N)}newChangeBuffer(T){return new u4(this,!!T&&T.trackRemovals)}getSize(T){return this.getMetadata(T).next(T=>T.byteSize)}getMetadata(T){return u6(T).get(tQ).next(T=>(ep(!!T),T))}setMetadata(T,S){return u6(T).put(tQ,S)}maybeDecodeDocument(T,S){if(S){let T=o6(this.serializer,S);if(!(T.isNoDocument()&&T.version.isEqual(eL.min())))return T}return ii.newInvalidDocument(T)}}function u3(T){return new u2(T)}class u4 extends null{constructor(T,S){super(),this.documentCache=T,this.trackRemovals=S,this.documentStates=new sb(T=>T.toString(),(T,S)=>T.isEqual(S))}applyChanges(T){let S=[],R=0,O=new rq((T,S)=>ek(T.canonicalString(),S.canonicalString()));return this.changes.forEach((N,P)=>{let M=this.documentStates.get(N);if(S.push(this.documentCache.removeEntry(T,N,M.readTime)),P.isValidDocument()){let L=o9(this.documentCache.serializer,P);O=O.add(N.path.popLast());let U=uC(L);R+=U-M.size,S.push(this.documentCache.addEntry(T,N,L))}else if(R-=M.size,this.trackRemovals){let R=o9(this.documentCache.serializer,P.convertToNoDocument(eL.min()));S.push(this.documentCache.addEntry(T,N,R))}}),O.forEach(R=>{S.push(this.documentCache.indexManager.addToCollectionParentIndex(T,R))}),S.push(this.documentCache.updateMetadata(T,R)),e5.waitFor(S)}getFromCache(T,S){return this.documentCache.getSizedEntry(T,S).next(T=>(this.documentStates.set(S,{size:T.size,readTime:T.document.readTime}),T.document))}getAllFromCache(T,S){return this.documentCache.getSizedEntries(T,S).next(({documents:T,sizeMap:S})=>(S.forEach((S,R)=>{this.documentStates.set(S,{size:R,readTime:T.get(S).readTime})}),T))}}function u6(T){return rx(T,tW)}function u9(T){return rx(T,tz)}function u5(T){let S=T.path.toArray();return[S.slice(0,S.length-2),S[S.length-2],S[S.length-1]]}function u8(T,S){let R=T.path.toArray();return[R.slice(0,R.length-2),R[R.length-2],o5(S),R[R.length-1]]}function u7(T,S){let R=S.documentKey.path.toArray();return[T,o5(S.readTime),R.slice(0,R.length-2),R.length>0?R[R.length-1]:""]}function ce(T,S){let R=T.path.toArray(),O=S.path.toArray(),N=0;for(let T=0;T<R.length-2&&T<O.length-2;++T)if(N=ek(R[T],O[T]))return N;return(N=ek(R.length,O.length))||(N=ek(R[R.length-2],O[O.length-2]))?N:ek(R[R.length-1],O[O.length-1])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ct=17;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(T,S){this.overlayedDocument=T,this.mutatedFields=S}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(T,S,R,O){this.remoteDocumentCache=T,this.mutationQueue=S,this.documentOverlayCache=R,this.indexManager=O}getDocument(T,S){let R=null;return this.documentOverlayCache.getOverlay(T,S).next(O=>(R=O,this.remoteDocumentCache.getEntry(T,S))).next(T=>(null!==R&&s7(R.mutation,T,rK.empty(),eM.now()),T))}getDocuments(T,S){return this.remoteDocumentCache.getEntries(T,S).next(S=>this.getLocalViewOfDocuments(T,S,sD()).next(()=>S))}getLocalViewOfDocuments(T,S,R=sD()){let O=sI();return this.populateOverlays(T,O,S).next(()=>this.computeViews(T,S,O,R).next(T=>{let S=sE();return T.forEach((T,R)=>{S=S.insert(T,R.overlayedDocument)}),S}))}getOverlayedDocuments(T,S){let R=sI();return this.populateOverlays(T,R,S).next(()=>this.computeViews(T,S,R,sD()))}populateOverlays(T,S,R){let O=[];return R.forEach(T=>{S.has(T)||O.push(T)}),this.documentOverlayCache.getOverlays(T,O).next(T=>{T.forEach((T,R)=>{S.set(T,R)})})}computeViews(T,S,R,O){let N=sS(),P=sO(),M=sw();return S.forEach((T,S)=>{let M=R.get(S.key);O.has(S.key)&&(void 0===M||M.mutation instanceof as)?N=N.insert(S.key,S):void 0!==M?(P.set(S.key,M.mutation.getFieldMask()),s7(M.mutation,S,M.mutation.getFieldMask(),eM.now())):P.set(S.key,rK.empty())}),this.recalculateAndSaveOverlays(T,N).next(T=>(T.forEach((T,S)=>P.set(T,S)),S.forEach((T,S)=>{var R;return M.set(T,new cr(S,null!==(R=P.get(T))&&void 0!==R?R:null))}),M))}recalculateAndSaveOverlays(T,S){let R=sO(),O=new rU((T,S)=>T-S),N=sD();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(T,S).next(T=>{for(let N of T)N.keys().forEach(T=>{let P=S.get(T);if(null===P)return;let M=R.get(T)||rK.empty();M=N.applyToLocalView(P,M),R.set(T,M);let L=(O.get(N.batchId)||sD()).add(T);O=O.insert(N.batchId,L)})}).next(()=>{let P=[],M=O.getReverseIterator();for(;M.hasNext();){let O=M.getNext(),L=O.key,U=O.value,V=sR();U.forEach(T=>{if(!N.has(T)){let O=s5(S.get(T),R.get(T));null!==O&&V.set(T,O),N=N.add(T)}}),P.push(this.documentOverlayCache.saveOverlays(T,L,V))}return e5.waitFor(P)}).next(()=>R)}recalculateAndSaveOverlaysForDocumentKeys(T,S){return this.remoteDocumentCache.getEntries(T,S).next(S=>this.recalculateAndSaveOverlays(T,S))}getDocumentsMatchingQuery(T,S,R,O){return i5(S)?this.getDocumentsMatchingDocumentQuery(T,S.path):i8(S)?this.getDocumentsMatchingCollectionGroupQuery(T,S,R,O):this.getDocumentsMatchingCollectionQuery(T,S,R,O)}getNextDocuments(T,S,R,O){return this.remoteDocumentCache.getAllFromCollectionGroup(T,S,R,O).next(N=>{let P=O-N.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(T,S,R.largestBatchId,O-N.size):e5.resolve(sI()),M=eq,L=N;return P.next(S=>e5.forEach(S,(S,R)=>(M<R.largestBatchId&&(M=R.largestBatchId),N.get(S))?e5.resolve():this.remoteDocumentCache.getEntry(T,S).next(T=>{L=L.insert(S,T)})).next(()=>this.populateOverlays(T,S,N)).next(()=>this.computeViews(T,L,S,sD())).next(T=>({batchId:M,changes:sC(T)})))})}getDocumentsMatchingDocumentQuery(T,S){return this.getDocument(T,new ez(S)).next(T=>{let S=sE();return T.isFoundDocument()&&(S=S.insert(T.key,T)),S})}getDocumentsMatchingCollectionGroupQuery(T,S,R,O){let N=S.collectionGroup,P=sE();return this.indexManager.getCollectionParents(T,N).next(M=>e5.forEach(M,M=>{let L=i4(S,M.child(N));return this.getDocumentsMatchingCollectionQuery(T,L,R,O).next(T=>{T.forEach((T,S)=>{P=P.insert(T,S)})})}).next(()=>P))}getDocumentsMatchingCollectionQuery(T,S,R,O){let N;return this.documentOverlayCache.getOverlaysForCollection(T,S.path,R.largestBatchId).next(P=>(N=P,this.remoteDocumentCache.getDocumentsMatchingQuery(T,S,R,N,O))).next(T=>{N.forEach((S,R)=>{let O=R.getKey();null===T.get(O)&&(T=T.insert(O,ii.newInvalidDocument(O)))});let R=sE();return T.forEach((T,O)=>{let P=N.get(T);void 0!==P&&s7(P.mutation,O,rK.empty(),eM.now()),sd(S,O)&&(R=R.insert(T,O))}),R})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(T){this.serializer=T,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(T,S){return e5.resolve(this.bundles.get(S))}saveBundleMetadata(T,S){return this.bundles.set(S.id,lp(S)),e5.resolve()}getNamedQuery(T,S){return e5.resolve(this.namedQueries.get(S))}saveNamedQuery(T,S){return this.namedQueries.set(S.name,lf(S)),e5.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(){this.overlays=new rU(ez.comparator),this.overlayByBatchId=new Map}getOverlay(T,S){return e5.resolve(this.overlays.get(S))}getOverlays(T,S){let R=sI();return e5.forEach(S,S=>this.getOverlay(T,S).next(T=>{null!==T&&R.set(S,T)})).next(()=>R)}saveOverlays(T,S,R){return R.forEach((R,O)=>{this.saveOverlay(T,S,O)}),e5.resolve()}removeOverlaysForBatchId(T,S,R){let O=this.overlayByBatchId.get(R);return void 0!==O&&(O.forEach(T=>this.overlays=this.overlays.remove(T)),this.overlayByBatchId.delete(R)),e5.resolve()}getOverlaysForCollection(T,S,R){let O=sI(),N=S.length+1,P=new ez(S.child("")),M=this.overlays.getIteratorFrom(P);for(;M.hasNext();){let T=M.getNext().value,P=T.getKey();if(!S.isPrefixOf(P.path))break;P.path.length===N&&T.largestBatchId>R&&O.set(T.getKey(),T)}return e5.resolve(O)}getOverlaysForCollectionGroup(T,S,R,O){let N=new rU((T,S)=>T-S),P=this.overlays.getIterator();for(;P.hasNext();){let T=P.getNext().value;if(T.getKey().getCollectionGroup()===S&&T.largestBatchId>R){let S=N.get(T.largestBatchId);null===S&&(S=sI(),N=N.insert(T.largestBatchId,S)),S.set(T.getKey(),T)}}let M=sI(),L=N.getIterator();for(;L.hasNext()&&(L.getNext().value.forEach((T,S)=>M.set(T,S)),!(M.size()>=O)););return e5.resolve(M)}saveOverlay(T,S,R){let O=this.overlays.get(R.key);if(null!==O){let T=this.overlayByBatchId.get(O.largestBatchId).delete(R.key);this.overlayByBatchId.set(O.largestBatchId,T)}this.overlays=this.overlays.insert(R.key,new ay(S,R));let N=this.overlayByBatchId.get(S);void 0===N&&(N=sD(),this.overlayByBatchId.set(S,N)),this.overlayByBatchId.set(S,N.add(R.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(){this.sessionToken=rY.EMPTY_BYTE_STRING}getSessionToken(T){return e5.resolve(this.sessionToken)}setSessionToken(T,S){return this.sessionToken=S,e5.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(){this.refsByKey=new rq(cl.compareByKey),this.refsByTarget=new rq(cl.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(T,S){let R=new cl(T,S);this.refsByKey=this.refsByKey.add(R),this.refsByTarget=this.refsByTarget.add(R)}addReferences(T,S){T.forEach(T=>this.addReference(T,S))}removeReference(T,S){this.removeRef(new cl(T,S))}removeReferences(T,S){T.forEach(T=>this.removeReference(T,S))}removeReferencesForId(T){let S=new ez(new eU([])),R=new cl(S,T),O=new cl(S,T+1),N=[];return this.refsByTarget.forEachInRange([R,O],T=>{this.removeRef(T),N.push(T.key)}),N}removeAllReferences(){this.refsByKey.forEach(T=>this.removeRef(T))}removeRef(T){this.refsByKey=this.refsByKey.delete(T),this.refsByTarget=this.refsByTarget.delete(T)}referencesForId(T){let S=new ez(new eU([])),R=new cl(S,T),O=new cl(S,T+1),N=sD();return this.refsByTarget.forEachInRange([R,O],T=>{N=N.add(T.key)}),N}containsKey(T){let S=new cl(T,0),R=this.refsByKey.firstAfterOrEqual(S);return null!==R&&T.isEqual(R.key)}}class cl{constructor(T,S){this.key=T,this.targetOrBatchId=S}static compareByKey(T,S){return ez.comparator(T.key,S.key)||ek(T.targetOrBatchId,S.targetOrBatchId)}static compareByTargetId(T,S){return ek(T.targetOrBatchId,S.targetOrBatchId)||ez.comparator(T.key,S.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(T,S){this.indexManager=T,this.referenceDelegate=S,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new rq(cl.compareByKey)}checkEmpty(T){return e5.resolve(0===this.mutationQueue.length)}addMutationBatch(T,S,R,O){let N=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let P=new ag(N,S,R,O);for(let S of(this.mutationQueue.push(P),O))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new cl(S.key,N)),this.indexManager.addToCollectionParentIndex(T,S.key.path.popLast());return e5.resolve(P)}lookupMutationBatch(T,S){return e5.resolve(this.findMutationBatch(S))}getNextMutationBatchAfterBatchId(T,S){let R=S+1,O=this.indexOfBatchId(R),N=O<0?0:O;return e5.resolve(this.mutationQueue.length>N?this.mutationQueue[N]:null)}getHighestUnacknowledgedBatchId(){return e5.resolve(0===this.mutationQueue.length?no:this.nextBatchId-1)}getAllMutationBatches(T){return e5.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(T,S){let R=new cl(S,0),O=new cl(S,Number.POSITIVE_INFINITY),N=[];return this.batchesByDocumentKey.forEachInRange([R,O],T=>{let S=this.findMutationBatch(T.targetOrBatchId);N.push(S)}),e5.resolve(N)}getAllMutationBatchesAffectingDocumentKeys(T,S){let R=new rq(ek);return S.forEach(T=>{let S=new cl(T,0),O=new cl(T,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([S,O],T=>{R=R.add(T.targetOrBatchId)})}),e5.resolve(this.findMutationBatches(R))}getAllMutationBatchesAffectingQuery(T,S){let R=S.path,O=R.length+1,N=R;ez.isDocumentKey(N)||(N=N.child(""));let P=new cl(new ez(N),0),M=new rq(ek);return this.batchesByDocumentKey.forEachWhile(T=>{let S=T.key.path;return!!R.isPrefixOf(S)&&(S.length===O&&(M=M.add(T.targetOrBatchId)),!0)},P),e5.resolve(this.findMutationBatches(M))}findMutationBatches(T){let S=[];return T.forEach(T=>{let R=this.findMutationBatch(T);null!==R&&S.push(R)}),S}removeMutationBatch(T,S){ep(0===this.indexOfExistingBatchId(S.batchId,"removed")),this.mutationQueue.shift();let R=this.batchesByDocumentKey;return e5.forEach(S.mutations,O=>{let N=new cl(O.key,S.batchId);return R=R.delete(N),this.referenceDelegate.markPotentiallyOrphaned(T,O.key)}).next(()=>{this.batchesByDocumentKey=R})}removeCachedMutationKeys(T){}containsKey(T,S){let R=new cl(S,0),O=this.batchesByDocumentKey.firstAfterOrEqual(R);return e5.resolve(S.isEqual(O&&O.key))}performConsistencyCheck(T){return this.mutationQueue.length,e5.resolve()}indexOfExistingBatchId(T,S){return this.indexOfBatchId(T)}indexOfBatchId(T){return 0===this.mutationQueue.length?0:T-this.mutationQueue[0].batchId}findMutationBatch(T){let S=this.indexOfBatchId(T);return S<0||S>=this.mutationQueue.length?null:this.mutationQueue[S]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(){return new rU(ez.comparator)}class cd{constructor(T){this.sizer=T,this.docs=cc(),this.size=0}setIndexManager(T){this.indexManager=T}addEntry(T,S){let R=S.key,O=this.docs.get(R),N=O?O.size:0,P=this.sizer(S);return this.docs=this.docs.insert(R,{document:S.mutableCopy(),size:P}),this.size+=P-N,this.indexManager.addToCollectionParentIndex(T,R.path.popLast())}removeEntry(T){let S=this.docs.get(T);S&&(this.docs=this.docs.remove(T),this.size-=S.size)}getEntry(T,S){let R=this.docs.get(S);return e5.resolve(R?R.document.mutableCopy():ii.newInvalidDocument(S))}getEntries(T,S){let R=sS();return S.forEach(T=>{let S=this.docs.get(T);R=R.insert(T,S?S.document.mutableCopy():ii.newInvalidDocument(T))}),e5.resolve(R)}getDocumentsMatchingQuery(T,S,R,O){let N=sS(),P=S.path,M=new ez(P.child("")),L=this.docs.getIteratorFrom(M);for(;L.hasNext();){let{key:T,value:{document:M}}=L.getNext();if(!P.isPrefixOf(T.path))break;!(T.path.length>P.length+1||0>=e3(e1(M),R))&&(O.has(M.key)||sd(S,M))&&(N=N.insert(M.key,M.mutableCopy()))}return e5.resolve(N)}getAllFromCollectionGroup(T,S,R,O){ef()}forEachDocumentKey(T,S){return e5.forEach(this.docs,T=>S(T))}newChangeBuffer(T){return new cf(this)}getSize(T){return e5.resolve(this.size)}}function ch(T){return new cd(T)}class cf extends u1{constructor(T){super(),this.documentCache=T}applyChanges(T){let S=[];return this.changes.forEach((R,O)=>{O.isValidDocument()?S.push(this.documentCache.addEntry(T,O)):this.documentCache.removeEntry(R)}),e5.waitFor(S)}getFromCache(T,S){return this.documentCache.getEntry(T,S)}getAllFromCache(T,S){return this.documentCache.getEntries(T,S)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(T){this.persistence=T,this.targets=new sb(T=>iz(T),iG),this.lastRemoteSnapshotVersion=eL.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new co,this.targetCount=0,this.targetIdGenerator=uP.forTargetCache()}forEachTarget(T,S){return this.targets.forEach((T,R)=>S(R)),e5.resolve()}getLastRemoteSnapshotVersion(T){return e5.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(T){return e5.resolve(this.highestSequenceNumber)}allocateTargetId(T){return this.highestTargetId=this.targetIdGenerator.next(),e5.resolve(this.highestTargetId)}setTargetsMetadata(T,S,R){return R&&(this.lastRemoteSnapshotVersion=R),S>this.highestSequenceNumber&&(this.highestSequenceNumber=S),e5.resolve()}saveTargetData(T){this.targets.set(T.target,T);let S=T.targetId;S>this.highestTargetId&&(this.targetIdGenerator=new uP(S),this.highestTargetId=S),T.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=T.sequenceNumber)}addTargetData(T,S){return this.saveTargetData(S),this.targetCount+=1,e5.resolve()}updateTargetData(T,S){return this.saveTargetData(S),e5.resolve()}removeTargetData(T,S){return this.targets.delete(S.target),this.references.removeReferencesForId(S.targetId),this.targetCount-=1,e5.resolve()}removeTargets(T,S,R){let O=0,N=[];return this.targets.forEach((P,M)=>{M.sequenceNumber<=S&&null===R.get(M.targetId)&&(this.targets.delete(P),N.push(this.removeMatchingKeysForTargetId(T,M.targetId)),O++)}),e5.waitFor(N).next(()=>O)}getTargetCount(T){return e5.resolve(this.targetCount)}getTargetData(T,S){let R=this.targets.get(S)||null;return e5.resolve(R)}addMatchingKeys(T,S,R){return this.references.addReferences(S,R),e5.resolve()}removeMatchingKeys(T,S,R){this.references.removeReferences(S,R);let O=this.persistence.referenceDelegate,N=[];return O&&S.forEach(S=>{N.push(O.markPotentiallyOrphaned(T,S))}),e5.waitFor(N)}removeMatchingKeysForTargetId(T,S){return this.references.removeReferencesForId(S),e5.resolve()}getMatchingKeysForTargetId(T,S){let R=this.references.referencesForId(S);return e5.resolve(R)}containsKey(T,S){return e5.resolve(this.references.containsKey(S))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cm="MemoryPersistence";class cy{constructor(T,S){this.mutationQueues={},this.overlays={},this.listenSequence=new tv(0),this._started=!1,this._started=!0,this.globalsCache=new ca,this.referenceDelegate=T(this),this.targetCache=new cp(this);let R=T=>this.referenceDelegate.documentSize(T);this.indexManager=new up,this.remoteDocumentCache=ch(R),this.serializer=new o4(S),this.bundleCache=new ci(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(T){return this.indexManager}getDocumentOverlayCache(T){let S=this.overlays[T.toKey()];return S||(S=new cs,this.overlays[T.toKey()]=S),S}getMutationQueue(T,S){let R=this.mutationQueues[T.toKey()];return R||(R=new cu(S,this.referenceDelegate),this.mutationQueues[T.toKey()]=R),R}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(T,S,R){eu(cm,"Starting transaction:",T);let O=new cv(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),R(O).next(T=>this.referenceDelegate.onTransactionCommitted(O).next(()=>T)).toPromise().then(T=>(O.raiseOnCommittedEvent(),T))}mutationQueuesContainKey(T,S){return e5.or(Object.values(this.mutationQueues).map(R=>()=>R.containsKey(T,S)))}}class cv extends e6{constructor(T){super(),this.currentSequenceNumber=T}}class cT{constructor(T){this.persistence=T,this.localViewReferences=new co,this._orphanedDocuments=null}static factory(T){return new cT(T)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw ef()}addReference(T,S,R){return this.localViewReferences.addReference(R,S),this.orphanedDocuments.delete(R.toString()),e5.resolve()}removeReference(T,S,R){return this.localViewReferences.removeReference(R,S),this.orphanedDocuments.add(R.toString()),e5.resolve()}markPotentiallyOrphaned(T,S){return this.orphanedDocuments.add(S.toString()),e5.resolve()}removeTarget(T,S){this.localViewReferences.removeReferencesForId(S.targetId).forEach(T=>this.orphanedDocuments.add(T.toString()));let R=this.persistence.getTargetCache();return R.getMatchingKeysForTargetId(T,S.targetId).next(T=>{T.forEach(T=>this.orphanedDocuments.add(T.toString()))}).next(()=>R.removeTargetData(T,S))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(T){let S=this.persistence.getRemoteDocumentCache().newChangeBuffer();return e5.forEach(this.orphanedDocuments,R=>{let O=ez.fromPath(R);return this.isReferenced(T,O).next(T=>{T||S.removeEntry(O,eL.min())})}).next(()=>(this._orphanedDocuments=null,S.apply(T)))}updateLimboDocument(T,S){return this.isReferenced(T,S).next(T=>{T?this.orphanedDocuments.delete(S.toString()):this.orphanedDocuments.add(S.toString())})}documentSize(T){return 0}isReferenced(T,S){return e5.or([()=>e5.resolve(this.localViewReferences.containsKey(S)),()=>this.persistence.getTargetCache().containsKey(T,S),()=>this.persistence.mutationQueuesContainKey(T,S)])}}class cS{constructor(T,S){this.persistence=T,this.orphanedSequenceNumbers=new sb(T=>tE(T.path),(T,S)=>T.isEqual(S)),this.garbageCollector=uY(this,S)}static factory(T,S){return new cS(T,S)}onTransactionStarted(){}onTransactionCommitted(T){return e5.resolve()}forEachTarget(T,S){return this.persistence.getTargetCache().forEachTarget(T,S)}getSequenceNumberCount(T){let S=this.orphanedDocumentCount(T);return this.persistence.getTargetCache().getTargetCount(T).next(T=>S.next(S=>T+S))}orphanedDocumentCount(T){let S=0;return this.forEachOrphanedDocumentSequenceNumber(T,T=>{S++}).next(()=>S)}forEachOrphanedDocumentSequenceNumber(T,S){return e5.forEach(this.orphanedSequenceNumbers,(R,O)=>this.isPinned(T,R,O).next(T=>T?e5.resolve():S(O)))}removeTargets(T,S,R){return this.persistence.getTargetCache().removeTargets(T,S,R)}removeOrphanedDocuments(T,S){let R=0,O=this.persistence.getRemoteDocumentCache(),N=O.newChangeBuffer();return O.forEachDocumentKey(T,O=>this.isPinned(T,O,S).next(T=>{T||(R++,N.removeEntry(O,eL.min()))})).next(()=>N.apply(T)).next(()=>R)}markPotentiallyOrphaned(T,S){return this.orphanedSequenceNumbers.set(S,T.currentSequenceNumber),e5.resolve()}removeTarget(T,S){let R=S.withSequenceNumber(T.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(T,R)}addReference(T,S,R){return this.orphanedSequenceNumbers.set(R,T.currentSequenceNumber),e5.resolve()}removeReference(T,S,R){return this.orphanedSequenceNumbers.set(R,T.currentSequenceNumber),e5.resolve()}updateLimboDocument(T,S){return this.orphanedSequenceNumbers.set(S,T.currentSequenceNumber),e5.resolve()}documentSize(T){let S=T.key.toString().length;return T.isFoundDocument()&&(S+=nq(T.data.value)),S}isPinned(T,S,R){return e5.or([()=>this.persistence.mutationQueuesContainKey(T,S),()=>this.persistence.getTargetCache().containsKey(T,S),()=>{let T=this.orphanedSequenceNumbers.get(S);return e5.resolve(void 0!==T&&T>R)}])}getCacheSize(T){return this.persistence.getRemoteDocumentCache().getSize(T)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(T){this.serializer=T}createOrUpgrade(T,S,R,O){let N=new te("createOrUpgrade",S);R<1&&O>=1&&(cw(T),cC(T),ck(T),cR(T));let P=e5.resolve();return R<3&&O>=3&&(0!==R&&(cN(T),ck(T)),P=P.next(()=>cP(N))),R<4&&O>=4&&(0!==R&&(P=P.next(()=>cI(T,N))),P=P.next(()=>{cx(T)})),R<5&&O>=5&&(P=P.next(()=>this.removeAcknowledgedMutations(N))),R<6&&O>=6&&(P=P.next(()=>(cA(T),this.addDocumentGlobal(N)))),R<7&&O>=7&&(P=P.next(()=>this.ensureSequenceNumbers(N))),R<8&&O>=8&&(P=P.next(()=>this.createCollectionParentIndex(T,N))),R<9&&O>=9&&(P=P.next(()=>{cD(T)})),R<10&&O>=10&&(P=P.next(()=>this.rewriteCanonicalIds(N))),R<11&&O>=11&&(P=P.next(()=>{cM(T),cL(T)})),R<12&&O>=12&&(P=P.next(()=>{cj(T)})),R<13&&O>=13&&(P=P.next(()=>cO(T)).next(()=>this.rewriteRemoteDocumentCache(T,N)).next(()=>T.deleteObjectStore(tR))),R<14&&O>=14&&(P=P.next(()=>this.runOverlayMigration(T,N))),R<15&&O>=15&&(P=P.next(()=>cF(T))),R<16&&O>=16&&(P=P.next(()=>{S.objectStore(ru).clear()}).next(()=>{S.objectStore(rf).clear()})),R<17&&O>=17&&(P=P.next(()=>{cU(T)})),P}addDocumentGlobal(T){let S=0;return T.store(tR).iterate((T,R)=>{S+=uC(R)}).next(()=>{let R={byteSize:S};return T.store(tW).put(tQ,R)})}removeAcknowledgedMutations(T){let S=T.store(tk),R=T.store(tD);return S.loadAll().next(S=>e5.forEach(S,S=>{let O=IDBKeyRange.bound([S.userId,no],[S.userId,S.lastAcknowledgedBatchId]);return R.loadAll(tM,O).next(R=>e5.forEach(R,R=>{ep(R.userId===S.userId);let O=ln(this.serializer,R);return uw(T,S.userId,O).next(()=>{})}))}))}ensureSequenceNumbers(T){let S=T.store(t0),R=T.store(tR);return T.store(t6).get(t4).next(T=>{let O=R=>S.put({targetId:0,path:tE(R),sequenceNumber:T.highestListenSequenceNumber}),N=[];return R.iterate((T,R)=>{let P=new eU(T),M=cE(P);N.push(S.get(M).next(T=>T?e5.resolve():O(P)))}).next(()=>e5.waitFor(N))})}createCollectionParentIndex(T,S){T.createObjectStore(t9,{keyPath:t5});let R=S.store(t9),O=new ug,N=T=>{if(O.add(T)){let S=T.lastSegment(),O=T.popLast();return R.put({collectionId:S,parent:tE(O)})}};return S.store(tR).iterate({keysOnly:!0},(T,S)=>N(new eU(T).popLast())).next(()=>S.store(tV).iterate({keysOnly:!0},([T,S,R],O)=>N(tI(S).popLast())))}rewriteCanonicalIds(T){let S=T.store(tY);return S.iterate((T,R)=>{let O=li(R),N=ls(this.serializer,O);return S.put(N)})}rewriteRemoteDocumentCache(T,S){let R=S.store(tR),O=[];return R.iterate((T,R)=>{let N=S.store(tz),P=cB(R).path.toArray(),M={prefixPath:P.slice(0,P.length-2),collectionGroup:P[P.length-2],documentId:P[P.length-1],readTime:R.readTime||[0,0],unknownDocument:R.unknownDocument,noDocument:R.noDocument,document:R.document,hasCommittedMutations:!!R.hasCommittedMutations};O.push(N.put(M))}).next(()=>e5.waitFor(O))}runOverlayMigration(T,S){let R=S.store(tD),O=u3(this.serializer),N=new cy(cT.factory,this.serializer.remoteSerializer);return R.loadAll().next(T=>{let R=new Map;return T.forEach(T=>{var S;let O=null!==(S=R.get(T.userId))&&void 0!==S?S:sD();ln(this.serializer,T).keys().forEach(T=>O=O.add(T)),R.set(T.userId,O)}),e5.forEach(R,(T,R)=>{let P=new er(R),M=lw.forUser(this.serializer,P),L=N.getIndexManager(P);return new cn(O,uI.forUser(P,this.serializer,L,N.referenceDelegate),M,L).recalculateAndSaveOverlaysForDocumentKeys(new rP(S,tv.INVALID),T).next()})})}}function cE(T){return[0,tE(T)]}function cw(T){T.createObjectStore(tO)}function cC(T){T.createObjectStore(tk,{keyPath:tN}),T.createObjectStore(tD,{keyPath:tP,autoIncrement:!0}).createIndex(tM,tL,{unique:!0}),T.createObjectStore(tV)}function cI(T,S){return S.store(tD).loadAll().next(R=>{T.deleteObjectStore(tD),T.createObjectStore(tD,{keyPath:tP,autoIncrement:!0}).createIndex(tM,tL,{unique:!0});let O=S.store(tD),N=R.map(T=>O.put(T));return e5.waitFor(N)})}function cR(T){T.createObjectStore(tR)}function cO(T){let S=T.createObjectStore(tz,{keyPath:tq});S.createIndex(tG,tH),S.createIndex(t$,tK)}function cA(T){T.createObjectStore(tW)}function ck(T){T.createObjectStore(t0,{keyPath:t1}).createIndex(t2,t3,{unique:!0}),T.createObjectStore(tY,{keyPath:tJ}).createIndex(tX,tZ,{unique:!0}),T.createObjectStore(t6)}function cN(T){T.deleteObjectStore(t0),T.deleteObjectStore(tY),T.deleteObjectStore(t6)}function cD(T){T.objectStoreNames.contains("remoteDocumentChanges")&&T.deleteObjectStore("remoteDocumentChanges")}function cP(T){let S=T.store(t6),R={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:eL.min().toTimestamp(),targetCount:0};return S.put(t4,R)}function cx(T){T.createObjectStore(t8,{keyPath:t7})}function cM(T){T.createObjectStore(rt,{keyPath:rr})}function cL(T){T.createObjectStore(rn,{keyPath:ri})}function cF(T){T.createObjectStore(rs,{keyPath:ra,autoIncrement:!0}).createIndex(ro,rl,{unique:!1}),T.createObjectStore(ru,{keyPath:rc}).createIndex(rd,rh,{unique:!1}),T.createObjectStore(rf,{keyPath:rp}).createIndex(rg,rm,{unique:!1})}function cj(T){let S=T.createObjectStore(ry,{keyPath:rv});S.createIndex(rb,rT,{unique:!1}),S.createIndex(rS,r_,{unique:!1})}function cU(T){T.createObjectStore(rE,{keyPath:rw})}function cB(T){return T.document?new ez(eU.fromString(T.document.name).popFirst(5)):T.noDocument?ez.fromSegments(T.noDocument.path):T.unknownDocument?ez.fromSegments(T.unknownDocument.path):ef()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cV="IndexedDbPersistence",cz=null,cq=5e3,cG=4e3,cH=null,c$=null,cK="firestore_zombie",cW="main";class cQ{constructor(T,S,R,O,N,P,M,L,U,V,$=ct){if(this.allowTabSynchronization=T,this.persistenceKey=S,this.clientId=R,this.queue=N,this.window=P,this.document=M,this.sequenceNumberSyncer=U,this.forceOwningTab=V,this.schemaVersion=$,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=T=>Promise.resolve(),!cQ.isAvailable())throw new ey(em.UNIMPLEMENTED,c$);this.referenceDelegate=new uJ(this,O),this.dbName=S+cW,this.serializer=new o4(L),this.simpleDb=new tt(this.dbName,this.schemaVersion,new c_(this.serializer)),this.globalsCache=new lI,this.targetCache=new ux(this.referenceDelegate,this.serializer),this.remoteDocumentCache=u3(this.serializer),this.bundleCache=new lS,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===V&&ec(cV,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ey(em.FAILED_PRECONDITION,cH);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",T=>this.targetCache.getHighestSequenceNumber(T))}).then(T=>{this.listenSequence=new tv(T,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(T=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(T)))}setPrimaryStateListener(T){return this.primaryStateListener=async S=>{if(this.started)return T(S)},T(this.isPrimary)}setDatabaseDeletedListener(T){this.simpleDb.setVersionChangeListener(async S=>{null===S.newVersion&&await T()})}setNetworkEnabled(T){this.networkEnabled!==T&&(this.networkEnabled=T,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",T=>cJ(T).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(T).next(T=>{T||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(T)).next(S=>this.isPrimary&&!S?this.releasePrimaryLeaseIfHeld(T).next(()=>!1):!!S&&this.acquireOrExtendPrimaryLease(T).next(()=>!0))).catch(T=>{if(ta(T))return eu(cV,"Failed to extend owner lease: ",T),this.isPrimary;if(!this.allowTabSynchronization)throw T;return eu(cV,"Releasing owner lease after error during lease refresh",T),!1}).then(T=>{this.isPrimary!==T&&this.queue.enqueueRetryable(()=>this.primaryStateListener(T)),this.isPrimary=T})}verifyPrimaryLease(T){return cY(T).get(tA).next(T=>e5.resolve(this.isLocalClient(T)))}removeClientMetadata(T){return cJ(T).delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,cz)){this.lastGarbageCollectionTime=Date.now();let T=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",T=>{let S=rx(T,t8);return S.loadAll().next(T=>{let R=this.filterActiveClients(T,cz),O=T.filter(T=>-1===R.indexOf(T));return e5.forEach(O,T=>S.delete(T.clientId)).next(()=>O)})}).catch(()=>[]);if(this.webStorage)for(let S of T)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(S.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",cG,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(T){return!!T&&T.ownerId===this.clientId}canActAsPrimary(T){return this.forceOwningTab?e5.resolve(!0):cY(T).get(tA).next(S=>{if(null!==S&&this.isWithinAge(S.leaseTimestampMs,cq)&&!this.isClientZombied(S.ownerId)){if(this.isLocalClient(S)&&this.networkEnabled)return!0;if(!this.isLocalClient(S)){if(!S.allowTabSynchronization)throw new ey(em.FAILED_PRECONDITION,cH);return!1}}return!!this.networkEnabled&&!!this.inForeground||cJ(T).loadAll().next(T=>void 0===this.filterActiveClients(T,cq).find(T=>{if(this.clientId!==T.clientId){let S=!this.networkEnabled&&T.networkEnabled,R=!this.inForeground&&T.inForeground,O=this.networkEnabled===T.networkEnabled;if(S||R&&O)return!0}return!1}))}).next(T=>(this.isPrimary!==T&&eu(cV,`Client ${T?"is":"is not"} eligible for a primary lease.`),T))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[tO,t8],T=>{let S=new rP(T,tv.INVALID);return this.releasePrimaryLeaseIfHeld(S).next(()=>this.removeClientMetadata(S))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(T,S){return T.filter(T=>this.isWithinAge(T.updateTimeMs,S)&&!this.isClientZombied(T.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",T=>cJ(T).loadAll().next(T=>this.filterActiveClients(T,cz).map(T=>T.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(T,S){return uI.forUser(T,this.serializer,S,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(T){return new uv(T,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(T){return lw.forUser(this.serializer,T)}getBundleCache(){return this.bundleCache}runTransaction(T,S,R){let O;eu(cV,"Starting transaction:",T);let N="readonly"===S?"readonly":"readwrite",P=rD(this.schemaVersion);return this.simpleDb.runTransaction(T,N,P,N=>(O=new rP(N,this.listenSequence?this.listenSequence.next():tv.INVALID),"readwrite-primary"===S)?this.verifyPrimaryLease(O).next(T=>!!T||this.canActAsPrimary(O)).next(S=>{if(!S)throw ec(`Failed to obtain primary lease for action '${T}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new ey(em.FAILED_PRECONDITION,e4);return R(O)}).next(T=>this.acquireOrExtendPrimaryLease(O).next(()=>T)):this.verifyAllowTabSynchronization(O).next(()=>R(O))).then(T=>(O.raiseOnCommittedEvent(),T))}verifyAllowTabSynchronization(T){return cY(T).get(tA).next(T=>{if(null!==T&&this.isWithinAge(T.leaseTimestampMs,cq)&&!this.isClientZombied(T.ownerId)&&!this.isLocalClient(T)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!T.allowTabSynchronization))throw new ey(em.FAILED_PRECONDITION,cH)})}acquireOrExtendPrimaryLease(T){let S={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cY(T).put(tA,S)}static isAvailable(){return tt.isAvailable()}releasePrimaryLeaseIfHeld(T){let S=cY(T);return S.get(tA).next(T=>this.isLocalClient(T)?(eu(cV,"Releasing primary lease."),S.delete(tA)):e5.resolve())}isWithinAge(T,S){let R=Date.now(),O=R-S,N=R;return!(T<O)&&(!(T>N)||(ec(`Detected an update time that is in the future: ${T} > ${N}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var T;"function"==typeof(null===(T=this.window)||void 0===T?void 0:T.addEventListener)&&(this.windowUnloadHandler=()=>{this.markClientZombied();let T=/(?:Version|Mobile)\/1[456]/;isSafari()&&(navigator.appVersion.match(T)||navigator.userAgent.match(T))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(T){var S;try{let R=(null===(S=this.webStorage)||void 0===S?void 0:S.getItem(this.zombiedClientLocalStorageKey(T)))!==null;return eu(cV,`Client '${T}' ${R?"is":"is not"} zombied in LocalStorage`),R}catch(T){return ec(cV,"Failed to get zombied client id.",T),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(T){ec("Failed to set zombie client id.",T)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(T){}}zombiedClientLocalStorageKey(T){return`${cK}_${this.persistenceKey}_${T}`}}function cY(T){return rx(T,tO)}function cJ(T){return rx(T,t8)}function cX(T,S){let R=T.projectId;return T.isDefaultDatabase||(R+="."+T.database),"firestore/"+S+"/"+R+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cZ(T,S,R,O,N){S=[...S],(T=[...T]).sort(R),S.sort(R);let P=T.length,M=S.length,L=0,U=0;for(;L<M&&U<P;){let P=R(T[U],S[L]);P<0?N(T[U++]):P>0?O(S[L++]):(L++,U++)}for(;L<M;)O(S[L++]);for(;U<P;)N(T[U++])}function c0(T,S){if(T.length!==S.length)return!1;for(let R=0;R<T.length;++R)if(T[R]!==S[R])return!1;return!0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c4="LocalStore",c6=3e8;class c9{constructor(T,S,R,O){this.persistence=T,this.queryEngine=S,this.serializer=O,this.targetDataByTarget=new rU(ek),this.targetIdByTarget=new sb(T=>iz(T),iG),this.collectionGroupReadTime=new Map,this.remoteDocuments=T.getRemoteDocumentCache(),this.targetCache=T.getTargetCache(),this.bundleCache=T.getBundleCache(),this.initializeUserComponents(R)}initializeUserComponents(T){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(T),this.indexManager=this.persistence.getIndexManager(T),this.mutationQueue=this.persistence.getMutationQueue(T,this.indexManager),this.localDocuments=new cn(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(T){return this.persistence.runTransaction("Collect garbage","readwrite-primary",S=>T.collect(S,this.targetDataByTarget))}}function c5(T,S,R,O){return new c9(T,S,R,O)}async function c8(T,S){let R=eg(T);return await R.persistence.runTransaction("Handle user change","readonly",T=>{let O;return R.mutationQueue.getAllMutationBatches(T).next(N=>(O=N,R.initializeUserComponents(S),R.mutationQueue.getAllMutationBatches(T))).next(S=>{let N=[],P=[],M=sD();for(let T of O)for(let S of(N.push(T.batchId),T.mutations))M=M.add(S.key);for(let T of S)for(let S of(P.push(T.batchId),T.mutations))M=M.add(S.key);return R.localDocuments.getDocuments(T,M).next(T=>({affectedDocuments:T,removedBatchIds:N,addedBatchIds:P}))})})}function c7(T,S){let R,O;let N=eg(T),P=eM.now(),M=S.reduce((T,S)=>T.add(S.key),sD());return N.persistence.runTransaction("Locally write mutations","readwrite",T=>{let L=sS(),U=sD();return N.remoteDocuments.getEntries(T,M).next(T=>{(L=T).forEach((T,S)=>{S.isValidDocument()||(U=U.add(T))})}).next(()=>N.localDocuments.getOverlayedDocuments(T,L)).next(O=>{R=O;let M=[];for(let T of S){let S=ae(T,R.get(T.key).overlayedDocument);null!=S&&M.push(new as(T.key,S,ir(S.value.mapValue),s4.exists(!0)))}return N.mutationQueue.addMutationBatch(T,P,M,S)}).next(S=>{O=S;let P=S.applyToLocalDocumentSet(R,U);return N.documentOverlayCache.saveOverlays(T,S.batchId,P)})}).then(()=>({batchId:O.batchId,changes:sC(R)}))}function de(T,S){let R=eg(T);return R.persistence.runTransaction("Acknowledge batch","readwrite-primary",T=>{let O=S.batch.keys(),N=R.remoteDocuments.newChangeBuffer({trackRemovals:!0});return dm(R,T,S,N).next(()=>N.apply(T)).next(()=>R.mutationQueue.performConsistencyCheck(T)).next(()=>R.documentOverlayCache.removeOverlaysForBatchId(T,O,S.batch.batchId)).next(()=>R.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(T,dt(S))).next(()=>R.localDocuments.getDocuments(T,O))})}function dt(T){let S=sD();for(let R=0;R<T.mutationResults.length;++R)T.mutationResults[R].transformResults.length>0&&(S=S.add(T.batch.mutations[R].key));return S}function dr(T,S){let R=eg(T);return R.persistence.runTransaction("Reject batch","readwrite-primary",T=>{let O;return R.mutationQueue.lookupMutationBatch(T,S).next(S=>(ep(null!==S),O=S.keys(),R.mutationQueue.removeMutationBatch(T,S))).next(()=>R.mutationQueue.performConsistencyCheck(T)).next(()=>R.documentOverlayCache.removeOverlaysForBatchId(T,O,S)).next(()=>R.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(T,O)).next(()=>R.localDocuments.getDocuments(T,O))})}function dn(T){let S=eg(T);return S.persistence.runTransaction("Get highest unacknowledged batch id","readonly",T=>S.mutationQueue.getHighestUnacknowledgedBatchId(T))}function di(T){let S=eg(T);return S.persistence.runTransaction("Get last remote snapshot version","readonly",T=>S.targetCache.getLastRemoteSnapshotVersion(T))}function ds(T,S){let R=eg(T),O=S.snapshotVersion,N=R.targetDataByTarget;return R.persistence.runTransaction("Apply remote event","readwrite-primary",T=>{let P=R.remoteDocuments.newChangeBuffer({trackRemovals:!0});N=R.targetDataByTarget;let M=[];S.targetChanges.forEach((P,L)=>{let U=N.get(L);if(!U)return;M.push(R.targetCache.removeMatchingKeys(T,P.removedDocuments,L).next(()=>R.targetCache.addMatchingKeys(T,P.addedDocuments,L)));let V=U.withSequenceNumber(T.currentSequenceNumber);null!==S.targetMismatches.get(L)?V=V.withResumeToken(rY.EMPTY_BYTE_STRING,eL.min()).withLastLimboFreeSnapshotVersion(eL.min()):P.resumeToken.approximateByteSize()>0&&(V=V.withResumeToken(P.resumeToken,O)),N=N.insert(L,V),dl(U,V,P)&&M.push(R.targetCache.updateTargetData(T,V))});let L=sS(),U=sD();if(S.documentUpdates.forEach(O=>{S.resolvedLimboDocuments.has(O)&&M.push(R.persistence.referenceDelegate.updateLimboDocument(T,O))}),M.push(da(T,P,S.documentUpdates).next(T=>{L=T.changedDocuments,U=T.existenceChangedKeys})),!O.isEqual(eL.min())){let S=R.targetCache.getLastRemoteSnapshotVersion(T).next(S=>R.targetCache.setTargetsMetadata(T,T.currentSequenceNumber,O));M.push(S)}return e5.waitFor(M).next(()=>P.apply(T)).next(()=>R.localDocuments.getLocalViewOfDocuments(T,L,U)).next(()=>L)}).then(T=>(R.targetDataByTarget=N,T))}function da(T,S,R){let O=sD(),N=sD();return R.forEach(T=>O=O.add(T)),S.getEntries(T,O).next(T=>{let O=sS();return R.forEach((R,P)=>{let M=T.get(R);P.isFoundDocument()!==M.isFoundDocument()&&(N=N.add(R)),P.isNoDocument()&&P.version.isEqual(eL.min())?(S.removeEntry(R,P.readTime),O=O.insert(R,P)):!M.isValidDocument()||P.version.compareTo(M.version)>0||0===P.version.compareTo(M.version)&&M.hasPendingWrites?(S.addEntry(P),O=O.insert(R,P)):eu(c4,"Ignoring outdated watch update for ",R,". Current version:",M.version," Watch version:",P.version)}),{changedDocuments:O,existenceChangedKeys:N}})}function dl(T,S,R){return!!(0===T.resumeToken.approximateByteSize()||S.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=c6)||R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}async function du(T,S){let R=eg(T);try{await R.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>e5.forEach(S,S=>e5.forEach(S.addedKeys,O=>R.persistence.referenceDelegate.addReference(T,S.targetId,O)).next(()=>e5.forEach(S.removedKeys,O=>R.persistence.referenceDelegate.removeReference(T,S.targetId,O)))))}catch(T){if(ta(T))eu(c4,"Failed to update sequence numbers: "+T);else throw T}for(let T of S){let S=T.targetId;if(!T.fromCache){let T=R.targetDataByTarget.get(S),O=T.snapshotVersion,N=T.withLastLimboFreeSnapshotVersion(O);R.targetDataByTarget=R.targetDataByTarget.insert(S,N)}}}function dc(T,S){let R=eg(T);return R.persistence.runTransaction("Get next mutation batch","readonly",T=>(void 0===S&&(S=no),R.mutationQueue.getNextMutationBatchAfterBatchId(T,S)))}function dd(T,S){let R=eg(T);return R.persistence.runTransaction("read document","readonly",T=>R.localDocuments.getDocument(T,S))}function dh(T,S){let R=eg(T);return R.persistence.runTransaction("Allocate target","readwrite",T=>{let O;return R.targetCache.getTargetData(T,S).next(N=>N?(O=N,e5.resolve(O)):R.targetCache.allocateTargetId(T).next(N=>(O=new o3(S,N,"TargetPurposeListen",T.currentSequenceNumber),R.targetCache.addTargetData(T,O).next(()=>O))))}).then(T=>{let O=R.targetDataByTarget.get(T.targetId);return(null===O||T.snapshotVersion.compareTo(O.snapshotVersion)>0)&&(R.targetDataByTarget=R.targetDataByTarget.insert(T.targetId,T),R.targetIdByTarget.set(S,T.targetId)),T})}function df(T,S,R){let O=eg(T),N=O.targetIdByTarget.get(R);return void 0!==N?e5.resolve(O.targetDataByTarget.get(N)):O.targetCache.getTargetData(S,R)}async function dp(T,S,R){let O=eg(T),N=O.targetDataByTarget.get(S),P=R?"readwrite":"readwrite-primary";try{R||await O.persistence.runTransaction("Release target",P,T=>O.persistence.referenceDelegate.removeTarget(T,N))}catch(T){if(ta(T))eu(c4,`Failed to update sequence numbers for target ${S}: ${T}`);else throw T}O.targetDataByTarget=O.targetDataByTarget.remove(S),O.targetIdByTarget.delete(N.target)}function dg(T,S,R){let O=eg(T),N=eL.min(),P=sD();return O.persistence.runTransaction("Execute query","readwrite",T=>df(O,T,se(S)).next(S=>{if(S)return N=S.lastLimboFreeSnapshotVersion,O.targetCache.getMatchingKeysForTargetId(T,S.targetId).next(T=>{P=T})}).next(()=>O.queryEngine.getDocumentsMatchingQuery(T,S,R?N:eL.min(),R?P:sD())).next(T=>(dw(O,sm(S),T),{documents:T,remoteKeys:P})))}function dm(T,S,R,O){let N=R.batch,P=N.keys(),M=e5.resolve();return P.forEach(T=>{M=M.next(()=>O.getEntry(S,T)).next(S=>{let P=R.docVersions.get(T);ep(null!==P),0>S.version.compareTo(P)&&(N.applyToRemoteDocument(S,R),S.isValidDocument()&&(S.setReadTime(R.commitVersion),O.addEntry(S)))})}),M.next(()=>T.mutationQueue.removeMutationBatch(S,N))}function dy(T,S){let R=eg(T),O=eg(R.mutationQueue);return R.persistence.runTransaction("Lookup mutation documents","readonly",T=>O.lookupMutationKeys(T,S).next(S=>S?R.localDocuments.getDocuments(T,S):e5.resolve(null)))}function dT(T,S){eg(eg(T,c9).mutationQueue).removeCachedMutationKeys(S)}function dS(T){return eg(eg(T,c9).persistence).getActiveClients()}function d_(T,S){let R=eg(T),O=eg(R.targetCache),N=R.targetDataByTarget.get(S);return N?Promise.resolve(N.target):R.persistence.runTransaction("Get target data","readonly",T=>O.getTargetDataForTarget(T,S).next(T=>T?T.target:null))}function dE(T,S){let R=eg(T),O=R.collectionGroupReadTime.get(S)||eL.min();return R.persistence.runTransaction("Get new document changes","readonly",T=>R.remoteDocuments.getAllFromCollectionGroup(T,S,e0(O,eq),Number.MAX_SAFE_INTEGER)).then(T=>(dw(R,S,T),T))}function dw(T,S,R){let O=T.collectionGroupReadTime.get(S)||eL.min();R.forEach((T,S)=>{S.readTime.compareTo(O)>0&&(O=S.readTime)}),T.collectionGroupReadTime.set(S,O)}function dC(T){return se(i3(eU.fromString(`__bundle__/docs/${T}`)))}async function dI(T,S,R,O){let N=eg(T),P=sD(),M=sS();for(let T of R){let R=S.toDocumentKey(T.metadata.name);T.document&&(P=P.add(R));let O=S.toMutableDocument(T);O.setReadTime(S.toSnapshotVersion(T.metadata.readTime)),M=M.insert(R,O)}let L=N.remoteDocuments.newChangeBuffer({trackRemovals:!0}),U=await dh(N,dC(O));return N.persistence.runTransaction("Apply bundle documents","readwrite",T=>da(T,L,M).next(S=>(L.apply(T),S)).next(S=>N.targetCache.removeMatchingKeysForTargetId(T,U.targetId).next(()=>N.targetCache.addMatchingKeys(T,P,U.targetId)).next(()=>N.localDocuments.getLocalViewOfDocuments(T,S.changedDocuments,S.existenceChangedKeys)).next(()=>S.changedDocuments)))}function dR(T,S){let R=eg(T),O=a0(S.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",T=>R.bundleCache.getBundleMetadata(T,S.id)).then(T=>!!T&&T.createTime.compareTo(O)>=0)}function dO(T,S){let R=eg(T);return R.persistence.runTransaction("Save bundle","readwrite",T=>R.bundleCache.saveBundleMetadata(T,S))}async function dA(T,S,R=sD()){let O=await dh(T,se(lh(S.bundledQuery))),N=eg(T);return N.persistence.runTransaction("Save named query","readwrite",T=>{let P=a0(S.readTime);if(O.snapshotVersion.compareTo(P)>=0)return N.bundleCache.saveNamedQuery(T,S);let M=O.withResumeToken(rY.EMPTY_BYTE_STRING,P);return N.targetDataByTarget=N.targetDataByTarget.insert(M.targetId,M),N.targetCache.updateTargetData(T,M).next(()=>N.targetCache.removeMatchingKeysForTargetId(T,O.targetId)).next(()=>N.targetCache.addMatchingKeys(T,R,O.targetId)).next(()=>N.bundleCache.saveNamedQuery(T,S))})}function dk(T,S){eg(T).queryEngine.indexAutoCreationEnabled=S}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(T){this._documentReadCount+=T}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dD=100;function dP(){return(0,K.G6)()?8:tr((0,K.z$)())>0?6:4}class dx{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=dD,this.relativeIndexReadCostPerDocument=dP()}initialize(T,S){this.localDocumentsView=T,this.indexManager=S,this.initialized=!0}getDocumentsMatchingQuery(T,S,R,O){let N={result:null};return this.performQueryUsingIndex(T,S).next(T=>{N.result=T}).next(()=>{if(!N.result)return this.performQueryUsingRemoteKeys(T,S,O,R).next(T=>{N.result=T})}).next(()=>{if(N.result)return;let R=new dN;return this.executeFullCollectionScan(T,S,R).next(O=>{if(N.result=O,this.indexAutoCreationEnabled)return this.createCacheIndexes(T,S,R,O.size)})}).next(()=>N.result)}createCacheIndexes(T,S,R,O){return R.documentReadCount<this.indexAutoCreationMinCollectionSize?(eo()<=V.in.DEBUG&&eu("QueryEngine","SDK will not create cache indexes for query:",sc(S),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),e5.resolve()):(eo()<=V.in.DEBUG&&eu("QueryEngine","Query:",sc(S),"scans",R.documentReadCount,"local documents and returns",O,"documents as results."),R.documentReadCount>this.relativeIndexReadCostPerDocument*O)?(eo()<=V.in.DEBUG&&eu("QueryEngine","The SDK decides to create cache indexes for query:",sc(S),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(T,se(S))):e5.resolve()}performQueryUsingIndex(T,S){if(i6(S))return e5.resolve(null);let R=se(S);return this.indexManager.getIndexType(T,R).next(O=>0===O?null:(null!==S.limit&&1===O&&(R=se(S=ss(S,null,"F"))),this.indexManager.getDocumentsMatchingTarget(T,R).next(O=>{let N=sD(...O);return this.localDocumentsView.getDocuments(T,N).next(O=>this.indexManager.getMinOffset(T,R).next(R=>{let P=this.applyQuery(S,O);return this.needsRefill(S,P,N,R.readTime)?this.performQueryUsingIndex(T,ss(S,null,"F")):this.appendRemainingResults(T,P,S,R)}))})))}performQueryUsingRemoteKeys(T,S,R,O){return i6(S)||O.isEqual(eL.min())?e5.resolve(null):this.localDocumentsView.getDocuments(T,R).next(N=>{let P=this.applyQuery(S,N);return this.needsRefill(S,P,R,O)?e5.resolve(null):(eo()<=V.in.DEBUG&&eu("QueryEngine","Re-using previous result from %s to execute query: %s",O.toString(),sc(S)),this.appendRemainingResults(T,P,S,e0(O,eq)).next(T=>T))})}applyQuery(T,S){let R=new rq(sy(T));return S.forEach((S,O)=>{sd(T,O)&&(R=R.add(O))}),R}needsRefill(T,S,R,O){if(null===T.limit)return!1;if(R.size!==S.size)return!0;let N="F"===T.limitType?S.last():S.first();return!!N&&(N.hasPendingWrites||N.version.compareTo(O)>0)}executeFullCollectionScan(T,S,R){return eo()<=V.in.DEBUG&&eu("QueryEngine","Using full collection scan to execute query:",sc(S)),this.localDocumentsView.getDocumentsMatchingQuery(T,S,e2.min(),R)}appendRemainingResults(T,S,R,O){return this.localDocumentsView.getDocumentsMatchingQuery(T,R,O).next(T=>(S.forEach(S=>{T=T.insert(S.key,S)}),T))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dM="firestore_clients";function dL(T,S){return`${dM}_${T}_${S}`}let dF="firestore_mutations";function dj(T,S,R){let O=`${dF}_${T}_${R}`;return S.isAuthenticated()&&(O+=`_${S.uid}`),O}let dU="firestore_targets";function dB(T,S){return`${dU}_${T}_${S}`}let dV="firestore_online_state";function dz(T){return`${dV}_${T}`}let dq="firestore_bundle_loaded_v2";function dG(T){return`${dq}_${T}`}let dH="firestore_sequence_number";function d$(T){return`${dH}_${T}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dK="SharedClientState";class dW{constructor(T,S,R,O){this.user=T,this.batchId=S,this.state=R,this.error=O}static fromWebStorageEntry(T,S,R){let O;let N=JSON.parse(R),P="object"==typeof N&&-1!==["pending","acknowledged","rejected"].indexOf(N.state)&&(void 0===N.error||"object"==typeof N.error);return(P&&N.error&&(P="string"==typeof N.error.message&&"string"==typeof N.error.code)&&(O=new ey(N.error.code,N.error.message)),P)?new dW(T,S,N.state,O):(ec(dK,`Failed to parse mutation state for ID '${S}': ${R}`),null)}toWebStorageJSON(){let T={state:this.state,updateTimeMs:Date.now()};return this.error&&(T.error={code:this.error.code,message:this.error.message}),JSON.stringify(T)}}class dQ{constructor(T,S,R){this.targetId=T,this.state=S,this.error=R}static fromWebStorageEntry(T,S){let R;let O=JSON.parse(S),N="object"==typeof O&&-1!==["not-current","current","rejected"].indexOf(O.state)&&(void 0===O.error||"object"==typeof O.error);return(N&&O.error&&(N="string"==typeof O.error.message&&"string"==typeof O.error.code)&&(R=new ey(O.error.code,O.error.message)),N)?new dQ(T,O.state,R):(ec(dK,`Failed to parse target state for ID '${T}': ${S}`),null)}toWebStorageJSON(){let T={state:this.state,updateTimeMs:Date.now()};return this.error&&(T.error={code:this.error.code,message:this.error.message}),JSON.stringify(T)}}class dY{constructor(T,S){this.clientId=T,this.activeTargetIds=S}static fromWebStorageEntry(T,S){let R=JSON.parse(S),O="object"==typeof R&&R.activeTargetIds instanceof Array,N=sx();for(let T=0;O&&T<R.activeTargetIds.length;++T)O=nd(R.activeTargetIds[T]),N=N.add(R.activeTargetIds[T]);return O?new dY(T,N):(ec(dK,`Failed to parse client data for instance '${T}': ${S}`),null)}}class dJ{constructor(T,S){this.clientId=T,this.onlineState=S}static fromWebStorageEntry(T){let S=JSON.parse(T);return"object"==typeof S&&-1!==["Unknown","Online","Offline"].indexOf(S.onlineState)&&"string"==typeof S.clientId?new dJ(S.clientId,S.onlineState):(ec(dK,`Failed to parse online state: ${T}`),null)}}class dX{constructor(){this.activeTargetIds=sx()}addQueryTarget(T){this.activeTargetIds=this.activeTargetIds.add(T)}removeQueryTarget(T){this.activeTargetIds=this.activeTargetIds.delete(T)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class dZ{constructor(T,S,R,O,N){this.window=T,this.queue=S,this.persistenceKey=R,this.localClientId=O,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new rU(ek),this.started=!1,this.earlyEvents=[];let P=R.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=N,this.localClientStorageKey=dL(this.persistenceKey,this.localClientId),this.sequenceNumberKey=d$(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new dX),this.clientStateKeyRe=RegExp(`^${dM}_${P}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${dF}_${P}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${dU}_${P}_(\\d+)$`),this.onlineStateKey=dz(this.persistenceKey),this.bundleLoadedKey=dG(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(T){return!!(T&&T.localStorage)}async start(){for(let T of(await this.syncEngine.getActiveClients())){if(T===this.localClientId)continue;let S=this.getItem(dL(this.persistenceKey,T));if(S){let R=dY.fromWebStorageEntry(T,S);R&&(this.activeClients=this.activeClients.insert(R.clientId,R))}}this.persistClientState();let T=this.storage.getItem(this.onlineStateKey);if(T){let S=this.fromWebStorageOnlineState(T);S&&this.handleOnlineStateEvent(S)}for(let T of this.earlyEvents)this.handleWebStorageEvent(T);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(T){this.setItem(this.sequenceNumberKey,JSON.stringify(T))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(T){let S=!1;return this.activeClients.forEach((R,O)=>{O.activeTargetIds.has(T)&&(S=!0)}),S}addPendingMutation(T){this.persistMutationState(T,"pending")}updateMutationState(T,S,R){this.persistMutationState(T,S,R),this.removeMutationState(T)}addLocalQueryTarget(T,S=!0){let R="not-current";if(this.isActiveQueryTarget(T)){let S=this.storage.getItem(dB(this.persistenceKey,T));if(S){let O=dQ.fromWebStorageEntry(T,S);O&&(R=O.state)}}return S&&this.localClientState.addQueryTarget(T),this.persistClientState(),R}removeLocalQueryTarget(T){this.localClientState.removeQueryTarget(T),this.persistClientState()}isLocalQueryTarget(T){return this.localClientState.activeTargetIds.has(T)}clearQueryState(T){this.removeItem(dB(this.persistenceKey,T))}updateQueryState(T,S,R){this.persistQueryTargetState(T,S,R)}handleUserChange(T,S,R){S.forEach(T=>{this.removeMutationState(T)}),this.currentUser=T,R.forEach(T=>{this.addPendingMutation(T)})}setOnlineState(T){this.persistOnlineState(T)}notifyBundleLoaded(T){this.persistBundleLoadedState(T)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(T){let S=this.storage.getItem(T);return eu(dK,"READ",T,S),S}setItem(T,S){eu(dK,"SET",T,S),this.storage.setItem(T,S)}removeItem(T){eu(dK,"REMOVE",T),this.storage.removeItem(T)}handleWebStorageEvent(T){let S=T;if(S.storageArea===this.storage){if(eu(dK,"EVENT",S.key,S.newValue),S.key===this.localClientStorageKey){ec("Received WebStorage notification for local change. Another client might have garbage-collected our state");return}this.queue.enqueueRetryable(async()=>{if(!this.started){this.earlyEvents.push(S);return}if(null!==S.key){if(this.clientStateKeyRe.test(S.key)){if(null!=S.newValue){let T=this.fromWebStorageClientState(S.key,S.newValue);if(T)return this.handleClientStateEvent(T.clientId,T)}else{let T=this.fromWebStorageClientStateKey(S.key);return this.handleClientStateEvent(T,null)}}else if(this.mutationBatchKeyRe.test(S.key)){if(null!==S.newValue){let T=this.fromWebStorageMutationMetadata(S.key,S.newValue);if(T)return this.handleMutationBatchEvent(T)}}else if(this.queryTargetKeyRe.test(S.key)){if(null!==S.newValue){let T=this.fromWebStorageQueryTargetMetadata(S.key,S.newValue);if(T)return this.handleQueryTargetEvent(T)}}else if(S.key===this.onlineStateKey){if(null!==S.newValue){let T=this.fromWebStorageOnlineState(S.newValue);if(T)return this.handleOnlineStateEvent(T)}}else if(S.key===this.sequenceNumberKey){let T=d0(S.newValue);T!==tv.INVALID&&this.sequenceNumberHandler(T)}else if(S.key===this.bundleLoadedKey){let T=this.fromWebStoreBundleLoadedState(S.newValue);await Promise.all(T.map(T=>this.syncEngine.synchronizeWithChangedDocuments(T)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(T,S,R){let O=new dW(this.currentUser,T,S,R),N=dj(this.persistenceKey,this.currentUser,T);this.setItem(N,O.toWebStorageJSON())}removeMutationState(T){let S=dj(this.persistenceKey,this.currentUser,T);this.removeItem(S)}persistOnlineState(T){let S={clientId:this.localClientId,onlineState:T};this.storage.setItem(this.onlineStateKey,JSON.stringify(S))}persistQueryTargetState(T,S,R){let O=dB(this.persistenceKey,T),N=new dQ(T,S,R);this.setItem(O,N.toWebStorageJSON())}persistBundleLoadedState(T){let S=JSON.stringify(Array.from(T));this.setItem(this.bundleLoadedKey,S)}fromWebStorageClientStateKey(T){let S=this.clientStateKeyRe.exec(T);return S?S[1]:null}fromWebStorageClientState(T,S){let R=this.fromWebStorageClientStateKey(T);return dY.fromWebStorageEntry(R,S)}fromWebStorageMutationMetadata(T,S){let R=this.mutationBatchKeyRe.exec(T),O=Number(R[1]),N=void 0!==R[2]?R[2]:null;return dW.fromWebStorageEntry(new er(N),O,S)}fromWebStorageQueryTargetMetadata(T,S){let R=Number(this.queryTargetKeyRe.exec(T)[1]);return dQ.fromWebStorageEntry(R,S)}fromWebStorageOnlineState(T){return dJ.fromWebStorageEntry(T)}fromWebStoreBundleLoadedState(T){return JSON.parse(T)}async handleMutationBatchEvent(T){if(T.user.uid!==this.currentUser.uid){eu(dK,`Ignoring mutation for non-active user ${T.user.uid}`);return}return this.syncEngine.applyBatchState(T.batchId,T.state,T.error)}handleQueryTargetEvent(T){return this.syncEngine.applyTargetState(T.targetId,T.state,T.error)}handleClientStateEvent(T,S){let R=S?this.activeClients.insert(T,S):this.activeClients.remove(T),O=this.extractActiveQueryTargets(this.activeClients),N=this.extractActiveQueryTargets(R),P=[],M=[];return N.forEach(T=>{O.has(T)||P.push(T)}),O.forEach(T=>{N.has(T)||M.push(T)}),this.syncEngine.applyActiveTargetsChange(P,M).then(()=>{this.activeClients=R})}handleOnlineStateEvent(T){this.activeClients.get(T.clientId)&&this.onlineStateHandler(T.onlineState)}extractActiveQueryTargets(T){let S=sx();return T.forEach((T,R)=>{S=S.unionWith(R.activeTargetIds)}),S}}function d0(T){let S=tv.INVALID;if(null!=T)try{let R=JSON.parse(T);ep("number"==typeof R),S=R}catch(T){ec(dK,"Failed to read sequence number from WebStorage",T)}return S}class d3{constructor(){this.localState=new dX,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(T){}updateMutationState(T,S,R){}addLocalQueryTarget(T,S=!0){return S&&this.localState.addQueryTarget(T),this.queryState[T]||"not-current"}updateQueryState(T,S,R){this.queryState[T]=S}removeLocalQueryTarget(T){this.localState.removeQueryTarget(T)}isLocalQueryTarget(T){return this.localState.activeTargetIds.has(T)}clearQueryState(T){delete this.queryState[T]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(T){return this.localState.activeTargetIds.has(T)}start(){return this.localState=new dX,Promise.resolve()}handleUserChange(T,S,R){}setOnlineState(T){}shutdown(){}writeSequenceNumber(T){}notifyBundleLoaded(T){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{addCallback(T){}shutdown(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(T){this.sendFn=T.sendFn,this.closeFn=T.closeFn}onConnected(T){this.wrappedOnConnected=T}onOpen(T){this.wrappedOnOpen=T}onClose(T){this.wrappedOnClose=T}onMessage(T){this.wrappedOnMessage=T}close(){this.closeFn()}send(T){this.sendFn(T)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(T){this.wrappedOnClose(T)}callOnMessage(T){this.wrappedOnMessage(T)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d9=null;function d5(){return 268435456+Math.round(2147483648*Math.random())}function d8(){return null===d9?d9=d5():d9++,"0x"+d9.toString(16)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d7(T){return new Promise((S,R)=>{T((T,O)=>{T?R(T):S(O)})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let he="1.9.1",ht="GrpcConnection",hr=`gl-node/${process.versions.node} fire/${en} grpc/${he}`;function hn(T,S,R,O){ep(null===S||"OAuth"===S.type);let N=new X.SF;return S&&S.headers.forEach((T,S)=>N.set(S,T)),R&&R.headers.forEach((T,S)=>N.set(S,T)),O&&N.set("X-Firebase-GMPID",O),N.set("X-Goog-Api-Client",hr),N.set("Google-Cloud-Resource-Prefix",T),N.set("x-goog-request-params",T),N}class hs{constructor(T,S){this.databaseInfo=S,this.cachedStub=null,this.firestore=T.google.firestore.v1,this.databasePath=`projects/${S.databaseId.projectId}/databases/${S.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){eu(ht,"Creating Firestore stub.");let T=this.databaseInfo.ssl?X.K9.createSsl():X.K9.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,T)}return this.cachedStub}invokeRPC(T,S,R,O,N){let P=d8(),M=this.ensureActiveStub(),L=hn(this.databasePath,O,N,this.databaseInfo.appId),U=Object.assign({database:this.databasePath},R);return d7(S=>(eu(ht,`RPC '${T}' ${P} invoked with request:`,R),M[T](U,L,(R,O)=>{R?(eu(ht,`RPC '${T}' ${P} failed with error:`,R),S(new ey(aS(R.code),R.message))):(eu(ht,`RPC '${T}' ${P} completed with response:`,O),S(void 0,O))})))}invokeStreamingRPC(T,S,R,O,N,P){let M=d8(),L=[],U=new ev;eu(ht,`RPC '${T}' ${M} invoked (streaming) with request:`,R);let V=this.ensureActiveStub(),$=hn(this.databasePath,O,N,this.databaseInfo.appId),K=Object.assign(Object.assign({},R),{database:this.databasePath}),W=V[T](K,$),Q=!1;return W.on("data",S=>{eu(ht,`RPC ${T} ${M} received result:`,S),L.push(S),void 0!==P&&L.length===P&&(Q=!0,U.resolve(L))}),W.on("end",()=>{eu(ht,`RPC '${T}' ${M} completed.`),Q||(Q=!0,U.resolve(L))}),W.on("error",S=>{eu(ht,`RPC '${T}' ${M} failed with error:`,S);let R=aS(S.code);U.reject(new ey(R,S.message))}),U.promise}openStream(T,S,R){let O=d8(),N=this.ensureActiveStub(),P=hn(this.databasePath,S,R,this.databaseInfo.appId),M=N[T](P),L=!1,U=T=>{L||(L=!0,V.callOnClose(T),M.end())},V=new d6({sendFn:S=>{if(L)eu(ht,`RPC '${T}' stream ${O} not sending because gRPC stream is closed:`,S);else{eu(ht,`RPC '${T}' stream ${O} sending:`,S);try{M.write(S)}catch(T){throw ec("Failure sending:",S),ec("Error:",T),T}}},closeFn:()=>{eu(ht,`RPC '${T}' stream ${O} closed locally via close().`),U()}}),$=!1;return M.on("data",S=>{L||(eu(ht,`RPC '${T}' stream ${O} received:`,S),$||(V.callOnConnected(),$=!0),V.callOnMessage(S))}),M.on("end",()=>{eu(ht,`RPC '${T}' stream ${O} ended.`),U()}),M.on("error",S=>{L||(ed(ht,`RPC '${T}' stream ${O} error. Code:`,S.code,"Message:",S.message),U(new ey(aS(S.code),S.message)))}),eu(ht,`Opening RPC '${T}' stream ${O} to ${this.databaseInfo.host}`),setTimeout(()=>{V.callOnOpen()},0),V}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let ha={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var ho={nested:ha},hl=Object.freeze({__proto__:null,nested:ha,default:ho});/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hu={longs:String,enums:String,defaults:!0,oneofs:!1};function hc(){let T=Z.im(hl,hu);return X.Rz(T)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hd(T){return new hs(hc(),T)}function hh(){return new d4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function hp(){return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(T){return new aH(T,!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hm="ExponentialBackoff",hy=1e3,hv=1.5,hT=6e4;class hS{constructor(T,S,R=hy,O=hv,N=hT){this.queue=T,this.timerId=S,this.initialDelayMs=R,this.backoffFactor=O,this.maxDelayMs=N,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(T){this.cancel();let S=Math.floor(this.currentBaseMs+this.jitterDelayMs()),R=Math.max(0,Date.now()-this.lastAttemptTime),O=Math.max(0,S-R);O>0&&eu(hm,`Backing off for ${O} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${S} ms, last attempt: ${R} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,O,()=>(this.lastAttemptTime=Date.now(),T())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h_="PersistentStream",hE=6e4,hw=1e4;class hC{constructor(T,S,R,O,N,P,M,L){this.queue=T,this.idleTimerId=R,this.healthTimerId=O,this.connection=N,this.authCredentialsProvider=P,this.appCheckCredentialsProvider=M,this.listener=L,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new hS(T,S)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state){this.performBackoff();return}this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,hE,()=>this.handleIdleCloseTimer()))}sendRequest(T){this.cancelIdleCheck(),this.stream.send(T)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(T,S){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==T?this.backoff.reset():S&&S.code===em.RESOURCE_EXHAUSTED?(ec(S.toString()),ec("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):S&&S.code===em.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=T,await this.listener.onClose(S)}tearDown(){}auth(){this.state=1;let T=this.getCloseGuardedDispatcher(this.closeCount),S=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([T,R])=>{this.closeCount===S&&this.startStream(T,R)},S=>{T(()=>{let T=new ey(em.UNKNOWN,"Fetching auth token failed: "+S.message);return this.handleStreamClose(T)})})}startStream(T,S){let R=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(T,S),this.stream.onConnected(()=>{R(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{R(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,hw,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(T=>{R(()=>this.handleStreamClose(T))}),this.stream.onMessage(T=>{R(()=>1==++this.responseCount?this.onFirst(T):this.onNext(T))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(T){return eu(h_,`close with error: ${T}`),this.stream=null,this.close(4,T)}getCloseGuardedDispatcher(T){return S=>{this.queue.enqueueAndForget(()=>this.closeCount===T?S():(eu(h_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hI extends hC{constructor(T,S,R,O,N,P){super(T,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",S,R,O,P),this.serializer=N}startRpc(T,S){return this.connection.openStream("Listen",T,S)}onFirst(T){return this.onNext(T)}onNext(T){this.backoff.reset();let S=ol(this.serializer,T),R=oc(T);return this.listener.onWatchChange(S,R)}watch(T){let S={};S.database=a8(this.serializer),S.addTarget=oO(this.serializer,T);let R=oI(this.serializer,T);R&&(S.labels=R),this.sendRequest(S)}unwatch(T){let S={};S.database=a8(this.serializer),S.removeTarget=T,this.sendRequest(S)}}class hR extends hC{constructor(T,S,R,O,N,P){super(T,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",S,R,O,P),this.serializer=N}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(T,S){return this.connection.openStream("Write",T,S)}onFirst(T){return ep(!!T.streamToken),this.lastStreamToken=T.streamToken,ep(!T.writeResults||0===T.writeResults.length),this.listener.onHandshakeComplete()}onNext(T){ep(!!T.streamToken),this.lastStreamToken=T.streamToken,this.backoff.reset();let S=oy(T.writeResults,T.commitTime),R=a0(T.commitTime);return this.listener.onMutationResult(R,S)}writeHandshake(){let T={};T.database=a8(this.serializer),this.sendRequest(T)}writeMutations(T){let S={streamToken:this.lastStreamToken,writes:T.map(T=>od(this.serializer,T))};this.sendRequest(S)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{}class hA extends hO{constructor(T,S,R,O){super(),this.authCredentials=T,this.appCheckCredentials=S,this.connection=R,this.serializer=O,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new ey(em.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(T,S,R,O){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([N,P])=>this.connection.invokeRPC(T,a2(S,R),O,N,P)).catch(T=>{if("FirebaseError"===T.name)throw T.code===em.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),T;throw new ey(em.UNKNOWN,T.toString())})}invokeStreamingRPC(T,S,R,O,N){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([P,M])=>this.connection.invokeStreamingRPC(T,a2(S,R),O,P,M,N)).catch(T=>{if("FirebaseError"===T.name)throw T.code===em.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),T;throw new ey(em.UNKNOWN,T.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function hk(T,S,R,O){return new hA(T,S,R,O)}async function hN(T,S){let R=eg(T),O={writes:S.map(T=>od(R.serializer,T))};await R.invokeRPC("Commit",R.serializer.databaseId,eU.emptyPath(),O)}async function hD(T,S){let R=eg(T),O={documents:S.map(T=>a4(R.serializer,T))},N=await R.invokeStreamingRPC("BatchGetDocuments",R.serializer.databaseId,eU.emptyPath(),O,S.length),P=new Map;N.forEach(T=>{let S=oo(R.serializer,T);P.set(S.key.toString(),S)});let M=[];return S.forEach(T=>{let S=P.get(T.toString());ep(!!S),M.push(S)}),M}async function hP(T,S,R){var O;let N=eg(T),{request:P,aliasMap:M,parent:L}=oE(N.serializer,st(S),R);N.connection.shouldResourcePathBeIncludedInRequest||delete P.parent;let U=(await N.invokeStreamingRPC("RunAggregationQuery",N.serializer.databaseId,L,P,1)).filter(T=>!!T.result);ep(1===U.length);let V=null===(O=U[0].result)||void 0===O?void 0:O.aggregateFields;return Object.keys(V).reduce((T,S)=>(T[M[S]]=V[S],T),{})}function hx(T,S,R){let O=eg(T);return O.verifyInitialized(),new hR(S,O.connection,O.authCredentials,O.appCheckCredentials,O.serializer,R)}function hM(T,S,R){let O=eg(T);return O.verifyInitialized(),new hI(S,O.connection,O.authCredentials,O.appCheckCredentials,O.serializer,R)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hL="OnlineStateTracker",hF=1,hj=1e4;class hU{constructor(T,S){this.asyncQueue=T,this.onlineStateHandler=S,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",hj,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${hj/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(T){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=hF&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${hF} times. Most recent error: ${T.toString()}`),this.setAndBroadcast("Offline")))}set(T){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===T&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(T)}setAndBroadcast(T){T!==this.state&&(this.state=T,this.onlineStateHandler(T))}logClientOfflineWarningIfNecessary(T){let S=`Could not reach Cloud Firestore backend. ${T}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(ec(S),this.shouldWarnClientIsOffline=!1):eu(hL,S)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hB="RemoteStore",hV=10;class hz{constructor(T,S,R,O,N){this.localStore=T,this.datastore=S,this.asyncQueue=R,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=N,this.connectivityMonitor.addCallback(T=>{R.enqueueAndForget(async()=>{hZ(this)&&(eu(hB,"Restarting streams for network reachability change."),await fd(this))})}),this.onlineStateTracker=new hU(R,O)}}function hq(T,S,R,O,N){return new hz(T,S,R,O,N)}async function hG(T){if(hZ(T))for(let S of T.onNetworkStatusChange)await S(!0)}async function hH(T){for(let S of T.onNetworkStatusChange)await S(!1)}async function h$(T){let S=eg(T);eu(hB,"RemoteStore shutting down."),S.offlineCauses.add(5),await hH(S),S.connectivityMonitor.shutdown(),S.onlineStateTracker.set("Unknown")}function hK(T,S){let R=eg(T);!R.listenTargets.has(S.targetId)&&(R.listenTargets.set(S.targetId,S),hX(R)?hJ(R):fp(R).isOpen()&&hQ(R,S))}function hW(T,S){let R=eg(T),O=fp(R);R.listenTargets.delete(S),O.isOpen()&&hY(R,S),0===R.listenTargets.size&&(O.isOpen()?O.markIdle():hZ(R)&&R.onlineStateTracker.set("Unknown"))}function hQ(T,S){if(T.watchChangeAggregator.recordPendingTargetRequest(S.targetId),S.resumeToken.approximateByteSize()>0||S.snapshotVersion.compareTo(eL.min())>0){let R=T.remoteSyncer.getRemoteKeysForTarget(S.targetId).size;S=S.withExpectedCount(R)}fp(T).watch(S)}function hY(T,S){T.watchChangeAggregator.recordPendingTargetRequest(S),fp(T).unwatch(S)}function hJ(T){T.watchChangeAggregator=new aj({getRemoteKeysForTarget:S=>T.remoteSyncer.getRemoteKeysForTarget(S),getTargetDataForTarget:S=>T.listenTargets.get(S)||null,getDatabaseId:()=>T.datastore.serializer.databaseId}),fp(T).start(),T.onlineStateTracker.handleWatchStreamStart()}function hX(T){return hZ(T)&&!fp(T).isStarted()&&T.listenTargets.size>0}function hZ(T){return 0===eg(T).offlineCauses.size}function h0(T){T.watchChangeAggregator=void 0}async function h1(T){T.onlineStateTracker.set("Online")}async function h2(T){T.listenTargets.forEach((S,R)=>{hQ(T,S)})}async function h3(T,S){h0(T),hX(T)?(T.onlineStateTracker.handleWatchStreamFailure(S),hJ(T)):T.onlineStateTracker.set("Unknown")}async function h4(T,S,R){if(T.onlineStateTracker.set("Online"),S instanceof aM&&2===S.state&&S.cause){try{await h8(T,S)}catch(R){eu(hB,"Failed to remove targets %s: %s ",S.targetIds.join(","),R),await h6(T,R)}return}if(S instanceof aP?T.watchChangeAggregator.handleDocumentChange(S):S instanceof ax?T.watchChangeAggregator.handleExistenceFilter(S):T.watchChangeAggregator.handleTargetChange(S),!R.isEqual(eL.min()))try{let S=await di(T.localStore);R.compareTo(S)>=0&&await h5(T,R)}catch(S){eu(hB,"Failed to raise snapshot:",S),await h6(T,S)}}async function h6(T,S,R){if(ta(S))T.offlineCauses.add(1),await hH(T),T.onlineStateTracker.set("Offline"),R||(R=()=>di(T.localStore)),T.asyncQueue.enqueueRetryable(async()=>{eu(hB,"Retrying IndexedDB access"),await R(),T.offlineCauses.delete(1),await hG(T)});else throw S}function h9(T,S){return S().catch(R=>h6(T,R,S))}function h5(T,S){let R=T.watchChangeAggregator.createRemoteEvent(S);return R.targetChanges.forEach((R,O)=>{if(R.resumeToken.approximateByteSize()>0){let N=T.listenTargets.get(O);N&&T.listenTargets.set(O,N.withResumeToken(R.resumeToken,S))}}),R.targetMismatches.forEach((S,R)=>{let O=T.listenTargets.get(S);O&&(T.listenTargets.set(S,O.withResumeToken(rY.EMPTY_BYTE_STRING,O.snapshotVersion)),hY(T,S),hQ(T,new o3(O.target,S,R,O.sequenceNumber)))}),T.remoteSyncer.applyRemoteEvent(R)}async function h8(T,S){let R=S.cause;for(let O of S.targetIds)T.listenTargets.has(O)&&(await T.remoteSyncer.rejectListen(O,R),T.listenTargets.delete(O),T.watchChangeAggregator.removeTarget(O))}async function h7(T){let S=eg(T),R=fg(S),O=S.writePipeline.length>0?S.writePipeline[S.writePipeline.length-1].batchId:no;for(;fe(S);)try{let T=await dc(S.localStore,O);if(null===T){0===S.writePipeline.length&&R.markIdle();break}O=T.batchId,ft(S,T)}catch(T){await h6(S,T)}fr(S)&&fi(S)}function fe(T){return hZ(T)&&T.writePipeline.length<hV}function ft(T,S){T.writePipeline.push(S);let R=fg(T);R.isOpen()&&R.handshakeComplete&&R.writeMutations(S.mutations)}function fr(T){return hZ(T)&&!fg(T).isStarted()&&T.writePipeline.length>0}function fi(T){fg(T).start()}async function fa(T){fg(T).writeHandshake()}async function fo(T){let S=fg(T);for(let R of T.writePipeline)S.writeMutations(R.mutations)}async function fl(T,S,R){let O=T.writePipeline.shift(),N=am.from(O,S,R);await h9(T,()=>T.remoteSyncer.applySuccessfulWrite(N)),await h7(T)}async function fu(T,S){S&&fg(T).handshakeComplete&&await fc(T,S),fr(T)&&fi(T)}async function fc(T,S){if(aT(S.code)){let R=T.writePipeline.shift();fg(T).inhibitBackoff(),await h9(T,()=>T.remoteSyncer.rejectFailedWrite(R.batchId,S)),await h7(T)}}async function fd(T){let S=eg(T);S.offlineCauses.add(4),await hH(S),S.onlineStateTracker.set("Unknown"),S.offlineCauses.delete(4),await hG(S)}async function fh(T,S){let R=eg(T);R.asyncQueue.verifyOperationInProgress(),eu(hB,"RemoteStore received new credentials");let O=hZ(R);R.offlineCauses.add(3),await hH(R),O&&R.onlineStateTracker.set("Unknown"),await R.remoteSyncer.handleCredentialChange(S),R.offlineCauses.delete(3),await hG(R)}async function ff(T,S){let R=eg(T);S?(R.offlineCauses.delete(2),await hG(R)):S||(R.offlineCauses.add(2),await hH(R),R.onlineStateTracker.set("Unknown"))}function fp(T){return T.watchStream||(T.watchStream=hM(T.datastore,T.asyncQueue,{onConnected:h1.bind(null,T),onOpen:h2.bind(null,T),onClose:h3.bind(null,T),onWatchChange:h4.bind(null,T)}),T.onNetworkStatusChange.push(async S=>{S?(T.watchStream.inhibitBackoff(),hX(T)?hJ(T):T.onlineStateTracker.set("Unknown")):(await T.watchStream.stop(),h0(T))})),T.watchStream}function fg(T){return T.writeStream||(T.writeStream=hx(T.datastore,T.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:fa.bind(null,T),onClose:fu.bind(null,T),onHandshakeComplete:fo.bind(null,T),onMutationResult:fl.bind(null,T)}),T.onNetworkStatusChange.push(async S=>{S?(T.writeStream.inhibitBackoff(),await h7(T)):(await T.writeStream.stop(),T.writePipeline.length>0&&(eu(hB,`Stopping write stream with ${T.writePipeline.length} pending writes`),T.writePipeline=[]))})),T.writeStream}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fm="AsyncQueue";class fy{constructor(T,S,R,O,N){this.asyncQueue=T,this.timerId=S,this.targetTimeMs=R,this.op=O,this.removalCallback=N,this.deferred=new ev,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(T=>{})}get promise(){return this.deferred.promise}static createAndSchedule(T,S,R,O,N){let P=new fy(T,S,Date.now()+R,O,N);return P.start(R),P}start(T){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),T)}skipDelay(){return this.handleDelayElapsed()}cancel(T){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ey(em.CANCELLED,"Operation cancelled"+(T?": "+T:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(T=>this.deferred.resolve(T))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fv(T,S){if(ec(fm,`${S}: ${T}`),ta(T))return new ey(em.UNAVAILABLE,`${S}: ${T}`);throw T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(T){T?this.comparator=(S,R)=>T(S,R)||ez.comparator(S.key,R.key):this.comparator=(T,S)=>ez.comparator(T.key,S.key),this.keyedMap=sE(),this.sortedSet=new rU(this.comparator)}static emptySet(T){return new fb(T.comparator)}has(T){return null!=this.keyedMap.get(T)}get(T){return this.keyedMap.get(T)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(T){let S=this.keyedMap.get(T);return S?this.sortedSet.indexOf(S):-1}get size(){return this.sortedSet.size}forEach(T){this.sortedSet.inorderTraversal((S,R)=>(T(S),!1))}add(T){let S=this.delete(T.key);return S.copy(S.keyedMap.insert(T.key,T),S.sortedSet.insert(T,null))}delete(T){let S=this.get(T);return S?this.copy(this.keyedMap.remove(T),this.sortedSet.remove(S)):this}isEqual(T){if(!(T instanceof fb)||this.size!==T.size)return!1;let S=this.sortedSet.getIterator(),R=T.sortedSet.getIterator();for(;S.hasNext();){let T=S.getNext().key,O=R.getNext().key;if(!T.isEqual(O))return!1}return!0}toString(){let T=[];return(this.forEach(S=>{T.push(S.toString())}),0===T.length)?"DocumentSet ()":"DocumentSet (\n  "+T.join("  \n")+"\n)"}copy(T,S){let R=new fb;return R.comparator=this.comparator,R.keyedMap=T,R.sortedSet=S,R}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(){this.changeMap=new rU(ez.comparator)}track(T){let S=T.doc.key,R=this.changeMap.get(S);if(!R){this.changeMap=this.changeMap.insert(S,T);return}0!==T.type&&3===R.type?this.changeMap=this.changeMap.insert(S,T):3===T.type&&1!==R.type?this.changeMap=this.changeMap.insert(S,{type:R.type,doc:T.doc}):2===T.type&&2===R.type?this.changeMap=this.changeMap.insert(S,{type:2,doc:T.doc}):2===T.type&&0===R.type?this.changeMap=this.changeMap.insert(S,{type:0,doc:T.doc}):1===T.type&&0===R.type?this.changeMap=this.changeMap.remove(S):1===T.type&&2===R.type?this.changeMap=this.changeMap.insert(S,{type:1,doc:R.doc}):0===T.type&&1===R.type?this.changeMap=this.changeMap.insert(S,{type:2,doc:T.doc}):ef()}getChanges(){let T=[];return this.changeMap.inorderTraversal((S,R)=>{T.push(R)}),T}}class fS{constructor(T,S,R,O,N,P,M,L,U){this.query=T,this.docs=S,this.oldDocs=R,this.docChanges=O,this.mutatedKeys=N,this.fromCache=P,this.syncStateChanged=M,this.excludesMetadataChanges=L,this.hasCachedResults=U}static fromInitialDocuments(T,S,R,O,N){let P=[];return S.forEach(T=>{P.push({type:0,doc:T})}),new fS(T,S,fb.emptySet(S),P,R,O,!0,!1,N)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(T){if(this.fromCache!==T.fromCache||this.hasCachedResults!==T.hasCachedResults||this.syncStateChanged!==T.syncStateChanged||!this.mutatedKeys.isEqual(T.mutatedKeys)||!sl(this.query,T.query)||!this.docs.isEqual(T.docs)||!this.oldDocs.isEqual(T.oldDocs))return!1;let S=this.docChanges,R=T.docChanges;if(S.length!==R.length)return!1;for(let T=0;T<S.length;T++)if(S[T].type!==R[T].type||!S[T].doc.isEqual(R[T].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(T=>T.listensToRemoteStore())}}function fE(){return new fw}class fw{constructor(){this.queries=fC(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){fN(this,new ey(em.ABORTED,"Firestore shutting down"))}}function fC(){return new sb(T=>su(T),sl)}async function fI(T,S){let R=eg(T),O=3,N=S.query,P=R.queries.get(N);P?!P.hasRemoteListeners()&&S.listensToRemoteStore()&&(O=2):(P=new f_,O=S.listensToRemoteStore()?0:1);try{switch(O){case 0:P.viewSnap=await R.onListen(N,!0);break;case 1:P.viewSnap=await R.onListen(N,!1);break;case 2:await R.onFirstRemoteStoreListen(N)}}catch(R){let T=fv(R,`Initialization of query '${sc(S.query)}' failed`);S.onError(T);return}R.queries.set(N,P),P.listeners.push(S),S.applyOnlineStateChange(R.onlineState),P.viewSnap&&S.onViewSnapshot(P.viewSnap)&&fD(R)}async function fR(T,S){let R=eg(T),O=S.query,N=3,P=R.queries.get(O);if(P){let T=P.listeners.indexOf(S);T>=0&&(P.listeners.splice(T,1),0===P.listeners.length?N=S.listensToRemoteStore()?0:1:!P.hasRemoteListeners()&&S.listensToRemoteStore()&&(N=2))}switch(N){case 0:return R.queries.delete(O),R.onUnlisten(O,!0);case 1:return R.queries.delete(O),R.onUnlisten(O,!1);case 2:return R.onLastRemoteStoreUnlisten(O);default:return}}function fO(T,S){let R=eg(T),O=!1;for(let T of S){let S=T.query,N=R.queries.get(S);if(N){for(let S of N.listeners)S.onViewSnapshot(T)&&(O=!0);N.viewSnap=T}}O&&fD(R)}function fA(T,S,R){let O=eg(T),N=O.queries.get(S);if(N)for(let T of N.listeners)T.onError(R);O.queries.delete(S)}function fk(T,S){let R=eg(T);R.onlineState=S;let O=!1;R.queries.forEach((T,R)=>{for(let T of R.listeners)T.applyOnlineStateChange(S)&&(O=!0)}),O&&fD(R)}function fN(T,S){let R=eg(T),O=R.queries;R.queries=fC(),O.forEach((T,R)=>{for(let T of R.listeners)T.onError(S)})}function fD(T){T.snapshotsInSyncListeners.forEach(T=>{T.next()})}!function(T){T.Default="default",T.Cache="cache"}(M||(M={}));class fP{constructor(T,S,R){this.query=T,this.queryObserver=S,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=R||{}}onViewSnapshot(T){if(!this.options.includeMetadataChanges){let S=[];for(let R of T.docChanges)3!==R.type&&S.push(R);T=new fS(T.query,T.docs,T.oldDocs,S,T.mutatedKeys,T.fromCache,T.syncStateChanged,!0,T.hasCachedResults)}let S=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(T)&&(this.queryObserver.next(T),S=!0):this.shouldRaiseInitialEvent(T,this.onlineState)&&(this.raiseInitialEvent(T),S=!0),this.snap=T,S}onError(T){this.queryObserver.error(T)}applyOnlineStateChange(T){this.onlineState=T;let S=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,T)&&(this.raiseInitialEvent(this.snap),S=!0),S}shouldRaiseInitialEvent(T,S){if(!T.fromCache||!this.listensToRemoteStore())return!0;let R="Offline"!==S;return(!this.options.waitForSyncWhenOnline||!R)&&(!T.docs.isEmpty()||T.hasCachedResults||"Offline"===S)}shouldRaiseEvent(T){if(T.docChanges.length>0)return!0;let S=this.snap&&this.snap.hasPendingWrites!==T.hasPendingWrites;return(!!T.syncStateChanged||!!S)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(T){T=fS.fromInitialDocuments(T.query,T.docs,T.mutatedKeys,T.fromCache,T.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(T)}listensToRemoteStore(){return this.options.source!==M.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(T,S,R,O){this.targetId=T,this.fromCache=S,this.addedKeys=R,this.removedKeys=O}static fromSnapshot(T,S){let R=sD(),O=sD();for(let T of S.docChanges)switch(T.type){case 0:R=R.add(T.doc.key);break;case 1:O=O.add(T.doc.key)}return new fx(T,S.fromCache,R,O)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(T){this.serializer=T}toDocumentKey(T){return a6(this.serializer,T)}toMutableDocument(T){return T.metadata.exists?on(this.serializer,T.document,!1):ii.newNoDocument(this.toDocumentKey(T.metadata.name),this.toSnapshotVersion(T.metadata.readTime))}toSnapshotVersion(T){return a0(T)}}class fL{constructor(T,S,R){this.bundleMetadata=T,this.localStore=S,this.serializer=R,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=fF(T)}addSizedElement(T){this.progress.bytesLoaded+=T.byteLength;let S=this.progress.documentsLoaded;if(T.payload.namedQuery)this.queries.push(T.payload.namedQuery);else if(T.payload.documentMetadata){this.documents.push({metadata:T.payload.documentMetadata}),!T.payload.documentMetadata.exists&&++S;let R=eU.fromString(T.payload.documentMetadata.name);this.collectionGroups.add(R.get(R.length-2))}else T.payload.document&&(this.documents[this.documents.length-1].document=T.payload.document,++S);return S!==this.progress.documentsLoaded?(this.progress.documentsLoaded=S,Object.assign({},this.progress)):null}getQueryDocumentMapping(T){let S=new Map,R=new fM(this.serializer);for(let O of T)if(O.metadata.queries){let T=R.toDocumentKey(O.metadata.name);for(let R of O.metadata.queries){let O=(S.get(R)||sD()).add(T);S.set(R,O)}}return S}async complete(){let T=await dI(this.localStore,new fM(this.serializer),this.documents,this.bundleMetadata.id),S=this.getQueryDocumentMapping(this.documents);for(let T of this.queries)await dA(this.localStore,T,S.get(T.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:T}}}function fF(T){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:T.totalDocuments,totalBytes:T.totalBytes}}function fj(T){return{taskState:"Success",documentsLoaded:T.totalDocuments,bytesLoaded:T.totalBytes,totalDocuments:T.totalDocuments,totalBytes:T.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(T){this.key=T}}class fB{constructor(T){this.key=T}}class fV{constructor(T,S){this.query=T,this._syncedDocuments=S,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=sD(),this.mutatedKeys=sD(),this.docComparator=sy(T),this.documentSet=new fb(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(T,S){let R=S?S.changeSet:new fT,O=S?S.documentSet:this.documentSet,N=S?S.mutatedKeys:this.mutatedKeys,P=O,M=!1,L="F"===this.query.limitType&&O.size===this.query.limit?O.last():null,U="L"===this.query.limitType&&O.size===this.query.limit?O.first():null;if(T.inorderTraversal((T,S)=>{let V=O.get(T),$=sd(this.query,S)?S:null,K=!!V&&this.mutatedKeys.has(V.key),W=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations),Q=!1;V&&$?V.data.isEqual($.data)?K!==W&&(R.track({type:3,doc:$}),Q=!0):!this.shouldWaitForSyncedDocument(V,$)&&(R.track({type:2,doc:$}),Q=!0,(L&&this.docComparator($,L)>0||U&&0>this.docComparator($,U))&&(M=!0)):!V&&$?(R.track({type:0,doc:$}),Q=!0):V&&!$&&(R.track({type:1,doc:V}),Q=!0,(L||U)&&(M=!0)),Q&&($?(P=P.add($),N=W?N.add(T):N.delete(T)):(P=P.delete(T),N=N.delete(T)))}),null!==this.query.limit)for(;P.size>this.query.limit;){let T="F"===this.query.limitType?P.last():P.first();P=P.delete(T.key),N=N.delete(T.key),R.track({type:1,doc:T})}return{documentSet:P,changeSet:R,needsRefill:M,mutatedKeys:N}}shouldWaitForSyncedDocument(T,S){return T.hasLocalMutations&&S.hasCommittedMutations&&!S.hasLocalMutations}applyChanges(T,S,R,O){let N=this.documentSet;this.documentSet=T.documentSet,this.mutatedKeys=T.mutatedKeys;let P=T.changeSet.getChanges();P.sort((T,S)=>fz(T.type,S.type)||this.docComparator(T.doc,S.doc)),this.applyTargetChange(R),O=null!=O&&O;let M=S&&!O?this.updateLimboDocuments():[],L=0===this.limboDocuments.size&&this.current&&!O?1:0,U=L!==this.syncState;return(this.syncState=L,0!==P.length||U)?{snapshot:new fS(this.query,T.documentSet,N,P,T.mutatedKeys,0===L,U,!1,!!R&&R.resumeToken.approximateByteSize()>0),limboChanges:M}:{limboChanges:M}}applyOnlineStateChange(T){return this.current&&"Offline"===T?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new fT,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(T){return!this._syncedDocuments.has(T)&&!!this.documentSet.has(T)&&!this.documentSet.get(T).hasLocalMutations}applyTargetChange(T){T&&(T.addedDocuments.forEach(T=>this._syncedDocuments=this._syncedDocuments.add(T)),T.modifiedDocuments.forEach(T=>{}),T.removedDocuments.forEach(T=>this._syncedDocuments=this._syncedDocuments.delete(T)),this.current=T.current)}updateLimboDocuments(){if(!this.current)return[];let T=this.limboDocuments;this.limboDocuments=sD(),this.documentSet.forEach(T=>{this.shouldBeInLimbo(T.key)&&(this.limboDocuments=this.limboDocuments.add(T.key))});let S=[];return T.forEach(T=>{this.limboDocuments.has(T)||S.push(new fB(T))}),this.limboDocuments.forEach(R=>{T.has(R)||S.push(new fU(R))}),S}synchronizeWithPersistedState(T){this._syncedDocuments=T.remoteKeys,this.limboDocuments=sD();let S=this.computeDocChanges(T.documents);return this.applyChanges(S,!0)}computeInitialSnapshot(){return fS.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function fz(T,S){let R=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ef()}};return R(T)-R(S)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fq="SyncEngine";class fG{constructor(T,S,R){this.query=T,this.targetId=S,this.view=R}}class fH{constructor(T){this.key=T,this.receivedDocument=!1}}class f${constructor(T,S,R,O,N,P){this.localStore=T,this.remoteStore=S,this.eventManager=R,this.sharedClientState=O,this.currentUser=N,this.maxConcurrentLimboResolutions=P,this.syncEngineListener={},this.queryViewsByQuery=new sb(T=>su(T),sl),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new rU(ez.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new co,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=uP.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function fK(T,S,R,O,N,P,M){let L=new f$(T,S,R,O,N,P);return M&&(L._isPrimaryClient=!0),L}async function fW(T,S,R=!0){let O;let N=pS(T),P=N.queryViewsByQuery.get(S);return P?(N.sharedClientState.addLocalQueryTarget(P.targetId),O=P.view.computeInitialSnapshot()):O=await fY(N,S,R,!0),O}async function fQ(T,S){let R=pS(T);await fY(R,S,!0,!1)}async function fY(T,S,R,O){let N;let P=await dh(T.localStore,se(S)),M=P.targetId,L=T.sharedClientState.addLocalQueryTarget(M,R);return O&&(N=await fJ(T,S,M,"current"===L,P.resumeToken)),T.isPrimaryClient&&R&&hK(T.remoteStore,P),N}async function fJ(T,S,R,O,N){T.applyDocChanges=(S,R,O)=>pl(T,S,R,O);let P=await dg(T.localStore,S,!0),M=new fV(S,P.remoteKeys),L=M.computeDocChanges(P.documents),U=aD.createSynthesizedTargetChangeForCurrentChange(R,O&&"Offline"!==T.onlineState,N),V=M.applyChanges(L,T.isPrimaryClient,U);pi(T,R,V.limboChanges);let $=new fG(S,R,M);return T.queryViewsByQuery.set(S,$),T.queriesByTarget.has(R)?T.queriesByTarget.get(R).push(S):T.queriesByTarget.set(R,[S]),V.snapshot}async function fX(T,S,R){let O=eg(T),N=O.queryViewsByQuery.get(S),P=O.queriesByTarget.get(N.targetId);if(P.length>1){O.queriesByTarget.set(N.targetId,P.filter(T=>!sl(T,S))),O.queryViewsByQuery.delete(S);return}O.isPrimaryClient?(O.sharedClientState.removeLocalQueryTarget(N.targetId),O.sharedClientState.isActiveQueryTarget(N.targetId)||await dp(O.localStore,N.targetId,!1).then(()=>{O.sharedClientState.clearQueryState(N.targetId),R&&hW(O.remoteStore,N.targetId),pr(O,N.targetId)}).catch(e9)):(pr(O,N.targetId),await dp(O.localStore,N.targetId,!0))}async function fZ(T,S){let R=eg(T),O=R.queryViewsByQuery.get(S),N=R.queriesByTarget.get(O.targetId);R.isPrimaryClient&&1===N.length&&(R.sharedClientState.removeLocalQueryTarget(O.targetId),hW(R.remoteStore,O.targetId))}async function f0(T,S,R){let O=p_(T);try{let T=await c7(O.localStore,S);O.sharedClientState.addPendingMutation(T.batchId),pe(O,T.batchId,R),await po(O,T.changes),await h7(O.remoteStore)}catch(S){let T=fv(S,"Failed to persist write");R.reject(T)}}async function f3(T,S){let R=eg(T);try{let T=await ds(R.localStore,S);S.targetChanges.forEach((T,S)=>{let O=R.activeLimboResolutionsByTarget.get(S);O&&(ep(T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size<=1),T.addedDocuments.size>0?O.receivedDocument=!0:T.modifiedDocuments.size>0?ep(O.receivedDocument):T.removedDocuments.size>0&&(ep(O.receivedDocument),O.receivedDocument=!1))}),await po(R,T,S)}catch(T){await e9(T)}}function f4(T,S,R){let O=eg(T);if(O.isPrimaryClient&&0===R||!O.isPrimaryClient&&1===R){let T=[];O.queryViewsByQuery.forEach((R,O)=>{let N=O.view.applyOnlineStateChange(S);N.snapshot&&T.push(N.snapshot)}),fk(O.eventManager,S),T.length&&O.syncEngineListener.onWatchChange(T),O.onlineState=S,O.isPrimaryClient&&O.sharedClientState.setOnlineState(S)}}async function f6(T,S,R){let O=eg(T);O.sharedClientState.updateQueryState(S,"rejected",R);let N=O.activeLimboResolutionsByTarget.get(S),P=N&&N.key;if(P){let T=new rU(ez.comparator);T=T.insert(P,ii.newNoDocument(P,eL.min()));let R=sD().add(P),N=new aN(eL.min(),new Map,new rU(ek),T,R);await f3(O,N),O.activeLimboTargetsByKey=O.activeLimboTargetsByKey.remove(P),O.activeLimboResolutionsByTarget.delete(S),pa(O)}else await dp(O.localStore,S,!1).then(()=>pr(O,S,R)).catch(e9)}async function f9(T,S){let R=eg(T),O=S.batch.batchId;try{let T=await de(R.localStore,S);pt(R,O,null),f8(R,O),R.sharedClientState.updateMutationState(O,"acknowledged"),await po(R,T)}catch(T){await e9(T)}}async function f5(T,S,R){let O=eg(T);try{let T=await dr(O.localStore,S);pt(O,S,R),f8(O,S),O.sharedClientState.updateMutationState(S,"rejected",R),await po(O,T)}catch(T){await e9(T)}}function f8(T,S){(T.pendingWritesCallbacks.get(S)||[]).forEach(T=>{T.resolve()}),T.pendingWritesCallbacks.delete(S)}function f7(T,S){T.pendingWritesCallbacks.forEach(T=>{T.forEach(T=>{T.reject(new ey(em.CANCELLED,S))})}),T.pendingWritesCallbacks.clear()}function pe(T,S,R){let O=T.mutationUserCallbacks[T.currentUser.toKey()];O||(O=new rU(ek)),O=O.insert(S,R),T.mutationUserCallbacks[T.currentUser.toKey()]=O}function pt(T,S,R){let O=eg(T),N=O.mutationUserCallbacks[O.currentUser.toKey()];if(N){let T=N.get(S);T&&(R?T.reject(R):T.resolve(),N=N.remove(S)),O.mutationUserCallbacks[O.currentUser.toKey()]=N}}function pr(T,S,R=null){for(let O of(T.sharedClientState.removeLocalQueryTarget(S),T.queriesByTarget.get(S)))T.queryViewsByQuery.delete(O),R&&T.syncEngineListener.onWatchError(O,R);T.queriesByTarget.delete(S),T.isPrimaryClient&&T.limboDocumentRefs.removeReferencesForId(S).forEach(S=>{T.limboDocumentRefs.containsKey(S)||pn(T,S)})}function pn(T,S){T.enqueuedLimboResolutions.delete(S.path.canonicalString());let R=T.activeLimboTargetsByKey.get(S);null!==R&&(hW(T.remoteStore,R),T.activeLimboTargetsByKey=T.activeLimboTargetsByKey.remove(S),T.activeLimboResolutionsByTarget.delete(R),pa(T))}function pi(T,S,R){for(let O of R)O instanceof fU?(T.limboDocumentRefs.addReference(O.key,S),ps(T,O)):O instanceof fB?(eu(fq,"Document no longer in limbo: "+O.key),T.limboDocumentRefs.removeReference(O.key,S),T.limboDocumentRefs.containsKey(O.key)||pn(T,O.key)):ef()}function ps(T,S){let R=S.key,O=R.path.canonicalString();T.activeLimboTargetsByKey.get(R)||T.enqueuedLimboResolutions.has(O)||(eu(fq,"New document in limbo: "+R),T.enqueuedLimboResolutions.add(O),pa(T))}function pa(T){for(;T.enqueuedLimboResolutions.size>0&&T.activeLimboTargetsByKey.size<T.maxConcurrentLimboResolutions;){let S=T.enqueuedLimboResolutions.values().next().value;T.enqueuedLimboResolutions.delete(S);let R=new ez(eU.fromString(S)),O=T.limboTargetIdGenerator.next();T.activeLimboResolutionsByTarget.set(O,new fH(R)),T.activeLimboTargetsByKey=T.activeLimboTargetsByKey.insert(R,O),hK(T.remoteStore,new o3(se(i3(R.path)),O,"TargetPurposeLimboResolution",tv.INVALID))}}async function po(T,S,R){let O=eg(T),N=[],P=[],M=[];O.queryViewsByQuery.isEmpty()||(O.queryViewsByQuery.forEach((T,L)=>{M.push(O.applyDocChanges(L,S,R).then(T=>{var S;if((T||R)&&O.isPrimaryClient){let N=T?!T.fromCache:null===(S=null==R?void 0:R.targetChanges.get(L.targetId))||void 0===S?void 0:S.current;O.sharedClientState.updateQueryState(L.targetId,N?"current":"not-current")}if(T){N.push(T);let S=fx.fromSnapshot(L.targetId,T);P.push(S)}}))}),await Promise.all(M),O.syncEngineListener.onWatchChange(N),await du(O.localStore,P))}async function pl(T,S,R,O){let N=S.view.computeDocChanges(R);N.needsRefill&&(N=await dg(T.localStore,S.query,!1).then(({documents:T})=>S.view.computeDocChanges(T,N)));let P=O&&O.targetChanges.get(S.targetId),M=O&&null!=O.targetMismatches.get(S.targetId),L=S.view.applyChanges(N,T.isPrimaryClient,P,M);return pi(T,S.targetId,L.limboChanges),L.snapshot}async function pu(T,S){let R=eg(T);if(!R.currentUser.isEqual(S)){eu(fq,"User change. New user:",S.toKey());let T=await c8(R.localStore,S);R.currentUser=S,f7(R,"'waitForPendingWrites' promise is rejected due to a user change."),R.sharedClientState.handleUserChange(S,T.removedBatchIds,T.addedBatchIds),await po(R,T.affectedDocuments)}}function pc(T,S){let R=eg(T),O=R.activeLimboResolutionsByTarget.get(S);if(O&&O.receivedDocument)return sD().add(O.key);{let T=sD(),O=R.queriesByTarget.get(S);if(!O)return T;for(let S of O){let O=R.queryViewsByQuery.get(S);T=T.unionWith(O.view.syncedDocuments)}return T}}async function pd(T,S){let R=eg(T),O=await dg(R.localStore,S.query,!0),N=S.view.synchronizeWithPersistedState(O);return R.isPrimaryClient&&pi(R,S.targetId,N.limboChanges),N}async function ph(T,S){let R=eg(T);return dE(R.localStore,S).then(T=>po(R,T))}async function pf(T,S,R,O){let N=eg(T),P=await dy(N.localStore,S);if(null===P){eu(fq,"Cannot apply mutation batch with id: "+S);return}"pending"===R?await h7(N.remoteStore):"acknowledged"===R||"rejected"===R?(pt(N,S,O||null),f8(N,S),dT(N.localStore,S)):ef(),await po(N,P)}async function pp(T,S){let R=eg(T);if(pS(R),p_(R),!0===S&&!0!==R._isPrimaryClient){let T=R.sharedClientState.getAllActiveQueryTargets(),S=await pm(R,T.toArray());for(let T of(R._isPrimaryClient=!0,await ff(R.remoteStore,!0),S))hK(R.remoteStore,T)}else if(!1===S&&!1!==R._isPrimaryClient){let T=[],S=Promise.resolve();R.queriesByTarget.forEach((O,N)=>{R.sharedClientState.isLocalQueryTarget(N)?T.push(N):S=S.then(()=>(pr(R,N),dp(R.localStore,N,!0))),hW(R.remoteStore,N)}),await S,await pm(R,T),pg(R),R._isPrimaryClient=!1,await ff(R.remoteStore,!1)}}function pg(T){let S=eg(T);S.activeLimboResolutionsByTarget.forEach((T,R)=>{hW(S.remoteStore,R)}),S.limboDocumentRefs.removeAllReferences(),S.activeLimboResolutionsByTarget=new Map,S.activeLimboTargetsByKey=new rU(ez.comparator)}async function pm(T,S,R){let O=eg(T),N=[],P=[];for(let T of S){let S;let R=O.queriesByTarget.get(T);if(R&&0!==R.length)for(let T of(S=await dh(O.localStore,se(R[0])),R)){let S=O.queryViewsByQuery.get(T),R=await pd(O,S);R.snapshot&&P.push(R.snapshot)}else{let R=await d_(O.localStore,T);S=await dh(O.localStore,R),await fJ(O,py(R),T,!1,S.resumeToken)}N.push(S)}return O.syncEngineListener.onWatchChange(P),N}function py(T){return i2(T.path,T.collectionGroup,T.orderBy,T.filters,T.limit,"F",T.startAt,T.endAt)}function pv(T){return dS(eg(T).localStore)}async function pb(T,S,R,O){let N=eg(T);if(N._isPrimaryClient){eu(fq,"Ignoring unexpected query state notification.");return}let P=N.queriesByTarget.get(S);if(P&&P.length>0)switch(R){case"current":case"not-current":{let T=await dE(N.localStore,sm(P[0])),O=aN.createSynthesizedRemoteEventForCurrentChange(S,"current"===R,rY.EMPTY_BYTE_STRING);await po(N,T,O);break}case"rejected":await dp(N.localStore,S,!0),pr(N,S,O);break;default:ef()}}async function pT(T,S,R){let O=pS(T);if(O._isPrimaryClient){for(let T of S){if(O.queriesByTarget.has(T)&&O.sharedClientState.isActiveQueryTarget(T)){eu(fq,"Adding an already active target "+T);continue}let S=await d_(O.localStore,T),R=await dh(O.localStore,S);await fJ(O,py(S),R.targetId,!1,R.resumeToken),hK(O.remoteStore,R)}for(let T of R)O.queriesByTarget.has(T)&&await dp(O.localStore,T,!1).then(()=>{hW(O.remoteStore,T),pr(O,T)}).catch(e9)}}function pS(T){let S=eg(T);return S.remoteStore.remoteSyncer.applyRemoteEvent=f3.bind(null,S),S.remoteStore.remoteSyncer.getRemoteKeysForTarget=pc.bind(null,S),S.remoteStore.remoteSyncer.rejectListen=f6.bind(null,S),S.syncEngineListener.onWatchChange=fO.bind(null,S.eventManager),S.syncEngineListener.onWatchError=fA.bind(null,S.eventManager),S}function p_(T){let S=eg(T);return S.remoteStore.remoteSyncer.applySuccessfulWrite=f9.bind(null,S),S.remoteStore.remoteSyncer.rejectFailedWrite=f5.bind(null,S),S}async function pE(T,S,R){try{let O=await S.getMetadata();if(await dR(T.localStore,O))return await S.close(),R._completeWith(fj(O)),Promise.resolve(new Set);R._updateProgress(fF(O));let N=new fL(O,T.localStore,S.serializer),P=await S.nextElement();for(;P;){let T=await N.addSizedElement(P);T&&R._updateProgress(T),P=await S.nextElement()}let M=await N.complete();return await po(T,M.changedDocs,void 0),await dO(T.localStore,O),R._completeWith(M.progress),Promise.resolve(M.changedCollectionGroups)}catch(T){return ed(fq,`Loading bundle failed with ${T}`),R._failWith(T),Promise.resolve(new Set)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(T){this.serializer=hg(T.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(T),this.persistence=this.createPersistence(T),await this.persistence.start(),this.localStore=this.createLocalStore(T),this.gcScheduler=this.createGarbageCollectionScheduler(T,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(T,this.localStore)}createGarbageCollectionScheduler(T,S){return null}createIndexBackfillerScheduler(T,S){return null}createLocalStore(T){return c5(this.persistence,new dx,T.initialUser,this.serializer)}createPersistence(T){return new cy(cT.factory,this.serializer)}createSharedClientState(T){return new d3}async terminate(){var T,S;null===(T=this.gcScheduler)||void 0===T||T.stop(),null===(S=this.indexBackfillerScheduler)||void 0===S||S.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pw.provider={build:()=>new pw};class pC extends null{constructor(T,S,R){super(),this.onlineComponentProvider=T,this.cacheSizeBytes=S,this.forceOwnership=R,this.kind="persistent",this.synchronizeTabs=!1}async initialize(T){await super.initialize(T),await this.onlineComponentProvider.initialize(this,T),await p_(this.onlineComponentProvider.syncEngine),await h7(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(T){return c5(this.persistence,new dx,T.initialUser,this.serializer)}createGarbageCollectionScheduler(T,S){return new uW(this.persistence.referenceDelegate.garbageCollector,T.asyncQueue,S)}createIndexBackfillerScheduler(T,S){let R=new ty(S,this.persistence);return new tm(T.asyncQueue,R)}createPersistence(T){let S=cX(T.databaseInfo.databaseId,T.databaseInfo.persistenceKey),R=void 0!==this.cacheSizeBytes?uV.withCacheSize(this.cacheSizeBytes):uV.DEFAULT;return new cQ(this.synchronizeTabs,S,T.clientId,R,T.asyncQueue,hf(),hp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(T){return new d3}}class pI{async initialize(T,S){this.localStore||(this.localStore=T.localStore,this.sharedClientState=T.sharedClientState,this.datastore=this.createDatastore(S),this.remoteStore=this.createRemoteStore(S),this.eventManager=this.createEventManager(S),this.syncEngine=this.createSyncEngine(S,!T.synchronizeTabs),this.sharedClientState.onlineStateHandler=T=>f4(this.syncEngine,T,1),this.remoteStore.remoteSyncer.handleCredentialChange=pu.bind(null,this.syncEngine),await ff(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(T){return fE()}createDatastore(T){let S=hg(T.databaseInfo.databaseId),R=hd(T.databaseInfo);return hk(T.authCredentials,T.appCheckCredentials,R,S)}createRemoteStore(T){return hq(this.localStore,this.datastore,T.asyncQueue,T=>f4(this.syncEngine,T,0),hh())}createSyncEngine(T,S){return fK(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,T.initialUser,T.maxConcurrentLimboResolutions,S)}async terminate(){var T,S;await h$(this.remoteStore),null===(T=this.datastore)||void 0===T||T.terminate(),null===(S=this.eventManager)||void 0===S||S.terminate()}}pI.provider={build:()=>new pI};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pR=10240;function pO(T,S=pR){let R=0;return{async read(){if(R<T.byteLength){let O={value:T.slice(R,R+S),done:!1};return R+=S,O}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pA(T,S,R){if(!R)throw new ey(em.INVALID_ARGUMENT,`Function ${T}() cannot be called with an empty ${S}.`)}function pk(T,S,R,O){if(!0===S&&!0===O)throw new ey(em.INVALID_ARGUMENT,`${T} and ${R} cannot be used together.`)}function pN(T){if(!ez.isDocumentKey(T))throw new ey(em.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${T} has ${T.length}.`)}function pD(T){if(ez.isDocumentKey(T))throw new ey(em.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${T} has ${T.length}.`)}function pP(T){return"object"==typeof T&&null!==T&&(Object.getPrototypeOf(T)===Object.prototype||null===Object.getPrototypeOf(T))}function px(T){if(void 0===T)return"undefined";if(null===T)return"null";if("string"==typeof T)return T.length>20&&(T=`${T.substring(0,20)}...`),JSON.stringify(T);if("number"==typeof T||"boolean"==typeof T)return""+T;if("object"==typeof T){if(T instanceof Array)return"an array";{let S=pM(T);return S?`a custom ${S} object`:"an object"}}if("function"==typeof T)return"a function";return ef()}function pM(T){return T.constructor?T.constructor.name:null}function pL(T,S){if("_delegate"in T&&(T=T._delegate),!(T instanceof S)){if(S.name===T.constructor.name)throw new ey(em.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let R=px(T);throw new ey(em.INVALID_ARGUMENT,`Expected type '${S.name}', but it was: ${R}`)}}return T}function pF(T,S){if(S<=0)throw new ey(em.INVALID_ARGUMENT,`Function ${T}() requires a positive number, but it was: ${S}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pj(T,S){if(!(T instanceof Uint8Array))throw new ey(em.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${px(T)}`);return pO(T,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(T){this.observer=T,this.muted=!1}next(T){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,T)}error(T){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,T):ec("Uncaught Error in snapshot listener:",T.toString()))}mute(){this.muted=!0}scheduleEvent(T,S){setTimeout(()=>{this.muted||T(S)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pB{constructor(T,S){this.payload=T,this.byteLength=S}isBundleMetadata(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(T,S){this.reader=T,this.serializer=S,this.metadata=new ev,this.buffer=new Uint8Array,this.textDecoder=aC(),this.nextElementImpl().then(T=>{T&&T.isBundleMetadata()?this.metadata.resolve(T.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==T?void 0:T.payload)}`))},T=>this.metadata.reject(T))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let T=await this.readLength();if(null===T)return null;let S=this.textDecoder.decode(T),R=Number(S);return isNaN(R)&&this.raiseError(`length string (${S}) is not valid number`),new pB(JSON.parse(await this.readJsonString(R)),T.length+R)}indexOfOpenBracket(){return this.buffer.findIndex(T=>123===T)}async readLength(){for(;0>this.indexOfOpenBracket()&&!await this.pullMoreDataToBuffer(););if(0===this.buffer.length)return null;let T=this.indexOfOpenBracket();T<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let S=this.buffer.slice(0,T);return this.buffer=this.buffer.slice(T),S}async readJsonString(T){for(;this.buffer.length<T;)await this.pullMoreDataToBuffer()&&this.raiseError("Reached the end of bundle when more is expected.");let S=this.textDecoder.decode(this.buffer.slice(0,T));return this.buffer=this.buffer.slice(T),S}raiseError(T){throw this.reader.cancel(),Error(`Invalid bundle format: ${T}`)}async pullMoreDataToBuffer(){let T=await this.reader.read();if(!T.done){let S=new Uint8Array(this.buffer.length+T.value.length);S.set(this.buffer),S.set(T.value,this.buffer.length),this.buffer=S}return T.done}}function pz(T,S){return new pV(T,S)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pq{constructor(T){this.datastore=T,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(T){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ey(em.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let S=await hD(this.datastore,T);return S.forEach(T=>this.recordVersion(T)),S}set(T,S){this.write(S.toMutation(T,this.precondition(T))),this.writtenDocs.add(T.toString())}update(T,S){try{this.write(S.toMutation(T,this.preconditionForUpdate(T)))}catch(T){this.lastTransactionError=T}this.writtenDocs.add(T.toString())}delete(T){this.write(new ad(T,this.precondition(T))),this.writtenDocs.add(T.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let T=this.readVersions;this.mutations.forEach(S=>{T.delete(S.key.toString())}),T.forEach((T,S)=>{let R=ez.fromPath(S);this.mutations.push(new ap(R,this.precondition(R)))}),await hN(this.datastore,this.mutations),this.committed=!0}recordVersion(T){let S;if(T.isFoundDocument())S=T.version;else if(T.isNoDocument())S=eL.min();else throw ef();let R=this.readVersions.get(T.key.toString());if(R){if(!S.isEqual(R))throw new ey(em.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(T.key.toString(),S)}precondition(T){let S=this.readVersions.get(T.toString());return this.writtenDocs.has(T.toString())||!S?s4.none():S.isEqual(eL.min())?s4.exists(!1):s4.updateTime(S)}preconditionForUpdate(T){let S=this.readVersions.get(T.toString());if(this.writtenDocs.has(T.toString())||!S)return s4.exists(!0);if(S.isEqual(eL.min()))throw new ey(em.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return s4.updateTime(S)}write(T){this.ensureCommitNotCalled(),this.mutations.push(T)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pG="FirestoreClient",pH=100,p$=11,pK=20,pW=22;class pQ{constructor(T,S,R,O,N){this.authCredentials=T,this.appCheckCredentials=S,this.asyncQueue=R,this.databaseInfo=O,this.user=er.UNAUTHENTICATED,this.clientId=eA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=N,this.authCredentials.start(R,async T=>{eu(pG,"Received user=",T.uid),await this.authCredentialListener(T),this.user=T}),this.appCheckCredentials.start(R,T=>(eu(pG,"Received new app check token=",T),this.appCheckCredentialListener(T,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:pH}}setCredentialChangeListener(T){this.authCredentialListener=T}setAppCheckTokenChangeListener(T){this.appCheckCredentialListener=T}terminate(){this.asyncQueue.enterRestrictedMode();let T=new ev;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),T.resolve()}catch(R){let S=fv(R,"Failed to shutdown persistence");T.reject(S)}}),T.promise}}async function pY(T,S){T.asyncQueue.verifyOperationInProgress(),eu(pG,"Initializing OfflineComponentProvider");let R=T.configuration;await S.initialize(R);let O=R.initialUser;T.setCredentialChangeListener(async T=>{O.isEqual(T)||(await c8(S.localStore,T),O=T)}),S.persistence.setDatabaseDeletedListener(()=>T.terminate()),T._offlineComponents=S}async function pJ(T,S){T.asyncQueue.verifyOperationInProgress();let R=await pZ(T);eu(pG,"Initializing OnlineComponentProvider"),await S.initialize(R,T.configuration),T.setCredentialChangeListener(T=>fh(S.remoteStore,T)),T.setAppCheckTokenChangeListener((T,R)=>fh(S.remoteStore,R)),T._onlineComponents=S}function pX(T){return"FirebaseError"===T.name?T.code===em.FAILED_PRECONDITION||T.code===em.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&T instanceof DOMException)||T.code===pW||T.code===pK||T.code===p$}async function pZ(T){if(!T._offlineComponents){if(T._uninitializedComponentsProvider){eu(pG,"Using user provided OfflineComponentProvider");try{await pY(T,T._uninitializedComponentsProvider._offline)}catch(R){let S=R;if(!pX(S))throw S;ed("Error using user provided cache. Falling back to memory cache: "+S),await pY(T,new pw)}}else eu(pG,"Using default OfflineComponentProvider"),await pY(T,new pw)}return T._offlineComponents}async function p0(T){return T._onlineComponents||(T._uninitializedComponentsProvider?(eu(pG,"Using user provided OnlineComponentProvider"),await pJ(T,T._uninitializedComponentsProvider._online)):(eu(pG,"Using default OnlineComponentProvider"),await pJ(T,new pI))),T._onlineComponents}function p3(T){return pZ(T).then(T=>T.localStore)}function p4(T){return p0(T).then(T=>T.syncEngine)}function p6(T){return p0(T).then(T=>T.datastore)}async function p9(T){let S=await p0(T),R=S.eventManager;return R.onListen=fW.bind(null,S.syncEngine),R.onUnlisten=fX.bind(null,S.syncEngine),R.onFirstRemoteStoreListen=fQ.bind(null,S.syncEngine),R.onLastRemoteStoreUnlisten=fZ.bind(null,S.syncEngine),R}function p5(T,S,R,O){let N=new pU(O),P=new fP(S,N,R);return T.asyncQueue.enqueueAndForget(async()=>fI(await p9(T),P)),()=>{N.mute(),T.asyncQueue.enqueueAndForget(async()=>fR(await p9(T),P))}}function p8(T,S,R={}){let O=new ev;return T.asyncQueue.enqueueAndForget(async()=>gr(await p9(T),T.asyncQueue,S,R,O)),O.promise}function p7(T,S,R={}){let O=new ev;return T.asyncQueue.enqueueAndForget(async()=>gn(await p9(T),T.asyncQueue,S,R,O)),O.promise}function ge(T,S,R){let O=new ev;return T.asyncQueue.enqueueAndForget(async()=>{try{let N=await p6(T);O.resolve(hP(N,S,R))}catch(T){O.reject(T)}}),O.promise}function gt(T,S){let R=new ev;return T.asyncQueue.enqueueAndForget(async()=>f0(await p4(T),S,R)),R.promise}function gr(T,S,R,O,N){let P=new pU({next:L=>{P.mute(),S.enqueueAndForget(()=>fR(T,M));let U=L.docs.has(R);!U&&L.fromCache?N.reject(new ey(em.UNAVAILABLE,"Failed to get document because the client is offline.")):U&&L.fromCache&&O&&"server"===O.source?N.reject(new ey(em.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):N.resolve(L)},error:T=>N.reject(T)}),M=new fP(i3(R.path),P,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return fI(T,M)}function gn(T,S,R,O,N){let P=new pU({next:R=>{P.mute(),S.enqueueAndForget(()=>fR(T,M)),R.fromCache&&"server"===O.source?N.reject(new ey(em.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):N.resolve(R)},error:T=>N.reject(T)}),M=new fP(R,P,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return fI(T,M)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(T,S){return T.timeoutSeconds===S.timeoutSeconds}function gs(T){let S={};return void 0!==T.timeoutSeconds&&(S.timeoutSeconds=T.timeoutSeconds),S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ga="ComponentProvider",go=new Map;function gl(T){let S=go.get(T);S&&(eu(ga,"Removing Datastore"),go.delete(T),S.terminate())}function gu(T,S,R,O){return new nt(T,S,R,O.host,O.ssl,O.experimentalForceLongPolling,O.experimentalAutoDetectLongPolling,gs(O.experimentalLongPollingOptions),O.useFetchStreams)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gc="firestore.googleapis.com",gd=!0,gh=5,gf=30,gp=!0;class gg{constructor(T){var S,R;if(void 0===T.host){if(void 0!==T.ssl)throw new ey(em.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gc,this.ssl=gd}else this.host=T.host,this.ssl=null!==(S=T.ssl)&&void 0!==S?S:gd;if(this.credentials=T.credentials,this.ignoreUndefinedProperties=!!T.ignoreUndefinedProperties,this.localCache=T.localCache,void 0===T.cacheSizeBytes)this.cacheSizeBytes=uB;else{if(T.cacheSizeBytes!==uU&&T.cacheSizeBytes<uq)throw new ey(em.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${uq}`);this.cacheSizeBytes=T.cacheSizeBytes}pk("experimentalForceLongPolling",T.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",T.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!T.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===T.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=gp:this.experimentalAutoDetectLongPolling=!!T.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gs(null!==(R=T.experimentalLongPollingOptions)&&void 0!==R?R:{}),gm(this.experimentalLongPollingOptions),this.useFetchStreams=!!T.useFetchStreams}isEqual(T){return this.host===T.host&&this.ssl===T.ssl&&this.credentials===T.credentials&&this.cacheSizeBytes===T.cacheSizeBytes&&this.experimentalForceLongPolling===T.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===T.experimentalAutoDetectLongPolling&&gi(this.experimentalLongPollingOptions,T.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===T.ignoreUndefinedProperties&&this.useFetchStreams===T.useFetchStreams}}function gm(T){if(void 0!==T.timeoutSeconds){if(isNaN(T.timeoutSeconds))throw new ey(em.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (must not be NaN)`);if(T.timeoutSeconds<gh)throw new ey(em.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (minimum allowed value is ${gh})`);if(T.timeoutSeconds>gf)throw new ey(em.INVALID_ARGUMENT,`invalid long polling timeout: ${T.timeoutSeconds} (maximum allowed value is ${gf})`)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(T,S,R,O){this._authCredentials=T,this._appCheckCredentials=S,this._databaseId=R,this._app=O,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ey(em.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(T){if(this._settingsFrozen)throw new ey(em.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gg(T),void 0!==T.credentials&&(this._authCredentials=eR(T.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return gl(this),Promise.resolve()}}function gv(T,S,R,O={}){var N;let P=(T=pL(T,gy))._getSettings(),M=`${S}:${R}`;if(P.host!==gc&&P.host!==M&&ed("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),T._setSettings(Object.assign(Object.assign({},P),{host:M,ssl:!1})),O.mockUserToken){let S,R;if("string"==typeof O.mockUserToken)S=O.mockUserToken,R=er.MOCK_USER;else{S=(0,K.Sg)(O.mockUserToken,null===(N=T._app)||void 0===N?void 0:N.options.projectId);let P=O.mockUserToken.sub||O.mockUserToken.user_id;if(!P)throw new ey(em.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");R=new er(P)}T._authCredentials=new eS(new eb(S,R))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(T,S,R){this.converter=S,this._query=R,this.type="query",this.firestore=T}withConverter(T){return new gb(this.firestore,T,this._query)}}class gT{constructor(T,S,R){this.converter=S,this._key=R,this.type="document",this.firestore=T}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gS(this.firestore,this.converter,this._key.path.popLast())}withConverter(T){return new gT(this.firestore,T,this._key)}}class gS extends gb{constructor(T,S,R){super(T,S,i3(R)),this._path=R,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let T=this._path.popLast();return T.isEmpty()?null:new gT(this.firestore,null,new ez(T))}withConverter(T){return new gS(this.firestore,T,this._path)}}function g_(T,S,...R){if(T=(0,K.m9)(T),pA("collection","path",S),T instanceof gy){let O=eU.fromString(S,...R);return pD(O),new gS(T,null,O)}{if(!(T instanceof gT)&&!(T instanceof gS))throw new ey(em.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let O=T._path.child(eU.fromString(S,...R));return pD(O),new gS(T.firestore,null,O)}}function gE(T,S,...R){if(T=(0,K.m9)(T),1==arguments.length&&(S=eA.newId()),pA("doc","path",S),T instanceof gy){let O=eU.fromString(S,...R);return pN(O),new gT(T,null,new ez(O))}{if(!(T instanceof gT)&&!(T instanceof gS))throw new ey(em.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let O=T._path.child(eU.fromString(S,...R));return pN(O),new gT(T.firestore,T instanceof gS?T.converter:null,new ez(O))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gw="AsyncQueue";class gC{constructor(T=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new hS(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=T}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(T){this.enqueue(T)}enqueueAndForgetEvenWhileRestricted(T){this.verifyNotFailed(),this.enqueueInternal(T)}enterRestrictedMode(T){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=T||!1)}enqueue(T){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let S=new ev;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(T().then(S.resolve,S.reject),S.promise)).then(()=>S.promise)}enqueueRetryable(T){this.enqueueAndForget(()=>(this.retryableOps.push(T),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(T){if(ta(T))eu(gw,"Operation failed with retryable error: "+T);else throw T}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(T){let S=this.tail.then(()=>(this.operationInProgress=!0,T().catch(T=>{throw this.failure=T,this.operationInProgress=!1,ec("INTERNAL UNHANDLED ERROR: ",gI(T)),T}).then(T=>(this.operationInProgress=!1,T))));return this.tail=S,S}enqueueAfterDelay(T,S,R){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(T)>-1&&(S=0);let O=fy.createAndSchedule(this,T,S,R,T=>this.removeDelayedOperation(T));return this.delayedOperations.push(O),O}verifyNotFailed(){this.failure&&ef()}verifyOperationInProgress(){}async drain(){let T;do T=this.tail,await T;while(T!==this.tail)}containsDelayedOperation(T){for(let S of this.delayedOperations)if(S.timerId===T)return!0;return!1}runAllDelayedOperationsUntil(T){return this.drain().then(()=>{for(let S of(this.delayedOperations.sort((T,S)=>T.targetTimeMs-S.targetTimeMs),this.delayedOperations))if(S.skipDelay(),"all"!==T&&S.timerId===T)break;return this.drain()})}skipDelaysForTimerId(T){this.timerIdsToSkip.push(T)}removeDelayedOperation(T){let S=this.delayedOperations.indexOf(T);this.delayedOperations.splice(S,1)}}function gI(T){let S=T.message||"";return T.stack&&(S=T.stack.includes(T.message)?T.stack:T.message+"\n"+T.stack),S}class gR extends gy{constructor(T,S,R,O){super(T,S,R,O),this.type="firestore",this._queue=new gC,this._persistenceKey=(null==O?void 0:O.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let T=this._firestoreClient.terminate();this._queue=new gC(T),this._firestoreClient=void 0,await T}}}function gO(T,S){let R="object"==typeof T?T:(0,L.Mq)(),O="string"==typeof T?T:S||nn,N=(0,L.qX)(R,"firestore").getImmediate({identifier:O});if(!N._initialized){let T=(0,K.P0)("firestore");T&&gv(N,...T)}return N}function gA(T){if(T._terminated)throw new ey(em.FAILED_PRECONDITION,"The client has already been terminated.");return T._firestoreClient||gk(T),T._firestoreClient}function gk(T){var S,R,O;let N=T._freezeSettings(),P=gu(T._databaseId,(null===(S=T._app)||void 0===S?void 0:S.options.appId)||"",T._persistenceKey,N);!T._componentsProvider&&(null===(R=N.localCache)||void 0===R?void 0:R._offlineComponentProvider)&&(null===(O=N.localCache)||void 0===O?void 0:O._onlineComponentProvider)&&(T._componentsProvider={_offline:N.localCache._offlineComponentProvider,_online:N.localCache._onlineComponentProvider}),T._firestoreClient=new pQ(T._authCredentials,T._appCheckCredentials,T._queue,P,T._componentsProvider&&gN(T._componentsProvider))}function gN(T){let S=null==T?void 0:T._online.build();return{_offline:null==T?void 0:T._offline.build(S),_online:S}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(T,S=!0){ei(L.Jn),(0,L.Xd)(new U.wA("firestore",(T,{instanceIdentifier:R,options:O})=>{let N=T.getProvider("app").getImmediate(),P=new gR(new e_(T.getProvider("auth-internal")),new eI(T.getProvider("app-check-internal")),na(N,R),N);return O=Object.assign({useFetchStreams:S},O),P._setSettings(O),P},"PUBLIC").setMultipleInstances(!0)),(0,L.KN)(ee,et,T),(0,L.KN)(ee,et,"esm2017")}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(T,S,R){this.alias=T,this.aggregateType=S,this.fieldPath=R}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(T="count",S){this._internalFieldPath=S,this.type="AggregateField",this.aggregateType=T}}class gM{constructor(T,S,R){this._userDataWriter=S,this._data=R,this.type="AggregateQuerySnapshot",this.query=T}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(T){this._byteString=T}static fromBase64String(T){try{return new gL(rY.fromBase64String(T))}catch(T){throw new ey(em.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+T)}}static fromUint8Array(T){return new gL(rY.fromUint8Array(T))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(T){return this._byteString.isEqual(T._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(...T){for(let S=0;S<T.length;++S)if(0===T[S].length)throw new ey(em.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new eV(T)}isEqual(T){return this._internalPath.isEqual(T._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(T){this._methodName=T}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(T,S){if(!isFinite(T)||T<-90||T>90)throw new ey(em.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+T);if(!isFinite(S)||S<-180||S>180)throw new ey(em.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+S);this._lat=T,this._long=S}get latitude(){return this._lat}get longitude(){return this._long}isEqual(T){return this._lat===T._lat&&this._long===T._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(T){return ek(this._lat,T._lat)||ek(this._long,T._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gB{constructor(T){this._values=(T||[]).map(T=>T)}toArray(){return this._values.map(T=>T)}isEqual(T){return c0(this._values,T._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gV=/^__.*__$/;class gz{constructor(T,S,R){this.data=T,this.fieldMask=S,this.fieldTransforms=R}toMutation(T,S){return null!==this.fieldMask?new as(T,this.data,this.fieldMask,S,this.fieldTransforms):new ar(T,this.data,S,this.fieldTransforms)}}class gq{constructor(T,S,R){this.data=T,this.fieldMask=S,this.fieldTransforms=R}toMutation(T,S){return new as(T,this.data,this.fieldMask,S,this.fieldTransforms)}}function gG(T){switch(T){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ef()}}class gH{constructor(T,S,R,O,N,P){this.settings=T,this.databaseId=S,this.serializer=R,this.ignoreUndefinedProperties=O,void 0===N&&this.validatePath(),this.fieldTransforms=N||[],this.fieldMask=P||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(T){return new gH(Object.assign(Object.assign({},this.settings),T),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(T){var S;let R=null===(S=this.path)||void 0===S?void 0:S.child(T),O=this.contextWith({path:R,arrayElement:!1});return O.validatePathSegment(T),O}childContextForFieldPath(T){var S;let R=null===(S=this.path)||void 0===S?void 0:S.child(T),O=this.contextWith({path:R,arrayElement:!1});return O.validatePath(),O}childContextForArray(T){return this.contextWith({path:void 0,arrayElement:!0})}createError(T){return ma(T,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(T){return void 0!==this.fieldMask.find(S=>T.isPrefixOf(S))||void 0!==this.fieldTransforms.find(S=>T.isPrefixOf(S.field))}validatePath(){if(this.path)for(let T=0;T<this.path.length;T++)this.validatePathSegment(this.path.get(T))}validatePathSegment(T){if(0===T.length)throw this.createError("Document fields must not be empty");if(gG(this.dataSource)&&gV.test(T))throw this.createError('Document fields cannot begin and end with "__"')}}class g${constructor(T,S,R){this.databaseId=T,this.ignoreUndefinedProperties=S,this.serializer=R||hg(T)}createContext(T,S,R,O=!1){return new gH({dataSource:T,methodName:S,targetDoc:R,path:eV.emptyPath(),arrayElement:!1,hasConverter:O},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gK(T){let S=T._freezeSettings(),R=hg(T._databaseId);return new g$(T._databaseId,!!S.ignoreUndefinedProperties,R)}function gW(T,S,R,O,N,P={}){let M,L;let U=T.createContext(P.merge||P.mergeFields?2:0,S,R,N);mt("Data must be an object, but it was:",U,O);let V=g6(O,U);if(P.merge)M=new rK(U.fieldMask),L=U.fieldTransforms;else if(P.mergeFields){let T=[];for(let O of P.mergeFields){let N=mr(S,O,R);if(!U.contains(N))throw new ey(em.INVALID_ARGUMENT,`Field '${N}' is specified in your field mask but missing from your input data.`);mo(T,N)||T.push(N)}M=new rK(T),L=U.fieldTransforms.filter(T=>M.covers(T.field))}else M=null,L=U.fieldTransforms;return new gz(new ie(V),M,L)}class gQ extends gj{_toFieldTransform(T){if(2===T.dataSource)T.fieldMask.push(T.path);else if(1===T.dataSource)throw T.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw T.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(T){return T instanceof gQ}}function gY(T,S,R){return new gH({dataSource:3,targetDoc:S.settings.targetDoc,methodName:T._methodName,arrayElement:R},S.databaseId,S.serializer,S.ignoreUndefinedProperties)}class gJ extends gj{_toFieldTransform(T){return new sX(T.path,new sq)}isEqual(T){return T instanceof gJ}}class gX extends null{constructor(T,S){super(T),this._elements=S}_toFieldTransform(T){let S=gY(this,T,!0),R=new sG(this._elements.map(T=>g4(T,S)));return new sX(T.path,R)}isEqual(T){return T instanceof gX&&deepEqual(this._elements,T._elements)}}class gZ extends null{constructor(T,S){super(T),this._elements=S}_toFieldTransform(T){let S=gY(this,T,!0),R=new s$(this._elements.map(T=>g4(T,S)));return new sX(T.path,R)}isEqual(T){return T instanceof gZ&&deepEqual(this._elements,T._elements)}}class g0 extends gj{constructor(T,S){super(T),this._operand=S}_toFieldTransform(T){let S=new sW(T.serializer,sF(T.serializer,this._operand));return new sX(T.path,S)}isEqual(T){return T instanceof g0&&this._operand===T._operand}}function g1(T,S,R,O){let N=T.createContext(1,S,R);mt("Data must be an object, but it was:",N,O);let P=[],M=ie.empty();return rL(O,(T,O)=>{let L=mi(S,T,R);O=(0,K.m9)(O);let U=N.childContextForFieldPath(L);if(O instanceof gQ)P.push(L);else{let T=g4(O,U);null!=T&&(P.push(L),M.set(L,T))}}),new gq(M,new rK(P),N.fieldTransforms)}function g2(T,S,R,O,N,P){let M=T.createContext(1,S,R),L=[mr(S,O,R)],U=[N];if(P.length%2!=0)throw new ey(em.INVALID_ARGUMENT,`Function ${S}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<P.length;T+=2)L.push(mr(S,P[T])),U.push(P[T+1]);let V=[],$=ie.empty();for(let T=L.length-1;T>=0;--T)if(!mo(V,L[T])){let S=L[T],R=U[T];R=(0,K.m9)(R);let O=M.childContextForFieldPath(S);if(R instanceof gQ)V.push(S);else{let T=g4(R,O);null!=T&&(V.push(S),$.set(S,T))}}return new gq($,new rK(V),M.fieldTransforms)}function g3(T,S,R,O=!1){return g4(R,T.createContext(O?4:3,S))}function g4(T,S){if(me(T=(0,K.m9)(T)))return mt("Unsupported field value:",S,T),g6(T,S);if(T instanceof gj)return g5(T,S),null;if(void 0===T&&S.ignoreUndefinedProperties)return null;if(S.path&&S.fieldMask.push(S.path),!(T instanceof Array))return g8(T,S);if(S.settings.arrayElement&&4!==S.dataSource)throw S.createError("Nested arrays are not supported");return g9(T,S)}function g6(T,S){let R={};return rj(T)?S.path&&S.path.length>0&&S.fieldMask.push(S.path):rL(T,(T,O)=>{let N=g4(O,S.childContextForField(T));null!=N&&(R[T]=N)}),{mapValue:{fields:R}}}function g9(T,S){let R=[],O=0;for(let N of T){let T=g4(N,S.childContextForArray(O));null==T&&(T={nullValue:"NULL_VALUE"}),R.push(T),O++}return{arrayValue:{values:R}}}function g5(T,S){if(!gG(S.dataSource))throw S.createError(`${T._methodName}() can only be used with update() and set()`);if(!S.path)throw S.createError(`${T._methodName}() is not currently supported inside arrays`);let R=T._toFieldTransform(S);R&&S.fieldTransforms.push(R)}function g8(T,S){if(null===(T=(0,K.m9)(T)))return{nullValue:"NULL_VALUE"};if("number"==typeof T)return sF(S.serializer,T);if("boolean"==typeof T)return{booleanValue:T};if("string"==typeof T)return{stringValue:T};if(T instanceof Date){let R=eM.fromDate(T);return{timestampValue:aQ(S.serializer,R)}}if(T instanceof eM){let R=new eM(T.seconds,1e3*Math.floor(T.nanoseconds/1e3));return{timestampValue:aQ(S.serializer,R)}}if(T instanceof gU)return{geoPointValue:{latitude:T.latitude,longitude:T.longitude}};else if(T instanceof gL)return{bytesValue:aJ(S.serializer,T._byteString)};else if(T instanceof gT){let R=S.databaseId,O=T.firestore._databaseId;if(!O.isEqual(R))throw S.createError(`Document reference is for database ${O.projectId}/${O.database} but should be for database ${R.projectId}/${R.database}`);return{referenceValue:a1(T.firestore._databaseId||S.databaseId,T._key.path)}}else if(T instanceof gB)return g7(T,S);else throw S.createError(`Unsupported field value: ${px(T)}`)}function g7(T,S){return{mapValue:{fields:{[nh]:{stringValue:ng},[nm]:{arrayValue:{values:T.toArray().map(T=>{if("number"!=typeof T)throw S.createError("VectorValues must only contain numeric values.");return sM(S.serializer,T)})}}}}}}function me(T){return"object"==typeof T&&null!==T&&!(T instanceof Array)&&!(T instanceof Date)&&!(T instanceof eM)&&!(T instanceof gU)&&!(T instanceof gL)&&!(T instanceof gT)&&!(T instanceof gj)&&!(T instanceof gB)}function mt(T,S,R){if(!me(R)||!pP(R)){let O=px(R);if("an object"===O)throw S.createError(T+" a custom object");throw S.createError(T+" "+O)}}function mr(T,S,R){if((S=(0,K.m9)(S))instanceof gF)return S._internalPath;if("string"==typeof S)return mi(T,S);throw ma("Field path arguments must be of type string or ",T,!1,void 0,R)}let mn=RegExp("[~\\*/\\[\\]]");function mi(T,S,R){if(S.search(mn)>=0)throw ma(`Invalid field path (${S}). Paths must not contain '~', '*', '/', '[', or ']'`,T,!1,void 0,R);try{return new gF(...S.split("."))._internalPath}catch(O){throw ma(`Invalid field path (${S}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,T,!1,void 0,R)}}function ma(T,S,R,O,N){let P=O&&!O.isEmpty(),M=void 0!==N,L=`Function ${S}() called with invalid data`;R&&(L+=" (via `toFirestore()`)"),L+=". ";let U="";return(P||M)&&(U+=" (found",P&&(U+=` in field ${O}`),M&&(U+=` in document ${N}`),U+=")"),new ey(em.INVALID_ARGUMENT,L+T+U)}function mo(T,S){return T.some(T=>T.isEqual(S))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(T,S,R,O,N){this._firestore=T,this._userDataWriter=S,this._key=R,this._document=O,this._converter=N}get id(){return this._key.path.lastSegment()}get ref(){return new gT(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let T=new mu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(T)}}}get(T){if(this._document){let S=this._document.data.field(mc("DocumentSnapshot.get",T));if(null!==S)return this._userDataWriter.convertValue(S)}}}class mu extends ml{data(){return super.data()}}function mc(T,S){return"string"==typeof S?mi(T,S):S instanceof gF?S._internalPath:S._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(T){if("L"===T.limitType&&0===T.explicitOrderBy.length)throw new ey(em.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mf{}class mp extends mf{}function mg(T,S,...R){let O=[];for(let N of(S instanceof mf&&O.push(S),mF(O=O.concat(R)),O))T=N._apply(T);return T}class mm extends mp{constructor(T,S,R){super(),this._field=T,this._op=S,this._value=R,this.type="where"}static _create(T,S,R){return new mm(T,S,R)}_apply(T){let S=this._parse(T);return mx(T._query,S),new gb(T.firestore,T.converter,sn(T._query,S))}_parse(T){let S=gK(T.firestore);return mR(T._query,"where",S,T.firestore._databaseId,this._field,this._op,this._value)}}function my(T,S,R){let O=S,N=mc("where",T);return mm._create(N,O,R)}class mv extends mf{constructor(T,S){super(),this.type=T,this._queryConstraints=S}static _create(T,S){return new mv(T,S)}_parse(T){let S=this._queryConstraints.map(S=>S._parse(T)).filter(T=>T.getFilters().length>0);return 1===S.length?S[0]:ib.create(S,this._getOperator())}_apply(T){let S=this._parse(T);return 0===S.getFilters().length?T:(mM(T._query,S),new gb(T.firestore,T.converter,sn(T._query,S)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class mb extends mp{constructor(T,S){super(),this._field=T,this._direction=S,this.type="orderBy"}static _create(T,S){return new mb(T,S)}_apply(T){let S=mO(T._query,this._field,this._direction);return new gb(T.firestore,T.converter,si(T._query,S))}}function mT(T,S="asc"){let R=S,O=mc("orderBy",T);return mb._create(O,R)}class mS extends mp{constructor(T,S,R){super(),this.type=T,this._limit=S,this._limitType=R}static _create(T,S,R){return new mS(T,S,R)}_apply(T){return new gb(T.firestore,T.converter,ss(T._query,this._limit,this._limitType))}}function m_(T){return pF("limit",T),mS._create("limit",T,"F")}class mE extends mp{constructor(T,S,R){super(),this.type=T,this._docOrFields=S,this._inclusive=R}static _create(T,S,R){return new mE(T,S,R)}_apply(T){let S=mI(T,this.type,this._docOrFields,this._inclusive);return new gb(T.firestore,T.converter,sa(T._query,S))}}function mw(...T){return mE._create("startAfter",T,!1)}class mC extends null{constructor(T,S,R){super(),this.type=T,this._docOrFields=S,this._inclusive=R}static _create(T,S,R){return new mC(T,S,R)}_apply(T){let S=mI(T,this.type,this._docOrFields,this._inclusive);return new gb(T.firestore,T.converter,so(T._query,S))}}function mI(T,S,R,O){if(R[0]=(0,K.m9)(R[0]),R[0]instanceof ml)return mA(T._query,T.firestore._databaseId,S,R[0]._document,O);{let N=gK(T.firestore);return mk(T._query,T.firestore._databaseId,N,S,R,O)}}function mR(T,S,R,O,N,P,M){let L;if(N.isKeyField()){if("array-contains"===P||"array-contains-any"===P)throw new ey(em.INVALID_ARGUMENT,`Invalid Query. You can't perform '${P}' queries on documentId().`);if("in"===P||"not-in"===P){mD(M,P);let S=[];for(let R of M)S.push(mN(O,T,R));L={arrayValue:{values:S}}}else L=mN(O,T,M)}else("in"===P||"not-in"===P||"array-contains-any"===P)&&mD(M,P),L=g3(R,S,M,"in"===P||"not-in"===P);return iv.create(N,P,L)}function mO(T,S,R){if(null!==T.startAt)throw new ey(em.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==T.endAt)throw new ey(em.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ih(S,R)}function mA(T,S,R,O,N){if(!O)throw new ey(em.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${R}().`);let P=[];for(let R of i7(T))if(R.field.isKeyField())P.push(n$(S,O.key));else{let T=O.data.field(R.field);if(r5(T))throw new ey(em.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+R.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==T)P.push(T);else{let T=R.field.canonicalString();throw new ey(em.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${T}' (used as the orderBy) does not exist.`)}}return new ia(P,N)}function mk(T,S,R,O,N,P){let M=T.explicitOrderBy;if(N.length>M.length)throw new ey(em.INVALID_ARGUMENT,`Too many arguments provided to ${O}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let L=[];for(let P=0;P<N.length;P++){let U=N[P];if(M[P].field.isKeyField()){if("string"!=typeof U)throw new ey(em.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${O}(), but got a ${typeof U}`);if(!i8(T)&&-1!==U.indexOf("/"))throw new ey(em.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${O}() must be a plain document ID, but '${U}' contains a slash.`);let R=T.path.child(eU.fromString(U));if(!ez.isDocumentKey(R))throw new ey(em.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${O}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let N=new ez(R);L.push(n$(S,N))}else{let T=g3(R,O,U);L.push(T)}}return new ia(L,P)}function mN(T,S,R){if("string"==typeof(R=(0,K.m9)(R))){if(""===R)throw new ey(em.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!i8(S)&&-1!==R.indexOf("/"))throw new ey(em.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${R}' contains a '/' character.`);let O=S.path.child(eU.fromString(R));if(!ez.isDocumentKey(O))throw new ey(em.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${O}' is not because it has an odd number of segments (${O.length}).`);return n$(T,new ez(O))}if(R instanceof gT)return n$(T,R._key);throw new ey(em.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${px(R)}.`)}function mD(T,S){if(!Array.isArray(T)||0===T.length)throw new ey(em.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${S.toString()}' filters.`)}function mP(T){switch(T){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function mx(T,S){let R=mL(T.filters,mP(S.op));if(null!==R){if(R===S.op)throw new ey(em.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${S.op.toString()}' filter.`);throw new ey(em.INVALID_ARGUMENT,`Invalid query. You cannot use '${S.op.toString()}' filters with '${R.toString()}' filters.`)}}function mM(T,S){let R=T;for(let T of S.getFlattenedFilters())mx(R,T),R=sn(R,T)}function mL(T,S){for(let R of T)for(let T of R.getFlattenedFilters())if(S.indexOf(T.op)>=0)return T.op;return null}function mF(T){let S=T.filter(T=>T instanceof mv).length,R=T.filter(T=>T instanceof mm).length;if(S>1||S>0&&R>0)throw new ey(em.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{convertValue(T,S="none"){switch(nv(T)){case 0:return null;case 1:return T.booleanValue;case 2:return r1(T.integerValue||T.doubleValue);case 3:return this.convertTimestamp(T.timestampValue);case 4:return this.convertServerTimestamp(T,S);case 5:return T.stringValue;case 6:return this.convertBytes(r2(T.bytesValue));case 7:return this.convertReference(T.referenceValue);case 8:return this.convertGeoPoint(T.geoPointValue);case 9:return this.convertArray(T.arrayValue,S);case 11:return this.convertObject(T.mapValue,S);case 10:return this.convertVectorValue(T.mapValue);default:throw ef()}}convertObject(T,S){return this.convertObjectMap(T.fields,S)}convertObjectMap(T,S="none"){let R={};return rL(T,(T,O)=>{R[T]=this.convertValue(O,S)}),R}convertVectorValue(T){var S,R,O;return new gB(null===(O=null===(R=null===(S=T.fields)||void 0===S?void 0:S[nm].arrayValue)||void 0===R?void 0:R.values)||void 0===O?void 0:O.map(T=>r1(T.doubleValue)))}convertGeoPoint(T){return new gU(r1(T.latitude),r1(T.longitude))}convertArray(T,S){return(T.values||[]).map(T=>this.convertValue(T,S))}convertServerTimestamp(T,S){switch(S){case"previous":let R=r7(T);if(null==R)return null;return this.convertValue(R,S);case"estimate":return this.convertTimestamp(ne(T));default:return null}}convertTimestamp(T){let S=r0(T);return new eM(S.seconds,S.nanos)}convertDocumentKey(T,S){let R=eU.fromString(T);ep(o2(R));let O=new ni(R.get(1),R.get(3)),N=new ez(R.popFirst(5));return O.isEqual(S)||ec(`Document ${N} contains a document reference within a different database (${O.projectId}/${O.database}) which is not supported. It will be treated as a reference in the current database (${S.projectId}/${S.database}) instead.`),N}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mU(T,S,R){return T?R&&(R.merge||R.mergeFields)?T.toFirestore(S,R):T.toFirestore(S):S}function mB(){return new gx("count")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(T){return mz(T,["next","error","complete"])}function mz(T,S){if("object"!=typeof T||null===T)return!1;let R=T;for(let T of S)if(T in R&&"function"==typeof R[T])return!0;return!1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mq{constructor(T,S){this.hasPendingWrites=T,this.fromCache=S}isEqual(T){return this.hasPendingWrites===T.hasPendingWrites&&this.fromCache===T.fromCache}}class mG extends ml{constructor(T,S,R,O,N,P){super(T,S,R,O,P),this._firestore=T,this._firestoreImpl=T,this.metadata=N}exists(){return super.exists()}data(T={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,T.serverTimestamps);{let S=new mH(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(S,T)}}}get(T,S={}){if(this._document){let R=this._document.data.field(mc("DocumentSnapshot.get",T));if(null!==R)return this._userDataWriter.convertValue(R,S.serverTimestamps)}}}class mH extends mG{data(T={}){return super.data(T)}}class m${constructor(T,S,R,O){this._firestore=T,this._userDataWriter=S,this._snapshot=O,this.metadata=new mq(O.hasPendingWrites,O.fromCache),this.query=R}get docs(){let T=[];return this.forEach(S=>T.push(S)),T}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(T,S){this._snapshot.docs.forEach(R=>{T.call(S,new mH(this._firestore,this._userDataWriter,R.key,R,new mq(this._snapshot.mutatedKeys.has(R.key),this._snapshot.fromCache),this.query.converter))})}docChanges(T={}){let S=!!T.includeMetadataChanges;if(S&&this._snapshot.excludesMetadataChanges)throw new ey(em.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===S||(this._cachedChanges=mK(this,S),this._cachedChangesIncludeMetadataChanges=S),this._cachedChanges}}function mK(T,S){if(T._snapshot.oldDocs.isEmpty()){let S=0;return T._snapshot.docChanges.map(R=>{let O=new mH(T._firestore,T._userDataWriter,R.doc.key,R.doc,new mq(T._snapshot.mutatedKeys.has(R.doc.key),T._snapshot.fromCache),T.query.converter);return R.doc,{type:"added",doc:O,oldIndex:-1,newIndex:S++}})}{let R=T._snapshot.oldDocs;return T._snapshot.docChanges.filter(T=>S||3!==T.type).map(S=>{let O=new mH(T._firestore,T._userDataWriter,S.doc.key,S.doc,new mq(T._snapshot.mutatedKeys.has(S.doc.key),T._snapshot.fromCache),T.query.converter),N=-1,P=-1;return 0!==S.type&&(N=R.indexOf(S.doc.key),R=R.delete(S.doc.key)),1!==S.type&&(P=(R=R.add(S.doc)).indexOf(S.doc.key)),{type:mW(S.type),doc:O,oldIndex:N,newIndex:P}})}}function mW(T){switch(T){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ef()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mQ(T){T=pL(T,gT);let S=pL(T.firestore,gR);return p8(gA(S),T._key).then(R=>m4(S,T,R))}class mY extends mj{constructor(T){super(),this.firestore=T}convertBytes(T){return new gL(T)}convertReference(T){let S=this.convertDocumentKey(T,this.firestore._databaseId);return new gT(this.firestore,null,S)}}function mJ(T){T=pL(T,gb);let S=pL(T.firestore,gR),R=gA(S),O=new mY(S);return mh(T._query),p7(R,T._query).then(R=>new m$(S,O,T,R))}function mX(T,S,R){T=pL(T,gT);let O=pL(T.firestore,gR),N=mU(T.converter,S,R),P=gW(gK(O),"setDoc",T._key,N,null!==T.converter,R).toMutation(T._key,s4.none());return m3(O,[P])}function mZ(T,S,R,...O){let N;T=pL(T,gT);let P=pL(T.firestore,gR),M=gK(P);return m3(P,[(N="string"==typeof(S=(0,K.m9)(S))||S instanceof gF?g2(M,"updateDoc",T._key,S,R,O):g1(M,"updateDoc",T._key,S)).toMutation(T._key,s4.exists(!0))])}function m0(T){return m3(pL(T.firestore,gR),[new ad(T._key,s4.none())])}function m1(T,S){let R=pL(T.firestore,gR),O=gE(T),N=mU(T.converter,S);return m3(R,[gW(gK(T.firestore),"addDoc",O._key,N,null!==T.converter,{}).toMutation(O._key,s4.exists(!1))]).then(()=>O)}function m2(T,...S){var R,O,N;let P,M,L;T=(0,K.m9)(T);let U={includeMetadataChanges:!1,source:"default"},V=0;"object"==typeof S[0]&&!mV(S[V])&&(U=S[V],V++);let $={includeMetadataChanges:U.includeMetadataChanges,source:U.source};if(mV(S[V])){let T=S[V];S[V]=null===(R=T.next)||void 0===R?void 0:R.bind(T),S[V+1]=null===(O=T.error)||void 0===O?void 0:O.bind(T),S[V+2]=null===(N=T.complete)||void 0===N?void 0:N.bind(T)}if(T instanceof gT)M=pL(T.firestore,gR),L=i3(T._key.path),P={next:R=>{S[V]&&S[V](m4(M,T,R))},error:S[V+1],complete:S[V+2]};else{let R=pL(T,gb);M=pL(R.firestore,gR),L=R._query;let O=new mY(M);P={next:T=>{S[V]&&S[V](new m$(M,O,R,T))},error:S[V+1],complete:S[V+2]},mh(T._query)}return p5(gA(M),L,$,P)}function m3(T,S){return gt(gA(T),S)}function m4(T,S,R){let O=R.docs.get(S._key),N=new mY(T);return new mG(T,N,S._key,O,new mq(R.hasPendingWrites,R.fromCache),S.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(T){return m9(T,{count:mB()})}function m9(T,S){let R=pL(T.firestore,gR),O=gA(R),N=rF(S,(T,S)=>new gP(S,T.aggregateType,T._internalFieldPath));return ge(O,T._query,N).then(S=>m5(R,T,S))}function m5(T,S,R){return new gM(S,new mY(T),R)}class m8{constructor(T){this.forceOwnership=T,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(T){this._onlineComponentProvider=pI.provider,this._offlineComponentProvider={build:S=>new pC(S,null==T?void 0:T.cacheSizeBytes,this.forceOwnership)}}}function m7(){return new gJ("serverTimestamp")}function ye(T){return new g0("increment",T)}new WeakMap,/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gD("node")},98280:(T,S,R)=>{"use strict";R.d(S,{LP:()=>eJ,ps:()=>eX}),R(35890);var O,N,P=R(84803),M=R(82912),L=R(62646),U=R(20662);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V="/firebase-messaging-sw.js",$="/firebase-cloud-messaging-push-scope",K="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",W="https://fcmregistrations.googleapis.com/v1",Q="google.c.a.c_id",Y="google.c.a.c_l",X="google.c.a.ts",Z="google.c.a.e";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ee(T){return btoa(String.fromCharCode(...new Uint8Array(T))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function et(T){let S="=".repeat((4-T.length%4)%4),R=atob((T+S).replace(/\-/g,"+").replace(/_/g,"/")),O=new Uint8Array(R.length);for(let T=0;T<R.length;++T)O[T]=R.charCodeAt(T);return O}(function(T){T[T.DATA_MESSAGE=1]="DATA_MESSAGE",T[T.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(O||(O={})),function(T){T.PUSH_RECEIVED="push-received",T.NOTIFICATION_CLICKED="notification-clicked"}(N||(N={}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let er="fcm_token_details_db",en=5,ei="fcm_token_object_Store";async function es(T){if("databases"in indexedDB&&!(await indexedDB.databases()).map(T=>T.name).includes(er))return null;let S=null;return(await (0,M.X3)(er,en,{upgrade:async(R,O,N,P)=>{var M;if(O<2||!R.objectStoreNames.contains(ei))return;let L=P.objectStore(ei),U=await L.index("fcmSenderId").get(T);if(await L.clear(),U){if(2===O){let T=U;if(!T.auth||!T.p256dh||!T.endpoint)return;S={token:T.fcmToken,createTime:null!==(M=T.createTime)&&void 0!==M?M:Date.now(),subscriptionOptions:{auth:T.auth,p256dh:T.p256dh,endpoint:T.endpoint,swScope:T.swScope,vapidKey:"string"==typeof T.vapidKey?T.vapidKey:ee(T.vapidKey)}}}else if(3===O){let T=U;S={token:T.fcmToken,createTime:T.createTime,subscriptionOptions:{auth:ee(T.auth),p256dh:ee(T.p256dh),endpoint:T.endpoint,swScope:T.swScope,vapidKey:ee(T.vapidKey)}}}else if(4===O){let T=U;S={token:T.fcmToken,createTime:T.createTime,subscriptionOptions:{auth:ee(T.auth),p256dh:ee(T.p256dh),endpoint:T.endpoint,swScope:T.swScope,vapidKey:ee(T.vapidKey)}}}}}})).close(),await (0,M.Lj)(er),await (0,M.Lj)("fcm_vapid_details_db"),await (0,M.Lj)("undefined"),ea(S)?S:null}function ea(T){if(!T||!T.subscriptionOptions)return!1;let{subscriptionOptions:S}=T;return"number"==typeof T.createTime&&T.createTime>0&&"string"==typeof T.token&&T.token.length>0&&"string"==typeof S.auth&&S.auth.length>0&&"string"==typeof S.p256dh&&S.p256dh.length>0&&"string"==typeof S.endpoint&&S.endpoint.length>0&&"string"==typeof S.swScope&&S.swScope.length>0&&"string"==typeof S.vapidKey&&S.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eo="firebase-messaging-database",eu=1,ec="firebase-messaging-store",ed=null;function eh(){return ed||(ed=(0,M.X3)(eo,eu,{upgrade:(T,S)=>{0===S&&T.createObjectStore(ec)}})),ed}async function ef(T){let S=em(T),R=await eh(),O=await R.transaction(ec).objectStore(ec).get(S);if(O)return O;{let S=await es(T.appConfig.senderId);if(S)return await ep(T,S),S}}async function ep(T,S){let R=em(T),O=(await eh()).transaction(ec,"readwrite");return await O.objectStore(ec).put(S,R),await O.done,S}async function eg(T){let S=em(T),R=(await eh()).transaction(ec,"readwrite");await R.objectStore(ec).delete(S),await R.done}function em({appConfig:T}){return T.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ey={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},ev=new L.LL("messaging","Messaging",ey);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eb(T,S){let R;let O={method:"POST",headers:await eE(T),body:JSON.stringify(ew(S))};try{let S=await fetch(e_(T.appConfig),O);R=await S.json()}catch(T){throw ev.create("token-subscribe-failed",{errorInfo:null==T?void 0:T.toString()})}if(R.error){let T=R.error.message;throw ev.create("token-subscribe-failed",{errorInfo:T})}if(!R.token)throw ev.create("token-subscribe-no-token");return R.token}async function eT(T,S){let R;let O={method:"PATCH",headers:await eE(T),body:JSON.stringify(ew(S.subscriptionOptions))};try{let N=await fetch(`${e_(T.appConfig)}/${S.token}`,O);R=await N.json()}catch(T){throw ev.create("token-update-failed",{errorInfo:null==T?void 0:T.toString()})}if(R.error){let T=R.error.message;throw ev.create("token-update-failed",{errorInfo:T})}if(!R.token)throw ev.create("token-update-no-token");return R.token}async function eS(T,S){let R={method:"DELETE",headers:await eE(T)};try{let O=await fetch(`${e_(T.appConfig)}/${S}`,R),N=await O.json();if(N.error){let T=N.error.message;throw ev.create("token-unsubscribe-failed",{errorInfo:T})}}catch(T){throw ev.create("token-unsubscribe-failed",{errorInfo:null==T?void 0:T.toString()})}}function e_({projectId:T}){return`${W}/projects/${T}/registrations`}async function eE({appConfig:T,installations:S}){let R=await S.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":T.apiKey,"x-goog-firebase-installations-auth":`FIS ${R}`})}function ew({p256dh:T,auth:S,endpoint:R,vapidKey:O}){let N={web:{endpoint:R,auth:S,p256dh:T}};return O!==K&&(N.web.applicationPubKey=O),N}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eC=6048e5;async function eI(T){let S=await eA(T.swRegistration,T.vapidKey),R={vapidKey:T.vapidKey,swScope:T.swRegistration.scope,endpoint:S.endpoint,auth:ee(S.getKey("auth")),p256dh:ee(S.getKey("p256dh"))},O=await ef(T.firebaseDependencies);if(!O)return eO(T.firebaseDependencies,R);if(ek(O.subscriptionOptions,R))return Date.now()>=O.createTime+eC?eR(T,{token:O.token,createTime:Date.now(),subscriptionOptions:R}):O.token;try{await eS(T.firebaseDependencies,O.token)}catch(T){console.warn(T)}return eO(T.firebaseDependencies,R)}async function eR(T,S){try{let R=await eT(T.firebaseDependencies,S),O=Object.assign(Object.assign({},S),{token:R,createTime:Date.now()});return await ep(T.firebaseDependencies,O),R}catch(T){throw T}}async function eO(T,S){let R={token:await eb(T,S),createTime:Date.now(),subscriptionOptions:S};return await ep(T,R),R.token}async function eA(T,S){return await T.pushManager.getSubscription()||T.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:et(S)})}function ek(T,S){let R=S.vapidKey===T.vapidKey,O=S.endpoint===T.endpoint,N=S.auth===T.auth,P=S.p256dh===T.p256dh;return R&&O&&N&&P}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(T){let S={from:T.from,collapseKey:T.collapse_key,messageId:T.fcmMessageId};return eD(S,T),eP(S,T),ex(S,T),S}function eD(T,S){if(!S.notification)return;T.notification={};let R=S.notification.title;R&&(T.notification.title=R);let O=S.notification.body;O&&(T.notification.body=O);let N=S.notification.image;N&&(T.notification.image=N);let P=S.notification.icon;P&&(T.notification.icon=P)}function eP(T,S){S.data&&(T.data=S.data)}function ex(T,S){var R,O,N,P,M;if(!S.fcmOptions&&!(null===(R=S.notification)||void 0===R?void 0:R.click_action))return;T.fcmOptions={};let L=null!==(N=null===(O=S.fcmOptions)||void 0===O?void 0:O.link)&&void 0!==N?N:null===(P=S.notification)||void 0===P?void 0:P.click_action;L&&(T.fcmOptions.link=L);let U=null===(M=S.fcmOptions)||void 0===M?void 0:M.analytics_label;U&&(T.fcmOptions.analyticsLabel=U)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(T){return"object"==typeof T&&!!T&&Q in T}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eL(T){if(!T||!T.options)throw eF("App Configuration Object");if(!T.name)throw eF("App Name");let{options:S}=T;for(let T of["projectId","apiKey","appId","messagingSenderId"])if(!S[T])throw eF(T);return{appName:T.name,projectId:S.projectId,apiKey:S.apiKey,appId:S.appId,senderId:S.messagingSenderId}}function eF(T){return ev.create("missing-app-config-values",{valueName:T})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(T,S){let R=[];for(let O=0;O<T.length;O++)R.push(T.charAt(O)),O<S.length&&R.push(S.charAt(O));R.join("")})("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(T,S,R){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let O=eL(T);this.firebaseDependencies={app:T,appConfig:O,installations:S,analyticsProvider:R}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eU(T){try{T.swRegistration=await navigator.serviceWorker.register(V,{scope:$}),T.swRegistration.update().catch(()=>{})}catch(T){throw ev.create("failed-service-worker-registration",{browserErrorMessage:null==T?void 0:T.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eB(T,S){if(S||T.swRegistration||await eU(T),S||!T.swRegistration){if(!(S instanceof ServiceWorkerRegistration))throw ev.create("invalid-sw-registration");T.swRegistration=S}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eV(T,S){S?T.vapidKey=S:T.vapidKey||(T.vapidKey=K)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ez(T,S){if(!navigator)throw ev.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw ev.create("permission-blocked");return await eV(T,null==S?void 0:S.vapidKey),await eB(T,null==S?void 0:S.serviceWorkerRegistration),eI(T)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eq(T,S,R){let O=eG(S);(await T.firebaseDependencies.analyticsProvider.get()).logEvent(O,{message_id:R[Q],message_name:R[Y],message_time:R[X],message_device_time:Math.floor(Date.now()/1e3)})}function eG(T){switch(T){case N.NOTIFICATION_CLICKED:return"notification_open";case N.PUSH_RECEIVED:return"notification_foreground";default:throw Error()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eH(T,S){let R=S.data;if(!R.isFirebaseMessaging)return;T.onMessageHandler&&R.messageType===N.PUSH_RECEIVED&&("function"==typeof T.onMessageHandler?T.onMessageHandler(eN(R)):T.onMessageHandler.next(eN(R)));let O=R.data;eM(O)&&"1"===O[Z]&&await eq(T,R.messageType,O)}let e$="@firebase/messaging",eK="0.12.12",eW=T=>{let S=new ej(T.getProvider("app").getImmediate(),T.getProvider("installations-internal").getImmediate(),T.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",T=>eH(S,T)),S},eQ=T=>{let S=T.getProvider("messaging").getImmediate();return{getToken:T=>ez(S,T)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eY(T,S){if(!navigator)throw ev.create("only-available-in-window");return T.onMessageHandler=S,()=>{T.onMessageHandler=null}}async function eJ(T,S){return ez(T=(0,L.m9)(T),S)}function eX(T,S){return eY(T=(0,L.m9)(T),S)}(function T(){(0,U.Xd)(new P.wA("messaging",eW,"PUBLIC")),(0,U.Xd)(new P.wA("messaging-internal",eQ,"PRIVATE")),(0,U.KN)(e$,eK),(0,U.KN)(e$,eK,"esm2017")})()},62745:(T,S,R)=>{"use strict";R.d(S,{oq:()=>t9,getDownloadURL:()=>t6,getStorage:()=>t8,ref:()=>t5,KV:()=>t4});var O,N,P=R(20662),M=R(62646),L=R(12942),U=R(84803);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V="firebasestorage.googleapis.com",$="storageBucket",K=12e4,W=6e5,Q=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y extends M.ZR{constructor(T,S,R=0){super(X(T),`Firebase Storage: ${S} (${X(T)})`),this.status_=R,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Y.prototype)}get status(){return this.status_}set status(T){this.status_=T}_codeEquals(T){return X(T)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(T){this.customData.serverResponse=T,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function X(T){return"storage/"+T}function Z(){let T="An unknown error occurred, please check the error payload for server response.";return new Y(O.UNKNOWN,T)}function ee(T){return new Y(O.OBJECT_NOT_FOUND,"Object '"+T+"' does not exist.")}function et(T){return new Y(O.QUOTA_EXCEEDED,"Quota for bucket '"+T+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function er(){let T="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Y(O.UNAUTHENTICATED,T)}function en(){return new Y(O.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function ei(T){return new Y(O.UNAUTHORIZED,"User does not have permission to access '"+T+"'.")}function es(){return new Y(O.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ea(){return new Y(O.CANCELED,"User canceled the upload/download.")}function eo(T){return new Y(O.INVALID_URL,"Invalid URL '"+T+"'.")}function eu(T){return new Y(O.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+T+"'.")}function ec(){return new Y(O.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+$+"' property when initializing the app?")}function ed(){return new Y(O.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function eh(){return new Y(O.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function ef(){return new Y(O.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function ep(T){return new Y(O.INVALID_ARGUMENT,T)}function eg(){return new Y(O.APP_DELETED,"The Firebase app was deleted.")}function em(T){return new Y(O.INVALID_ROOT_OPERATION,"The operation '"+T+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ey(T,S){return new Y(O.INVALID_FORMAT,"String does not match format '"+T+"': "+S)}function ev(T){throw new Y(O.INTERNAL_ERROR,"Internal error: "+T)}!function(T){T.UNKNOWN="unknown",T.OBJECT_NOT_FOUND="object-not-found",T.BUCKET_NOT_FOUND="bucket-not-found",T.PROJECT_NOT_FOUND="project-not-found",T.QUOTA_EXCEEDED="quota-exceeded",T.UNAUTHENTICATED="unauthenticated",T.UNAUTHORIZED="unauthorized",T.UNAUTHORIZED_APP="unauthorized-app",T.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",T.INVALID_CHECKSUM="invalid-checksum",T.CANCELED="canceled",T.INVALID_EVENT_NAME="invalid-event-name",T.INVALID_URL="invalid-url",T.INVALID_DEFAULT_BUCKET="invalid-default-bucket",T.NO_DEFAULT_BUCKET="no-default-bucket",T.CANNOT_SLICE_BLOB="cannot-slice-blob",T.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",T.NO_DOWNLOAD_URL="no-download-url",T.INVALID_ARGUMENT="invalid-argument",T.INVALID_ARGUMENT_COUNT="invalid-argument-count",T.APP_DELETED="app-deleted",T.INVALID_ROOT_OPERATION="invalid-root-operation",T.INVALID_FORMAT="invalid-format",T.INTERNAL_ERROR="internal-error",T.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(O||(O={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(T,S){this.bucket=T,this.path_=S}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let T=encodeURIComponent;return"/b/"+T(this.bucket)+"/o/"+T(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(T,S){let R;try{R=eb.makeFromUrl(T,S)}catch(S){return new eb(T,"")}if(""===R.path)return R;throw eu(T)}static makeFromUrl(T,S){let R=null,O="([A-Za-z0-9.\\-_]+)";function N(T){"/"===T.path.charAt(T.path.length-1)&&(T.path_=T.path_.slice(0,-1))}let P=RegExp("^gs://"+O+"(/(.*))?$","i"),M={bucket:1,path:3};function L(T){T.path_=decodeURIComponent(T.path)}let U="v[A-Za-z0-9_]+",$=S.replace(/[.]/g,"\\."),K="(/([^?#]*).*)?$",W=RegExp(`^https?://${$}/${U}/b/${O}/o${K}`,"i"),Q=S===V?"(?:storage.googleapis.com|storage.cloud.google.com)":S,Y="([^?#]*)",X=[{regex:P,indices:M,postModify:N},{regex:W,indices:{bucket:1,path:3},postModify:L},{regex:RegExp(`^https?://${Q}/${O}/${Y}`,"i"),indices:{bucket:1,path:2},postModify:L}];for(let S=0;S<X.length;S++){let O=X[S],N=O.regex.exec(T);if(N){let T=N[O.indices.bucket],S=N[O.indices.path];S||(S=""),R=new eb(T,S),O.postModify(R);break}}if(null==R)throw eo(T);return R}}class eT{constructor(T){this.promise_=Promise.reject(T)}getPromise(){return this.promise_}cancel(T=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(T,S,R){let O=1,N=null,P=null,M=!1,L=0;function U(){return 2===L}let V=!1;function $(...T){V||(V=!0,S.apply(null,T))}function K(S){N=setTimeout(()=>{N=null,T(Q,U())},S)}function W(){P&&clearTimeout(P)}function Q(T,...S){let R;if(V){W();return}if(T||U()||M){W(),$.call(null,T,...S);return}O<64&&(O*=2),1===L?(L=2,R=0):R=(O+Math.random())*1e3,K(R)}let Y=!1;function X(T){!Y&&(Y=!0,W(),!V&&(null!==N?(T||(L=2),clearTimeout(N),K(0)):T||(L=1)))}return K(0),P=setTimeout(()=>{M=!0,X(!0)},R),X}function e_(T){T(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(T){return void 0!==T}function ew(T){return"function"==typeof T}function eC(T){return"object"==typeof T&&!Array.isArray(T)}function eI(T){return"string"==typeof T||T instanceof String}function eR(T){return eO()&&T instanceof Blob}function eO(){return"undefined"!=typeof Blob}function eA(T,S,R,O){if(O<S)throw ep(`Invalid value for '${T}'. Expected ${S} or greater.`);if(O>R)throw ep(`Invalid value for '${T}'. Expected ${R} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ek(T,S,R){let O=S;return null==R&&(O=`https://${S}`),`${R}://${O}/v0${T}`}function eN(T){let S=encodeURIComponent,R="?";for(let O in T)T.hasOwnProperty(O)&&(R=R+(S(O)+"=")+S(T[O])+"&");return R.slice(0,-1)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eD(T,S){let R=T>=500&&T<600,O=-1!==[408,429].indexOf(T),N=-1!==S.indexOf(T);return R||O||N}!function(T){T[T.NO_ERROR=0]="NO_ERROR",T[T.NETWORK_ERROR=1]="NETWORK_ERROR",T[T.ABORT=2]="ABORT"}(N||(N={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(T,S,R,O,N,P,M,L,U,V,$,K=!0){this.url_=T,this.method_=S,this.headers_=R,this.body_=O,this.successCodes_=N,this.additionalRetryCodes_=P,this.callback_=M,this.errorCallback_=L,this.timeout_=U,this.progressCallback_=V,this.connectionFactory_=$,this.retry=K,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,S)=>{this.resolve_=T,this.reject_=S,this.start_()})}start_(){let T=(T,S)=>{if(S){T(!1,new ex(!1,null,!0));return}let R=this.connectionFactory_();this.pendingConnection_=R;let O=T=>{let S=T.loaded,R=T.lengthComputable?T.total:-1;null!==this.progressCallback_&&this.progressCallback_(S,R)};null!==this.progressCallback_&&R.addUploadProgressListener(O),R.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&R.removeUploadProgressListener(O),this.pendingConnection_=null;let S=R.getErrorCode()===N.NO_ERROR,P=R.getStatus();if(!S||eD(P,this.additionalRetryCodes_)&&this.retry){T(!1,new ex(!1,null,R.getErrorCode()===N.ABORT));return}T(!0,new ex(-1!==this.successCodes_.indexOf(P),R))})},S=(T,S)=>{let R=this.resolve_,O=this.reject_,N=S.connection;if(S.wasSuccessCode)try{let T=this.callback_(N,N.getResponse());eE(T)?R(T):R()}catch(T){O(T)}else if(null!==N){let T=Z();T.serverResponse=N.getErrorText(),O(this.errorCallback_?this.errorCallback_(N,T):T)}else O(S.canceled?this.appDelete_?eg():ea():es())};this.canceled_?S(!1,new ex(!1,null,!0)):this.backoffId_=eS(T,S,this.timeout_)}getPromise(){return this.promise_}cancel(T){this.canceled_=!0,this.appDelete_=T||!1,null!==this.backoffId_&&e_(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ex{constructor(T,S,R){this.wasSuccessCode=T,this.connection=S,this.canceled=!!R}}function eM(T,S){null!==S&&S.length>0&&(T.Authorization="Firebase "+S)}function eL(T,S){T["X-Firebase-Storage-Version"]="webjs/"+(null!=S?S:"AppManager")}function eF(T,S){S&&(T["X-Firebase-GMPID"]=S)}function ej(T,S){null!==S&&(T["X-Firebase-AppCheck"]=S)}function eU(T,S,R,O,N,P,M=!0){let L=eN(T.urlParams),U=T.url+L,V=Object.assign({},T.headers);return eF(V,S),eM(V,R),eL(V,P),ej(V,O),new eP(U,T.method,V,T.body,T.successCodes,T.additionalRetryCodes,T.handler,T.errorHandler,T.timeout,T.progressCallback,N,M)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eB(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function eV(...T){let S=eB();if(void 0!==S){let R=new S;for(let S=0;S<T.length;S++)R.append(T[S]);return R.getBlob()}if(eO())return new Blob(T);throw new Y(O.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function ez(T,S,R){return T.webkitSlice?T.webkitSlice(S,R):T.mozSlice?T.mozSlice(S,R):T.slice?T.slice(S,R):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eq(T){if(/[^-A-Za-z0-9+/=]/.test(T))throw ey("base64","Invalid character found");return Buffer.from(T,"base64").toString("binary")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eG={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class eH{constructor(T,S){this.data=T,this.contentType=S||null}}function e$(T,S){switch(T){case eG.RAW:return new eH(eK(S));case eG.BASE64:case eG.BASE64URL:return new eH(eQ(T,S));case eG.DATA_URL:return new eH(eJ(S),eX(S))}throw Z()}function eK(T){let S=[];for(let R=0;R<T.length;R++){let O=T.charCodeAt(R);O<=127?S.push(O):O<=2047?S.push(192|O>>6,128|63&O):(64512&O)==55296?R<T.length-1&&(64512&T.charCodeAt(R+1))==56320?(O=65536|(1023&O)<<10|1023&T.charCodeAt(++R),S.push(240|O>>18,128|O>>12&63,128|O>>6&63,128|63&O)):S.push(239,191,189):(64512&O)==56320?S.push(239,191,189):S.push(224|O>>12,128|O>>6&63,128|63&O)}return new Uint8Array(S)}function eW(T){let S;try{S=decodeURIComponent(T)}catch(T){throw ey(eG.DATA_URL,"Malformed data URL.")}return eK(S)}function eQ(T,S){let R;switch(T){case eG.BASE64:{let R=-1!==S.indexOf("-"),O=-1!==S.indexOf("_");if(R||O)throw ey(T,"Invalid character '"+(R?"-":"_")+"' found: is it base64url encoded?");break}case eG.BASE64URL:{let R=-1!==S.indexOf("+"),O=-1!==S.indexOf("/");if(R||O)throw ey(T,"Invalid character '"+(R?"+":"/")+"' found: is it base64 encoded?");S=S.replace(/-/g,"+").replace(/_/g,"/")}}try{R=eq(S)}catch(S){if(S.message.includes("polyfill"))throw S;throw ey(T,"Invalid character found")}let O=new Uint8Array(R.length);for(let T=0;T<R.length;T++)O[T]=R.charCodeAt(T);return O}class eY{constructor(T){this.base64=!1,this.contentType=null;let S=T.match(/^data:([^,]+)?,/);if(null===S)throw ey(eG.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let R=S[1]||null;null!=R&&(this.base64=eZ(R,";base64"),this.contentType=this.base64?R.substring(0,R.length-7):R),this.rest=T.substring(T.indexOf(",")+1)}}function eJ(T){let S=new eY(T);return S.base64?eQ(eG.BASE64,S.rest):eW(S.rest)}function eX(T){return new eY(T).contentType}function eZ(T,S){return T.length>=S.length&&T.substring(T.length-S.length)===S}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(T,S){let R=0,O="";eR(T)?(this.data_=T,R=T.size,O=T.type):T instanceof ArrayBuffer?(S?this.data_=new Uint8Array(T):(this.data_=new Uint8Array(T.byteLength),this.data_.set(new Uint8Array(T))),R=this.data_.length):T instanceof Uint8Array&&(S?this.data_=T:(this.data_=new Uint8Array(T.length),this.data_.set(T)),R=T.length),this.size_=R,this.type_=O}size(){return this.size_}type(){return this.type_}slice(T,S){if(!eR(this.data_))return new e0(new Uint8Array(this.data_.buffer,T,S-T),!0);{let R=ez(this.data_,T,S);return null===R?null:new e0(R)}}static getBlob(...T){if(eO()){let S=T.map(T=>T instanceof e0?T.data_:T);return new e0(eV.apply(null,S))}{let S=T.map(T=>eI(T)?e$(eG.RAW,T).data:T.data_),R=0;S.forEach(T=>{R+=T.byteLength});let O=new Uint8Array(R),N=0;return S.forEach(T=>{for(let S=0;S<T.length;S++)O[N++]=T[S]}),new e0(O,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(T){let S;try{S=JSON.parse(T)}catch(T){return null}return eC(S)?S:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(T){if(0===T.length)return null;let S=T.lastIndexOf("/");return -1===S?"":T.slice(0,S)}function e3(T,S){let R=S.split("/").filter(T=>T.length>0).join("/");return 0===T.length?R:T+"/"+R}function e4(T){let S=T.lastIndexOf("/",T.length-2);return -1===S?T:T.slice(S+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e6(T,S){return S}class e9{constructor(T,S,R,O){this.server=T,this.local=S||T,this.writable=!!R,this.xform=O||e6}}let e5=null;function e8(T){return!eI(T)||T.length<2?T:e4(T)}function e7(){if(e5)return e5;let T=[];function S(T,S){return e8(S)}T.push(new e9("bucket")),T.push(new e9("generation")),T.push(new e9("metageneration")),T.push(new e9("name","fullPath",!0));let R=new e9("name");function O(T,S){return void 0!==S?Number(S):S}R.xform=S,T.push(R);let N=new e9("size");return N.xform=O,T.push(N),T.push(new e9("timeCreated")),T.push(new e9("updated")),T.push(new e9("md5Hash",null,!0)),T.push(new e9("cacheControl",null,!0)),T.push(new e9("contentDisposition",null,!0)),T.push(new e9("contentEncoding",null,!0)),T.push(new e9("contentLanguage",null,!0)),T.push(new e9("contentType",null,!0)),T.push(new e9("metadata","customMetadata",!0)),e5=T}function te(T,S){function R(){let R=new eb(T.bucket,T.fullPath);return S._makeStorageReference(R)}Object.defineProperty(T,"ref",{get:R})}function tt(T,S,R){let O={};O.type="file";let N=R.length;for(let T=0;T<N;T++){let N=R[T];O[N.local]=N.xform(O,S[N.server])}return te(O,T),O}function tr(T,S,R){let O=e1(S);return null===O?null:tt(T,O,R)}function ti(T,S,R,O){let N=e1(S);if(null===N||!eI(N.downloadTokens))return null;let P=N.downloadTokens;if(0===P.length)return null;let M=encodeURIComponent;return P.split(",").map(S=>{let N=T.bucket,P=T.fullPath;return ek("/b/"+M(N)+"/o/"+M(P),R,O)+eN({alt:"media",token:S})})[0]}function ts(T,S){let R={},O=S.length;for(let N=0;N<O;N++){let O=S[N];O.writable&&(R[O.server]=T[O.local])}return JSON.stringify(R)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ta="prefixes",tl="items";function tu(T,S,R){let O={prefixes:[],items:[],nextPageToken:R.nextPageToken};if(R[ta])for(let N of R[ta]){let R=N.replace(/\/$/,""),P=T._makeStorageReference(new eb(S,R));O.prefixes.push(P)}if(R[tl])for(let N of R[tl]){let R=T._makeStorageReference(new eb(S,N.name));O.items.push(R)}return O}function tc(T,S,R){let O=e1(R);return null===O?null:tu(T,S,O)}class td{constructor(T,S,R,O){this.url=T,this.method=S,this.handler=R,this.timeout=O,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(T){if(!T)throw Z()}function tf(T,S){return function(R,O){let N=tr(T,O,S);return th(null!==N),N}}function tp(T,S){return function(R,O){let N=tc(T,S,O);return th(null!==N),N}}function tg(T,S){return function(R,O){let N=tr(T,O,S);return th(null!==N),ti(N,O,T.host,T._protocol)}}function tm(T){return function(S,R){let O;return(O=401===S.getStatus()?S.getErrorText().includes("Firebase App Check token is invalid")?en():er():402===S.getStatus()?et(T.bucket):403===S.getStatus()?ei(T.path):R).status=S.getStatus(),O.serverResponse=R.serverResponse,O}}function ty(T){let S=tm(T);return function(R,O){let N=S(R,O);return 404===R.getStatus()&&(N=ee(T.path)),N.serverResponse=O.serverResponse,N}}function tv(T,S,R){let O=ek(S.fullServerUrl(),T.host,T._protocol),N="GET",P=T.maxOperationRetryTime,M=new td(O,N,tf(T,R),P);return M.errorHandler=ty(S),M}function tb(T,S,R,O,N){let P={};S.isRoot?P.prefix="":P.prefix=S.path+"/",R&&R.length>0&&(P.delimiter=R),O&&(P.pageToken=O),N&&(P.maxResults=N);let M=ek(S.bucketOnlyServerUrl(),T.host,T._protocol),L="GET",U=T.maxOperationRetryTime,V=new td(M,L,tp(T,S.bucket),U);return V.urlParams=P,V.errorHandler=tm(S),V}function tT(T,S,R){let O=ek(S.fullServerUrl(),T.host,T._protocol),N="GET",P=T.maxOperationRetryTime,M=new td(O,N,tg(T,R),P);return M.errorHandler=ty(S),M}function tS(T,S){let R=new td(ek(S.fullServerUrl(),T.host,T._protocol),"DELETE",function(T,S){},T.maxOperationRetryTime);return R.successCodes=[200,204],R.errorHandler=ty(S),R}function t_(T,S){return T&&T.contentType||S&&S.type()||"application/octet-stream"}function tE(T,S,R){let O=Object.assign({},R);return O.fullPath=T.path,O.size=S.size(),O.contentType||(O.contentType=t_(null,S)),O}function tw(T,S,R,O,N){let P=S.bucketOnlyServerUrl(),M={"X-Goog-Upload-Protocol":"multipart"},L=function(){let T="";for(let S=0;S<2;S++)T+=Math.random().toString().slice(2);return T}();M["Content-Type"]="multipart/related; boundary="+L;let U=tE(S,O,N),V="--"+L+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ts(U,R)+"\r\n--"+L+"\r\nContent-Type: "+U.contentType+"\r\n\r\n",$="\r\n--"+L+"--",K=e0.getBlob(V,O,$);if(null===K)throw ed();let W={name:U.fullPath},Q=ek(P,T.host,T._protocol),Y="POST",X=T.maxUploadRetryTime,Z=new td(Q,Y,tf(T,R),X);return Z.urlParams=W,Z.headers=M,Z.body=K.uploadData(),Z.errorHandler=tm(S),Z}class tC{constructor(T,S,R,O){this.current=T,this.total=S,this.finalized=!!R,this.metadata=O||null}}function tI(T,S){let R=null;try{R=T.getResponseHeader("X-Goog-Upload-Status")}catch(T){th(!1)}let O=S||["active"];return th(!!R&&-1!==O.indexOf(R)),R}function tR(T,S,R,O,N){let P=S.bucketOnlyServerUrl(),M=tE(S,O,N),L={name:M.fullPath},U=ek(P,T.host,T._protocol),V="POST",$={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${O.size()}`,"X-Goog-Upload-Header-Content-Type":M.contentType,"Content-Type":"application/json; charset=utf-8"},K=ts(M,R),W=new td(U,V,function(T){let S;tI(T);try{S=T.getResponseHeader("X-Goog-Upload-URL")}catch(T){th(!1)}return th(eI(S)),S},T.maxUploadRetryTime);return W.urlParams=L,W.headers=$,W.body=K,W.errorHandler=tm(S),W}function tO(T,S,R,O){let N={"X-Goog-Upload-Command":"query"},P=new td(R,"POST",function(T){let S=tI(T,["active","final"]),R=null;try{R=T.getResponseHeader("X-Goog-Upload-Size-Received")}catch(T){th(!1)}R||th(!1);let N=Number(R);return th(!isNaN(N)),new tC(N,O.size(),"final"===S)},T.maxUploadRetryTime);return P.headers=N,P.errorHandler=tm(S),P}let tA=null;function tk(T,S,R,O,N,P,M,L){let U=new tC(0,0);if(M?(U.current=M.current,U.total=M.total):(U.current=0,U.total=O.size()),O.size()!==U.total)throw eh();let V=U.total-U.current,$=V;N>0&&($=Math.min($,N));let K=U.current,W=K+$,Q="",Y={"X-Goog-Upload-Command":Q=0===$?"finalize":V===$?"upload, finalize":"upload","X-Goog-Upload-Offset":`${U.current}`},X=O.slice(K,W);if(null===X)throw ed();let Z=new td(R,"POST",function(T,R){let N;let M=tI(T,["active","final"]),L=U.current+$,V=O.size();return N="final"===M?tf(S,P)(T,R):null,new tC(L,V,"final"===M,N)},S.maxUploadRetryTime);return Z.headers=Y,Z.body=X.uploadData(),Z.progressCallback=L||null,Z.errorHandler=tm(T),Z}let tN={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function tD(T){switch(T){case"running":case"pausing":case"canceling":return tN.RUNNING;case"paused":return tN.PAUSED;case"success":return tN.SUCCESS;case"canceled":return tN.CANCELED;default:return tN.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(T,S,R){if(ew(T)||null!=S||null!=R)this.next=T,this.error=null!=S?S:void 0,this.complete=null!=R?R:void 0;else{let S=T;this.next=S.next,this.error=S.error,this.complete=S.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(T){return(...S)=>{Promise.resolve().then(()=>T(...S))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tL=null;class tF{constructor(){this.errorText_="",this.sent_=!1,this.fetch_=L.fetch,this.errorCode_=N.NO_ERROR}async send(T,S,R,O){if(this.sent_)throw ev("cannot .send() more than once");this.sent_=!0;try{let P=await this.fetch_(T,{method:S,headers:O||{},body:R});this.headers_=P.headers,this.statusCode_=P.status,this.errorCode_=N.NO_ERROR,this.body_=await P.arrayBuffer()}catch(T){this.errorText_=null==T?void 0:T.message,this.statusCode_=0,this.errorCode_=N.NETWORK_ERROR}}getErrorCode(){if(void 0===this.errorCode_)throw ev("cannot .getErrorCode() before receiving response");return this.errorCode_}getStatus(){if(void 0===this.statusCode_)throw ev("cannot .getStatus() before receiving response");return this.statusCode_}getErrorText(){return this.errorText_}abort(){}getResponseHeader(T){if(!this.headers_)throw ev("cannot .getResponseHeader() before receiving response");return this.headers_.get(T)}addUploadProgressListener(T){}removeUploadProgressListener(T){}}class tj extends tF{getResponse(){if(!this.body_)throw ev("cannot .getResponse() before receiving response");return Buffer.from(this.body_).toString("utf-8")}}function tU(){return tL?tL():new tj}class tB extends null{getResponse(){if(!this.body_)throw ev("cannot .getResponse() before sending");return this.body_}}class tV extends null{constructor(){super(...arguments),this.stream_=null}async send(T,S,R,O){if(this.sent_)throw ev("cannot .send() more than once");this.sent_=!0;try{let P=await this.fetch_(T,{method:S,headers:O||{},body:R});this.headers_=P.headers,this.statusCode_=P.status,this.errorCode_=N.NO_ERROR,this.stream_=P.body}catch(T){this.errorText_=null==T?void 0:T.message,this.statusCode_=0,this.errorCode_=N.NETWORK_ERROR}}getResponse(){if(!this.stream_)throw ev("cannot .getResponse() before sending");return this.stream_}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(T,S){this._service=T,S instanceof eb?this._location=S:this._location=eb.makeFromUrl(S,T.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(T,S){return new tz(T,S)}get root(){let T=new eb(this._location.bucket,"");return this._newRef(this._service,T)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return e4(this._location.path)}get storage(){return this._service}get parent(){let T=e2(this._location.path);if(null===T)return null;let S=new eb(this._location.bucket,T);return new tz(this._service,S)}_throwIfRoot(T){if(""===this._location.path)throw em(T)}}function tq(T,S,R){T._throwIfRoot("uploadBytes");let O=tw(T.storage,T._location,e7(),new e0(S,!0),R);return T.storage.makeRequestWithTokens(O,tU).then(S=>({metadata:S,ref:T}))}function tG(T,S){null!=S&&"number"==typeof S.maxResults&&eA("options.maxResults",1,1e3,S.maxResults);let R=S||{},O=tb(T.storage,T._location,"/",R.pageToken,R.maxResults);return T.storage.makeRequestWithTokens(O,tU)}function tH(T){T._throwIfRoot("getDownloadURL");let S=tT(T.storage,T._location,e7());return T.storage.makeRequestWithTokens(S,tU).then(T=>{if(null===T)throw ef();return T})}function t$(T){T._throwIfRoot("deleteObject");let S=tS(T.storage,T._location);return T.storage.makeRequestWithTokens(S,tU)}function tK(T,S){let R=e3(T._location.path,S),O=new eb(T._location.bucket,R);return new tz(T.storage,O)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(T){return/^[A-Za-z]+:\/\//.test(T)}function tQ(T,S){return new tz(T,S)}function tY(T,S){if(T instanceof t0){let R=T;if(null==R._bucket)throw ec();let O=new tz(R,R._bucket);return null!=S?tY(O,S):O}return void 0!==S?tK(T,S):T}function tJ(T,S){if(!(S&&tW(S)))return tY(T,S);if(T instanceof t0)return tQ(T,S);throw ep("To use ref(service, url), the first argument must be a Storage instance.")}function tX(T,S){let R=null==S?void 0:S[$];return null==R?null:eb.makeFromBucketSpec(R,T)}function tZ(T,S,R,O={}){T.host=`${S}:${R}`,T._protocol="http";let{mockUserToken:N}=O;N&&(T._overrideAuthToken="string"==typeof N?N:(0,M.Sg)(N,T.app.options.projectId))}class t0{constructor(T,S,R,O,N){this.app=T,this._authProvider=S,this._appCheckProvider=R,this._url=O,this._firebaseVersion=N,this._bucket=null,this._host=V,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=K,this._maxUploadRetryTime=W,this._requests=new Set,null!=O?this._bucket=eb.makeFromBucketSpec(O,this._host):this._bucket=tX(this._host,this.app.options)}get host(){return this._host}set host(T){this._host=T,null!=this._url?this._bucket=eb.makeFromBucketSpec(this._url,T):this._bucket=tX(T,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(T){eA("time",0,Number.POSITIVE_INFINITY,T),this._maxUploadRetryTime=T}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(T){eA("time",0,Number.POSITIVE_INFINITY,T),this._maxOperationRetryTime=T}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let T=this._authProvider.getImmediate({optional:!0});if(T){let S=await T.getToken();if(null!==S)return S.accessToken}return null}async _getAppCheckToken(){let T=this._appCheckProvider.getImmediate({optional:!0});return T?(await T.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(T=>T.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(T){return new tz(this,T)}_makeRequest(T,S,R,O,N=!0){if(this._deleted)return new eT(eg());{let P=eU(T,this._appId,R,O,S,this._firebaseVersion,N);return this._requests.add(P),P.getPromise().then(()=>this._requests.delete(P),()=>this._requests.delete(P)),P}}async makeRequestWithTokens(T,S){let[R,O]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(T,S,R,O).getPromise()}}let t1="@firebase/storage",t2="0.13.2",t3="storage";function t4(T,S,R){return tq(T=(0,M.m9)(T),S,R)}function t6(T){return tH(T=(0,M.m9)(T))}function t9(T){return t$(T=(0,M.m9)(T))}function t5(T,S){return tJ(T=(0,M.m9)(T),S)}function t8(T=(0,P.Mq)(),S){T=(0,M.m9)(T);let R=(0,P.qX)(T,t3).getImmediate({identifier:S}),O=(0,M.P0)("storage");return O&&t7(R,...O),R}function t7(T,S,R,O={}){tZ(T,S,R,O)}function rt(T,{instanceIdentifier:S}){return new t0(T.getProvider("app").getImmediate(),T.getProvider("auth-internal"),T.getProvider("app-check-internal"),S,P.Jn)}(function(){(0,P.Xd)(new U.wA(t3,rt,"PUBLIC").setMultipleInstances(!0)),(0,P.KN)(t1,t2)})()},82912:(T,S,R)=>{"use strict";let O,N;R.d(S,{Lj:()=>es,X3:()=>ei});let P=(T,S)=>S.some(S=>T instanceof S);function M(){return O||(O=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function L(){return N||(N=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let U=new WeakMap,V=new WeakMap,$=new WeakMap,K=new WeakMap,W=new WeakMap;function Q(T){let S=new Promise((S,R)=>{let O=()=>{T.removeEventListener("success",N),T.removeEventListener("error",P)},N=()=>{S(er(T.result)),O()},P=()=>{R(T.error),O()};T.addEventListener("success",N),T.addEventListener("error",P)});return S.then(S=>{S instanceof IDBCursor&&U.set(S,T)}).catch(()=>{}),W.set(S,T),S}function Y(T){if(V.has(T))return;let S=new Promise((S,R)=>{let O=()=>{T.removeEventListener("complete",N),T.removeEventListener("error",P),T.removeEventListener("abort",P)},N=()=>{S(),O()},P=()=>{R(T.error||new DOMException("AbortError","AbortError")),O()};T.addEventListener("complete",N),T.addEventListener("error",P),T.addEventListener("abort",P)});V.set(T,S)}let X={get(T,S,R){if(T instanceof IDBTransaction){if("done"===S)return V.get(T);if("objectStoreNames"===S)return T.objectStoreNames||$.get(T);if("store"===S)return R.objectStoreNames[1]?void 0:R.objectStore(R.objectStoreNames[0])}return er(T[S])},set:(T,S,R)=>(T[S]=R,!0),has:(T,S)=>T instanceof IDBTransaction&&("done"===S||"store"===S)||S in T};function Z(T){X=T(X)}function ee(T){return T!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?L().includes(T)?function(...S){return T.apply(en(this),S),er(U.get(this))}:function(...S){return er(T.apply(en(this),S))}:function(S,...R){let O=T.call(en(this),S,...R);return $.set(O,S.sort?S.sort():[S]),er(O)}}function et(T){return"function"==typeof T?ee(T):(T instanceof IDBTransaction&&Y(T),P(T,M()))?new Proxy(T,X):T}function er(T){if(T instanceof IDBRequest)return Q(T);if(K.has(T))return K.get(T);let S=et(T);return S!==T&&(K.set(T,S),W.set(S,T)),S}let en=T=>W.get(T);function ei(T,S,{blocked:R,upgrade:O,blocking:N,terminated:P}={}){let M=indexedDB.open(T,S),L=er(M);return O&&M.addEventListener("upgradeneeded",T=>{O(er(M.result),T.oldVersion,T.newVersion,er(M.transaction),T)}),R&&M.addEventListener("blocked",T=>R(T.oldVersion,T.newVersion,T)),L.then(T=>{P&&T.addEventListener("close",()=>P()),N&&T.addEventListener("versionchange",T=>N(T.oldVersion,T.newVersion,T))}).catch(()=>{}),L}function es(T,{blocked:S}={}){let R=indexedDB.deleteDatabase(T);return S&&R.addEventListener("blocked",T=>S(T.oldVersion,T)),er(R).then(()=>void 0)}let ea=["get","getKey","getAll","getAllKeys","count"],eo=["put","add","delete","clear"],eu=new Map;function ec(T,S){if(!(T instanceof IDBDatabase&&!(S in T)&&"string"==typeof S))return;if(eu.get(S))return eu.get(S);let R=S.replace(/FromIndex$/,""),O=S!==R,N=eo.includes(R);if(!(R in(O?IDBIndex:IDBObjectStore).prototype)||!(N||ea.includes(R)))return;let P=async function(T,...S){let P=this.transaction(T,N?"readwrite":"readonly"),M=P.store;return O&&(M=M.index(S.shift())),(await Promise.all([M[R](...S),N&&P.done]))[0]};return eu.set(S,P),P}Z(T=>({...T,get:(S,R,O)=>ec(S,R)||T.get(S,R,O),has:(S,R)=>!!ec(S,R)||T.has(S,R)}))},95196:(T,S,R)=>{"use strict";function O(T){return T&&T.__esModule?T:{default:T}}R.r(S),R.d(S,{_:()=>O,_interop_require_default:()=>O})},81513:T=>{"use strict";T.exports={i8:"1.9.15"}},56541:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},89987:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"options":{"go_package":"google.golang.org/protobuf/types/descriptorpb","java_package":"com.google.protobuf","java_outer_classname":"DescriptorProtos","csharp_namespace":"Google.Protobuf.Reflection","objc_class_prefix":"GPB","cc_enable_arenas":true,"optimize_for":"SPEED"},"nested":{"FileDescriptorSet":{"edition":"proto2","fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}},"extensions":[[536000000,536000000]]},"Edition":{"edition":"proto2","values":{"EDITION_UNKNOWN":0,"EDITION_LEGACY":900,"EDITION_PROTO2":998,"EDITION_PROTO3":999,"EDITION_2023":1000,"EDITION_2024":1001,"EDITION_1_TEST_ONLY":1,"EDITION_2_TEST_ONLY":2,"EDITION_99997_TEST_ONLY":99997,"EDITION_99998_TEST_ONLY":99998,"EDITION_99999_TEST_ONLY":99999,"EDITION_MAX":2147483647}},"FileDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10},"weakDependency":{"rule":"repeated","type":"int32","id":11},"optionDependency":{"rule":"repeated","type":"string","id":15},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12},"edition":{"type":"Edition","id":14}}},"DescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10},"visibility":{"type":"SymbolVisibility","id":11}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2},"options":{"type":"ExtensionRangeOptions","id":3}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"ExtensionRangeOptions":{"edition":"proto2","fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999},"declaration":{"rule":"repeated","type":"Declaration","id":2,"options":{"retention":"RETENTION_SOURCE"}},"features":{"type":"FeatureSet","id":50},"verification":{"type":"VerificationState","id":3,"options":{"default":"UNVERIFIED","retention":"RETENTION_SOURCE"}}},"extensions":[[1000,536870911]],"nested":{"Declaration":{"fields":{"number":{"type":"int32","id":1},"fullName":{"type":"string","id":2},"type":{"type":"string","id":3},"reserved":{"type":"bool","id":5},"repeated":{"type":"bool","id":6}},"reserved":[[4,4]]},"VerificationState":{"values":{"DECLARATION":0,"UNVERIFIED":1}}}},"FieldDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8},"proto3Optional":{"type":"bool","id":17}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REPEATED":3,"LABEL_REQUIRED":2}}}},"OneofDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3},"reservedRange":{"rule":"repeated","type":"EnumReservedRange","id":4},"reservedName":{"rule":"repeated","type":"string","id":5},"visibility":{"type":"SymbolVisibility","id":6}},"nested":{"EnumReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"EnumValueDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"edition":"proto2","fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31,"options":{"default":true}},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"swiftPrefix":{"type":"string","id":39},"phpClassPrefix":{"type":"string","id":40},"phpNamespace":{"type":"string","id":41},"phpMetadataNamespace":{"type":"string","id":44},"rubyPackage":{"type":"string","id":45},"features":{"type":"FeatureSet","id":50},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[42,42],[38,38],"php_generic_services"],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"edition":"proto2","fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":11,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":12},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[5,5],[6,6],[8,8],[9,9]]},"FieldOptions":{"edition":"proto2","fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"unverifiedLazy":{"type":"bool","id":15},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10,"options":{"deprecated":true}},"debugRedact":{"type":"bool","id":16},"retention":{"type":"OptionRetention","id":17},"targets":{"rule":"repeated","type":"OptionTargetType","id":19},"editionDefaults":{"rule":"repeated","type":"EditionDefault","id":20},"features":{"type":"FeatureSet","id":21},"featureSupport":{"type":"FeatureSupport","id":22},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[18,18]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}},"OptionRetention":{"values":{"RETENTION_UNKNOWN":0,"RETENTION_RUNTIME":1,"RETENTION_SOURCE":2}},"OptionTargetType":{"values":{"TARGET_TYPE_UNKNOWN":0,"TARGET_TYPE_FILE":1,"TARGET_TYPE_EXTENSION_RANGE":2,"TARGET_TYPE_MESSAGE":3,"TARGET_TYPE_FIELD":4,"TARGET_TYPE_ONEOF":5,"TARGET_TYPE_ENUM":6,"TARGET_TYPE_ENUM_ENTRY":7,"TARGET_TYPE_SERVICE":8,"TARGET_TYPE_METHOD":9}},"EditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"value":{"type":"string","id":2}}},"FeatureSupport":{"fields":{"editionIntroduced":{"type":"Edition","id":1},"editionDeprecated":{"type":"Edition","id":2},"deprecationWarning":{"type":"string","id":3},"editionRemoved":{"type":"Edition","id":4}}}}},"OneofOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"edition":"proto2","fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":6,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[5,5]]},"EnumValueOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":1},"features":{"type":"FeatureSet","id":2},"debugRedact":{"type":"bool","id":3},"featureSupport":{"type":"FieldOptions.FeatureSupport","id":4},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":34},"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":33},"idempotencyLevel":{"type":"IdempotencyLevel","id":34,"options":{"default":"IDEMPOTENCY_UNKNOWN"}},"features":{"type":"FeatureSet","id":35},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"nested":{"IdempotencyLevel":{"values":{"IDEMPOTENCY_UNKNOWN":0,"NO_SIDE_EFFECTS":1,"IDEMPOTENT":2}}}},"UninterpretedOption":{"edition":"proto2","fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"FeatureSet":{"edition":"proto2","fields":{"fieldPresence":{"type":"FieldPresence","id":1,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},"enumType":{"type":"EnumType","id":2,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},"repeatedFieldEncoding":{"type":"RepeatedFieldEncoding","id":3,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},"utf8Validation":{"type":"Utf8Validation","id":4,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},"messageEncoding":{"type":"MessageEncoding","id":5,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},"jsonFormat":{"type":"JsonFormat","id":6,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},"enforceNamingStyle":{"type":"EnforceNamingStyle","id":7,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},"defaultSymbolVisibility":{"type":"VisibilityFeature.DefaultSymbolVisibility","id":8,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},"extensions":[[1000,9994],[9995,9999],[10000,10000]],"reserved":[[999,999]],"nested":{"FieldPresence":{"values":{"FIELD_PRESENCE_UNKNOWN":0,"EXPLICIT":1,"IMPLICIT":2,"LEGACY_REQUIRED":3}},"EnumType":{"values":{"ENUM_TYPE_UNKNOWN":0,"OPEN":1,"CLOSED":2}},"RepeatedFieldEncoding":{"values":{"REPEATED_FIELD_ENCODING_UNKNOWN":0,"PACKED":1,"EXPANDED":2}},"Utf8Validation":{"values":{"UTF8_VALIDATION_UNKNOWN":0,"VERIFY":2,"NONE":3}},"MessageEncoding":{"values":{"MESSAGE_ENCODING_UNKNOWN":0,"LENGTH_PREFIXED":1,"DELIMITED":2}},"JsonFormat":{"values":{"JSON_FORMAT_UNKNOWN":0,"ALLOW":1,"LEGACY_BEST_EFFORT":2}},"EnforceNamingStyle":{"values":{"ENFORCE_NAMING_STYLE_UNKNOWN":0,"STYLE2024":1,"STYLE_LEGACY":2}},"VisibilityFeature":{"fields":{},"reserved":[[1,536870911]],"nested":{"DefaultSymbolVisibility":{"values":{"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN":0,"EXPORT_ALL":1,"EXPORT_TOP_LEVEL":2,"LOCAL_ALL":3,"STRICT":4}}}}}},"FeatureSetDefaults":{"edition":"proto2","fields":{"defaults":{"rule":"repeated","type":"FeatureSetEditionDefault","id":1},"minimumEdition":{"type":"Edition","id":4},"maximumEdition":{"type":"Edition","id":5}},"nested":{"FeatureSetEditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"overridableFeatures":{"type":"FeatureSet","id":4},"fixedFeatures":{"type":"FeatureSet","id":5}},"reserved":[[1,1],[2,2],"features"]}}},"SourceCodeInfo":{"edition":"proto2","fields":{"location":{"rule":"repeated","type":"Location","id":1}},"extensions":[[536000000,536000000]],"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"span":{"rule":"repeated","type":"int32","id":2,"options":{"packed":true}},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"edition":"proto2","fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4},"semantic":{"type":"Semantic","id":5}},"nested":{"Semantic":{"values":{"NONE":0,"SET":1,"ALIAS":2}}}}}},"SymbolVisibility":{"edition":"proto2","values":{"VISIBILITY_UNSET":0,"VISIBILITY_LOCAL":1,"VISIBILITY_EXPORT":2}}}}}}}}')},57674:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},73795:T=>{"use strict";T.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')}};