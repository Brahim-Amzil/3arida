exports.id=2522,exports.ids=[2522],exports.modules={35303:()=>{},9977:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var a=r(53854),s=r(34218),o=r(41956),i=r.n(o),n=r(50902),l=r(24434);function d({petition:e,size:t=256,variant:r="default",branded:o=!1,downloadable:d=!0,shareable:c=!0,className:h="",onShare:m,onDownload:x}){let[u,g]=(0,s.useState)(""),[f,p]=(0,s.useState)(!0),[w,j]=(0,s.useState)(""),[b,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{if(p(!0),j(""),e.qrCodeUrl&&!o)g(e.qrCodeUrl);else{let r=await (0,n.w1)(e.id,{size:t,branded:o,includeAnalytics:!0});g(r)}}catch(e){console.error("Error generating QR code:",e),j("Failed to generate QR code")}finally{p(!1)}})()},[e.id,e.qrCodeUrl,t,o]);let v=async()=>{if(u)try{await (0,n.bw)(e.id,e.title,"png",{size:512,branded:o}),await (0,l.$l)(e.id),x&&x()}catch(e){console.error("Error downloading QR code:",e)}},N=async()=>{if(u)try{if(navigator.share){let t=await fetch(u),r=await t.blob(),a=new File([r],`${e.title}_qr_code.png`,{type:"image/png"});await navigator.share({title:`${e.title} - QR Code`,text:`Scan this QR code to support: ${e.title}`,files:[a]})}else{let t=`${window.location.origin}/petitions/${e.id}`;await navigator.clipboard.writeText(t),alert("Petition link copied to clipboard!")}await (0,l.$l)(e.id),m&&m()}catch(e){console.error("Error sharing QR code:",e)}},k=()=>{"default"===r&&y(!0)},C=()=>{y(!1)};return"default"===r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:`text-center ${h}`,children:[f?a.jsx("div",{className:"flex items-center justify-center bg-gray-100 rounded-lg",style:{width:t,height:t},children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):w?a.jsx("div",{className:"flex items-center justify-center bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm",style:{width:t,height:t},children:w}):a.jsx("div",{className:"inline-block cursor-pointer",onClick:k,children:a.jsx(i(),{src:u,alt:`QR Code for ${e.title}`,width:t,height:t,className:"rounded-lg shadow-md hover:shadow-lg transition-shadow"})}),!f&&!w&&(d||c)&&(0,a.jsxs)("div",{className:"flex gap-2 justify-center mt-3",children:[d&&(0,a.jsxs)("button",{onClick:v,className:"px-4 py-2 text-sm bg-gray-800 hover:bg-gray-900 text-white rounded-md transition-colors flex items-center gap-2 font-medium",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download"]}),c&&(0,a.jsxs)("button",{onClick:N,className:"px-4 py-2 text-sm bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors flex items-center gap-2 font-medium",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]})]})]}),b&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:C,children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Petition QR Code"}),a.jsx("button",{onClick:C,className:"text-gray-400 hover:text-gray-600 p-1",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"text-center",children:[f?a.jsx("div",{className:"flex items-center justify-center bg-gray-100 rounded-lg mx-auto",style:{width:300,height:300},children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):w?a.jsx("div",{className:"flex items-center justify-center bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm mx-auto",style:{width:300,height:300},children:w}):a.jsx("div",{className:"inline-block mb-4",children:a.jsx(i(),{src:u,alt:`QR Code for ${e.title}`,width:300,height:300,className:"rounded-lg shadow-md"})}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mb-6",children:[a.jsx("p",{className:"font-medium text-gray-900",children:e.title}),a.jsx("p",{children:"Scan to view and support this petition"})]}),!f&&!w&&(0,a.jsxs)("div",{className:"flex gap-3",children:[d&&(0,a.jsxs)("button",{onClick:v,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-900 text-white rounded-md transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download"]}),c&&(0,a.jsxs)("button",{onClick:N,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]})]})]})]})})]}):"card"===r?a.jsx("div",{className:`bg-white rounded-lg shadow-md p-6 ${h}`,children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Share this Petition"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Scan the QR code to view and support this petition"}),f?a.jsx("div",{className:"flex items-center justify-center bg-gray-100 rounded-lg mx-auto",style:{width:t,height:t},children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):w?a.jsx("div",{className:"flex items-center justify-center bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm mx-auto",style:{width:t,height:t},children:w}):a.jsx("div",{className:"inline-block mb-4 cursor-pointer",onClick:k,children:a.jsx(i(),{src:u,alt:`QR Code for ${e.title}`,width:t,height:t,className:"rounded-lg shadow-md hover:shadow-lg transition-shadow"})}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mb-4",children:[a.jsx("p",{className:"font-medium",children:e.title}),a.jsx("p",{children:"Created by User"})]}),!f&&!w&&(0,a.jsxs)("div",{className:"flex gap-2 justify-center",children:[d&&(0,a.jsxs)("button",{onClick:v,className:"flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-900 text-white rounded-md transition-colors flex items-center justify-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download"]}),c&&(0,a.jsxs)("button",{onClick:N,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors flex items-center justify-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]})]})]})}):null}},24844:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>n,Zb:()=>i,aY:()=>d,ll:()=>l});var a=r(53854),s=r(34218),o=r(68504);let i=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let n=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",e),...t}));n.displayName="CardHeader";let l=s.forwardRef(({className:e,...t},r)=>a.jsx("h3",{ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle",s.forwardRef(({className:e,...t},r)=>a.jsx("p",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",e),...t})).displayName="CardDescription";let d=s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,o.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",s.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},21663:(e,t,r)=>{"use strict";r.d(t,{Rc:()=>l,fc:()=>h,u2:()=>d,xw:()=>i}),r(53854);var a=r(34218),s=r(51018),o=r(58198);let i=(e="/auth/login")=>{let{user:t,loading:r}=(0,o.useAuth)(),i=(0,s.useRouter)();return(0,a.useEffect)(()=>{if(!r&&!t){let t=window.location.pathname,r=`${e}?redirect=${encodeURIComponent(t)}`;i.push(r)}},[t,r,i,e]),{user:t,loading:r,isAuthenticated:!!t}},n=(e,t="/dashboard")=>{let{user:r,userProfile:i,loading:n}=(0,o.useAuth)(),l=(0,s.useRouter)();return(0,a.useEffect)(()=>{if(!n){if(r)i&&!e.includes(i.role)&&l.push(t);else{let e=window.location.pathname,t=`/auth/login?redirect=${encodeURIComponent(e)}`;l.push(t)}}},[r,i,n,l,e,t]),{user:r,userProfile:i,loading:n,isAuthenticated:!!r,hasRequiredRole:!!i&&e.includes(i.role)}},l=(e="/dashboard")=>n(["admin"],e),d=(e="/dashboard")=>n(["moderator","admin"],e),c=(e,t)=>!!e&&t.includes(e.role),h=e=>c(e,["moderator","admin"])},50902:(e,t,r)=>{"use strict";r.d(t,{bv:()=>l,bw:()=>c,w1:()=>n});var a=r(75944),s=r(62745),o=r(31489),i=r(1853);let n=async(e,t={})=>{let{size:r=256,branded:s=!1,includeAnalytics:o=!0}=t;try{let t=`http://localhost:3000/petitions/${e}${o?"?utm_source=qr":""}`,i=await a.toDataURL(t,{width:r,height:r,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"});if(s)return await d(i,r);return i}catch(e){throw console.error("Error generating QR code:",e),Error("Failed to generate QR code")}},l=async(e,t={})=>{let{size:r=512,branded:a=!1,updatePetition:l=!0}=t;try{let t=await n(e,{size:r,branded:a,includeAnalytics:!0}),d=await fetch(t),c=await d.blob(),h=`qr-codes/${e}-${Date.now()}.png`,m=(0,s.ref)(i.t,h);await (0,s.KV)(m,c);let x=await (0,s.getDownloadURL)(m);if(l){let t=(0,o.doc)(i.db,"petitions",e);await (0,o.updateDoc)(t,{qrCodeUrl:x,hasQrCode:!0,updatedAt:o.Timestamp.fromDate(new Date)})}return x}catch(e){throw console.error("Error generating and storing QR code:",e),Error("Failed to generate and store QR code")}},d=async(e,t)=>{try{let r=document.createElement("canvas"),a=r.getContext("2d");if(!a)throw Error("Could not get canvas context");r.width=t,r.height=t+60;let s=new Image;return await new Promise((t,r)=>{s.onload=t,s.onerror=r,s.src=e}),a.drawImage(s,0,0,t,t),a.fillStyle="#000000",a.font=`${Math.floor(.04*t)}px Arial, sans-serif`,a.textAlign="center",a.fillText("3arida.ma",t/2,t+30),a.fillText("Petition Platform",t/2,t+50),r.toDataURL("image/png")}catch(t){return console.error("Error adding branding to QR code:",t),e}},c=async(e,t,r="png",a={})=>{try{let{size:s=512,branded:o=!0}=a;if("png"===r){let r=await n(e,{size:s,branded:o,includeAnalytics:!0}),a=document.createElement("a");a.href=r,a.download=`${t.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_qr_code.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}else"pdf"===r&&await c(e,t,"png",a)}catch(e){throw console.error("Error downloading QR code:",e),Error("Failed to download QR code")}}},2520:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>s});var a=r(4656);let s={title:"Next.js",description:"Generated by Next.js"};function o({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{children:e})})}}};