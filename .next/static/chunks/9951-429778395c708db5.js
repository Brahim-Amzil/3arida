(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9951],{3525:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c},useAuth:function(){return l}});var a=r(7437),i=r(2265),o=r(7065),n=r(8121),s=r(1221);let u=(0,i.createContext)({user:null,userProfile:null,loading:!0,isAuthenticated:!1}),l=()=>{let e=(0,i.useContext)(u);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function c(e){let{children:t}=e,[r,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(null),[f,h]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let e=null,t=(0,o.Aj)(s.auth,async t=>{if(console.log("\uD83D\uDD10 Auth state changed:",t?"User logged in":"User logged out"),l(t),h(!1),e&&(e(),e=null),t){let r=(0,n.doc)(s.db,"users",t.uid);e=(0,n.cf)(r,async e=>{if(e.exists()){var r,a,i,o,n,u,l,c;let f=e.data();if(console.log("\uD83D\uDC64 User profile updated from Firestore",{hasBio:!!f.bio,bio:f.bio,isActive:f.isActive}),!1===f.isActive){console.warn("⚠️ User account is inactive, logging out..."),await s.auth.signOut(),window.location.href="/auth/login?error=account-inactive";return}d({id:t.uid,name:f.name||t.displayName||"",email:f.email||t.email||"",phone:f.phone,photoURL:f.photoURL||t.photoURL,bio:f.bio,verifiedEmail:f.verifiedEmail||t.emailVerified||!1,verifiedPhone:f.verifiedPhone||!1,role:f.role||"user",creatorPageId:f.creatorPageId,fcmToken:f.fcmToken,fcmTokenUpdatedAt:null===(a=f.fcmTokenUpdatedAt)||void 0===a?void 0:null===(r=a.toDate)||void 0===r?void 0:r.call(a),createdAt:(null===(o=f.createdAt)||void 0===o?void 0:null===(i=o.toDate)||void 0===i?void 0:i.call(o))||new Date,updatedAt:null===(u=f.updatedAt)||void 0===u?void 0:null===(n=u.toDate)||void 0===n?void 0:n.call(u),lastLoginAt:null===(c=f.lastLoginAt)||void 0===c?void 0:null===(l=c.toDate)||void 0===l?void 0:l.call(c),isActive:!1!==f.isActive})}else d({id:t.uid,name:t.displayName||"",email:t.email||"",verifiedEmail:t.emailVerified,verifiedPhone:!1,role:"user",isActive:!0,createdAt:new Date})},e=>{console.error("Error listening to user profile:",e),d({id:t.uid,name:t.displayName||"",email:t.email||"",verifiedEmail:t.emailVerified,verifiedPhone:!1,role:"user",isActive:!0,createdAt:new Date})})}else d(null)});return()=>{t(),e&&e()}},[]),(0,a.jsx)(u.Provider,{value:{user:r,userProfile:c,loading:f,isAuthenticated:!!r},children:t})}},575:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var a=r(7437),i=r(2265),o=r(4949),n=r(6061),s=r(2169);let u=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=i.forwardRef((e,t)=>{let{className:r,variant:i,size:n,asChild:l=!1,...c}=e,d=l?o.g7:"button";return(0,a.jsx)(d,{className:(0,s.cn)(u({variant:i,size:n,className:r})),ref:t,...c})});l.displayName="Button"},5671:function(e,t,r){"use strict";r.d(t,{Ol:function(){return s},Zb:function(){return n},aY:function(){return l},ll:function(){return u}});var a=r(7437),i=r(2265),o=r(2169);let n=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...i})});n.displayName="Card";let s=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...i})});s.displayName="CardHeader";let u=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...i})});u.displayName="CardTitle",i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...i})}).displayName="CardDescription";let l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...i})});l.displayName="CardContent",i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...i})}).displayName="CardFooter"},8793:function(e,t,r){"use strict";r.d(t,{Cb:function(){return u},Yi:function(){return n},fZ:function(){return s},kS:function(){return l}});var a=r(7065),i=r(8121);r(5496);var o=r(1221);let n=async e=>{try{let t=await (0,a.Xb)(o.auth,e.email,e.password);await (0,a.ck)(t.user,{displayName:e.name}),await c(t.user,{name:e.name,email:e.email});try{await (0,a.w$)(t.user),console.log("✅ Verification email sent")}catch(e){console.warn("⚠️ Could not send verification email:",e)}return t}catch(e){throw console.error("Registration error:",e),Error(h(e.code))}},s=async e=>{try{let t=await (0,a.e5)(o.auth,e.email,e.password),r=(0,i.doc)(o.db,"users",t.user.uid),n=await (0,i.getDoc)(r);if(n.exists()){let e=n.data();if(!1===e.isActive)throw await (0,a.w7)(o.auth),Error("Your account has been deactivated. Please contact support.")}return await f(t.user.uid),t}catch(e){throw console.error("Login error:",e),Error(h(e.code))}},u=async()=>{try{let e=new a.hJ,t=await (0,a.rh)(o.auth,e);await d(t.user);let r=(0,i.doc)(o.db,"users",t.user.uid),n=await (0,i.getDoc)(r);if(n.exists()){let e=n.data();if(!1===e.isActive)throw await (0,a.w7)(o.auth),Error("Your account has been deactivated. Please contact support.")}return await f(t.user.uid),t}catch(e){throw console.error("Google login error:",e),Error(h(e.code))}},l=async()=>{try{await (0,a.w7)(o.auth)}catch(e){throw console.error("Logout error:",e),Error("Failed to logout")}},c=async(e,t)=>{try{let r=(0,i.doc)(o.db,"users",e.uid);if(!(await (0,i.getDoc)(r)).exists()){let{name:a,email:o}=t,n=new Date;await (0,i.setDoc)(r,{id:e.uid,name:a,email:o,phone:e.phoneNumber||null,verifiedEmail:!1,verifiedPhone:!1,role:"user",creatorPageId:null,lastLoginAt:n,createdAt:n,updatedAt:n,isActive:!0})}}catch(e){throw console.error("Error creating user profile:",e),Error("Failed to create user profile")}},d=async e=>{try{let t=(0,i.doc)(o.db,"users",e.uid);if(!(await (0,i.getDoc)(t)).exists()){let r=new Date;await (0,i.setDoc)(t,{id:e.uid,name:e.displayName||"",email:e.email||"",phone:e.phoneNumber||null,photoURL:e.photoURL||null,verifiedEmail:e.emailVerified,verifiedPhone:!1,role:"user",creatorPageId:null,lastLoginAt:r,createdAt:r,updatedAt:r,isActive:!0})}}catch(e){console.error("Error ensuring user profile:",e)}},f=async e=>{try{let t=(0,i.doc)(o.db,"users",e);await (0,i.updateDoc)(t,{lastLoginAt:new Date,updatedAt:new Date})}catch(e){console.error("Error updating login tracking:",e)}},h=e=>{switch(e){case"auth/email-already-in-use":return"An account with this email already exists.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/operation-not-allowed":return"This sign-in method is not enabled.";case"auth/weak-password":return"Password should be at least 6 characters long.";case"auth/user-disabled":return"This account has been disabled.";case"auth/user-not-found":return"No account found with this email address.";case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/invalid-credential":return"Invalid email or password. Please try again.";case"auth/too-many-requests":return"Too many failed attempts. Please try again later.";case"auth/network-request-failed":return"Network error. Please check your connection.";case"auth/popup-closed-by-user":case"auth/cancelled-popup-request":return"Sign-in was cancelled.";case"auth/invalid-phone-number":return"Please enter a valid Moroccan phone number.";case"auth/invalid-verification-code":return"Invalid verification code. Please try again.";case"auth/code-expired":return"Verification code has expired. Please request a new one.";case"auth/account-inactive":return"Your account has been deactivated. Please contact support.";default:return"An error occurred. Please try again."}}},1221:function(e,t,r){"use strict";r.d(t,{auth:function(){return u},db:function(){return l},t:function(){return c}});var a=r(6142),i=r(7065),o=r(8121),n=r(955);let s=0===(0,a.getApps)().length?(0,a.initializeApp)({apiKey:"AIzaSyAhYUelLCS8ItJwaltcjtUl8HHJwp605T0".trim(),authDomain:"arida-c5faf.firebaseapp.com".trim(),projectId:"arida-c5faf".trim(),storageBucket:"arida-c5faf.firebasestorage.app".trim(),messagingSenderId:"446881275370".trim(),appId:"1:446881275370:web:283f0360cfab3556a32693".trim()}):(0,a.Mq)(),u=(0,i.getAuth)(s),l=(0,o.getFirestore)(s),c=(0,n.getStorage)(s);t.Z=s},2169:function(e,t,r){"use strict";r.d(t,{cn:function(){return o}});var a=r(7042),i=r(4769);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,a.W)(t))}},1396:function(e,t,r){e.exports=r(5250)}}]);