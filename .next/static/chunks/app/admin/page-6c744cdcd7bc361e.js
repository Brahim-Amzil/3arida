(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{6244:function(e,s,t){Promise.resolve().then(t.bind(t,679))},679:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x}});var n=t(7437),i=t(2265),a=t(1069),l=t(5671),r=t(575),d=t(6587),c=t(8121),o=t(1221);function x(){let{user:e,userProfile:s,loading:t,hasRequiredRole:x}=(0,d.Rc)(),[m,h]=(0,i.useState)({totalPetitions:0,pendingPetitions:0,approvedPetitions:0,pausedPetitions:0,totalUsers:0,totalSignatures:0,recentPetitions:[]}),[u,g]=(0,i.useState)(!0),[j,p]=(0,i.useState)("");(0,i.useEffect)(()=>{!t&&x&&f()},[t,x]);let f=async()=>{try{g(!0),p("");let e=(0,c.collection)(o.db,"petitions"),[s,t,n,i,a,l]=await Promise.all([(0,c.getDocs)((0,c.query)(e)),(0,c.getDocs)((0,c.query)(e,(0,c.where)("status","==","pending"))),(0,c.getDocs)((0,c.query)(e,(0,c.where)("status","==","approved"))),(0,c.getDocs)((0,c.query)(e,(0,c.where)("status","==","paused"))),(0,c.getDocs)((0,c.query)(e,(0,c.orderBy)("createdAt","desc"),(0,c.b9)(5))),(0,c.getDocs)((0,c.collection)(o.db,"users"))]),r=0,d=[];s.forEach(e=>{let s={id:e.id,...e.data()};r+=s.currentSignatures||0}),a.forEach(e=>{var s,t,n,i;let a=e.data(),l={id:e.id,...a,createdAt:(null===(t=a.createdAt)||void 0===t?void 0:null===(s=t.toDate)||void 0===s?void 0:s.call(t))||new Date,updatedAt:(null===(i=a.updatedAt)||void 0===i?void 0:null===(n=i.toDate)||void 0===n?void 0:n.call(i))||new Date};d.push(l)}),h({totalPetitions:s.size,pendingPetitions:t.size,approvedPetitions:n.size,pausedPetitions:i.size,totalUsers:l.size,totalSignatures:r,recentPetitions:d})}catch(e){console.error("Error loading admin stats:",e),p("Failed to load admin statistics")}finally{g(!1)}};return t?(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(a.Z,{}),(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)]",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})]}):x?(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(a.Z,{}),(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Dashboard"}),(0,n.jsx)("p",{className:"text-lg text-gray-600",children:"Manage petitions, users, and platform statistics"})]}),(0,n.jsx)("div",{className:"mb-8",children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,n.jsx)(r.z,{asChild:!0,children:(0,n.jsx)("a",{href:"/admin/petitions",children:"Manage Petitions"})}),(0,n.jsx)(r.z,{variant:"outline",asChild:!0,children:(0,n.jsx)("a",{href:"/admin/users",children:"Manage Users"})}),(0,n.jsx)(r.z,{variant:"outline",asChild:!0,children:(0,n.jsx)("a",{href:"/admin/moderators",children:"Manage Moderators"})}),(0,n.jsx)(r.z,{variant:"outline",asChild:!0,children:(0,n.jsx)("a",{href:"/admin/analytics",children:"View Analytics"})})]})}),u?(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-6",children:(0,n.jsxs)("div",{className:"animate-pulse",children:[(0,n.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,n.jsx)("div",{className:"h-8 bg-gray-200 rounded"})]})})},s))}):j?(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 mb-8",children:[(0,n.jsx)("p",{className:"text-red-600",children:j}),(0,n.jsx)(r.z,{onClick:f,className:"mt-4",variant:"outline",children:"Try Again"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-6",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})}),(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Petitions"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:m.totalPetitions})]})]})})}),(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-6",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Review"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:m.pendingPetitions})]})]})})}),(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-6",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:m.totalUsers})]})]})})}),(0,n.jsx)(l.Zb,{children:(0,n.jsx)(l.aY,{className:"p-6",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,n.jsxs)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})}),(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Signatures"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:m.totalSignatures.toLocaleString()})]})]})})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{children:(0,n.jsx)(l.ll,{children:"Recent Petitions"})}),(0,n.jsx)(l.aY,{children:0===m.recentPetitions.length?(0,n.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No recent petitions"}):(0,n.jsx)("div",{className:"space-y-4",children:m.recentPetitions.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,n.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("pending"===e.status?"bg-yellow-100 text-yellow-800":"approved"===e.status?"bg-green-100 text-green-800":"paused"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.status}),(0,n.jsxs)("span",{className:"text-sm text-gray-500",children:[e.currentSignatures," signatures"]})]})]}),(0,n.jsx)(r.z,{size:"sm",variant:"outline",asChild:!0,children:(0,n.jsx)("a",{href:"/admin/petitions/".concat(e.id),children:"Review"})})]},e.id))})})]}),(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{children:(0,n.jsx)(l.ll,{children:"System Status"})}),(0,n.jsx)(l.aY,{children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Platform Status"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Operational"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Database"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Connected"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Storage"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Available"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Payments"}),(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})]})]})})]})]})]})]})]}):null}},6587:function(e,s,t){"use strict";t.d(s,{Rc:function(){return d},fc:function(){return x},u2:function(){return c},xw:function(){return l}}),t(7437);var n=t(2265),i=t(4033),a=t(3525);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/auth/login",{user:s,loading:t}=(0,a.useAuth)(),l=(0,i.useRouter)();return(0,n.useEffect)(()=>{if(!t&&!s){let s=window.location.pathname,t="".concat(e,"?redirect=").concat(encodeURIComponent(s));l.push(t)}},[s,t,l,e]),{user:s,loading:t,isAuthenticated:!!s}},r=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/dashboard",{user:t,userProfile:l,loading:r}=(0,a.useAuth)(),d=(0,i.useRouter)();return(0,n.useEffect)(()=>{if(!r){if(t)l&&!e.includes(l.role)&&d.push(s);else{let e=window.location.pathname,s="/auth/login?redirect=".concat(encodeURIComponent(e));d.push(s)}}},[t,l,r,d,e,s]),{user:t,userProfile:l,loading:r,isAuthenticated:!!t,hasRequiredRole:!!l&&e.includes(l.role)}},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/dashboard";return r(["admin"],e)},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/dashboard";return r(["moderator","admin"],e)},o=(e,s)=>!!e&&s.includes(e.role),x=e=>o(e,["moderator","admin"])}},function(e){e.O(0,[358,139,682,680,396,496,878,69,971,938,744],function(){return e(e.s=6244)}),_N_E=e.O()}]);