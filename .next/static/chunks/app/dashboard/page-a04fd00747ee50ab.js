(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{4369:function(e,s,t){Promise.resolve().then(t.bind(t,6086))},6086:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return h}});var i=t(7437),l=t(2265),r=t(4033),n=t(1396),a=t.n(n),d=t(2193),o=t(3466),c=t(3089),u=t(1138),x=t(1550);function h(){var e;let s=(0,r.useRouter)(),{user:t,userProfile:n,isAuthenticated:h,loading:m}=(0,u.useAuth)(),[g,v]=(0,l.useState)([]),[p,j]=(0,l.useState)(!0),[f,N]=(0,l.useState)(""),[y,b]=(0,l.useState)("all");(0,l.useEffect)(()=>{m||h||s.push("/auth/login?redirect=/dashboard")},[m,h,s]),(0,l.useEffect)(()=>{t&&k()},[t]);let k=async()=>{if(t)try{j(!0),N("");let e=await (0,x.gt)(t.uid);v(e)}catch(e){console.error("Error loading user petitions:",e),N("Failed to load your petitions. Please try again.")}finally{j(!1)}};if(m)return(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,i.jsx)(d.default,{}),(0,i.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)]",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})]});if(!h)return null;let w=g.reduce((e,s)=>e+s.currentSignatures,0),L=g.filter(e=>"approved"===e.status).length,A=g.filter(e=>"pending"===e.status).length,C=g.filter(e=>"all"===y||("active"===y?"approved"===e.status:"pending"===y?"pending"===e.status:"rejected"===y?"rejected"===e.status:"paused"===y?"paused"===e.status:"deleted"!==y||"deleted"===e.status||void 0!==e.deletedAt)),z={all:g.length,active:g.filter(e=>"approved"===e.status).length,pending:g.filter(e=>"pending"===e.status).length,rejected:g.filter(e=>"rejected"===e.status).length,paused:g.filter(e=>"paused"===e.status).length,deleted:g.filter(e=>"deleted"===e.status||void 0!==e.deletedAt).length};return(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,i.jsx)(d.default,{}),(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,i.jsx)("div",{className:"mb-8",children:(0,i.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Welcome back,"," ",(null==n?void 0:n.name)||(null==t?void 0:t.displayName)||(null==t?void 0:null===(e=t.email)||void 0===e?void 0:e.split("@")[0]),"!"]}),(0,i.jsx)("p",{className:"text-lg text-gray-600",children:"Manage your petitions and track their progress"})]}),(0,i.jsx)("div",{className:"mt-4 md:mt-0",children:(0,i.jsx)(a(),{href:"/petitions/create",children:(0,i.jsx)(c.z,{children:"+ New Petition"})})})]})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[(0,i.jsx)("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-2xl font-bold text-gray-900 leading-none",children:g.length}),(0,i.jsx)("p",{className:"text-xs text-gray-600 mt-0.5",children:"Total Petitions"})]})]})}),(0,i.jsx)("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-2xl font-bold text-gray-900 leading-none",children:L}),(0,i.jsx)("p",{className:"text-xs text-gray-600 mt-0.5",children:"Active Petitions"})]})]})}),(0,i.jsx)("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,i.jsx)("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-2xl font-bold text-gray-900 leading-none",children:A}),(0,i.jsx)("p",{className:"text-xs text-gray-600 mt-0.5",children:"Pending Review"})]})]})}),(0,i.jsx)("div",{className:"bg-white rounded-lg p-3 border border-gray-200 shadow-sm",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,i.jsxs)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-2xl font-bold text-gray-900 leading-none",children:w.toLocaleString()}),(0,i.jsx)("p",{className:"text-xs text-gray-600 mt-0.5",children:"Total Signatures"})]})]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:(0,i.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Petitions"})}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 mb-6",children:[(0,i.jsxs)(c.z,{variant:"all"===y?"default":"outline",size:"sm",onClick:()=>b("all"),className:"flex items-center gap-2",children:[(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),"All",(0,i.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700",children:z.all})]}),(0,i.jsxs)(c.z,{variant:"active"===y?"default":"outline",size:"sm",onClick:()=>b("active"),className:"flex items-center gap-2",children:[(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Active",(0,i.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700",children:z.active})]}),(0,i.jsxs)(c.z,{variant:"pending"===y?"default":"outline",size:"sm",onClick:()=>b("pending"),className:"flex items-center gap-2",children:[(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Pending Review",(0,i.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700",children:z.pending})]}),(0,i.jsxs)(c.z,{variant:"rejected"===y?"default":"outline",size:"sm",onClick:()=>b("rejected"),className:"flex items-center gap-2",children:[(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Rejected",(0,i.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700",children:z.rejected})]}),(0,i.jsxs)(c.z,{variant:"paused"===y?"default":"outline",size:"sm",onClick:()=>b("paused"),className:"flex items-center gap-2",children:[(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Paused",(0,i.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700",children:z.paused})]}),(0,i.jsxs)(c.z,{variant:"deleted"===y?"default":"outline",size:"sm",onClick:()=>b("deleted"),className:"flex items-center gap-2",children:[(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Deleted",(0,i.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700",children:z.deleted})]})]}),p&&(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((e,s)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden animate-pulse",children:[(0,i.jsx)("div",{className:"h-48 bg-gray-200"}),(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,i.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),(0,i.jsx)("div",{className:"h-2 bg-gray-200 rounded mb-2"}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"}),(0,i.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]})]},s))}),f&&(0,i.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,i.jsx)("p",{className:"text-red-600",children:f}),(0,i.jsx)(c.z,{onClick:k,className:"mt-4",variant:"outline",children:"Try Again"})]}),!p&&!f&&C.length>0&&(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(e=>(0,i.jsx)(o.Z,{petition:e,variant:"grid",showProgress:!0,showCreator:!1,showActions:!0},e.id))}),!p&&!f&&0===g.length&&(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,i.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No petitions yet"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:"You haven't created any petitions yet. Start your first petition to make change happen!"}),(0,i.jsx)(c.z,{asChild:!0,children:(0,i.jsx)(a(),{href:"/petitions/create",children:"Create Your First Petition"})})]}),!p&&!f&&g.length>0&&0===C.length&&(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,i.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,i.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",y," petitions"]}),(0,i.jsxs)("p",{className:"text-gray-600 mb-6",children:["You don't have any ",y," petitions at the moment."]}),(0,i.jsx)(c.z,{onClick:()=>b("all"),variant:"outline",children:"Show All Petitions"})]})]})]})]})}},1138:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c},useAuth:function(){return o}});var i=t(7437),l=t(2265),r=t(4867),n=t(5797),a=t(6831);let d=(0,l.createContext)({user:null,userProfile:null,loading:!0,isAuthenticated:!1}),o=()=>{let e=(0,l.useContext)(d);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function c(e){let{children:s}=e,[t,o]=(0,l.useState)(null),[c,u]=(0,l.useState)(null),[x,h]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{let e=null,s=(0,r.Aj)(a.auth,async s=>{if(console.log("\uD83D\uDD10 Auth state changed:",s?"User logged in":"User logged out"),o(s),h(!1),e&&(e(),e=null),s){let t=(0,n.doc)(a.db,"users",s.uid);e=(0,n.cf)(t,async e=>{if(e.exists()){var t,i,l,r,n,d,o,c;let x=e.data();if(console.log("\uD83D\uDC64 User profile updated from Firestore",{hasBio:!!x.bio,bio:x.bio,isActive:x.isActive}),!1===x.isActive){console.warn("⚠️ User account is inactive, logging out..."),await a.auth.signOut(),window.location.href="/auth/login?error=account-inactive";return}u({id:s.uid,name:x.name||s.displayName||"",email:x.email||s.email||"",phone:x.phone,photoURL:x.photoURL||s.photoURL,bio:x.bio,verifiedEmail:x.verifiedEmail||s.emailVerified||!1,verifiedPhone:x.verifiedPhone||!1,role:x.role||"user",creatorPageId:x.creatorPageId,fcmToken:x.fcmToken,fcmTokenUpdatedAt:null===(i=x.fcmTokenUpdatedAt)||void 0===i?void 0:null===(t=i.toDate)||void 0===t?void 0:t.call(i),createdAt:(null===(r=x.createdAt)||void 0===r?void 0:null===(l=r.toDate)||void 0===l?void 0:l.call(r))||new Date,updatedAt:null===(d=x.updatedAt)||void 0===d?void 0:null===(n=d.toDate)||void 0===n?void 0:n.call(d),lastLoginAt:null===(c=x.lastLoginAt)||void 0===c?void 0:null===(o=c.toDate)||void 0===o?void 0:o.call(c),isActive:!1!==x.isActive})}else u({id:s.uid,name:s.displayName||"",email:s.email||"",verifiedEmail:s.emailVerified,verifiedPhone:!1,role:"user",isActive:!0,createdAt:new Date})},e=>{console.error("Error listening to user profile:",e),u({id:s.uid,name:s.displayName||"",email:s.email||"",verifiedEmail:s.emailVerified,verifiedPhone:!1,role:"user",isActive:!0,createdAt:new Date})})}else u(null)});return()=>{s(),e&&e()}},[]),(0,i.jsx)(d.Provider,{value:{user:t,userProfile:c,loading:x,isAuthenticated:!!t},children:s})}},4033:function(e,s,t){e.exports=t(94)}},function(e){e.O(0,[4358,139,8218,7895,8326,745,9112,6691,8984,3466,2971,2472,1744],function(){return e(e.s=4369)}),_N_E=e.O()}]);