(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[864],{5531:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var a=s(2265);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),l=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:i="",children:l,iconNode:d,...m},x)=>(0,a.createElement)("svg",{ref:x,...c,width:t,height:t,stroke:e,strokeWidth:r?24*Number(s)/Number(t):s,className:n("lucide",i),...!l&&!o(m)&&{"aria-hidden":"true"},...m},[...d.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(l)?l:[l]])),m=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...i},o)=>(0,a.createElement)(d,{ref:o,iconNode:t,className:n(`lucide-${r(l(e))}`,`lucide-${e}`,s),...i}));return s.displayName=l(e),s}},2442:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(5531).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},4530:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(5531).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3101:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(5531).Z)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])},1138:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(5531).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},2549:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(5531).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8251:function(e,t,s){Promise.resolve().then(s.bind(s,6181))},6181:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return V}});var a=s(7437),r=s(2265),i=s(4033),l=s(6691),n=s.n(l),o=s(1396),c=s.n(o),d=s(1069),m=s(4890),x=s(4182),h=s(9479),u=s(575),p=s(5671),g=s(8063);function j(e){let{petition:t,onClose:s}=e,[i,l]=(0,r.useState)(!1),n="".concat(window.location.origin,"/petitions/").concat(t.id),o="Support this petition: ".concat(t.title),c=encodeURIComponent(n),d=encodeURIComponent(o),m=async()=>{try{await navigator.clipboard.writeText(n),l(!0),setTimeout(()=>l(!1),2e3),await (0,g.$l)(t.id)}catch(e){console.error("Failed to copy link:",e)}},x=async(e,s)=>{window.open(s,"_blank","width=600,height=400");try{await (0,g.$l)(t.id)}catch(e){console.error("Failed to track share:",e)}},h=async()=>{if(navigator.share)try{await navigator.share({title:t.title,text:o,url:n}),await (0,g.$l)(t.id)}catch(e){}},j=[{name:"Facebook",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),url:"https://www.facebook.com/sharer/sharer.php?u=".concat(c),color:"bg-blue-600 hover:bg-blue-700"},{name:"Twitter",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})}),url:"https://twitter.com/intent/tweet?text=".concat(d,"&url=").concat(c),color:"bg-sky-500 hover:bg-sky-600"},{name:"WhatsApp",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),url:"https://wa.me/?text=".concat(d,"%20").concat(c),color:"bg-green-500 hover:bg-green-600"},{name:"LinkedIn",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),url:"https://www.linkedin.com/sharing/share-offsite/?url=".concat(c),color:"bg-blue-700 hover:bg-blue-800"},{name:"Telegram",icon:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),url:"https://t.me/share/url?url=".concat(c,"&text=").concat(d),color:"bg-blue-500 hover:bg-blue-600"}];return(0,a.jsxs)(p.Zb,{className:"w-full max-w-md",children:[(0,a.jsx)(p.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(p.ll,{children:"Share Petition"}),s&&(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 p-1",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,a.jsxs)(p.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2 line-clamp-2",children:t.title}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:[t.currentSignatures.toLocaleString()," signatures"]}),(0,a.jsx)("span",{children:t.category})]})]}),void 0!==navigator.share&&(0,a.jsxs)(u.z,{onClick:h,className:"w-full flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Share on social media"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:j.map(e=>(0,a.jsxs)("button",{onClick:()=>x(e.name,e.url),className:"".concat(e.color," text-white p-3 rounded-lg flex items-center justify-center gap-2 transition-colors"),children:[e.icon,(0,a.jsx)("span",{className:"text-sm font-medium",children:e.name})]},e.name))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Copy link"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:n,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-sm"}),(0,a.jsx)(u.z,{onClick:m,variant:"outline",className:i?"bg-green-50 border-green-300 text-green-700":"",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-blue-800 mb-1",children:"Sharing Tips"}),(0,a.jsxs)("ul",{className:"text-xs text-blue-700 space-y-1",children:[(0,a.jsx)("li",{children:"• Add a personal message when sharing"}),(0,a.jsx)("li",{children:"• Share with friends who care about this cause"}),(0,a.jsx)("li",{children:"• Post in relevant groups and communities"}),(0,a.jsx)("li",{children:"• Use relevant hashtags on social media"})]})]})]})})]})]})}var b=s(3525),f=s(8121),y=s(1221);function v(e){let{petitionId:t,className:s="",onCommentsCountChange:i}=e,{user:l,userProfile:n}=(0,b.useAuth)(),[o,c]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),[x,h]=(0,r.useState)(!1),[g,j]=(0,r.useState)(""),[v,N]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)("latest"),[z,P]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{A()},[t]);let A=async()=>{try{m(!0),console.log("\uD83D\uDD0D Loading comments for petition:",t);let e=(0,f.collection)(y.db,"comments"),s=(0,f.query)(e,(0,f.where)("petitionId","==",t),(0,f.orderBy)("createdAt","desc")),a=await (0,f.getDocs)(s),r=[];console.log("\uD83D\uDCCA Found comments:",a.size),a.forEach(e=>{var t;let s=e.data(),a=s.likedBy||[];l&&a.includes(l.uid)&&P(t=>new Set(t).add(e.id)),r.push({id:e.id,petitionId:s.petitionId,authorId:s.authorId,authorName:s.authorName,content:s.content,createdAt:(null===(t=s.createdAt)||void 0===t?void 0:t.toDate())||new Date,isAnonymous:s.isAnonymous||!1,likes:s.likes||0,likedBy:a,replies:[]})}),console.log("✅ Loaded comments:",r.length);let n=L(r,C);c(n),null==i||i(r.length)}catch(e){console.error("❌ Error loading comments:",e),alert("Failed to load comments. Check console for details.")}finally{m(!1)}},L=(e,t)=>"mostLiked"===t?[...e].sort((e,t)=>t.likes-e.likes):[...e].sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime());(0,r.useEffect)(()=>{o.length>0&&c(L(o,C))},[C]);let M=async e=>{if(e.preventDefault(),l&&n&&g.trim())try{h(!0);let e={petitionId:t,authorId:l.uid,authorName:v?"Anonymous":n.name,content:g.trim(),createdAt:f.Timestamp.fromDate(new Date),isAnonymous:v,likes:0},s={id:(await (0,f.addDoc)((0,f.collection)(y.db,"comments"),e)).id,...e,createdAt:new Date,replies:[]};c(e=>{let t=[s,...e];return null==i||i(t.length),t}),j(""),k(!1)}catch(e){console.error("Error submitting comment:",e),alert("Failed to submit comment. Please try again.")}finally{h(!1)}},D=async e=>{if(!l){alert("Please sign in to like comments");return}try{var t,s,a;let r=(0,f.doc)(y.db,"comments",e);if(z.has(e))await (0,f.updateDoc)(r,{likes:(0,f.nP)(-1),likedBy:(null===(s=o.find(t=>t.id===e))||void 0===s?void 0:null===(t=s.likedBy)||void 0===t?void 0:t.filter(e=>e!==l.uid))||[]}),P(t=>{let s=new Set(t);return s.delete(e),s}),c(t=>t.map(t=>{var s;return t.id===e?{...t,likes:t.likes-1,likedBy:null===(s=t.likedBy)||void 0===s?void 0:s.filter(e=>e!==l.uid)}:t}));else{let t=(null===(a=o.find(t=>t.id===e))||void 0===a?void 0:a.likedBy)||[];await (0,f.updateDoc)(r,{likes:(0,f.nP)(1),likedBy:[...t,l.uid]}),P(t=>new Set(t).add(e)),c(t=>t.map(t=>t.id===e?{...t,likes:t.likes+1,likedBy:[...t.likedBy||[],l.uid]}:t))}}catch(e){console.error("Error liking comment:",e),alert("Failed to like comment. Please try again.")}},B=e=>{let t=Math.floor((new Date().getTime()-e.getTime())/1e3);return t<60?"just now":t<3600?"".concat(Math.floor(t/60),"m ago"):t<86400?"".concat(Math.floor(t/3600),"h ago"):t<604800?"".concat(Math.floor(t/86400),"d ago"):e.toLocaleDateString()};return(0,a.jsxs)(p.Zb,{className:s,children:[(0,a.jsxs)(p.Ol,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)(p.ll,{children:["Discussion (",o.length,")"]}),l&&!w&&(0,a.jsx)(u.z,{onClick:()=>k(!0),size:"sm",children:"Add Comment"})]}),o.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Sort by:"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>S("latest"),className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat("latest"===C?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Latest"}),(0,a.jsx)("button",{onClick:()=>S("mostLiked"),className:"px-3 py-1.5 text-sm rounded-md transition-colors ".concat("mostLiked"===C?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Most Liked"})]})]})]}),(0,a.jsxs)(p.aY,{className:"space-y-6",children:[w&&l&&(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:(0,a.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Share your thoughts"}),(0,a.jsx)("textarea",{value:g,onChange:e=>j(e.target.value),placeholder:"Why do you support this petition?",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",disabled:x,required:!0})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"anonymous",checked:v,onChange:e=>N(e.target.checked),className:"mr-2"}),(0,a.jsx)("label",{htmlFor:"anonymous",className:"text-sm text-gray-600",children:"Comment anonymously"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(u.z,{type:"submit",disabled:x||!g.trim(),size:"sm",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Posting..."]}):"Post Comment"}),(0,a.jsx)(u.z,{type:"button",variant:"outline",onClick:()=>{k(!1),j(""),N(!1)},size:"sm",children:"Cancel"})]})]})}),!l&&(0,a.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Join the Discussion"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Sign in to share your thoughts and support this petition."}),(0,a.jsx)(u.z,{asChild:!0,children:(0,a.jsx)("a",{href:"/auth/login?redirect=".concat(encodeURIComponent(window.location.pathname)),children:"Sign In to Comment"})})]}),d?(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-1"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]})},t))}):0===o.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No comments yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Be the first to share your thoughts on this petition."})]}):(0,a.jsx)("div",{className:"space-y-6",children:o.map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("span",{className:"text-green-600 font-medium text-sm",children:e.isAnonymous?"?":e.authorName.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.authorName}),e.isAnonymous&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"Anonymous"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:B(e.createdAt)})]}),(0,a.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap mb-3",children:e.content}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{onClick:()=>D(e.id),className:"flex items-center gap-1 text-sm transition-colors ".concat(z.has(e.id)?"text-red-500 hover:text-red-600":"text-gray-500 hover:text-gray-700"),disabled:!l,children:[(0,a.jsx)("svg",{className:"w-4 h-4 ".concat(z.has(e.id)?"fill-current":""),fill:z.has(e.id)?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),e.likes>0&&(0,a.jsx)("span",{className:"font-medium",children:e.likes})]}),(0,a.jsx)("button",{className:"text-sm text-gray-500 hover:text-gray-700",children:"Reply"}),e.authorId===(null==l?void 0:l.uid)&&(0,a.jsx)("button",{className:"text-sm text-red-500 hover:text-red-700",children:"Delete"})]})]})]},e.id))}),o.length>0&&o.length%10==0&&(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(u.z,{variant:"outline",size:"sm",children:"Load More Comments"})})]})]})}var N=s(1138),w=s(5531);let k=(0,w.Z)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),C=(0,w.Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function S(e){let{petition:t,onDelete:s,onArchive:i,onRequestDeletion:l}=e,[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(""),[j,b]=(0,r.useState)(!1),f=async()=>{try{b(!0),await s(),o(!1)}catch(e){console.error("Error deleting petition:",e),alert("Failed to delete petition. Please try again.")}finally{b(!1)}},y=async()=>{try{b(!0),await i(),d(!1)}catch(e){console.error("Error archiving petition:",e),alert("Failed to archive petition. Please try again.")}finally{b(!1)}},v=async()=>{if(!h.trim()){alert("Please provide a reason for deletion");return}try{b(!0),await l(h),x(!1),g(""),alert("Deletion request submitted. An admin will review it shortly.")}catch(e){console.error("Error requesting deletion:",e),alert("Failed to submit deletion request. Please try again.")}finally{b(!1)}},w=(()=>{let e=t.createdAt.getTime(),s=Date.now();return t.currentSignatures<=10||"pending"===t.status||(s-e)/36e5<24})();return(0,a.jsxs)(a.Fragment,{children:[n&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(N.Z,{className:"w-6 h-6 text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Petition?"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"This action cannot be undone"})]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to permanently delete this petition? All signatures, comments, and data will be removed from public view."}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,a.jsx)(u.z,{variant:"outline",onClick:()=>o(!1),disabled:j,children:"Cancel"}),(0,a.jsx)(u.z,{variant:"destructive",onClick:f,disabled:j,children:j?"Deleting...":"Delete Petition"})]})]})}),c&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(k,{className:"w-6 h-6 text-yellow-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Archive Petition?"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"You can restore it later"})]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-6",children:"Archiving will hide this petition from public view, but you can restore it anytime from your dashboard. All data will be preserved."}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,a.jsx)(u.z,{variant:"outline",onClick:()=>d(!1),disabled:j,children:"Cancel"}),(0,a.jsx)(u.z,{className:"bg-yellow-600 hover:bg-yellow-700",onClick:y,disabled:j,children:j?"Archiving...":"Archive Petition"})]})]})}),m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(C,{className:"w-6 h-6 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Request Deletion"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Admin will review your request"})]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Your petition has significant support. Please explain why you want to delete it, and an admin will review your request."}),(0,a.jsx)("textarea",{value:h,onChange:e=>g(e.target.value),placeholder:"Reason for deletion request...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none mb-4",disabled:j}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,a.jsx)(u.z,{variant:"outline",onClick:()=>{x(!1),g("")},disabled:j,children:"Cancel"}),(0,a.jsx)(u.z,{className:"bg-orange-600 hover:bg-orange-700",onClick:v,disabled:j||!h.trim(),children:j?"Submitting...":"Submit Request"})]})]})}),(0,a.jsxs)(p.Zb,{className:"border-orange-200 bg-orange-50",children:[(0,a.jsx)(p.Ol,{children:(0,a.jsxs)(p.ll,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(C,{className:"w-5 h-5 text-orange-600"}),"Petition Management"]})}),(0,a.jsxs)(p.aY,{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-700 mb-4",children:"As the creator, you can manage this petition."}),w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.z,{variant:"destructive",onClick:()=>o(!0),className:"w-full flex items-center justify-center gap-2",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4"}),"Delete Petition"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"You can delete this petition because it has ≤10 signatures, is pending approval, or was created within 24 hours."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.z,{className:"w-full flex items-center justify-center gap-2 bg-yellow-600 hover:bg-yellow-700",onClick:()=>d(!0),children:[(0,a.jsx)(k,{className:"w-4 h-4"}),"Archive Petition"]}),(0,a.jsxs)(u.z,{variant:"outline",onClick:()=>x(!0),className:"w-full flex items-center justify-center gap-2 border-orange-300 text-orange-700 hover:bg-orange-100",children:[(0,a.jsx)(C,{className:"w-4 h-4"}),"Request Deletion"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"This petition has significant support. You can archive it or request admin approval for deletion."})]})]})]})]})}let z=(0,w.Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),P=(0,w.Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function A(e){let{petitionId:t,isCreator:i}=e,[l,n]=(0,r.useState)([]),[o,c]=(0,r.useState)(!0),[d,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)({title:"",content:""}),[g,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{b()},[t]);let b=async()=>{try{let{collection:e,query:a,where:r,orderBy:i,getDocs:l}=await Promise.resolve().then(s.bind(s,8121)),{db:o}=await Promise.resolve().then(s.bind(s,1221)),c=e(o,"petitionUpdates"),d=a(c,r("petitionId","==",t),i("createdAt","desc")),m=(await l(d)).docs.map(e=>{var t;let s=e.data();return{id:e.id,...s,createdAt:(null===(t=s.createdAt)||void 0===t?void 0:t.toDate())||new Date}});n(m)}catch(e){console.error("Error fetching updates:",e)}finally{c(!1)}},f=async e=>{if(e.preventDefault(),!x.title.trim()||!x.content.trim()){alert("Please fill in all fields");return}j(!0);try{let{collection:e,addDoc:a,serverTimestamp:r}=await Promise.resolve().then(s.bind(s,8121)),{db:i,auth:l}=await Promise.resolve().then(s.bind(s,1221)),n=l.currentUser;if(!n){alert("You must be logged in to post updates");return}await a(e(i,"petitionUpdates"),{petitionId:t,title:x.title.trim(),content:x.content.trim(),createdAt:r(),createdBy:n.uid,createdByName:n.displayName||"Anonymous"}),h({title:"",content:""}),m(!1),await b()}catch(e){console.error("Error adding update:",e),alert("Failed to add update. Please try again.")}finally{j(!1)}},y=e=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e);return o?(0,a.jsx)(p.Zb,{children:(0,a.jsx)(p.aY,{className:"py-8 text-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto"})})}):(0,a.jsx)(p.Zb,{children:(0,a.jsxs)(p.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Updates"}),i&&!d&&(0,a.jsxs)(u.z,{onClick:()=>m(!0),size:"sm",className:"flex items-center gap-2",children:[(0,a.jsx)(z,{className:"w-4 h-4"}),"Post Update"]})]}),d&&(0,a.jsxs)("form",{onSubmit:f,className:"mb-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"update-title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Update Title"}),(0,a.jsx)("input",{id:"update-title",type:"text",value:x.title,onChange:e=>h({...x,title:e.target.value}),placeholder:"e.g., We reached 1,000 signatures!",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",maxLength:100,disabled:g})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"update-content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Update Content"}),(0,a.jsx)("textarea",{id:"update-content",value:x.content,onChange:e=>h({...x,content:e.target.value}),placeholder:"Share progress, news, or thank supporters...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",maxLength:1e3,disabled:g}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[x.content.length,"/1000 characters"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u.z,{type:"submit",disabled:g,children:g?"Posting...":"Post Update"}),(0,a.jsx)(u.z,{type:"button",variant:"outline",onClick:()=>{m(!1),h({title:"",content:""})},disabled:g,children:"Cancel"})]})]}),l.length>0?(0,a.jsx)("div",{className:"space-y-6",children:l.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[t<l.length-1&&(0,a.jsx)("div",{className:"absolute left-4 top-10 bottom-0 w-0.5 bg-gray-200"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center relative z-10",children:(0,a.jsx)(P,{className:"w-4 h-4 text-green-600"})}),(0,a.jsx)("div",{className:"flex-1 pb-6",children:(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-blue-600 mb-3",children:[y(e.createdAt)," • by"," ",e.createdByName]}),(0,a.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:e.content})]})})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})}),(0,a.jsx)("p",{className:"font-medium",children:"No updates yet"}),(0,a.jsx)("p",{className:"text-sm",children:i?"Post your first update to keep supporters informed":"The petition creator hasn't posted any updates"})]})]})})}let L=e=>{let[t,s]=(0,r.useState)(null),[a,i]=(0,r.useState)(!0),[l,n]=(0,r.useState)("");return(0,r.useEffect)(()=>{if(!e){i(!1);return}(async()=>{try{i(!0);let t=await (0,g.Am)(e);t?(s(t),n("")):(n("Petition not found"),s(null))}catch(e){console.error("Error loading petition:",e),n("Failed to load petition"),s(null)}finally{i(!1)}})()},[e]),{petition:t,loading:a,error:l}};var M=s(8161),D=s(9289),B=s(3101),Z=s(2442),T=s(2549);let U=(0,w.Z)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);var E=s(6587),F=s(4530);let I=(0,w.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function R(e){let{data:t,onClose:s}=e,r=(()=>{switch(t.type){case"approved":return{bg:"bg-green-50 border-green-200",icon:(0,a.jsx)(F.Z,{className:"w-6 h-6 text-green-600"}),iconBg:"bg-green-100",textColor:"text-green-900",titleColor:"text-green-800"};case"rejected":return{bg:"bg-red-50 border-red-200",icon:(0,a.jsx)(I,{className:"w-6 h-6 text-red-600"}),iconBg:"bg-red-100",textColor:"text-red-900",titleColor:"text-red-800"};case"paused":return{bg:"bg-orange-50 border-orange-200",icon:(0,a.jsx)(B.Z,{className:"w-6 h-6 text-orange-600"}),iconBg:"bg-orange-100",textColor:"text-orange-900",titleColor:"text-orange-800"};case"deleted":return{bg:"bg-gray-50 border-gray-300",icon:(0,a.jsx)(N.Z,{className:"w-6 h-6 text-gray-600"}),iconBg:"bg-gray-100",textColor:"text-gray-900",titleColor:"text-gray-800"};case"archived":return{bg:"bg-blue-50 border-blue-200",icon:(0,a.jsx)(C,{className:"w-6 h-6 text-blue-600"}),iconBg:"bg-blue-100",textColor:"text-blue-900",titleColor:"text-blue-800"};case"deletion_approved":return{bg:"bg-red-50 border-red-200",icon:(0,a.jsx)(F.Z,{className:"w-6 h-6 text-red-600"}),iconBg:"bg-red-100",textColor:"text-red-900",titleColor:"text-red-800"};case"deletion_denied":return{bg:"bg-yellow-50 border-yellow-200",icon:(0,a.jsx)(I,{className:"w-6 h-6 text-yellow-600"}),iconBg:"bg-yellow-100",textColor:"text-yellow-900",titleColor:"text-yellow-800"};default:return{bg:"bg-gray-50 border-gray-200",icon:(0,a.jsx)(C,{className:"w-6 h-6 text-gray-600"}),iconBg:"bg-gray-100",textColor:"text-gray-900",titleColor:"text-gray-800"}}})();return(0,a.jsx)("div",{className:"relative rounded-lg border-2 ".concat(r.bg," p-4 mb-6 shadow-md animate-in slide-in-from-top duration-300"),role:"alert",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 ".concat(r.iconBg," rounded-full p-2"),children:r.icon}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold ".concat(r.titleColor," mb-1"),children:t.title}),(0,a.jsx)("p",{className:"text-sm ".concat(r.textColor," mb-2"),children:t.message}),t.reason&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-white bg-opacity-60 rounded-md border border-current border-opacity-20",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"Admin's Reason:"}),(0,a.jsxs)("p",{className:"text-sm ".concat(r.textColor," italic"),children:['"',t.reason,'"']})]}),t.timestamp&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:t.timestamp.toLocaleString()})]}),(0,a.jsx)("button",{onClick:s,className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close notification",children:(0,a.jsx)(T.Z,{className:"w-5 h-5"})})]})})}function V(){var e,t;let l=(0,i.useParams)(),o=(0,i.useRouter)(),f=(0,i.useSearchParams)(),y=null==l?void 0:l.id,{user:w,userProfile:C}=(0,b.useAuth)(),{petition:z,loading:P,error:F}=L(y),[I,V]=(0,r.useState)(!1),[Y,q]=(0,r.useState)(!1),[W,H]=(0,r.useState)(!1),[_,O]=(0,r.useState)(!1),[X,$]=(0,r.useState)(!1),[G,Q]=(0,r.useState)(null),[J,K]=(0,r.useState)(null),[ee,et]=(0,r.useState)(!1),[es,ea]=(0,r.useState)("petition"),[er,ei]=(0,r.useState)(0),el=C&&("admin"===C.role||"moderator"===C.role);(0,r.useEffect)(()=>{(async()=>{if((null==z?void 0:z.creatorId)&&!J&&!ee){et(!0);try{let e=await (0,g.GA)(z.creatorId);K(e)}catch(e){console.error("Error fetching creator:",e)}finally{et(!1)}}})()},[null==z?void 0:z.creatorId,J,ee]),(0,r.useEffect)(()=>{(async()=>{if(null==z?void 0:z.id)try{let{collection:e,query:t,where:a,getCountFromServer:r}=await Promise.resolve().then(s.bind(s,8121)),{db:i}=await Promise.resolve().then(s.bind(s,1221)),l=e(i,"comments"),n=t(l,a("petitionId","==",z.id)),o=await r(n);ei(o.data().count)}catch(e){console.error("Error fetching comments count:",e)}})()},[null==z?void 0:z.id]),(0,r.useEffect)(()=>{if(!z)return;let e=f.get("notif"),t=f.get("reason");if(console.log("\uD83D\uDD0D Checking for notification parameters:",{notifType:e,notifReason:t,hasSearchParams:!!f,allParams:Object.fromEntries(f.entries())}),e){console.log("✅ Found notification type:",e);let s=null;switch(e){case"approved":s={type:"approved",title:"Petition Approved!",message:"Your petition has been approved by our moderation team and is now live on the platform.",reason:t||void 0,timestamp:new Date};break;case"rejected":s={type:"rejected",title:"Petition Rejected",message:"Your petition has been rejected by our moderation team.",reason:t||void 0,timestamp:new Date};break;case"paused":s={type:"paused",title:"Petition Paused",message:"Your petition has been temporarily paused by our moderation team.",reason:t||void 0,timestamp:new Date};break;case"deleted":s={type:"deleted",title:"Petition Deleted",message:"Your petition has been removed from the platform.",reason:t||void 0,timestamp:new Date};break;case"archived":s={type:"archived",title:"Petition Archived",message:"Your petition has been archived.",reason:t||void 0,timestamp:new Date};break;case"deletion_approved":s={type:"deletion_approved",title:"Deletion Request Approved",message:"Your deletion request has been approved. The petition has been removed.",reason:t||void 0,timestamp:new Date};break;case"deletion_denied":s={type:"deletion_denied",title:"Deletion Request Denied",message:"Your deletion request has been denied by our moderation team.",reason:t||void 0,timestamp:new Date}}if(s){console.log("✅ Setting notification alert:",s),Q(s);let e=window.location.pathname;window.history.replaceState({},"",e)}else console.log("❌ No alert data created for notification type:",e)}else console.log("ℹ️ No notification type found in URL")},[z,f]);let en=async e=>{if(z&&w)try{O(!0),await (0,g.Qq)(z.id,{name:(null==C?void 0:C.name)||w.displayName||"Anonymous",phone:e,location:{country:"Morocco"},comment:""}),V(!1),alert("Thank you for signing this petition!")}catch(e){console.error("Error signing petition:",e),alert(e.message||"Failed to sign petition. Please try again.")}finally{O(!1)}},eo=async e=>{if((0,E.fc)(C)&&z&&C){$(!0);try{await (0,g.Sp)(z.id,e,C.id);try{await (0,D.t8)(z.id,z.creatorId,z.title,e)}catch(e){console.warn("Failed to send notification, but status updated:",e)}alert("Petition ".concat(e," successfully!")),window.location.reload()}catch(e){console.error("Error updating petition:",e),alert("Error updating petition status"),$(!1)}}},ec=async()=>{(0,E.fc)(C)&&confirm("Are you sure you want to archive this petition?")&&await eo("archived")},ed=async()=>{(0,E.fc)(C)&&confirm("Are you sure you want to delete this petition? This action cannot be undone.")&&await eo("deleted")},em=async()=>{if(w&&z)try{await (0,g.Ee)(z.id,w.uid),alert("Petition deleted successfully"),o.push("/dashboard")}catch(e){console.error("Error deleting petition:",e),alert(e.message||"Failed to delete petition")}},ex=async()=>{if(w&&z)try{await (0,g.Ue)(z.id,w.uid),alert("Petition archived successfully"),o.push("/dashboard")}catch(e){console.error("Error archiving petition:",e),alert(e.message||"Failed to archive petition")}},eh=async e=>{if(w&&z)try{await (0,g.at)(z.id,w.uid,e);try{let{notifyAdminsOfDeletionRequest:t}=await Promise.resolve().then(s.bind(s,9289));await t(z.id,z.title,w.uid,e,z.currentSignatures)}catch(e){console.error("Error sending notification to admins:",e)}}catch(e){throw console.error("Error requesting deletion:",e),e}};if(P)return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(d.Z,{}),(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-4rem)]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})]});if(F||!z)return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(d.Z,{}),(0,a.jsx)("div",{className:"max-w-2xl mx-auto px-4 py-12",children:(0,a.jsx)(p.Zb,{children:(0,a.jsxs)(p.aY,{className:"py-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Petition Not Found"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:F||"The petition you are looking for does not exist."}),(0,a.jsx)(u.z,{asChild:!0,children:(0,a.jsx)(c(),{href:"/petitions",children:"Browse Petitions"})})]})})})]});let eu=(0,M.SB)(z.currentSignatures,z.targetSignatures),ep=(0,M.kC)(z.status),eg=(0,M.AN)(z.status);return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,a.jsx)(d.Z,{}),I&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full",children:(0,a.jsx)(x.Z,{onVerified:en,onCancel:()=>V(!1)})})}),Y&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Share QR Code"}),(0,a.jsx)("button",{onClick:()=>q(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)(h.Z,{petition:z,size:250,branded:!0,downloadable:!0,shareable:!0})]})}),W&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)(j,{petition:z,onClose:()=>H(!1)})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("nav",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,a.jsx)(c(),{href:"/",className:"hover:text-gray-700",children:"Home"}),(0,a.jsx)("span",{children:"/"}),(0,a.jsx)(c(),{href:"/petitions",className:"hover:text-gray-700",children:"Petitions"}),(0,a.jsx)("span",{children:"/"}),(0,a.jsx)("span",{className:"text-gray-900",children:z.title})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_340px] gap-8",children:[(0,a.jsxs)("div",{className:"w-full min-w-0 space-y-6",children:[G&&(0,a.jsx)(R,{data:G,onClose:()=>Q(null)}),(0,a.jsx)(p.Zb,{className:"w-full",style:{width:"100%",maxWidth:"100%"},children:(0,a.jsxs)(p.aY,{className:"p-6",style:{width:"100%"},children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-3",children:z.title}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6 w-full",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-".concat(ep,"-100 text-").concat(ep,"-800"),children:eg}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:z.category}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"•"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["By"," ",(0,a.jsx)("span",{className:"font-medium",children:ee?"Loading...":(null==J?void 0:J.name)||"Unknown User"})]}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"•"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:z.createdAt.toLocaleDateString()})]}),z.mediaUrls&&z.mediaUrls.length>0&&(0,a.jsx)("div",{className:"mb-6 space-y-4",children:z.mediaUrls.map((e,t)=>e.includes(".mp4")||e.includes(".webm")||e.includes(".ogg")||e.includes("video")?(0,a.jsxs)("video",{controls:!0,className:"w-full rounded-lg",children:[(0,a.jsx)("source",{src:e,type:"video/mp4"}),"Your browser does not support the video tag."]},t):(0,a.jsx)("div",{className:"relative w-full h-80 bg-gray-100 rounded-lg overflow-hidden",children:(0,a.jsx)(n(),{src:e,alt:z.title,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 66vw, 50vw"})},t))}),"paused"===z.status&&(0,a.jsx)("div",{className:"mb-6 bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(B.Z,{className:"h-5 w-5 text-orange-500"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-orange-800",children:"Petition Temporarily Paused"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-orange-700",children:"This petition is currently paused and cannot accept new signatures at this time. It may be under review or temporarily suspended by moderators."})]})]})}),(0,a.jsxs)("div",{className:"mb-6 w-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:z.currentSignatures.toLocaleString()}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[eu.toFixed(1),"% of"," ",z.targetSignatures.toLocaleString()," goal"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"bg-green-600 h-3 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(eu,100),"%")}})}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:z.targetSignatures-z.currentSignatures>0?"".concat((z.targetSignatures-z.currentSignatures).toLocaleString()," more signatures needed"):"Goal reached! \uD83C\uDF89"})]}),(0,a.jsxs)("div",{className:"flex gap-3 mb-6 w-full",children:[(0,a.jsx)(u.z,{onClick:()=>{if(!w){o.push("/auth/login?redirect=".concat(encodeURIComponent(window.location.pathname)));return}V(!0)},disabled:"approved"!==z.status||_,className:"flex-1",children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing..."]}):"Sign This Petition"}),(0,a.jsxs)(u.z,{variant:"outline",onClick:()=>{H(!0)},className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]}),(0,a.jsxs)(u.z,{variant:"outline",onClick:()=>q(!0),className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"QR Code"]})]}),(0,a.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,a.jsxs)("nav",{className:"flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>ea("petition"),className:"pb-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("petition"===es?"border-green-600 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Petition"}),(0,a.jsx)("button",{onClick:()=>ea("comments"),className:"pb-4 px-1 border-b-2 font-medium text-sm transition-colors relative ".concat("comments"===es?"border-green-600 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("span",{className:"flex items-center gap-2",children:["Comments",er>0&&(0,a.jsx)("span",{className:"inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold text-white bg-red-500 rounded-full",children:er>99?"99+":er})]})}),(0,a.jsx)("button",{onClick:()=>ea("signees"),className:"pb-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("signees"===es?"border-green-600 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Signees"}),(0,a.jsx)("button",{onClick:()=>ea("publisher"),className:"pb-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("publisher"===es?"border-green-600 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Publisher"})]})}),(0,a.jsxs)("div",{className:"min-h-[400px] w-full",children:["petition"===es&&(0,a.jsxs)("div",{className:"space-y-6 w-full",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"About this petition"}),(0,a.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap leading-relaxed",children:z.description})]}),z.youtubeVideoUrl&&(0,a.jsx)("div",{className:"relative w-full pb-[56.25%] rounded-lg overflow-hidden",children:(0,a.jsx)("iframe",{className:"absolute top-0 left-0 w-full h-full",src:z.youtubeVideoUrl.includes("embed")?z.youtubeVideoUrl:"https://www.youtube.com/embed/".concat((null===(e=z.youtubeVideoUrl.split("v=")[1])||void 0===e?void 0:e.split("&")[0])||z.youtubeVideoUrl.split("/").pop()),title:"YouTube video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),z.tags&&"string"==typeof z.tags&&z.tags.trim()&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:z.tags.split(",").map(e=>e.trim()).filter(e=>e.length>0).map((e,t)=>(0,a.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:["#",e]},t))})]}),"publisher"===es&&(0,a.jsxs)("div",{className:"space-y-6 w-full",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(null==J?void 0:J.photoURL)?(0,a.jsx)("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-gray-200 flex-shrink-0",children:(0,a.jsx)(n(),{src:J.photoURL,alt:J.name||"User",width:64,height:64,className:"object-cover"})}):(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("span",{className:"text-green-600 font-bold text-2xl",children:(null==J?void 0:null===(t=J.name)||void 0===t?void 0:t.charAt(0).toUpperCase())||"U"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:(null==J?void 0:J.name)||"Unknown User"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:null==J?void 0:J.email}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:(0,a.jsxs)("p",{children:["Member since"," ",(null==J?void 0:J.createdAt)?"string"==typeof J.createdAt?new Date(J.createdAt).toLocaleDateString():J.createdAt.toDate?J.createdAt.toDate().toLocaleDateString():new Date(J.createdAt).toLocaleDateString():"N/A"]})})]})]}),w&&z.creatorId===w.uid&&(0,a.jsx)(c(),{href:"/profile?tab=profile",children:(0,a.jsxs)(u.z,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Bio"]})})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"About the Publisher"}),(null==J?void 0:J.bio)?(0,a.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:J.bio}):(0,a.jsx)("p",{className:"text-gray-500 italic",children:w&&z.creatorId===w.uid?'You haven\'t added a bio yet. Click "Edit Bio" to add one.':"".concat((null==J?void 0:J.name)||"This user"," hasn't added a bio yet.")})]}),(z.publisherType||z.publisherName)&&(0,a.jsxs)("div",{className:"w-full bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Publisher Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[z.publisherType&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"Type"}),(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900",children:z.publisherType})]}),z.publisherName&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"Name"}),(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900",children:z.publisherName})]})]})]}),(z.petitionType||z.addressedToType||z.addressedToSpecific||z.referenceCode)&&(0,a.jsxs)("div",{className:"w-full bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-purple-900 mb-3",children:"Petition Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[z.petitionType&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-purple-700",children:"Type"}),(0,a.jsx)("p",{className:"text-sm font-medium text-purple-900",children:z.petitionType})]}),z.addressedToType&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-purple-700",children:"Addressed To"}),(0,a.jsx)("p",{className:"text-sm font-medium text-purple-900",children:z.addressedToType})]}),z.addressedToSpecific&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-xs text-purple-700",children:"Specific Target"}),(0,a.jsx)("p",{className:"text-sm font-medium text-purple-900",children:z.addressedToSpecific})]}),z.referenceCode&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-xs text-purple-700",children:"Reference Code"}),(0,a.jsx)("p",{className:"text-lg font-bold text-purple-900 font-mono tracking-wider",children:z.referenceCode}),(0,a.jsx)("p",{className:"text-xs text-purple-600 mt-1",children:"Use this code for support inquiries"})]})]})]})]}),"comments"===es&&(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(v,{petitionId:z.id,onCommentsCountChange:e=>ei(e)})}),"signees"===es&&(0,a.jsxs)("div",{className:"space-y-4 w-full",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[z.currentSignatures.toLocaleString()," ","Supporters"]})}),(0,a.jsxs)("div",{className:"w-full text-center py-8 text-gray-500",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,a.jsxs)("p",{className:"font-medium",children:[z.currentSignatures," people have signed"]}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Signature details are private for security"})]})]})]})]})}),(0,a.jsx)(A,{petitionId:z.id,isCreator:(null==w?void 0:w.uid)===z.creatorId})]}),(0,a.jsxs)("div",{className:"w-full space-y-6",children:[(0,a.jsxs)(p.Zb,{children:[(0,a.jsx)(p.Ol,{children:(0,a.jsx)(p.ll,{children:"Petition Stats"})}),(0,a.jsx)(p.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Signatures"}),(0,a.jsx)("span",{className:"font-medium",children:z.currentSignatures.toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Goal"}),(0,a.jsx)("span",{className:"font-medium",children:z.targetSignatures.toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Progress"}),(0,a.jsxs)("span",{className:"font-medium",children:[eu.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Views"}),(0,a.jsx)("span",{className:"font-medium",children:z.viewCount.toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Shares"}),(0,a.jsx)("span",{className:"font-medium",children:z.shareCount.toLocaleString()})]})]})})]}),w&&z.creatorId===w.uid&&"deleted"!==z.status&&(0,a.jsx)(S,{petition:z,onDelete:em,onArchive:ex,onRequestDeletion:eh}),el&&(0,a.jsxs)(p.Zb,{children:[(0,a.jsx)(p.Ol,{children:(0,a.jsx)(p.ll,{children:"Admin Actions"})}),(0,a.jsx)(p.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[("pending"===z.status||"rejected"===z.status)&&(0,a.jsxs)(u.z,{onClick:()=>eo("approved"),disabled:X,className:"w-full bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(Z.Z,{className:"w-4 h-4 mr-2"}),"rejected"===z.status?"Approve (Reverse Rejection)":"Approve Petition"]}),("pending"===z.status||"approved"===z.status||"paused"===z.status)&&(0,a.jsxs)(u.z,{onClick:()=>eo("rejected"),disabled:X,variant:"destructive",className:"w-full",children:[(0,a.jsx)(T.Z,{className:"w-4 h-4 mr-2"}),"Reject Petition"]}),"approved"===z.status&&(0,a.jsxs)(u.z,{onClick:()=>eo("paused"),disabled:X,variant:"outline",className:"w-full",children:[(0,a.jsx)(B.Z,{className:"w-4 h-4 mr-2"}),"Pause Petition"]}),"paused"===z.status&&(0,a.jsxs)(u.z,{onClick:()=>eo("approved"),disabled:X,className:"w-full bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(U,{className:"w-4 h-4 mr-2"}),"Resume Petition"]}),("approved"===z.status||"paused"===z.status||"rejected"===z.status)&&(0,a.jsxs)(u.z,{onClick:ec,disabled:X,variant:"outline",className:"w-full border-blue-300 text-blue-600 hover:bg-blue-50",children:[(0,a.jsx)(k,{className:"w-4 h-4 mr-2"}),"Archive Petition"]}),"archived"===z.status&&(0,a.jsxs)(u.z,{onClick:()=>eo("approved"),disabled:X,className:"w-full bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(U,{className:"w-4 h-4 mr-2"}),"Unarchive & Approve"]}),"deleted"!==z.status&&(0,a.jsxs)(u.z,{onClick:ed,disabled:X,variant:"destructive",className:"w-full",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Delete Petition"]})]})})]}),(0,a.jsx)("div",{onClick:()=>q(!0),className:"cursor-pointer hover:opacity-90 transition-opacity",children:(0,a.jsx)(h.Z,{petition:z,size:200,variant:"card",branded:!1,downloadable:!0,shareable:!1})})]})]})]}),(0,a.jsx)(m.Z,{})]})}},4182:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),r=s(2265),i=s(575);function l(e){let{onVerified:t,onCancel:s}=e,[l,n]=(0,r.useState)(""),[o,c]=(0,r.useState)(""),[d,m]=(0,r.useState)("phone"),[x,h]=(0,r.useState)(!1),[u,p]=(0,r.useState)(""),g=async()=>{if(!l.trim()){p("Please enter a valid phone number");return}h(!0),p("");try{await new Promise(e=>setTimeout(e,1e3)),m("code")}catch(e){p("Failed to send verification code")}finally{h(!1)}},j=async()=>{if(!o.trim()){p("Please enter the verification code");return}h(!0),p("");try{await new Promise(e=>setTimeout(e,1e3)),6===o.length?t(l):p("Invalid verification code")}catch(e){p("Failed to verify code")}finally{h(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Phone Verification Required"}),"phone"===d?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Please enter your phone number to sign this petition."}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,a.jsx)("input",{type:"tel",value:l,onChange:e=>n(e.target.value),placeholder:"+212 6XX XXX XXX",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),u&&(0,a.jsx)("p",{className:"text-red-600 text-sm",children:u}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(i.z,{onClick:g,disabled:x,className:"flex-1",children:x?"Sending...":"Send Code"}),(0,a.jsx)(i.z,{variant:"outline",onClick:s,disabled:x,children:"Cancel"})]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-gray-600",children:["Enter the 6-digit code sent to ",l]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Code"}),(0,a.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:"123456",maxLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-center text-lg tracking-widest"})]}),u&&(0,a.jsx)("p",{className:"text-red-600 text-sm",children:u}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(i.z,{onClick:j,disabled:x,className:"flex-1",children:x?"Verifying...":"Verify"}),(0,a.jsx)(i.z,{variant:"outline",onClick:()=>m("phone"),disabled:x,children:"Back"})]})]})]})})}},4890:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437);s(2265);var r=s(1396),i=s.n(r);function l(){return(0,a.jsx)("footer",{className:"bg-gray-900 text-white py-12 mt-auto",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold text-lg",children:"3"})}),(0,a.jsx)("span",{className:"text-xl font-bold",children:"3arida"})]}),(0,a.jsx)("p",{className:"text-gray-400",children:"Empowering Moroccan citizens to create change through petitions."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Platform"}),(0,a.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/petitions",className:"hover:text-white",children:"Discover Petitions"})}),(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/petitions/create",className:"hover:text-white",children:"Start a Petition"})}),(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/about",className:"hover:text-white",children:"About Us"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Support"}),(0,a.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/help",className:"hover:text-white",children:"Help Center"})}),(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/contact",className:"hover:text-white",children:"Contact Us"})}),(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/guidelines",className:"hover:text-white",children:"Community Guidelines"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Legal"}),(0,a.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/privacy",className:"hover:text-white",children:"Privacy Policy"})}),(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/terms",className:"hover:text-white",children:"Terms of Service"})}),(0,a.jsx)("li",{children:(0,a.jsx)(i(),{href:"/cookies",className:"hover:text-white",children:"Cookie Policy"})})]})]})]}),(0,a.jsx)("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-gray-400",children:(0,a.jsx)("p",{children:"\xa9 2024 3arida. All rights reserved. Made with ❤️ for Morocco."})})]})})}}},function(e){e.O(0,[358,139,218,682,680,396,496,340,691,298,878,69,63,770,971,938,744],function(){return e(e.s=8251)}),_N_E=e.O()}]);