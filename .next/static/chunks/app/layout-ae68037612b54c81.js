(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{7380:function(e,t,r){Promise.resolve().then(r.t.bind(r,2489,23)),Promise.resolve().then(r.t.bind(r,1654,23)),Promise.resolve().then(r.bind(r,1138)),Promise.resolve().then(r.bind(r,1602)),Promise.resolve().then(r.bind(r,2386)),Promise.resolve().then(r.bind(r,4580))},1138:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u},useAuth:function(){return c}});var i=r(7437),n=r(2265),o=r(4867),a=r(5797),s=r(6831);let l=(0,n.createContext)({user:null,userProfile:null,loading:!0,isAuthenticated:!1}),c=()=>{let e=(0,n.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function u(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[h,p]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=null,t=(0,o.Aj)(s.auth,async t=>{if(console.log("\uD83D\uDD10 Auth state changed:",t?"User logged in":"User logged out"),c(t),p(!1),e&&(e(),e=null),t){let r=(0,a.doc)(s.db,"users",t.uid);e=(0,a.cf)(r,async e=>{if(e.exists()){var r,i,n,o,a,l,c,u;let h=e.data();if(console.log("\uD83D\uDC64 User profile updated from Firestore",{hasBio:!!h.bio,bio:h.bio,isActive:h.isActive}),!1===h.isActive){console.warn("⚠️ User account is inactive, logging out..."),await s.auth.signOut(),window.location.href="/auth/login?error=account-inactive";return}d({id:t.uid,name:h.name||t.displayName||"",email:h.email||t.email||"",phone:h.phone,photoURL:h.photoURL||t.photoURL,bio:h.bio,verifiedEmail:h.verifiedEmail||t.emailVerified||!1,verifiedPhone:h.verifiedPhone||!1,role:h.role||"user",creatorPageId:h.creatorPageId,fcmToken:h.fcmToken,fcmTokenUpdatedAt:null===(i=h.fcmTokenUpdatedAt)||void 0===i?void 0:null===(r=i.toDate)||void 0===r?void 0:r.call(i),createdAt:(null===(o=h.createdAt)||void 0===o?void 0:null===(n=o.toDate)||void 0===n?void 0:n.call(o))||new Date,updatedAt:null===(l=h.updatedAt)||void 0===l?void 0:null===(a=l.toDate)||void 0===a?void 0:a.call(l),lastLoginAt:null===(u=h.lastLoginAt)||void 0===u?void 0:null===(c=u.toDate)||void 0===c?void 0:c.call(u),isActive:!1!==h.isActive})}else d({id:t.uid,name:t.displayName||"",email:t.email||"",verifiedEmail:t.emailVerified,verifiedPhone:!1,role:"user",isActive:!0,createdAt:new Date})},e=>{console.error("Error listening to user profile:",e),d({id:t.uid,name:t.displayName||"",email:t.email||"",verifiedEmail:t.emailVerified,verifiedPhone:!1,role:"user",isActive:!0,createdAt:new Date})})}else d(null)});return()=>{t(),e&&e()}},[]),(0,i.jsx)(l.Provider,{value:{user:r,userProfile:u,loading:h,isAuthenticated:!!r},children:t})}},1602:function(e,t,r){"use strict";r.r(t),r.d(t,{ProductionErrorBoundary:function(){return d},ProductionMonitoringProvider:function(){return u}});var i=r(7437),n=r(2265),o=r(1698),a=r(2601);class s{validate(){let e=[],t=[],r={};return this.requirements.forEach(e=>{let i=a.env[e.key];if(e.required&&!i){t.push("Missing required environment variable: ".concat(e.key)),t.push("  Description: ".concat(e.description)),e.example&&t.push("  Example: ".concat(e.example));return}if(i){if(e.validator&&!e.validator(i)){let r="Invalid format for ".concat(e.key,": ").concat(e.description),i=e.example?"  Expected format like: ".concat(e.example):"";t.push(r),i&&t.push(i)}e.key.includes("SECRET")||e.key.includes("PRIVATE")?r[e.key]="***HIDDEN***":r[e.key]=i}else e.required||(t.push("Optional environment variable not set: ".concat(e.key)),t.push("  Description: ".concat(e.description)))}),this.validateProductionConfig(e,t),{isValid:0===e.length,errors:e,warnings:t,config:r}}validateProductionConfig(e,t){let r="pk_test_xxxxx";r&&r.startsWith("pk_test_")&&t.push("Using Stripe test key in production environment");let i="http://localhost:3000";i&&!i.startsWith("https://")&&e.push("Production app URL must use HTTPS"),a.env.NEXTAUTH_SECRET||t.push("NEXTAUTH_SECRET not set - required for secure authentication")}generateTemplate(){let e=this.requirements.map(e=>{let t="# ".concat(e.description).concat(e.required?" (REQUIRED)":" (OPTIONAL)"),r=e.example?" # Example: ".concat(e.example):"",i=e.required?"your_value_here":"";return"".concat(t,"\n").concat(e.key,"=").concat(i).concat(r)}).join("\n\n");return"# 3arida Petition Platform - Environment Configuration\n# Copy this file to .env.production.local and fill in your values\n\n".concat(e,"\n\n# Additional Production Settings\nNODE_ENV=production\nNEXT_PUBLIC_ENABLE_ANALYTICS=true\nNEXT_PUBLIC_ENABLE_PERFORMANCE_MONITORING=true\nNEXT_PUBLIC_RATE_LIMIT_ENABLED=true\nNEXT_PUBLIC_CONTENT_MODERATION_ENABLED=true")}async validateFirebaseProject(){let e=[];try{let t;let{initializeApp:i,getApps:n}=await Promise.resolve().then(r.bind(r,607)),{getAuth:o}=await Promise.resolve().then(r.bind(r,4867)),{getFirestore:a}=await Promise.resolve().then(r.bind(r,5797)),{getStorage:s}=await Promise.resolve().then(r.bind(r,8071)),l={apiKey:"AIzaSyAhYUelLCS8ItJwaltcjtUl8HHJwp605T0",authDomain:"arida-c5faf.firebaseapp.com",projectId:"arida-c5faf",storageBucket:"arida-c5faf.firebasestorage.app",messagingSenderId:"446881275370",appId:"1:446881275370:web:283f0360cfab3556a32693",measurementId:"your_measurement_id"};t=0===n().length?i(l):n()[0];let c=o(t),u=a(t),d=s(t);return c||e.push("Firebase Auth initialization failed"),u||e.push("Firestore initialization failed"),d||e.push("Firebase Storage initialization failed"),{isValid:0===e.length,errors:e,projectInfo:{projectId:l.projectId,authDomain:l.authDomain,storageBucket:l.storageBucket}}}catch(t){return e.push("Firebase initialization error: ".concat(t instanceof Error?t.message:"Unknown error")),{isValid:!1,errors:e}}}validateStripeConfig(){let e=[],t=[],r="pk_test_xxxxx";return r?(r.startsWith("pk_")||e.push("Invalid Stripe publishable key format"),r.startsWith("pk_test_")?t.push("Using Stripe test key in production - payments will not be processed"):r.startsWith("pk_live_")||e.push("Production environment requires Stripe live keys (pk_live_...)"),{isValid:0===e.length,errors:e,warnings:t}):(e.push("Stripe publishable key not configured"),{isValid:!1,errors:e,warnings:t})}constructor(){this.requirements=[{key:"NEXT_PUBLIC_APP_URL",required:!0,validator:e=>e.startsWith("https://"),description:"Production app URL",example:"https://3arida.ma"},{key:"NEXT_PUBLIC_APP_NAME",required:!0,description:"Application name",example:"3arida"},{key:"NEXT_PUBLIC_FIREBASE_API_KEY",required:!0,validator:e=>e.length>20,description:"Firebase API key"},{key:"NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN",required:!0,validator:e=>e.includes(".firebaseapp.com"),description:"Firebase Auth domain",example:"your-project.firebaseapp.com"},{key:"NEXT_PUBLIC_FIREBASE_PROJECT_ID",required:!0,description:"Firebase project ID"},{key:"NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET",required:!0,validator:e=>e.includes(".appspot.com"),description:"Firebase Storage bucket",example:"your-project.appspot.com"},{key:"NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID",required:!0,validator:e=>/^\d+$/.test(e),description:"Firebase messaging sender ID"},{key:"NEXT_PUBLIC_FIREBASE_APP_ID",required:!0,validator:e=>e.startsWith("1:"),description:"Firebase app ID"},{key:"NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY",required:!0,validator:e=>e.startsWith("pk_live_")||e.startsWith("pk_test_"),description:"Stripe publishable key (should be pk_live_ for production)"},{key:"STRIPE_SECRET_KEY",required:!1,description:"Stripe secret key (server-side only)"},{key:"NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID",required:!1,validator:e=>e.startsWith("G-"),description:"Google Analytics measurement ID",example:"G-XXXXXXXXXX"},{key:"NEXT_PUBLIC_SENTRY_DSN",required:!1,validator:e=>e.startsWith("https://"),description:"Sentry DSN for error tracking"}]}}let l=new s;async function c(){console.log("\uD83D\uDD0D Validating environment configuration...");let e=l.validate();if(!e.isValid)return console.error("❌ Environment validation failed:"),e.errors.forEach(e=>console.error("  ".concat(e))),console.warn("⚠️ Continuing despite validation errors - some features may not work"),!0;e.warnings.length>0&&(console.warn("⚠️ Environment validation warnings:"),e.warnings.forEach(e=>console.warn("  ".concat(e))));try{let e=await l.validateFirebaseProject();if(!e.isValid)return console.error("❌ Firebase validation failed:"),e.errors.forEach(e=>console.error("  ".concat(e))),console.warn("⚠️ Continuing despite Firebase validation errors"),!0}catch(e){return console.error("❌ Firebase validation error:",e),console.warn("⚠️ Continuing despite Firebase validation errors"),!0}let t=l.validateStripeConfig();return t.isValid?(t.warnings.length>0&&t.warnings.forEach(e=>console.warn("  ".concat(e))),console.log("✅ Environment validation completed successfully")):(console.error("❌ Stripe validation failed:"),t.errors.forEach(e=>console.error("  ".concat(e))),console.warn("⚠️ Continuing despite Stripe validation errors")),!0}function u(e){let{children:t}=e;return(0,n.useEffect)(()=>{(async()=>{try{if(!await c()){console.error("❌ Environment validation failed in production");return}(0,o.initializeMonitoring)(),console.log("\uD83D\uDE80 3arida Petition Platform initialized successfully");try{let{getAnalytics:e,logEvent:t}=await r.e(9891).then(r.bind(r,9891)),i=e();t(i,"app_startup",{environment:"production",timestamp:Date.now()})}catch(e){console.warn("Failed to log startup event:",e)}}catch(e){console.error("❌ Failed to initialize application:",e),window.dispatchEvent(new CustomEvent("app-initialization-error",{detail:{error:e}}))}})()},[]),(0,i.jsx)(i.Fragment,{children:t})}function d(e){let{children:t}=e;return(0,n.useEffect)(()=>{let e=e=>{console.error("Global error caught:",e.error),Promise.resolve().then(r.bind(r,1698)).then(t=>{let{errorTracker:r}=t;r.trackError(e.error,{type:"global_error",filename:e.filename,lineno:e.lineno,colno:e.colno})})},t=e=>{console.error("Unhandled promise rejection:",e.reason),Promise.resolve().then(r.bind(r,1698)).then(t=>{let{errorTracker:r}=t;r.trackError(Error(e.reason),{type:"unhandled_promise_rejection"})})};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[]),(0,i.jsx)(i.Fragment,{children:t})}},2386:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var i=r(7437),n=r(2265);function o(){let[e,t]=(0,n.useState)(null),[r,o]=(0,n.useState)(!1),[a,s]=(0,n.useState)(!1);(0,n.useEffect)(()=>{s(!0);{let e=localStorage.getItem("pwaInstallDismissed");if(e){let t=parseInt(e);if(Date.now()-t<6048e5)return}}let e=e=>{e.preventDefault(),t(e),setTimeout(()=>{o(!0)},1e4)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);let l=async()=>{if(!e)return;e.prompt();let{outcome:r}=await e.userChoice;console.log("User response to install prompt: ".concat(r)),t(null),o(!1)};return a&&r&&e?(0,i.jsx)("div",{className:"fixed top-4 left-4 right-4 md:left-auto md:right-4 md:w-96 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-lg shadow-lg p-4 z-50 animate-slide-down",children:(0,i.jsxs)("div",{className:"flex items-start gap-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h3",{className:"text-sm font-semibold text-white mb-1",children:"ثبّت تطبيق 3arida"}),(0,i.jsx)("p",{className:"text-sm text-purple-100 mb-3",children:"احصل على تجربة أفضل مع التطبيق. يعمل بدون إنترنت ويرسل إشعارات فورية!"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:l,className:"flex-1 bg-white text-purple-600 text-sm font-medium px-4 py-2 rounded-lg hover:bg-purple-50 transition-colors",children:"تثبيت الآن"}),(0,i.jsx)("button",{onClick:()=>{o(!1),localStorage.setItem("pwaInstallDismissed",Date.now().toString())},className:"px-4 py-2 text-sm font-medium text-white hover:bg-white/10 rounded-lg transition-colors",children:"✕"})]})]})]})}):null}},4580:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var i=r(7437),n=r(2265),o=r(1138),a=r(6997),s=r(6831);let l=null;try{l=(0,a.KL)(s.Z)}catch(e){console.error("Failed to initialize Firebase Messaging:",e)}async function c(){try{if(!("Notification"in window))return console.log("This browser does not support notifications"),null;let e=await Notification.requestPermission();if("granted"!==e)return console.log("Notification permission denied"),null;if(!l)return console.error("Firebase Messaging not initialized"),null;let t=await (0,a.LP)(l,{vapidKey:"BKSAZcAXAFWEt8aB9sIU0aqT0_T5mmJ0HMFg2QdvSbBb_YTghHIzJ7QyR0vtXFTkPZQDzFRI_MxZcoCbqALcudg"});return console.log("FCM Token:",t),t}catch(e){return console.error("Error getting notification permission:",e),null}}async function u(e,t){try{let{doc:i,setDoc:n}=await Promise.resolve().then(r.bind(r,5797)),{db:o}=await Promise.resolve().then(r.bind(r,6831));return await n(i(o,"users",e),{fcmToken:t,fcmTokenUpdatedAt:new Date},{merge:!0}),console.log("FCM token saved to Firestore"),!0}catch(e){return console.error("Error saving FCM token:",e),!1}}function d(){let{user:e}=(0,o.useAuth)(),[t,r]=(0,n.useState)(!1),[s,d]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1);(0,n.useEffect)(()=>{p(!0)},[]),(0,n.useEffect)(()=>{if(!h||!e||!("Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window))return;{let e=localStorage.getItem("pushNotificationDismissed");if(e){let t=parseInt(e);if(Date.now()-t<6048e5)return}}let t="Notification"in window?Notification.permission:null;if("default"===t){let e=setTimeout(()=>{r(!0)},5e3);return()=>clearTimeout(e)}"granted"===t&&m()},[h,e]),(0,n.useEffect)(()=>{if(!h||!e)return;let t=function(e){if(l)return(0,a.ps)(l,t=>{console.log("Foreground message received:",t),e(t),t.notification&&new Notification(t.notification.title||"New Notification",{body:t.notification.body,icon:"/icon-192x192.png",badge:"/icon-192x192.png",data:t.data})})}(e=>{console.log("Received foreground message:",e)});return()=>{t&&t()}},[h,e]);let m=async()=>{if(e){d(!0);try{let t=await c();t&&(await u(e.uid,t),r(!1))}catch(e){console.error("Error enabling notifications:",e)}finally{d(!1)}}};return h&&t?(0,i.jsx)("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-4 z-50 animate-slide-up",children:(0,i.jsxs)("div",{className:"flex items-start gap-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-full flex items-center justify-center",children:(0,i.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"تفعيل الإشعارات الفورية"}),(0,i.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:"احصل على تحديثات فورية عند الموافقة على عريضتك أو وصولها لهدف جديد"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:m,disabled:s,className:"flex-1 bg-gradient-to-r from-purple-600 to-indigo-600 text-white text-sm font-medium px-4 py-2 rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-colors disabled:opacity-50",children:s?"جاري التفعيل...":"تفعيل"}),(0,i.jsx)("button",{onClick:()=>{r(!1),localStorage.setItem("pushNotificationDismissed",Date.now().toString())},className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"لاحقاً"})]})]})]})}):null}},6831:function(e,t,r){"use strict";r.d(t,{auth:function(){return l},db:function(){return c},t:function(){return u}});var i=r(607),n=r(4867),o=r(5797),a=r(8071);let s=0===(0,i.getApps)().length?(0,i.initializeApp)({apiKey:"AIzaSyAhYUelLCS8ItJwaltcjtUl8HHJwp605T0".trim(),authDomain:"arida-c5faf.firebaseapp.com".trim(),projectId:"arida-c5faf".trim(),storageBucket:"arida-c5faf.firebasestorage.app".trim(),messagingSenderId:"446881275370".trim(),appId:"1:446881275370:web:283f0360cfab3556a32693".trim()}):(0,i.Mq)(),l=(0,n.getAuth)(s),c=(0,o.getFirestore)(s),u=(0,a.getStorage)(s);t.Z=s},1698:function(e,t,r){"use strict";r.r(t),r.d(t,{errorTracker:function(){return l},initializeMonitoring:function(){return u},performanceCollector:function(){return c},productionMonitor:function(){return s},useMonitoring:function(){return d}});var i=r(2601);class n{registerDefaultHealthChecks(){this.registerHealthCheck("firebase-auth",this.checkFirebaseAuth.bind(this)),this.registerHealthCheck("firestore",this.checkFirestore.bind(this)),this.registerHealthCheck("storage",this.checkStorage.bind(this)),this.registerHealthCheck("stripe",this.checkStripe.bind(this))}registerHealthCheck(e,t){this.healthChecks.set(e,t)}async runHealthChecks(){let e=[];for(let[t,r]of Array.from(this.healthChecks))try{let i=await Promise.race([r(),this.timeoutPromise(t,5e3)]);e.push(i)}catch(r){e.push({service:t,status:"unhealthy",responseTime:5e3,error:r instanceof Error?r.message:"Unknown error",timestamp:Date.now()})}return{overall:this.calculateOverallHealth(e),services:e,uptime:Date.now()-this.startTime,version:i.env.npm_package_version||"1.0.0"}}calculateOverallHealth(e){let t=e.filter(e=>"unhealthy"===e.status).length,r=e.filter(e=>"degraded"===e.status).length;return t>0?"unhealthy":r>0?"degraded":"healthy"}timeoutPromise(e,t){return new Promise((r,i)=>{setTimeout(()=>{i(Error("Health check timeout for ".concat(e)))},t)})}async checkFirebaseAuth(){let e=performance.now();try{let{getAuth:t}=await Promise.resolve().then(r.bind(r,4867)),i=t();if(i&&void 0!==i.currentUser)return{service:"firebase-auth",status:"healthy",responseTime:performance.now()-e,timestamp:Date.now()};throw Error("Firebase Auth not properly initialized")}catch(t){return{service:"firebase-auth",status:"unhealthy",responseTime:performance.now()-e,error:t instanceof Error?t.message:"Unknown error",timestamp:Date.now()}}}async checkFirestore(){let e=performance.now();try{let{doc:t,getDoc:i}=await Promise.resolve().then(r.bind(r,5797)),{db:n}=await Promise.resolve().then(r.bind(r,6831)),o=t(n,"system","health");await i(o);let a=performance.now()-e;return{service:"firestore",status:a>1e3?"degraded":"healthy",responseTime:a,timestamp:Date.now()}}catch(t){return{service:"firestore",status:"unhealthy",responseTime:performance.now()-e,error:t instanceof Error?t.message:"Unknown error",timestamp:Date.now()}}}async checkStorage(){let e=performance.now();try{let{getStorage:t,ref:i,getDownloadURL:n}=await Promise.resolve().then(r.bind(r,8071)),o=t(),a=i(o,"health-check.txt");if(o&&a)return{service:"storage",status:"healthy",responseTime:performance.now()-e,timestamp:Date.now()};throw Error("Storage not accessible")}catch(t){return{service:"storage",status:"unhealthy",responseTime:performance.now()-e,error:t instanceof Error?t.message:"Unknown error",timestamp:Date.now()}}}async checkStripe(){let e=performance.now();try{let t="pk_test_xxxxx";if(!t)throw Error("Stripe publishable key not configured");if(!t.startsWith("pk_"))throw Error("Invalid Stripe publishable key format");return{service:"stripe",status:"healthy",responseTime:performance.now()-e,timestamp:Date.now()}}catch(t){return{service:"stripe",status:"unhealthy",responseTime:performance.now()-e,error:t instanceof Error?t.message:"Unknown error",timestamp:Date.now()}}}async logMetrics(){try{let e=await this.runHealthChecks();this.sendHealthMetrics(e)}catch(e){console.error("Health check failed:",e)}}async sendHealthMetrics(e){try{let{getAnalytics:t,logEvent:i}=await r.e(9891).then(r.bind(r,9891)),n=t();i(n,"system_health_check",{overall_status:e.overall,uptime_seconds:Math.round(e.uptime/1e3),healthy_services:e.services.filter(e=>"healthy"===e.status).length,total_services:e.services.length}),e.services.forEach(e=>{i(n,"service_health_check",{service_name:e.service,status:e.status,response_time_ms:Math.round(e.responseTime)})})}catch(e){console.warn("Failed to send health metrics:",e)}}constructor(){this.healthChecks=new Map,this.startTime=Date.now(),this.registerDefaultHealthChecks()}}class o{trackError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={error:e,context:t,timestamp:Date.now(),userId:this.getCurrentUserId(),url:window.location.href};this.errorQueue.push(r),this.reportError(r),this.errorQueue.length>100&&this.errorQueue.shift()}async reportError(e){try{var t;let{getAnalytics:i,logEvent:n}=await r.e(9891).then(r.bind(r,9891)),o=i();n(o,"application_error",{error_message:e.error.message,error_stack:null===(t=e.error.stack)||void 0===t?void 0:t.substring(0,500),user_id:e.userId,page_url:e.url})}catch(e){console.warn("Failed to report error:",e)}}getCurrentUserId(){try{return localStorage.getItem("userId")||void 0}catch(e){return}}getErrorSummary(){return{totalErrors:this.errorQueue.length,recentErrors:this.errorQueue.slice(-10),errorsByType:this.groupErrorsByType()}}groupErrorsByType(){return this.errorQueue.reduce((e,t)=>{let{error:r}=t,i=r.constructor.name;return e[i]=(e[i]||0)+1,e},{})}constructor(){this.errorQueue=[]}}class a{collectWebVitals(){this.observeMetric("largest-contentful-paint","LCP"),this.observeMetric("first-input","FID"),this.observeMetric("layout-shift","CLS")}observeMetric(e,t){if("PerformanceObserver"in window)try{new PerformanceObserver(r=>{r.getEntries().forEach(r=>{let i=r.startTime;"first-input"===e?i=r.processingStart-r.startTime:"layout-shift"===e&&(i=r.value),this.recordMetric(t,i)})}).observe({type:e,buffered:!0})}catch(t){console.warn("Failed to observe ".concat(e,":"),t)}}recordMetric(e,t){this.metrics.push({name:e,value:t,timestamp:Date.now(),url:window.location.pathname}),this.sendMetric(e,t)}async sendMetric(e,t){try{let{getAnalytics:i,logEvent:n}=await r.e(9891).then(r.bind(r,9891)),o=i();n(o,"performance_metric",{metric_name:e,metric_value:Math.round(t),page_path:window.location.pathname})}catch(e){console.warn("Failed to send performance metric:",e)}}constructor(){this.metrics=[]}}let s=new n,l=new o,c=new a;function u(){setInterval(()=>{s.logMetrics()},3e5),c.collectWebVitals(),window.addEventListener("error",e=>{l.trackError(e.error,{filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{l.trackError(Error(e.reason),{type:"unhandled_promise_rejection"})}),console.log("\uD83C\uDFE5 Production monitoring initialized")}function d(){return{trackError:l.trackError.bind(l),recordMetric:c.recordMetric.bind(c),getHealthStatus:s.runHealthChecks.bind(s)}}},2489:function(){}},function(e){e.O(0,[4358,139,745,2454,2971,2472,1744],function(){return e(e.s=7380)}),_N_E=e.O()}]);